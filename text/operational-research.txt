运 筹 学( 第 三 版 )甘应爱 田 丰 李维铮 李梅生 陈秉正 胡运权 顾基发 郭耀煌 钱颂迪 ( 主编 )清 华 大 学 出 版 社 ·北 京·内 容 简 介本书在修订版基础上 , 吸收了广大读者的意见 , 做了局部调整和修改。除原有 线性规划、整数规划、非线性规划、动态规划、图与网络分析、排队论、存储论、对策论、决策论、目标规划和多目标 决策以外 , 增加了启发式方法一章。本书着重介绍运筹学的基本原理和方法 , 注重结合经济管理专业实际 , 具有一定的深度和 广度。书中每章后附有 习题 , 便于 自 学。有 些部 分 的 后面 增 补 了“注 记”, 便 于 读者 了 解 运筹 学 各 分支 的 发 展趋势。本书可作为高等院校理工科各专业的教材 , 亦可作为考研究生的参考书。版权所有 , 翻印必究。举报电话 : 010-62782989 13501256678 13801310933本书封面贴有清华大学出版社防伪标签 , 无标签者不得销售。本书防伪标签采用特殊防伪技术 , 用户可通过在图案表面涂抹清水 , 图案消失 , 水干后图案 复现 ; 或 将表面膜揭下 , 放在白纸上用彩笔涂抹 , 图案在白纸上再现的方法识别真伪。图书在版编目 (CIP)数据运筹学/ 《运筹学》教材编写组编 . —3 版 . —北京 : 清华大学出版社 , 2005. 6ISBN 7-302-10214-7Ⅰ. 运… Ⅱ. 运… Ⅲ. 运筹学 - 高等学校 - 教材 Ⅳ. O22中国版本图书馆 CIP 数据核字( 2004) 第 139321 号出 版 者 : 清华大学出版社地址 : 北京清华大学学研大厦h tt p : / / www .tup .com .c n邮编 : 100084社 总 机 : 010-62770175客户服务 : 010-62776969责任编辑 : 魏荣桥印 装 者 : 北京市清华园胶印厂发 行 者 : 新华书店总店北京发行所开本 : 185×260 印张 : 30 .5 字数 : 721 千字版次 : 2005 年 6 月第 3 版 2005 年 6 月第1次印刷书号 : ISBN 7-302-10214-7/ F·1041印数 : 1～0000定价 : 00. 00 元序言( 修订版 )为了实现我国的四个现代化 , 我们不但要学习和掌握先进的科学技术 , 而且要学习和 掌握现代化的科学管理方法。近几年来 , 我们从管理实践中更加认识到 , 由于计划和管理 不当 , 在时间、人力、物力和资金等方面造成了很大的浪费 , 从而给我国的经济建设带来了 严重损失。为了适应现代化管理的需要 , 最近几年在我国许多工科院校中 , 相继建立了一 些工业经济、工商管理或系统工程等系或专业 , 并且都开设了运筹学的课程。运筹学是近几十年来发展起来的一门新兴学科。它的目的是为行政管理人员在做决策时提供科学的依据。因此 , 它是实现管理现代化的有力工具。运筹学在生产管理、工程 技术、军事作战、科学试验、财政经济以及社会科学中都得到了极为广泛的应用。应用运筹学去处理问题时 , 有两个重要的 特点 : 一 是从 全局的 观点 出发 ; 二是 通过 建 立模型 , 如数学模型或模拟模型 , 对于要求解的问题得到最合理的决策。在建立模型和求 解的过程中 , 往往要用到一些数学方法和 技巧。因 此 , 许多 运筹学 工作 者 , 特别是 中国 的 运筹学工作者 , 往往都是来自数学专业。由于这个原因 , 目前国内流行的有关运筹学的教 科书 , 多半偏重于数学方法的论证 , 对于解决实际问题时所需要的建立模型的概念与解题 的技巧不够重视。这种情况不太适宜于工科院校学生的需要。本书是专为工科院校的经济管理专业的学生编写的。内容上力求深入浅出 , 文字通俗易懂 , 方法上着重于思路和几 何的直观解释 , 并尽量结合经济管理专业举一些实例。本书自 1982 年出版以来 , 受到工科院校从事运筹学教学的老师和学习运筹学的学生 们的欢迎 , 1990 年修订版已经被国家教委管理工程类专业教 材委员 会推荐为 经济管理 类 通用教材。在总结多年本书教学经验基础上 , 吸收了广大读者的意见 , 作者们做了进一步 修改和增补 , 增加了绪论部分、目标规划、多目标决策等 , 原来各章也根据不同情况做了修 改。它的出版无疑对我国运筹学教学以及促进运筹学的研究都将是有意义的。中国数学会运筹学会 许国志 桂湘云·Ⅰ·第三版前言1980 年 11 月在天津大学召开了教育部直属高等工科院 校经济 管理工程 专业的第 二 次座谈会 ( 管理工程专业协作组会议 ) 。会上讨论了六门课的教学大纲。与会运筹学教师虽然初次见面 , 但志同道合地决定集体编写《运筹学》教材。参加编写的作者有 : 李维铮 、郭耀煌、甘应爱、田丰、郑大本 、李梅生、胡运权、钱颂迪、顾基发、李德 。《运筹学》试用教材的编写完成后 , 于 1982 年 2 月由清华大学出版社出版。该书是国内首次出版的运筹学 大学教材 , 受到各方面普遍的关注。经各 校使用 后 , 总结 经验 , 在 1990 年出 版了修 订版 ,参加修订的作者有 : 甘 应爱、田丰、李维铮 、李 梅生、陈秉正、郑大本 、胡运权、顾 基发、郭耀煌、钱颂迪、薛华成。现又 经过 14 年。 运筹 学的 研究 和 应用 在 我国 获 得了 更 大 发展。 为适应当前高校运筹学教学和科研的需要 , 本教 材再次 修订 和出 版第三 版。参加 这次 修 订的作者 , 除个别的还年轻外 , 大部分作者已退居二线或已退休。本教材从开始编写到第 三版出版 , 自始至终充分体现了作者之间的真诚合作精神。当第三版出版时 , 我们深深地 怀念已去世的作者李德、郑大本、李维铮三位教授。这次修订的主导思想是 : 教材中的内容都是运筹学的基础知识 , 所以全书的内容不做 大变动 , 在文字表达和内容阐述方面力求简明正确。修改陈旧的内容 , 个别的章节给予重 写 , 如修订后网络计划一章的术语与符号都符合新的技术规程 , 适当增加新内容。我国拥有资源量 , 按人均来看 , 是一个资源相对贫乏的国家。如何合理、有效、经济地 利用资源 , 是一个迫切需要研究解决的问 题。提高 管理 工作的 效能 和效 益 , 使人尽 其才 , 物尽其用 , 将运筹学的方法应用于实践 , 运筹 学的应 用有 着广阔 的前 景。管理 工作 者、科 学工作者和从事工程科学管理的人们都需要学习和掌握这门科学 , 以适应我国 21 世纪经 济建设的需要。参加本次修订的作者为 : 一、绪论 二、线性规划和目标规划顾基发 ( 中国科学院系统科学研究所 )钱颂迪 ( 南京航天管理干部学院 ) 胡运权 ( 哈尔滨工业大学管理学院 )三、整数规划李维铮 ( 天津大学管理学院 )四、非线性规划五、动态规划郭耀煌 ( 西南交通大学经济管理学院 ) 甘应爱 ( 华中科技大学 )六、图与网络分析第 10 章 第 11 章田 丰 ( 中国科学院系统科学研究所 ) 钱颂迪七、排队论李维铮 ( 天津大学管理学院 )八、存储论李梅生 ( 华中科技大学 )·Ⅲ·九、对策论陈秉正 ( 清华大学管理学院 )十、决策论第 15 章 第 16 章 十一、启发式方法钱颂迪顾基发第 17 章郭耀煌本书如有不妥之处 , 敬请广大读者批评指正。·Ⅳ·作者目录一 、绪论第 1 节 运筹学的简史 第 2 节 运筹学的性质和特点 第 3 节 运筹学的工作步骤 第 4 节 运筹学的模型 第 5 节 运筹学的应用 第 6 节 运筹学的展望 参考资料…………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………123346…………………………………………………………………………………7二 、线性规 划与目标规 划第 1 章 线性规划与单纯形法………………………………………………………………8第 1 节 线性规划问题及其数学模型 第 2 节 线性规划问题的几何意义 第 3 节 单纯形法 第 4 节 单纯形法的计算步骤 第 5 节 单纯形法的进一步讨论 第 6 节 应用举例 习题……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………81620283238……………………………………………………………………………………44第 2 章 对偶理论和灵敏度分析…………………………………………………………47第 1 节 单纯形法的矩阵描述 第 2 节 改进单纯形法 第 3 节 对偶问题的提出 第 4 节 线性规划的对偶理论 第 5 节 对偶问题的经济解释———影子价格 第 6 节 对偶单纯形法 第 7 节 灵敏度分析 第 8 节 * 习题……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………参数线性规划4748515360616370……………………………………………………………………………………73第 3 章 运输问题…………………………………………………………………………78第 1 节 运输问题的数学模型 第 2 节 表上作业法 第 3 节 产销不平衡的运输问题及其求解方法 第 4 节 应用举例……………………………………………………………………………………………………………………………………………………………………………………………………………………………………78798991·Ⅴ·习题……………………………………………………………………………………第 4 章 目标规划…………………………………………………………………………第 1 节 目标规划的数学模型 第 2 节 解目标规划的图解法 第 3 节 解目标规划的单纯形法 第 4 节 灵敏度分析 第 5 节 应用举例 习题…………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………参考资料………………………………………………………………………………三、整 数 规 划第 5 章 整数规划…………………………………………………………………………第 1 节 整数规划问题的提出 第 2 节 分支定界解法 第 3 节 割平面解法 第 4 节 0 - 1 型整数规划 第 5 节 指派问题 习题………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………参考资料………………………………………………………………………………四、非 线性规划第 6 章 *无约束问题 第 1 节 基本概念 第 2 节 一维搜索 第 3 节 无约束极值问题的解法……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………第 7 章 *约束极值问题 第 1 节 最优性条件 第 2 节 二次规划 第 3 节 可行方向法 第 4 节 制约函数法 习题……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………参考资料………………………………………………………………………………五、动 态 规 划第 8 章 动态规划的基本方法……………………………………………………………第 1 节 多阶段决策过程及实例 第 2 节 动态规划的基本概念和基本方程 第 3 节 动态规划的最优性原理和最优性定理 第 4 节 动态规划和静态规划的关系……………………………………………………………………………………………………………………………………………………………………………………·Ⅵ·97101101103104106108111113114114115118122126131132133133146151171171175177180187190191191193201203习题……………………………………………………………………………………211第 9 章 动态规划应用举例 第 1 节 资源分配问题 第 2 节 生产与存储问题 第 3 节 * 第 4 节 * 第 5 节 排序问题 第 6 节 设备更新问题 第 7 节 * 货郎担问题 习题………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………背包问题 复合系统工作可靠性问题……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………213213224233236238241244……………………………………………………………………………………245参考资料………………………………………………………………………………250六、图与网络 分析第 10 章 图与网络优化…………………………………………………………………251第 1 节 图的基本概念 第 2 节 树 第 3 节 最短路问题 第 4 节 网络最大流问题 第 5 节 最小费用最大流问题 第 6 节 中国邮递员问题 习题…………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………251255261268274276……………………………………………………………………………………281参考资料………………………………………………………………………………284第 11 章 网络计划………………………………………………………………………286第 1 节 网络计划图 第 2 节 网络计划图的时间参数计算 第 3 节 时标网络计划图 第 4 节 网络计划的优化 第 5 节 网络计划软件 参考资料……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………286290294295298300七、排 队 论第 12 章 排队论…………………………………………………………………………301第 1 节 基本概念 第 2 节 到达间隔的分布和服务时间的分布 第 3 节 单服务台负指数分布排队系统的分析 第 4 节 多服务台负指数分布排队系统的分析 第 5 节 一般服务时间 M/ G/ 1 模型 第 6 节 经济分析———系统的最优化 第 7 节 分析排队系统的随机模拟法………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………301306313322329331335·Ⅶ·习题……………………………………………………………………………………八、存 储 论第 13 章 存储论…………………………………………………………………………第 1 节 存储论的基本概念 第 2 节 确定性存储模型 第 3 节 随机性存储模型 第 4 节 其他类型存储问题 习题……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………参考资料………………………………………………………………………………九、对 策 论第 14 章 对策论基础 第 1 节 引言 第 2 节 矩阵对策的基本定理 第 3 节 矩阵对策的解法 第 4 节 * 习题……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………其他类型对策简介……………………………………………………………………………………………………………………………………………参考资料………………………………………………………………………………十、决 策 论第 15 章 单目标决策……………………………………………………………………第 1 节 决策的分类 第 2 节 决策过程 第 3 节 不确定型的决策 第 4 节 风险决策 第 5 节 效用理论在决策中的应用 第 6 节 决策树 第 7 节 灵敏度分析 习题……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………参考资料………………………………………………………………………………第 16 章 *多目标决策…………………………………………………………………第 1 节 引 言 第 2 节 基本概念 第 3 节 化多为少的方法 第 4 节 分层序列法 第 5 节 直解求非劣解 第 6 节 多目标线性规划的解法 第 7 节 层次分析法……………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………·Ⅷ·339343343346358373374376377377380393403410412413413414416419425428431432435436436436440447448449453参考资料………………………………………………………………………………十一 、启发式 方法第 17 章 *启发式方法 第 1 节 基本概念 第 2 节 应用及例子 习题………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………………参考资料………………………………………………………………………………458460460462472474·Ⅸ·一、绪论第 1 节 运筹学的简史运筹学作为科学名字出现在 20 世纪 30 年代末。当时英、美对付德国的空袭 , 雷达作 为防空系统的一部分 , 从技术上是可行的 , 但实际运用时却并不好用。为此一些科学家研 究如何合理运用雷达开始进行一类新问题的 研究。因 为它 与研究 技术 问题不 同 , 就称 之 为“运用研究”( oper ational r esea rch ) ( 我国在 1956 年 曾用 过运用 学的 名词 , 到 1957 年 正 式定名为运筹学 ) 。为了进行运筹学研究 , 在英、美的军队中成立了一些专门小组 , 开展了 护航舰队保护商船队的编队问题和当船队遭受 德国潜 艇攻 击时 , 如何 使船 队损失 最少 的 问题的研究。 研 究 了 反 潜 深 水 炸 弹 的 合 理 爆 炸 深 度 后 , 使 德 国 潜 艇 被 摧 毁 数 增 加 到 400 % ; 研究了船只在受敌机攻击时 , 提出了大船应急转向和小船应缓慢转向的逃避方法。 研究结果使船只在受敌机攻击时 , 中弹数由 47 % 降到 29 % 。当时研究和解决的问题都是 短期的和战术性的。第二次世界大战后在英、美军队 中相 继成 立了更 为正 式的运 筹研 究组织。并以兰德公司 ( RA ND ) 为首的一些 部门开 始着 重研 究战略 性问 题、未来的 武器 系 统的设计和其可能合理运用的方法。例如为美国 空军 评价 各种轰 炸机 系统 , 讨论 了未 来 的武器系统和未来战争的战略。他们还研究了苏 联的 军事 能力及 未来 的预报 , 分 析苏 联 政治局计划的行动原则和将来的行动预测。 到 20 世纪 50 年代 , 由于 开发 了各种 洲际 导 弹 , 到底发展哪种导弹 , 运筹学界也投入了争论。 到 20 世 纪 60 年 代 , 参与 了战略 力量 的 构成和数量问题研究 , 除军事方面的应用研究以外 , 相继在工业、农业、经济和社会问题等 各领域都有应用。与此同时 , 运筹数学有了飞快的发展 , 并形成了运筹学的许多分支。如 数学规划 ( 线性规划、非线性规则、整数规划、目标规划、动态规划、随机规划等 ) 、图论与网 络、排队论 ( 随机服务系统理论 ) 、存储论、对策论、决 策论、维 修更新 理论、搜 索论、可靠 性 和质量管理等。作为运筹学的早期工作其历史可追溯到 1914 年 , 军事运筹学中的兰彻斯 特 ( Lanchester ) 战斗方程 是在 1914 年提 出 的。排队 论的 先 驱者 丹麦 工程 师爱 尔 朗 ( Er- lang )1917 年在哥本哈根电话公司研究电话通信系 统时 , 提 出了排 队论 的一 些著名 公式。 存储论的最优批量公式是在 20 世纪 20 年代初提出的。在商 业方面 列温逊在 20 世 纪 30 年代已用运筹 思 想 分 析 商 业 广 告、顾 客 心 理。 线 性 规 划 是 由 丹 捷 格 ( G. B. Dan tzig ) 在 1947 年发表的成果。所解决的问题是美国制定空军军事 规划时 提出的 , 并提 出了求解 线 性规划问题的单纯形法。而早在 1939 年前苏联的学者康托洛 维奇 ( Л.В. Канторович) 在 解决工业生产组织和计划问题时 , 已提出了类似线性规划的模型 , 并给出了“解乘数法”的 求解方法。由于当时未被领导重视 , 直到 1960 年 康托洛 维奇 再次发 表了《最佳资 源利 用 的经济计算》一书后 , 才受到国内外的一致重视。为此康托洛维奇得到了诺贝尔奖金。值 得一提的是丹捷格认 为 线 性规 划 模 型的 提 出 是 受 到了 列 昂 节 夫 的投 入 产 出 模 型 ( 1932 年 ) 的影响。关于线性规划的理论是受到了冯· 诺依曼 ( Von N eumann) 的帮 助。冯· 诺·1·依曼和摩根斯坦 ( O. Morgen ste rn) 合著的《对策论与经济行为》(1944 年 ) 是对策论的奠 基 作 , 同时该书已隐约地指出了对策论与线性 规划 对偶理 论的 紧密 联系。线 性规划 提出 后 很快受到经济学家的重视 , 如在第二次大战中 从事运 输模 型研 究的美 国经 济学家 库普 曼 斯 ( T. C. K oopmans ) , 他很快看到了线性规划在经济中应用的意义 , 并呼吁年 轻的经济 学 家要关注线性规划。其中阿罗、萨谬尔逊、西蒙、多夫 曼和 胡尔 威茨等 都获 得了诺 贝尔 奖金 , 并在运筹学某些领域中发挥过重要作用。 回顾一 下最 早投 入运筹 学领 域工作 的诺 贝 尔奖金获得者、美国物理学家勃拉凯特 ( Blacket t ) 领导的第一个以运筹学命名的小组是有 意义的。由于该小组的成员复杂 , 人们戏称它为勃拉凯特马戏团 , 其实是一个由各方面专 家组成的交叉学科小组。从以上简史可见 , 为 运筹学 的建 立和 发展作 出贡 献的有 物理 学 家、经济学家、数学家、其他专业的学者、军官和各行业的实际工作者。最早建立运筹学会的国家是英国 ( 1948 年 ) , 接 着是 美 国 ( 1952 年 ) 、法国 ( 1956 年 ) 、 日本和印度 (1957 年 ) 等。到 2005 年为止 , 国际上已有 48 个 国家和 地区建立 了运筹学 会 或类似的组织。我国的运筹学会成立在 1980 年。在 1959 年英、美、法三国的运筹学会发 起成立了国际运筹学联合会 ( IFOR S) , 以后 各国的 运筹 学会 纷纷加 入 , 我国 于 1982 年 加 入该会。此外还 有一些地 区性组 织 , 如 欧洲运 筹学协会 ( E U RO ) 成 立于 1975 年 , 亚太 运 筹学协会 ( APOR S) 成立于 1985 年。在 20 世纪 50 年代中期钱学森、许国志等教授将运筹学由西方引入我国 , 并结合我国 的特点在国内推广应用。在 经 济数 学方 面 , 特 别是 投入 产出 表的 研 究和 应用 开 展 较早。 质量控制 ( 后改为质量管理 ) 的应用也有特色。在此期间以华罗庚教授为首的一大批数学 家加入到运筹学的研究队伍 , 使运筹数学的很多分支很快跟上当时的国际水平。第 2 节 运筹学的性质和特点运筹学是一门应用科学 , 至今还没有统 一且 确切的 定义。 提出以 下几 个定义 来说 明 运筹学的性质和特点。莫斯 ( P. M. Morse ) 和金博尔 ( G. E. Kimball ) 曾对运筹学下的定义 是 :“ 为决策机构在对其控制下业务活动进行 决策时 , 提 供以 数量化 为基 础的科 学方 法。” 它首先强调的是科学方法 , 这含义不单是某种研究方法的分散和偶然的应用 , 而是可用于 整个一类问题上 , 并能传授和有组织地活动。它强调以量化为基础 , 必然要用数学。但任 何决策都包含定量和定性两方面 , 而定性方 面又不 能简 单地 用数学 表示 , 如 政治、社会 等 因素 , 只有综合多种因素的决策才是全面的。 运筹学 工作 者的 职责是 为决 策者提 供可 以 量化方面的分析 , 指出那些定性的因素。另一定义是 :“运筹学是一门应用科学 , 它广泛应 用现有的科学技术知识和数学方法 , 解决实际中提出的专门问题 , 为决策者选择最优决策 提供定量依据。”这定义表明运筹学具有多学科 交叉 的特点 , 如 综合 运用 经济学、心 理学、 物理学、化学中的一些方法。运筹学是强调最 优决策 ,“最”是过分 理想 了 , 在实际 生活 中 往往用次优、满意等概念代替最优。因此 , 运筹学的又一定义是 :“ 运筹学是一种给出问题 坏的答案的艺术 , 否则的话问题的结果会更坏。”为了有效地应用运筹学 , 前英国运筹学学会会长托姆林森提出六条原则 : (1 ) 合伙原则。是指运筹学工作者要和各方面人 , 尤其是同实际部门工作者合作。 (2 ) 催化原则。在多学科共同解决某问题时 , 要引导人们改变一些常规的看法。·2·(3 ) 互相渗透原则。要求多部门彼此渗透地考虑问题 , 而不是只局限于本部门。 (4 ) 独立原则。在研究问题时 , 不应受某人或某部门的特殊政策所 左右 , 应独立从 事工作。(5 ) 宽容原则。解决问题的思路要宽 , 方法要多 , 而不是局限于某种特定的方法。 (6 ) 平衡原则。要考虑各种矛盾的平衡 , 关系的平衡。第 3 节 运筹学的工作步骤运筹学在解决大量实际问题过程中形成了自己的工作步骤。(1 ) 提出和形成问题。即要弄清问题的目标 , 可能的约束 , 问题 的可控变 量以及有 关参数 , 搜集有关资料 ;(2 ) 建立模型。即把问题中 可控变 量、参数 和目标 与约 束之间 的关 系用 一定 的模 型表示出来 ;(3 ) 求解。用各种手段 ( 主要 是数 学方法 , 也 可用 其他方 法 ) 将模 型求 解。解 可以 是最优解、次优解、满意解。复杂模型的求解需用计算机 , 解的精度要求可由决策者提出 ;(4 ) 解的检验。首先检查求解步骤和程序有无错误 , 然后检查解是否反映现实问题 ; (5 ) 解的控制。通过控制解的变化过程决定对解是否要作一定的改变 ; (6 ) 解的实施。是指将解用 到实际 中必 须考虑 到实 施的 问题 , 如向 实际 部门 讲清 解的用法 , 在实施中可能产生的问题和修改。以上过程应反复进行。第 4 节 运筹学的模型运筹学在解决问题时 , 按研究对象不同 可构 造各种 不同 的模 型。模型 是研究 者对 客 观现实经过思维抽象后用文字、图表、符号、关 系式以 及实 体模 样描述 所认 识到的 客观 对象。模型的有关参数和关系式是较容易改变 , 这 样是有 助于 问题 的分析 和研 究。利用 模 型可以进行一定预测、灵敏度分析等。模型有三种基本形式 : ①形象模型 ; ②模拟 模型 ; ③ 符号 或数 学模型。 目前用 得最 多 的是符号或数学模型。构造模型是一种创造性劳 动 , 成功 的模 型往往 是科 学和艺 术的 结 晶 , 构模的方法和思路有以下五种 :(1 ) 直接分析法。按研究者对问题内在机理的认识直接构造 出模型。运 筹学中已 有 不少现存的模型 , 如线性规划模型、投入产出 模型、排队 模型、存储 模型、决 策和对 策模 型 等。这些模型都有很好的求解方法及求解的软件 , 但用这些现存的模型研究问题时 , 要注 意不能生搬硬套。(2 ) 类比法。有些问题可以 用不同 方法 构造出 模型 , 而 这些模 型的 结构 性质 是类 同 的 , 这就可以互相类比。如物理学中的机械系统、气体动力学系统、水力学系统、热力学系 统及电路系统之间就有不少彼此类同的现象。甚 至有 些经 济系统、社 会系 统也可 以用 物理系统来类比。在分析一些经济、社会问题时 , 不同国家之间有时也可以找出某些类比的·3·现象。(3 ) 数据分析法。对有些问 题的机 理尚 未了解 清楚 , 若 能搜集 到与 此问 题密 切相 关的大量数据 , 或通过某些试验获得大量数据 , 这就可以用统计分析法建模。(4 ) 试验分析法。当有些问题的机理不清 , 又不能做大量试验来获 得数据 , 这时只 能通过做局部试验的数据加上分析来构造模型。(5 ) 想定 ( 构想 ) 法 ( scena rio) 。 当有些 问题 的机 理不清 , 又缺 少数 据 , 又 不能 做试 验 来获得数据时 , 例如一些社会、经济、军事问 题 , 人们只 能在 已有的 知识、经 验和某 些研 究 的基础上 , 对于将来可能发生的情况给出逻 辑上 合理的 设想 和描 述。然后 用已有 的方 法 构造模型 , 并不断修正完善 , 直至比较满意为止。模型的一般数学形式可用下列表达式描述 : 目标的评价准则U = f ( x i , yj ,ξk ) g( xi , y j ,ξk ) ≥ 0约束条件其中 : xi ———可控变量 ; yj ———已知参数 ; ζk ———随机因素。目标的评价准则一般 要求 达到 最佳 ( 最大 或最 小 ) 、适 中、满意 等。 准则 可 以是 单 一 的 , 也可是多个的。约束条件可以没有 , 也可有 多个。当 g 是 等式时 , 即 为平 衡条件。 当 模型中无随机因素时 , 称它为确定性模型 , 否则为随机模型。随机模型的评价准则可用期 望值 , 也可用方差 , 还可用某种概率分布来表 示。当可 控变 量只取 离散 值时 , 称为 离散 模 型 , 否则称为连续模型。也 可按 使 用的 数学 工具 将模 型 分为 代数 方程 模 型、微 分方 程 模 型、概率统计模型、逻辑模型等。若用求解方法来命名时 , 有直接最优化模型、数字模拟模 型、启发式模型。也有按用途来命名的 , 如分配模型、运输模型、更新模型、排队模型、存储 模型等。还可以用研究对象 来命 名 , 如 能源 模型、教 育 模型、军 事 对策 模 型、宏 观经 济 模 型等。第 5 节 运筹学的应用在介绍运筹学的简史时 , 已提到了运筹学在早期的应用 , 主要在军事领域。第二次世界大战后运筹学的应用转向民用 , 这里只能对某些重要领域给予简述。(1 ) 市场销售。主要应用在 广告预 算和 媒介 的选择、竞 争性 定价、新产 品 开发、销 售 计划的制定等方面。如美国杜邦公司在 20 世纪 50 年代起就非常重视将运筹学用于研究 如何做好广告工作 , 产品定价和新产品的引入。通用电力公司对某些市场进行模拟研究。 (2 ) 生产计划。在总体计划 方面主 要用 于总体 确定 生产、存储 和劳 动力 的配 合等 计 划 , 以适应波动的需求计划 , 用线性规划和模拟方法等。如巴基斯坦某一重型制造厂用线 性规划安排生产计划 , 节省 10 % 的生产费用。还可用于生 产作业计 划、日程表的 编排等。 此外 , 还有在合理下料、配料问题、物料管理等方面的应用。(3 ) 库存管理。主要应用于多种物资库存量的管理 , 确定某些设备 的能力或 容量 , 如 停车场的大小、新增发电设备的容量大小、电 子计算 机的 内存量、合理的 水库 容量等。 美国某机器制造公司应用存储论后 , 节省 18 % 的费用。目前国 外新动 向是将库 存理论与 计 ·4·算机的物资管理信息系统相结合。如美国西电公 司 , 从 1971 年 起用 5 年 时间 建立了“ 西 电物资管理系统”, 使公司节省了大量物资存储费用和运费 , 而且减少了管理人员。(4 ) 运输问题。这涉及空 运、水运、公路 运输、铁路 运输、管 道运 输、厂 内运 输。空 运 问题涉及飞行航班和飞行机组人员服务时间安排等。为此在国际运筹学协会中设有航空组 , 专门研究空运中的运筹学问题。水运有船舶航运计划、港口装卸设备的配置和船到港 后的运行安排。公路运输除了汽车调度计划外 , 还有公路网的设计和分析 , 市内公共汽车 路线的选择和行车时刻表的安排 , 出租汽车 的调 度和停 车场 的设 立。铁路 运输方 面的 应 用就更多了。(5 ) 财 政和 会 计。这 里涉 及预 算、贷 款、成 本分 析、定 价、投资、证券 管理、现金 管 理 等。用得较多的方法是统计分析、数学规 划、决策分 析。此 外还有 盈亏 点分析 法、价值 分析法等。(6 ) 人事管理。这里涉及六个方面 , 首先是人员的获得和需求估计 ; 第二 是人才的 开 发 , 即进行教育和训练 ; 第三是人员的分配 , 主要是各种指派问题 ; 第四是各类人员的合理 利用问题 ; 第五是人才的评价 , 其中有如何测定一个人对组织、社会的贡献 ; 第六是工资和 津贴的确定等。(7 ) 设备维修、更新和可靠性、项目选择和评价。 (8 ) 工程的优化设计。这在建筑、电子、光学、机械和化工等领域都有应用。 (9 ) 计算机和信息系统。可 将运筹 学用 于计算 机的 内存 分配 , 研究 不同 排队 规则 对 磁盘工作性能的影响。有人利用整数规划寻找满足一组需求文件的寻找次序 , 利用图论、 数学规划等方法研究计算机信息系统的自动设计。(10) 城市管理。这里有各种紧急服务系统的设计和运用 , 如 救火站、救护车、警车 等 分布点的设立。美国曾用排队论方法来确定纽约市紧急电话站的值班人数。加拿大曾研究一城市的警车的配置和负责范围 , 出事故 后警 车应走 的路 线等。此 外有 城市垃 圾的 清 扫、搬运和处理 ; 城市供水和污水处理系统的规划……我国运筹学的应用是在 1957 年始于建 筑业和 纺织 业。在 理论联 系实 际的思 想指 导 下 , 从 1958 年开始在交通运输、工业、农业、水利建设、邮电等方面都有应用。尤其是在运 输方面 , 从物资调运、装卸到调度等。在粮食部门的为解决合理粮食调运问题 , 提出了“ 图 上作业法”。我国的运筹学工作者从理论上 证明 了它的 科学 性。在解 决邮 递员合 理投 递路线时 , 管梅谷提出了国外称之为“ 中国邮路问 题”的解 法。在 工业生 产中 推广了 合理 下 料 , 机床负荷分配。在纺织业中曾用排队论方法解决细纱车间劳动组织 , 最优折布长度等 问题。在农业中研究了作业布局、劳力分配 和麦场 设置 等。从 20 世纪 60 年代起 我国 的 运筹学工作者在钢铁和石油部门开展较全面的 和深入 的应 用 ; 投入产 出法 在钢铁 部门 首 先得到应用。从 1965 年起统筹法的应用在建筑业、大型设备维修计划等方面取得可喜的 进展。从 1970 年起在全国大部分省、市和部 门推广 优选 法。其应 用范 围有配 方、配比 的 选择、生产工艺条件的选择、工艺参数的确定、工程 设计 参数 的选择、仪 器仪 表的调 试等。在 20 世纪 70 年代中期最优化方法在工程设 计界 得到广 泛的 重视。在 光学 设计、船舶 设 计、飞机设计、变压器设计、电 子线 路设 计、建筑 结 构设 计和 化工 过程 设 计等 方 面都 有 成果。从 20 世纪 70 年代中期排队论开始应用于研究矿山、港口、电讯和计算机的设计等方 面。图论曾用于线路布置和计算机的设计、化学物品的存放等。存储论在我国应用较晚 , ·5·20 世纪 70 年代末在汽车工业和其他部门取得成功。近年来 运筹学 的应用已 趋向研究 规 模大和复杂的问题 , 如部门计划、区域经济规划等 ; 并已与系统工程难以分解。第 6 节 运筹学的展望关于运筹学将往哪个方向发展 , 从 20 世纪 70 年代起西方运筹学工作者有种种观点 , 至今还未说清。这里提出某些运筹学界的观 点 , 供研究 参考。 美国前 运筹 学会主 席邦 特 ( S. Bonder ) 认为 , 运筹学应在三个领域发展 : 运筹 学应用、运 筹科 学和运 筹数 学。并强 调 发展前两者 , 从整体讲应协调发展。事实上 运筹数 学到 20 世纪 70 年 代已 形成一 系列 强 有力的分支 , 数学描述 相当 完善 , 这是 一件 好事。 正是 这一 点使 不少 运 筹学 界 的前 辈 认 为 , 有些专家钻进运筹数学的深处 , 而忘掉了运 筹学的 原有 特色 , 忽略 了多 学科的 横向 交 叉联系和解决实际问题的研究。近几年来出现一 种新 的批 评 , 指出有 些人 只迷恋 于数 学 模型的精巧、复杂化 , 使用高深的数学工具 , 而 不善于 处理 面临 大量新 的不 易解决 的实 际 问题。现代运筹学工作者面临的大量新问题是 经济、技术、社会、生态 和政 治等因 素交 叉在一起的复杂系统。因此 , 从 20 世纪 70 年代末至 20 世纪 80 年代初不少运筹学家提出 : 要大家注意研究大系统 , 注意与系统分析相结合。美国科学院国际开发署写了一本书 , 其 书名就把系统分析和 运筹 学并 列。有 的运 筹学 家提 出 了“ 要从 运 筹学 到系 统分 析”的 报告。由于研究新问题的时间范围很长 , 因此 必须 与未来 学紧 密结 合。由于 面临的 问题 大 多是涉及技术、经济、社会、心理等综合因素 的研究 , 在 运筹 学中除 常用 的数 学方法 以外 , 还引入一些非数学的方法和理论。曾在 20 世纪 50 年代写过“运筹学的数学方法”的美国 运筹学家沙旦 ( T. L. Saat y) , 他在 20 世纪 70 年代末提出了层次分析法 ( A H P ) , 并认为 过 去过分强调细巧的数学模型 , 可是它很难解 决那 些非结 构性 的复 杂问题。 因此宁 可用 看 起来是简 单 和 粗 糙 的 方 法 , 加 上 决 策 者 的 正 确 判 断 , 却 能 解 决 实 际 问 题。 切 克 兰 特 ( P. B. Check land) 把传统的运筹 学方 法 称为 硬系 统思 考 , 它 适用 于解 决那 种 结构 明确 的 系统以及战术和技术性问题 , 而对于结构不 明确的 , 有 人参 与活动 的系 统就 不太胜 任了。 这就应采用软系统思考方 法 , 相 应的 一些 概念 和方 法 都应 有所 变化 , 如 将 过分 理想 化 的 “最优解”换成“满意解”。过去把求得的“解”看作精确的、不能变的凝固的东西 , 而现在要 以“易变性”的理念看待所得的“解”, 以适 应系统 的不断 变化。 解决问 题的 过程是 决策 者 和分析者发挥其创造性的过程 , 这就是进入 20 世纪 70 年 代以 来人们 愈来 愈对人 机对 话 的算法感兴趣的原因。在 20 世纪 80 年代中一 些重要 的与 运筹学 有关 的国 际会议 中 , 大 多数认为决策支持系统是使运筹学发展的 一个 好机会。 进入 20 世 纪 90 年 代和 21 世 纪 初期 , 发生两个很重要的趋势。一个是软运筹学崛 起。主要发 源地是在 英国。 1989 年 英 国运筹学学会开了一个会议 , 后来由罗 森汉 特 ( J. Rosenhead ) 主编 了一 本论文 集 , 后来 被 称为软运筹 学 的“ 圣 经”。里 面 提 到 了 不 少 新 的 属 于 软 运 筹 的 方 法。 如 软 系 统 方 法 论( SSM : Checkland ) 、战 略 假设 表 面 化与 检 验 ( SAS T : Mason & Mit roff) 、战 略选 择 ( SC: F riend) 、问题结构法 ( PSM : Bryan t & Rosenhead ) 、超 对策 ( hyperga me: Benett ) 、亚 对 策 ( Metagam e: H owa rd) 、战略选择发展与分析 ( SODA : Eden ) 、生存系统模型 ( VSM : Beer ) 、 对话式计划 ( IP : Ackoff) 、批判式系统启发 ( CS H : Ulrich) 等。2001 年该书出版修 订版 , 增 加了很多实例。另一个趋势是与优化有关的 , 即软计算。这种方法不追求严格最优 , 具有 ·6·启发式思路 , 并借用来自生物学、物理学和其他学科的思想来解寻优方法。其中最著名的 有遗传算法 ( GA : H olland) 、模 拟 退火 ( SA : Metropolis ) 、神 经 网络 ( N N ) 、模糊 逻 辑 ( FL : Zadeh) 、进化计算 ( EC) 、禁忌算法 ( TS ) 、蚁群 优化 ( ACO: Dorigo ) 等。目 前国际上 已有 世 界软计算协会。2004 年召 开第 9 届 国 际会 议。但 都 是 在网 络 上开 会 , 并 且 有杂 志 : A p- p lied soft compu ting。此外在一 些老 的 分支 方 面 , 如 线 性 规 划 也出 现 新 的 亮 点 , 如 内 点 法 ; 图论中出现无标度网络 ( scale-fr ee netw or k) 等。总之运筹学还在不 断发展中 , 新的 思 想、观点和方法不断地出现。本书作为一本教材 , 所提供的一些运筹学思想和方法都是基 本的 , 作为学习运筹学的读者必须掌握的知识。参 考 资 料[1 ] Moder J J , Elmaghraby S E. Ha ndbook of Oper ations Resea rch. Founda tions and Fundamentals,Vol. 1 ; Models and Applica tion , Vol. 2. Von Nostr and Reinhold Com pany , 1978[2 ] Morse P M , Brown A A etc. Systems Analysis and Op erations R esear ch tool for policy and programplanning for developing count ries , National Academy of Sciences , 1976[3] 日本运筹学会 . OR 事典 (1975) ; OR 事典 ( 增补别册 ) OR 事例集 (1983 ) .日科技连出版社[4] H aley K B. Oper ational R esea rch’78. Nor t h Holland Publish Compa ny , 1979[5] Bra ns J P. Oper ational R esea rch’81. Nor t h Holland Publish Comp any , 1981[6] Saat y T L. Math ematical Met hods of Ope rations Research , McGraw Hill Book Com pany Inc. 1959[7] Bra ns J P. Oper ational R esea rch’84. Nor t h Holland Publish Comp any 1984[8] Ch eckl a nd P B. Systems thinking , systems practice. Wiley , Chicheste r , 1981[9]Rosenhead J. Ming ers J. Ration al analysis for a problematic world r evisted. Problem st ruct uringmethods for complexity , unce rtaint y and conflict. Wiley , Chichester , 2001[10 ] 顾基发 , 唐锡晋 . 软系统工程方法论与软运筹学 . 系统研究 . 杭州 : 浙江人民出版社 , 1996·7·二、线性规划与目标规划线性规划是运筹学的 一个 重要 分支。 自 1947 年 丹 捷格 ( G. B. Dantzig ) 提 出了 一 般 线性规划问题求解的方法———单纯形法之后 , 线性规划在理论上趋向成熟 , 在实用中日益 广泛与深入。特别是在电子计算机能处理成千上万个约束条件和决策变量的线性规划问题之后 , 线性规划的适用领域更为广泛了。 从解决 技术 问题的 最优 化设 计到工 业、农业、 商业、交通运输业、军事、经济计划和管理决 策等 领域都 可以 发挥 作用。它 已是现 代科 学管理的重 要 手 段 之 一。查 恩 斯 ( A. Cha rnes ) 与 库 伯 ( W. W. Cooper ) 继 丹 捷 格 之 后 , 于 1961 年提出 了目 标规 划 , 艾吉利 ( Y. Ijiri ) 提 出了 用优 先因子 来处 理多目 标问 题 , 使目 标 规划得到发展。近十多年来斯·姆· 李 ( S. M. Lee ) 与 杰斯 开莱尼 ( V. Jaaskelainen ) 应 用 计算机处理目标规划问题 , 使目标规划在实际应用方面比线性规划更广泛 , 更为管理者所 重视。第 1 章 线性规划与单纯形法第 1 节 线性规划问题及其数学模型1. 1 问题的提出在生产管理和经营活动中经常提出一类 问题 , 即如 何合 理地利 用有 限的人 力、物力、财力等资源 , 以便得到最好的经济效果。例 1 某工厂在计划期内要安排生产Ⅰ、Ⅱ两种产 品 , 已 知生产 单位产品 所需的设 备台时及 A、B 两种原材料的消耗 , 如表 1-1 所示。表 1-1ⅠⅡ设备128 台时原材料 A 原材料 B400416 kg12 kg该工厂每生产一件产品Ⅰ可获利 2 元 , 每生产一件产品Ⅱ可获利 3 元 , 问应如何安排 计划使该工厂获利最多 ? 这问题可以用以下的 数学 模型来 描述 , 设 x1 、x2 分别表 示在 计 划期内产品Ⅰ、Ⅱ的产量。因为 设备的 有效 台时是 8 , 这 是一 个限 制产 量的 条 件 , 所以 在 确定产品Ⅰ、Ⅱ的产量时 , 要考虑不超过设备的有效台时数 , 即可用不等式表示为 :x1 + 2 x2 ≤8·8·’‘’‘’‘同理 , 因原材料 A、B 的限量 , 可以得到以下不等式 ≤16 4 x2 ≤124 x1该工厂的目标是在不超过所有资源限量的条件 下 , 如何 确定产 量 x1 、x2 以 得到最 大的 利 润。若用 z 表示利润 , 这时 z = 2 x1 + 3 x2 。综合上述 , 该计划问题可用数学模型表示为 :目标函数m axz = 2 x1 + 3 x2x1 + 2 x2 ≤8满足约束条件 :4 x1≤ 16 4 x2 ≤ 12x1 , x2 ≥0例 2 靠近某河流有两个化工厂 ( 见图 1 -1) , 流经第一化 工厂的 河流流量 为每天 500万立方米 , 在 两 个 工 厂 之 间 有 一 条 流 量 为每天 200 万 立方 米的 支 流。第 一 化工 厂每 天排放 含有 某种有 害物 质的 工业污水 2 万立方米 , 第二化工厂每天排放这种 工业污水 1. 4 万立 方米。 从 第一 化 工厂 排出的工业污水流到第二化工厂 以前 , 有 20 % 可自 然 净化。 根据 环保 要求 , 河流 中工 业 污水的含量应不大于 0. 2 % 。这两个工厂都需各自处理一 部分工 业污水。第 一化工厂 处 理工业污水的成本是 1000 元/ 万立方米 , 第二化工厂处理工业污水的成本是 800 元/ 万立 方米。现在要问在满足环保要求的条件下 , 每厂各应处理多少工业污水 , 使这两个工厂总 的处理工业污水费用最小。图 1 -1这个问题可用数学模型来描述。设第一化工厂每天处理工业污水量为 x1 万立方米 , 第二化工厂每天处理工业污水量为 x2 万立 方米 , 从第 一化 工厂到 第二 化工 厂之间 , 河 流 中工业污水含量要不大于 0. 2 % , 由此可得近似关系式 (2 - x1 )/ 500≤2/ 1000。流经第二化工厂后 , 河流中的工业污水量仍要不大于 0. 2 % , 这时有近似关系式 [0. 8 (2 - x1 ) + ( 1. 4 - x2 ) ]/ 700≤2/ 1000由于每个工厂每天处理的工业污水量不会大于每天的排放量 , 故有 x1 ≤2 ; x2 ≤1. 4 这问题的目标是要求两厂用于处理工业污水的总费用最 小 , 即 z = 1000 x1 + 800 x2 。综 合 上述 , 这个环保问题可用数学模型表示为 :目标函数 min z = 1000 x1 + 800 x2x1≥10. 8 x1 + x2 ≥ 1. 6满足约束条件≤2 ≤1. 4x1x2 x1 , x2 ≥0从以上两例可以看出 , 它们都是属于一类优化问题。它们的共同特征 : (1 ) 每一个问题都用一组决策变量 ( x1 , x2 , … , xn ) 表示某一 方案 , 这组决 策变量的 值就代表一个具体方案。一般这些变量取值是非负且连续的。(2 ) 存在一定的约束条件 , 这些约束条件可以用一组线性等式或线性不等式来表示。·9·(3 ) 都有一个要求达到的目标 , 它可用决策变量的线性函数 ( 称 为目标函 数 ) 来表示。按问题的不同 , 要求目标函数实现最大化或最小化。满足以上三个条件的数学模型称为线性规划的数学模型。其一般形式为 :目标函数 m ax ( min) z = c1 x1 + c2 x2 + … + cn x n( 1 -1)a11 x1 + a12 x2 + … + a1 n x n ≤ ( = , ≥ ) b1 a21 x1 + a22 x2 + … + a2 n x n ≤ ( = , ≥ ) b2满足约束条件…( 1 -2)am1 x1 + am2 x2 + … + am n x n ≤ ( = , ≥ ) bmxn ≥0… ,x1 ,( 1 -3) x2 , 在线性规划的数学模型中 , 式 ( 1 -1 ) 称为目 标函 数 ; 式 ( 1 -2 ) 、式 ( 1 -3) 称 为约束 条件 ;式 (1 -3) 也称为变量的非负约束条件。1. 2 图解法图解法简单直观 , 有助于了解线性规划 问题求 解的 基本原 理。现 对上述 例 1 用图 解 法求解。在以 x1 、x2 为坐标轴的直角坐标系中 , 非负条件 x1 , x2 ≥ 0 是 指第一 象限。例 1 的每个约束条件都代表一个半平面。如约 束图 1 -2条件 x1 + 2 x2 ≤ 8 是代 表以直线 x1 + 2 x2 = 8 为边界的左 下 方 的 半 平 面 , 若 同 时 满 足 x1 , x2 ≥ 0 , x1 + 2 x2 ≤ 8 , 4 x1 ≤ 16 和 4 x2 ≤ 12 的 约束条 件的 点 , 必 然落 在 x1 , x2 坐标 轴和 由 这三个半平面交成的区域内。由例 1 的所 有 约束条件为半平面 交成 的区域 见图 1 -2 中 的 阴影部分。阴影 区域 中 的每 一 个点 ( 包 括 边 界点 ) 都 是 这 个 线 性 规划 问 题 的 解 ( 称 可 行 解 ) , 因而此区域是例 1 的线性规划问题的 解集合 , 称它为可行域。再分析目标函数 z = 2 x1 + 3 x2 , 在这坐标平面上 , 它可表示以 z 为参数、- 2/ 3 为斜 率的一族平行线 :x2 = - ( 2/ 3) x1 + z/ 3 位于同一直线上的点 , 具 有相 同的目 标函 数 值 , 因而称它为“ 等值 线”。 当 z 值由 小变 大 时 , 直线 x2 = - ( 2/ 3 ) x1 + z/ 3 沿 其 法 线 方 向向右上 方 移 动。 当 移 动 到 Q2 点 时 , 使 z 值在可行 域 边 界上 实 现 最 大 化 ( 见 图 1 -3 ) , 这就得 到了 例 1 的 最优 解 Q2 , Q2 点 的坐 标 为 (4 , 2 ) 。于是可计 算出满 足所 有约 束条 件 下的最大值 z = 14。图 1 -3·01·这说明该厂的最优生产计划方案是 : 生 产 4 件 产品 Ⅰ , 生产 2 件产 品Ⅱ , 可得 最大 利润为 14 元。上例中求解得到问题的最优解是唯一的 , 但对一般线性规划问题 , 求解结果还可能出现以下几种情况 :1. 无穷多最优解( 多重最优解 )若将例 1 中的目标 函数变 为求 max z = 2 x1 + 4 x2 , 则表 示目标函 数中以 参数 z 的 这 族平行直线与约束条件 x1 + 2 x2 ≤8 的 边界 线平行。 当 z 值由 小变 大时 , 将 与线段 Q2 Q3 重合 ( 见图 1 -4 ) 。线段 Q2 Q3 上任意一点都使 z 取得相同的最大值 , 这个线性规划问题 有 无穷多最优解 ( 多重最优解 ) 。2. 无界解对下述线性规划问题max z = x1 + x2 - 2 x1 + x2 ≤ 4 x1 - x2 ≤ 2 x2 ≥ 0x1 , 用图解法求解结果见图 1 -5。从图 1 -5 中可以看到 , 该问题可行 域无界 , 目标 函数值可 以 增大到无穷大。称这种情况为无界解。图 1 -4图 1 -53. 无可行解如果在例 1 的数学模型中增加一个约束条件 - 2 x1 + x2 ≥4 , 该问题的可行域为空集 ,即无可行解 , 也不存在最优解。当求解结果出现第 2、3 两种情况时 , 一 般说 明线性 规划 问题 的数学 模型 有错误。 前者缺乏必要的约束条件 , 后者是有矛盾的约束条件 , 建模时应注意。从图解法中直观地见到 , 当 线性 规划 问题 的 可行 域非 空时 , 它 是 有 界或 无 界凸 多 边 形。若线性规划问题存在最优解 , 它一定在有界可行域的某个顶点得到 ; 若在两个顶点同 时得到最优解 , 则它们连线上的任意一点都是最优解 , 即有无穷多最优解。图解法虽然直观、简便 , 但当变量 数多于 三 个以 上时 , 它 就无 能 为力 了。所 以在 第 3 ·11·节中要介绍一种代数法———单纯形法。为了便于 讨论 , 先 规定 线性规 划问 题的数 学模 型 的标准型式。1. 3 线性规划问题的标准型式由前节可知 , 线性规划 问题 有 各种 不同 的形 式。目 标函 数 有 的要 求 m ax , 有的 要 求 min ; 约束条件可以是“≤”, 也可 以 是“≥”形式 的不 等 式 , 还可 以是 等 式。决 策变 量一 般 是非负约束 , 但也允许在 ( - ∞ , ∞ ) 范围内取 值 , 即无约 束。将 这些多 种形 式的数 学模 型 统一变换为标准型式。这里规定的标准型式为 :( M1 )max z = c1 x1 + c2 x2 + … + cn x na1 1 x1 + a1 2 x2 + … + a1 n x n = b1 a2 1 x1 + a2 2 x2 + … + a2 n x n = b2 … am 1 x1 + am 2 x2 + … + am n x n = bm x1 , x2 , … , xn ≥0n( M′1 )max z = ∑cj x jj = 1n∑ai j x j = bi ,i = 1 , 2 , … , mj = 1xj ≥ 0 ,j = 1 , 2 , … , n在标准型式中规定各约束条件的右端项 bi > 0 , 否则等式两端乘以“ - 1”。 用向量和矩阵符号表述时为 :( M ″1 )max z = C Xn∑P j x j = bj = 1x j ≥ 0 ,j = 1 , 2 , … , n其中 : C = ( c1 , c2 , … , cn )x1a1 jb1X =x2⁝;Pj =a2 j⁝; b =b2⁝xnam jbm向量 P j 对应的决策变量是 x j 。 用矩阵描述时为 :max z = C XA X = b X≥0其中·21·A =a12 … a1 n ⁝a11⁝ ⁝am1am2 … am n= ( P1 , P2 , … , Pn ) ; 0 =00⁝0A———约束条件的 m× n 维系数矩阵 , 一般 m < n; b———资源向量 ; C———价值向量 ; X———决策变量向量。 实际碰到各种线性规划问题的数学模型都应变换为标准型式后求解。以下讨论如何变换为标准型的问题。(1 ) 若要求目标函数实现最小化, 即 min z = CX。这时只需将目标函数最小化变换求目标函数最大化, 即令 z′= - z, 于是得到 max z′= - CX。这就同标准型的目标函数的形式一致了。 (2 ) 约束方程为不等 式。这 里 有 两种 情 况 : 一 种是 约 束方 程 为“ ≤”不等 式 , 则 可 在 “≤”不等式的左端加入非 负松 弛变 量 , 把 原“ ≤”不等 式变 为 等式 ; 另 一种 是 约束 方程 为 “≥”不等式 , 则可在“ ≥”不等式的左端减去一个非负剩余变量 ( 也可称松弛变量 ) , 把不等式约束条件变为等式约束条件。下面举例说明。例 3 将例 1 的数学模型化为标准型。 例 1 的数学模型 ( 简称模型 M2 ) 为m ax z = 2 x1 + 3 x2x1 + 2 x2 ≤84 x1≤ 16 4 x2 ≤ 12x1 , x2 ≥0在各不等式中分别加上一个松弛变量 x3 , x4 , x5 , 使不等式变为等式。这时得到标准型 :max z = 2 x1 + 3 x2 + 0 x3 + 0 x4 + 0 x5x1 + 2 x2 + x3= 84 x1+ x4= 164 x2+ x5 = 12x1 ,x2 ,x3 , x4 , x5 ≥0所加松弛变量 x3 、x4 、x5 表示没有被利用的资源。当然也没有利润 , 在目标函数中 其系数应为零 , 即 c3 , c4 , c5 = 0 。(3 ) 若存在取值无约束的变量 xk , 可令 xk = x′k - x″k , 其中 x′k , x″k ≥ 0。 以上讨论说明 , 任何形式的数学模型都可化为标准型 , 下面举例说明。 例 4 将下述线性规划问题化为标准型min z = - x1 + 2 x2 - 3 x3x1 + x2 + x3 ≤ 7 x2 + x3 ≥ 2x1 -3 x1 + x2 + 2 x3 = 5 x1 , x2 ≥ 0 , x3 为无约束·31·解 步骤 : (1 ) 用 x4 - x5 替换 x3 , 其中 x4 , x5 ≥0 ; (2 ) 在第一个约束不等式≤号的左端加入松弛变量 x6 ; (3 ) 在第二个约束不等式≥号的左端减去剩余变量 x7 ; (4 ) 令 z′= - z , 把求 min z 改为求 max z′, 即可得到该问题的标准型m ax z′= x1 - 2 x2 + 3 ( x4 - x5 ) + 0 x6 + 0 x7x1 + x2 + ( x4 - x5 ) + x6= 7x1 - x2 + ( x4 - x5 ) -x7 = 23 x1 + x2 + 2( x4 - x5 )= 5x1 ,x2 , x4 , x5 , x6 , x7 ≥01. 4 线性规划问题的解的概念在讨论线性规划 问 题 的 求解 前 , 先 要了 解 线 性 规 划问 题 的 解 的 概 念。 由 1. 3 节 的( M1 ) 可知 , 一般线性规划问题的标准型为nmax z = ∑cj x jj = 1n∑ai j x j = bi ,i = 1 , 2 , … , mj = 1xj ≥0 ,j = 1 , 2 , … , n1. 可行解满足约束条件 (1 -5) 式、( 1 -6) 式的解 X = ( x1 , x2 , … , xn ) T , 称为线性规划问题的可行解 , 其中使目标函数达到最大值的可行解称为最优解。2. 基设 A 是约束方程组的 m× n 维系数矩阵 , 其秩为 m。 B 是矩阵 A 中 m× m 阶非奇 异 子矩阵 ( | B| ≠0) , 则称 B 是线性规划问题的一个基。这就是说 , 矩阵 B 是由 m 个线性 独 立的列向量组成。为不失一般性 , 可设a11a12 … a1 mB =⁝ ⁝⁝= ( P1 , P2 , … , Pm )am1am2 … am m称 P j ( j = 1 , 2 , … , m) 为基向量 , 与基向量 P j 相应 的变量 x j ( j = 1 , 2 , … , m) 为基变 量 , 否 则称为非基变量 , 为了进一步讨论线性规划 问题的 解 , 下面研 究约 束方程 组 (1 -5 ) 的求 解 问题。假设该方程组系数矩阵 A 的秩为 m , 因 m < n, 故它有无穷多个解。假设前 m 个变 量的系数列向量是线性独立的。这时 (1 -5) 式可写成a11a1 2a1 ma21⁝x1 +a2 2⁝x2 + … +a2 m⁝x mam1am2am m·41·( 1 -4)( 1 -5)( 1 -6)b1a1 , m + 1a1 n=b2⁝a2 , m + 1⁝xm + 1 - … -a2 n⁝x n( 1 -7)bmam, m + 1am n或mn∑P j x j = b - ∑P j x jj = 1j = m + 1方程组 (1 -7) 的一个基是a11a12 … a1 mB =a22 … a2 m ⁝a21⁝ ⁝= ( P1 , P2 , … , Pm )am1am2 … am m设 XB 是对应于这个基的基变量X B = ( x1 , x2 , … , xm ) T 现若令 (1 -7) 式的非基变量 xm + 1 = x m + 2 = … = xn = 0 , 这时变 量的个 数等于线 性方程的 个 数。用高斯消去法 , 求出一个解X = ( x1 , x2 , … , xm , 0 , … , 0 ) T该解的非零分量的数目不大于方程个数 m, 称 X 为基解。由 此可见 , 有一个 基 , 就 可 以求出一个基解。如图 1 -2 中的点 0 , Q1 , Q2 , Q3 , Q4 以及延长各条线 ( 包括 x1 = 0 , x2 = 0) 的交点都代表基解。3. 基可行解满足非负条件图 (1 -6 ) 的基解 , 称 为基可行 解。图 1 -2 中的 点 0 , Q1 , Q2 , Q3 , Q4 代 表基可行解。可见 , 基可行解的非零分量的数目也不大于 m, 并且都是非负的。4. 可行基对应于基可行解的基 , 称 为可 行基。 约束方 n 个。 一般程组 (1 -5) 具有 基解 的 数目 最 多是 Cm 基可行解的 数 目 要小 于 基 解 的 数目。 以 上 提到的几种解的概念 , 它 们 之间 的关 系 可用 图 1 -6 表 明。另外还要说明一点 , 基解中 的非 零分 量的个 数小于 m 个 时 , 该 基 解 是 退 化 解。 在 以 下 讨 论 时 , 假设不出现退化的 情况。以 上给 出了 线性规 划问题的解的概念和定义 , 它们 将有 助于 用来分 析线性规划问题的求解过程。图 1 -6·51·第 2 节 线性规划问题的几何意义在 1. 2 节介绍图解法时 , 已直观地看到可行域和最优解的几何意义 , 这一节从理论上进一步讨论。2. 1 基本概念1. 凸集设 K 是 n 维 欧氏 空间的 一点 集 , 若任意 两点 X( 1 ) ∈ K , X( 2 ) ∈ K 的连 线 上的 所有 点αX ( 1 ) + ( 1 - α) X( 2 ) ∈ K , ( 0≤α≤1) ; 则称 K 为凸集。实心圆 , 实心球体 , 实心立方体等都是凸集 , 圆环不是凸集。从直观上讲 , 凸集没有凹 入部分 , 其内部没有空洞。图 1 -7 中 的 ( a ) ( b) 是凸 集 , ( c) 不 是凸集。 图 1-2 中的 阴影 部 分是凸集。任何两个凸集的交集是凸集 , 见图 1-7( d ) 。图 1 -72. 凸组合设 X( 1 ) , X( 2 ) , … , X( k) 是 n 维欧氏空间 E n 中的 k 个点。若存在 μ1 ,μ2 , … ,μk , 且 0≤μik≤1 , i = 1 , 2 , … , k; ∑μi = 1 , 使i = 1X = μ1 X( 1 ) + μ2 X( 2 ) + … + μk X ( k)则称 X 为 X ( 1 ) , X( 2 ) , … , X( k ) 的凸组合。 ( 当 0 < μi < 1 时 , 称为严格凸组合 )3. 顶点设 K 是凸集 , X ∈ K; 若 X 不 能 用 不同 的 两 点 X( 1 ) ∈ K 和 X ( 2 ) ∈ K 的线 性 组 合 表示为X =αX( 1 ) + ( 1 - α) X( 2 ) ,(0 <α< 1)则称 X 为 K 的一个顶点 ( 或极点 ) 。2. 2 几个定理定理 1 若线性规划问题存在可行域 , 则其可行域nD =X ∑Pj x j = b,x j ≥ 0 是凸集j = 1·61·证 为了证明满足线性规划问题的约束条件n∑P j x j = b, x j ≥ 0 ,j = 1 , 2 , … , nj = 1的所有点 ( 可行解 ) 组成的集 合是 凸集 , 只要 证明 D 中任 意两 点连 线 上的 点必 然在 D 内 即可。设X( 1 ) = ( x( 1 ) X( 2 ) = ( x( 2 )11, x( 1 ) , x( 2 )22, … , x( 1 ) , … , x( 2 )nn) T ) T是 D 内的任意两点 ; X( 1 ) ≠ X( 2 ) 。 则有n∑P j x ( 1 )j= b,x( 1 )j ≥ 0 ,j = 1 , 2 , … , nj = 1n∑P j x ( 2 )j= b,x( 2 )j ≥ 0 ,j = 1 , 2 , … , nj = 1令 X = ( x1 , x2 , … , xn ) T 为 x( 1 ) , x( 2 ) 连线上的任意一点 , 即X 的每一个分量是 x j = αx( 1 )X =αX( 1 ) + ( 1 - α) X( 2 ) j + (1 - α) x( 2 )( 0≤α≤1), 将它代入约束条件 , 得到jnn∑P j x j = ∑P j [αx ( 1 )j+ ( 1 - α) x( 2 )]j = 1j = 1nnn= α∑j = 1P j x ( 1 )j+ ∑j = 1Pj x ( 2 )jα∑ j = 1P j x ( 2 )j= αb + b - αb = b又因 x( 1 )j, x( 2 )j ≥0 ,α> 0 , 1 - α> 0 , 所以 x j ≥0 , j = 1 , 2 , … , n。由此可见 X∈ D, D 是凸集。 证毕。引理 1 线性 规划问 题的 可行 解 X = ( x1 , x2 , … , xn ) T 为基 可行 解的充 要条 件是 X的正分量所对应的系数列向量是线性独立的。证 (1 ) 必要性 由基可行解的定义可知。(2 ) 充分性 若向量 P1 , P2 , … , Pk 线性独立 , 则必有 k≤ m; 当 k = m 时 , 它们 恰 构成一个基 , 从而 X = ( x1 , x2 , … , xk , 0…0 ) 为相应的基可 行解。当 k < m 时 , 则一定可 以 从其余的列向量中取出 m - k 个与 P 1 , P2 , … , Pk 构成 最大的线 性独立 向量 组 , 其 对应 的 解恰为 X, 所以根据定义它是基可行解。定理 2 线性规划问题的基可行解 X 对应于可行域 D 的顶点。 证 不失一般性 , 假设基可行解 X 的前 m 个分量为正。故m∑ 现在分两步来讨论 , 分别用反证法。 (1 ) 若 X 不是基可行解 , 则它一定不是可行域 D 的顶点 根据引理 1 , 若 X 不是基可行解 , 则其 正分 量所对 应的 系数列 向量 P1 , P2 , … , P m 线P j x j = bj = 1(1 -8 )性相关 , 即存在一组不全为零的数 αi , i = 1 , 2 , … , m 使得α1 P1 +α2 P2 + … +αm P m = 0( 1 -9)用一个 μ> 0 的数乘 ( 1 -9) 式再分别与 (1 -8 ) 式相加和相减 , 这样得到·71·( x1 - μα1 ) P1 + ( x2 - μα2 ) P2 + … + ( xm - μαm ) P m = b ( x1 + μα1 ) P1 + ( x2 + μα2 ) P2 + … + ( xm + μαm ) P m = b现取X( 1 ) = [ ( x1 - μα1 ) , ( x2 - μα2 ) , … , ( xm - μαm ) , 0 , … , 0] X( 2 ) = [ ( x1 + μα1 ) , ( x2 + μα2 ) , … , ( xm + μαm ) , 0 , … , 0]1 2 另一方面 , 当 μ充分小时 , 可保证1 2由 X( 1 ) , X( 2 ) 可以得到 X =X( 1 ) +X( 2 ) , 即 X 是 X ( 1 ) , X( 2 ) 连线的中点。xi ±μαi ≥0 ,i = 1 , 2 , … , m即 X( 1 ) , X( 2 ) 是可行解。这证明了 X 不是可行域 D 的顶点。 (2 ) 若 X 不是可行域 D 的顶点 , 则它一定不是基可行解 因为 X 不是可行域 D 的顶点 , 故在可行域 D 中可找到不同的两点 X( 1 ) = ( x( 1 ) X( 2 ) = ( x( 2 ), x( 1 ) , x( 2 )) T ) T 0 <α< 1, … , x( 1 ) , … , x( 2 )2n112nX = αX( 1 ) + (1 - α) X( 2 )使设 X 是基可行解 , 对应向量组 P1 … P m 线性独立。当 j > m 时 , 有 x j = x( 1 ) X( 1 ) , X( 2 ) 是可行域的两点。应满足j = x( 2 )j = 0 , 由于mm∑Pj x ( 1 )j= b 与 ∑P j x ( 2 )j= bj = 1j = 1将这两式相减 , 即得m∑P j ( x( 1 )jx( 2 ) j) = 0j = 1因 X( 1 ) ≠ X( 2 ) , 所以上式系数 ( x( 1 ) 假设矛盾。即 X 不是基可行解。x( 2 ) j) 不全为零 , 故向量组 P1 , P2 , … , Pm 线性 相关 , 与引理 2 若 K 是有界凸集 , 则任何一点 X∈ K 可表示为 K 的顶点的凸组合。 本引理证明从略 , 用以下例子说明这引理。例 5 设 X 是 三 角 形 中 任 意 一 点 , X( 1 ) , X( 2 ) 和 X( 3 ) 是 三 角 形 的 三 个 顶 点 , 试 用 三 个 顶 点的坐标表示 X( 见图 1 -8) 。解 任选一顶 点 X( 2 ) , 做 一条 连线 X X( 2 ) ;并延长交于 X( 1 ) 、X( 3 ) 连接线上一 点 X′。 因 X′ 是 X ( 1 ) 、X( 3 ) 连线上一点 , 故可用 X( 1 ) 、X( 3 ) 线 性 组合表示为图 1 -8X′=αX( 1 ) + ( 1 - α) X( 3 )0 < α< 1 又因 X 是 X′与 X ( 2 ) 连线上的一个点 , 故 0 <λ< 1X =λX′+ (1 - λ) X( 2 ) 将 X′的表达式代入上式得到X =λ[αX( 1 ) + (1 - α) X( 3 ) ] + (1 - λ) X( 2 ) =λαX( 1 ) +λ(1 - α) X( 3 ) + (1 - λ) X( 2 )·81·令μ1 = αλ,μ2 = ( 1 - λ) ,μ3 =λ( 1 - α)这就得到X = μ1 X( 1 ) + μ2 X( 2 ) + μ3 X( 3 ) ∑μi = 1 ,0 < μi < 1定理 3 若可行域有界 , 线性 规划 问题的 目标 函数 一定 可以 在其 可行 域 的顶 点上 达到最优。证 设 X( 1 ) , X( 2 ) , … , X( k) 是可行域的顶点 , 若 X( 0 ) 不是顶点 , 且目标函数在 X( 0 ) 处达到最优 z * = C X( 0 ) ( 标准型是 z* = m ax z) 。因 X( 0 ) 不是顶点 , 所以它可以用 D 的顶点线性表示为kkX( 0 ) = ∑αi X ( i) ,αi > 0 , ∑αi = 1i = 1i = 1因此kkCX ( 0 ) = C∑αi X ( i ) = ∑αi C X( i)( 1 -10 )i = 1i = 1在所有的顶点中必然能找 到 某一 个 顶点 X( m) , 使 C X( m) 是 所 有 C X( i ) 中最 大 者。并 且 将 X( m) 代替 ( 1 -10) 式中的所有 X( i ) , 这就得到kk∑αi CX ( i) ≤ ∑αi C X ( m ) = CX ( m)i = 1i = 1由此得到C X( 0 ) ≤ C X( m)根据假设 CX( 0 ) 是最大值 , 所以只能有C X( 0 ) = C X( m)即目标函数在顶点 X( m) 处也达到最大值。有时目标函数可能在多个顶点处达到最大值。这时在这些顶点的凸组合上也达到最大值。称这种线性规划问题有无限多个最优解。^ 假设 X^( 1 ) ,X( 2 ) , … ,^X( k ) 是目标函数达到最大值的顶点 , 若^X是这些顶点的凸组合 , 即kk^ X= ∑i = 1^ αi X( i) ,αi > 0 ,∑i = 1αi = 1于是^ C Xk= C∑i = 1^ αi Xk( i) = ∑i = 1^αi CX( i )设^ ( i) = m, C Xi = 1 , 2 , … , k于是^ C Xk= ∑i = 1αi m = m另外 , 若可行域为无界 , 则可能无最优解 , 也可能有最优解 , 若有也必定在某顶点上得到。根据以上讨论 , 可以得到以下结论 :线性规划问题的所有可行 解 构成 的集 合是 凸集 , 也可 能为 无 界域 , 它们 有 有限 个 顶·91·点 , 线性规划问题的每个基可行解对应可行 域的一 个顶 点 ; 若线性 规划 问题 有最优 解 , 必 在某顶点上得到。虽然顶点数目是有 限的 ( 它 不大 于 Cm n 个 ) , 若采 用“枚 举法”找 所有 基 可行解 , 然后一一比较 , 最终可能找到最优解。但当 n, m 的数较 大时 , 这种办 法是行不 通 的 , 所以要继续讨论 , 如何有效地找到最优解 , 有多种方法 , 这里仅介绍单纯形法。第 3 节 单 纯 形 法单纯形法求解线性规划的思路 : 一般线性 规划问 题具 有线 性方程 组的 变量数 大于 方 程个数 , 这时有不定的解。但可以从线性方程组中找出一个个的单纯形 , 每一个单纯形可 以求得一组解 , 然后再判 断该 解 使目 标函 数值 是增 大 还是 变小 , 决 定下 一 步选 择的 单 纯 形。这就是迭代 , 直到目标函数实现最大值或最小值为止。注意 : 单纯形是指 0 维中 的点 , 一维 中的 线段 , 二维 中的 三角 形 , 三 维 中 的四 面 体 , n 维空间中的有 n + 1 个顶点的多面体。例如在三维 空间中 的四 面体 , 其顶 点分 别为 ( 0 , 0 , 0) , ( 1 , 0 , 0) , ( 0 , 1 , 0) , ( 0 , 0 , 1) 。具有单位截距的单纯形的方程是 ∑ x i ≤1 , 并且 x i ≥0 , i = 1 , 2 , … , m。这样问题就得到了最优解 , 先举一例来说明。3. 1 举例例 6 试以例 1 来讨论如何用单纯形法求解。例 1 的标准型为max z = 2 x1 + 3 x2 + 0 x3 + 0 x4 + 0 x5x1 + 2 x2 + x3= 84 x1+ x4= 164 x2+ x5 = 12x j ≥ 0 ,j = 1 , 2 , … , 5约束方程 (1 -12 ) 式的系数矩阵1 2 1 0 0A = ( P1 , P2 , P3 , P4 , P5 ) =4 0 0 1 00 4 0 0 1从 (1 -12 ) 式中可以看到 x3 , x4 , x5 的系数列向量 010P3 =0, P4 =1, P5 =0001是线性独立的 , 这些向量构成一个基1 0 0B = ( P3 , P4 , P5 ) =0 1 00 0 1对应于 B 的变量 x3 , x4 , x5 为基变量 , 从 ( 1 -12) 式中可以得到x3 = 8 - x1 - 2 x2x4 = 16 - 4 x1x5 = 124 x2·02·(1 -11)(1 -12)(1 -13)将 (1 -13 ) 式代入目标函数 ( 1 -11 ) 式得到z = 0 + 2 x1 + 3 x2(1 -14)当令非基变量 x1 = x2 = 0 , 便得到 z = 0。这时得到一个基可行解 X( 0 )X( 0 ) = ( 0 , 0 , 8 , 16 , 12) T这个基可行解表示 : 工厂没有安排生产产品Ⅰ、Ⅱ ; 资源都没有被利用 , 所以工厂的利润指标 z = 0。从分析目标函数的 表达 式 ( 1 -14 ) 可以 看 到 : 非 基 变量 x1 , x2 ( 即没 有 安排 生 产 产 品 Ⅰ , Ⅱ ) 的系数都是正数 , 因此将非基变量变换为基变量 , 目标函数的值就可能增大。从经 济意义上讲 , 安排生产产品Ⅰ或Ⅱ , 就可以使工厂的利润指标增加。所以只要在目标函数 (1 -14 ) 的表达式中还存在有正系数的非基变量 , 这表示目标函数值还有增加的可能 , 就需 要将非基变量与基变量进行对换。一般选择正系数最大的那个非基变量 x2 为换入变量 , 将它换入到基变量中去 , 同时还要确定基变量中有一个要换出来成为非基变量 , 可按以下 方法来确定换出变量。现分析 (1 -13 ) 式 , 当将 x2 定为换入变量 后 , 必须 从 x3 , x4 , x5 中确 定一 个换出 变量 ,并保证其余的都是非负 , 即 x3 , x4 , x5 ≥0。当 x1 = 0 , 由 (1 -13) 式得到x3 = 8 - 2 x2 ≥0 x4 = 16 ≥0 x5 = 12 - 4 x2 ≥0(1 -15)从 (1 -15 ) 式中可以看出 , 只有选择x2 = mi n(8/ 2 , - , 12/ 4 ) = 3 时 , 才能使 ( 1 -15 ) 式成立。因当 x2 = 3 时 , 基变量 x5 = 0 , 这就决定用 x2 去替换 x5 。以 上 数学描述说明了每生产一件产品Ⅱ , 需要用掉各种资源数为 ( 2 , 0 , 4) 。由这些资源中的薄 弱环节 , 就确定了产品 Ⅱ的产量。这里 就是由原材料 B 的数量确定了 产品Ⅱ的产 量 x2 =12 4= 3 件。为了求得以 x3 , x4 , x2 为 基变 量的 一个 基可 行 解和 进 一步 分 析问 题 , 需 将 ( 1 -13 ) 中x2 的位置与 x5 的位置对换。得到x3 + 2 x2 = 8 - x1①x4 = 16 - 4 x1②(1 -16)③4 x2 = 12 - x5 用高斯消去 法 , 将 ( 1 -16 ) 式 中 x2 的 系 数 列 向 量 变 换 为 单 位 列 向 量。 其 运 算 步 骤 是 : ③′= ③/ 4 ; ①′= ① - 2 ×③′; ②′= ② , 并将结果仍按原顺序排列有 :x3 = 2 -x1 +1 2x5①′x4 = 16 - 4 x1②′(1 -17)x2 = 31 4x5③′再将 (1 -17 ) 式代入目标函数 ( 1 -11 ) 式得到·12·z = 9 + 2 x1 -3 4x5令非基变量 x1 = x5 = 0 , 得到 z = 9 , 并得到另一个基可行解 X( 1 )X( 1 ) = (0 , 3 , 2 , 16 , 0) T从目标函数的表达式 (1 -18) 中可以看到 , 非基 变量 x1 的系数 是正 的 , 说明目 标函 数 值还可以增大 , X( 1 ) 不 一定 是 最 优解。 于是 再 用上 述 方法 , 确 定换 入、换 出 变 量 , 继 续 迭 代 , 再得到另一个基可行解 X( 2 )X( 2 ) = (2 , 3 , 0 , 8 , 0 ) T再经过一次迭代 , 再得到一个基可行解 X( 3 )X( 3 ) = (4 , 2 , 0 , 0 , 4 ) T而这时得到目标函数的表达式是 :z = 14 - 1. 5 x3 - 0. 125 x4 (1 -19) 再检查 (1 -19 ) 式 , 可见到所有非基变量 x3 , x4 的 系数都 是负 数。这说 明若 要用剩 余资 源 x3 , x4 , 就必须支付附加费用。所以当 x3 = x4 = 0 时 , 即不再利用这些资源时 , 目标函数 达 到最大值。所以 X( 3 ) 是最优解。即当产品Ⅰ生产 4 件 , 产品Ⅱ生产 2 件 , 工厂才能得到最 大利润。通过上例 , 可以了解利用单纯形法 求解 线性规 划问 题的 思路。现 将每步 迭代 得 到的结果与图解法做一对比 , 其几何意义就很清楚了。原例 1 的线性规划问题是二维的 , 即两个 变量 x1 , x2 ; 当加入松 弛变量 x3 , x4 , x5 后 , 变换为高维的 , 这时 可 以想 象 , 满 足 所 有 约束 条 件 的 可 行域 是 高 维 空 间的 凸 多 面 体 ( 凸 集 ) 。这凸多面体上的顶点 , 就是基可 行解。初 始基 可行 解 X( 0 ) = ( 0 , 0 , 8 , 16 , 12 ) T 就 相 当于图 1 -2中的原点 ( 0 , 0) , X( 1 ) = (0 , 3 , 2 , 16 , 0 ) T 相 当于 图 1 -2 中的 Q4 点 ( 0 , 3 ) ; X( 2 ) = (2 , 3 , 0 , 8 , 0 ) T 相当于图 1 -2 中的 Q3 点 (2 , 3 ) , 最优解 X( 3 ) = ( 4 , 2 , 0 , 0 , 4 ) T 相当于图 1 -2 中的 Q2 点 ( 4 , 2) 。从初 始基 可行 解 X( 0 ) 开始 迭代 , 依次 得到 X( 1 ) , X( 2 ) , X( 3 ) 。这 相当 于 图 1 -2 中的目标函数平移时 , 从 0 点开始 , 首先碰到 Q4 , 然后碰到 Q3 , 最后达到 Q2 。下面 讨论一般线性规划问题的求解。3. 2 初始基可行解的确定为了确定初始基可行解 , 要首先找出初始可行基 , 其方法如下。 (1 ) 若线性规划问题nmax z = ∑cj x jj = 1n∑P j x j = bj = 1x j ≥ 0 ,j = 1 , 2 , … , n从 P j ( j = 1 , 2 , … , n) 中一般能直接观察到存在一个初始可行基B = ( P1 , P2 , … , Pm ) =0 … 0 1 … 0 0 ⁝ ⁝ ⁝ 0 … 110·22·(1 -18)(1 -20)(1 -21)(2 ) 对所有约束条件是“ ≤”形式的不等式 , 可以利用化为标准型的 方法 , 在每个约 束 条件的左端加上一个松弛变量。经过整理 , 重新对 x j 及 ai j ( i = 1 , 2 , … , m; j = 1 , 2 , … , n) 进行编号 , 则可得下列方程组x1x2+ a1 , m + 1 x m + 1 + … + a1 n x n = b1 + a2 , m + 1 x m + 1 + … + a2 n x n = b2…(1 -22)x m + am, m + 1 x m + 1 + … + am n x n = bmx j ≥0 ,j = 1 , 2 , … , n显然得到一个 m× m 单位矩阵B = ( P1 , P2 , … , Pm ) =0 … 0 1 … 0 0 ⁝ ⁝ ⁝ 0 … 110以 B 作为可行基。将 (1 -22 ) 式每个等式移项得x1x2= b1 - a1 , m + 1 xm + 1 - … - a1 n x n = b2 - a2 , m + 1 xm + 1 - … - a2 n x n…(1 -23)x m = bm - am, m + 1 xm + 1 - … - am n x n令 xm + 1 = xm + 2 = … = xn = 0 , 由 (1 -23 ) 式可得xi = bi( i = 1 , 2 , … , m)又因 bi ≥ 0( 在 1. 3 节中已做过规定 ) , 所以得到一个初始基可行解X = ( x1 , x2 , … , xm , 0 , … , 0 n - m个 ) T = ( b1 , b2 , … , bm , 0 , … , 0 n - m个) T(3 ) 对所有约束条件是“ ≥”形式的不等式及等式约束情况 , 若不存 在单位矩 阵时 , 就 采用人造基方法。即对不等式约束减去一个非负 的剩 余变 量后 , 再加 上一 个非负 的人 工 变量 ; 对于等式约束再加上一个非负的人工变量 , 总能得到一个单位矩阵。关于这个方法 将在本章第 5 节中进一步讨论。3. 3 最优性检验与解的判别对线性规划问题的求解结果可能出现唯一最优解、无穷多最优解、无界解和无可行解四种情况 , 为此需要建立对解的判别准则。一般情况下 , 经过迭代后 (1 -23 ) 式变成nxi = b′i∑ j = m+ 1a′ij x j( i = 1 , 2 , … , m)( 1-24)将 (1-24 ) 式代入目标函数 ( 1-20) 式 , 整理后得mnmz = ∑i = 1ci b′i + ∑j = m+ 1cj∑ i = 1ci a′i jx j( 1-25)·32·令mmz0 = ∑ci b′i , zj = ∑ci a′i j ,j = m + 1 , … , ni = 1i = 1于是nz = z0 + ∑( cj - zj ) x jj = m+ 1再令σj = cj - zj( j = m + 1 , … , n)则nz = z0 + ∑σj x jj = m+ 11. 最优解的判别定理若 X( 0 ) = ( b′1 , b′2 , … , b′m , 0 , … , 0 ) T 为 对 应 于 基 B 的 一 个 基 可 行 解 , 且 对 于 一 切j = m + 1 , … , n, 有 σj ≤0 , 则 X( 0 ) 为最优解。称 σj 为检验数。2. 无穷多最优解判别定理若 X( 0 ) = ( b′1 , b′2 , … , b′m , 0 , … , 0) T 为一个基可行解, 对于一切 j = m + 1 , …, n, 有 σj ≤0 ,又存在某个非基变量的检验数σm + k = 0 ,则线性规划问题有无穷多最优解。证 只需将非基变量 xm + k 换入基变量中 , 找到一 个新基 可行解 X( 1 ) 。因 σm + k = 0 , 由 (1 -27 ) 知 z = z0 , 故 X( 1 ) 也是最优解。由 2. 2 节 的定 理 3 可知 X( 0 ) , X( 1 ) 连 线上所 有点 都 是最优解。3. 无界解判别定理若 X( 0 ) = ( b′1 , b′2 , …, b′m , 0 , …, 0) T 为一基可行解, 有一个 σm + k > 0 , 并且对 i = 1 , 2 , …, m,有 ai , m + k ≤0 , 那么该线性规划问题具有无界解 ( 或称无最优解 ) 。证 构造一个新的解 X( 1 ) , 它的分量为 x( 1 ) i = b′i - λa′i , m + k x( 1 ) m + k = λ x( 1 ) j = 0 ,(λ> 0 )j = m + 1 , … , n, 且 j≠ m + k因 ai , m + k ≤0 , 所以对任意的 λ> 0 都是可行解 , 把 x( 1 ) 代入目标函数内得z = z0 + λσm + k因 σm + k > 0 , 故当 λ→ + ∞ , 则 z→ + ∞ , 故该问题目标函数无界。以上讨论都是针对标准型 , 即求目标函数极大化时的情况。当求目标函数极小化时 , 一种情况如前所述 , 将其化为标准型。如果不化 为标 准型 , 只需 在上 述 1 , 2 点中 把 σj ≤0 改为 σj ≥0 , 第 3 点中将 σm + k > 0 改写为 σm + k < 0 即可。3. 4 基变换若初始基可行解 X( 0 ) 不是最优解及不能 判别无 界时 , 需 要找 一个新 的基 可行解。 具·42·( 1-26)( 1-27)体做法是从原可行解基中换一个列向量 ( 当然要保证线性独立 ) , 得到一个新的可行基 , 这 称为基变换。为了换基 , 先要确定换入变量 , 再确 定换 出变 量 , 让它们 相应 的系数 列向 量 进行对换 , 就得到一个新的基可行解。1. 换入变量的确定由 (1 -27 ) 式 看 到 , 当 某 些 σj > 0 时 , x j 增 加 则目 标 函数 值 还 可以 增 大 , 这 时 要 将 某 个非基变量 x j 换到基变量中去 ( 称为换入变 量 ) 。 若有两 个以 上的 σj > 0 , 那么选 哪个 非 基变量作为换入变 量 呢 ? 为了 使 目 标 函 数值 增 加 得 快 , 从 直 观 上 一 般 选 σj > 0 中 的 大 者 , 即max j( σj > 0) =σk则对应的 xk 为换入变量。但也可以任选或按最小足码选。2. 换出变量的确定设 P1 , P2 , … , Pm 是一组线性独立的向量组 , 它们对应的基可行解是 X( 0 ) 。将它代入约束方程组 (1 -21 ) 得到m∑x( 0 ) i P i = b( 1-28)i = 1其他的向量 Pm + 1 , Pm + 2 , … , Pm + t , … , Pn 都 可以 用 P1 , P2 , … , Pm 线性 表示 , 若确 定非 基 变量 Pm + t 为换入变量 , 必然可以找到一组不全为 0 的数 ( i = 1 , 2 , … , m) 使得mPm+ t = ∑βi, m+ t P ii = 1或mPm+ t - ∑βi, m+ t P i = 0(1 -29)i = 1在 (1 -29 ) 式两边同乘一个正数 θ, 然后将它加到 ( 1 -28) 式上 , 得到mm∑i = 1x( 0 ) i P i + θ Pm + t∑ i = 1βi , m+ t P i = b或m∑( x( 0 )iθβi, m+ t ) Pi + θP m+ t = b(1 -30)i = 1当 θ取适当值 时 , 就 能 得 到 满 足约 束 条 件 的 一 个 可 行 解 ( 即 非 零 分 量 的 数 目 不 大 于 m 个 ) 。就应使 ( x( 0 ) - θβi, m + t ) ( i = 1 , 2 , … , m) 中 的某一 个为 零 , 并保 证其 余的 分 量为 非负。 这个要求可以用以下的办法达 到 : 比较各 比值 x( 0 ) i βi, m + ti( i = 1 , 2 , … , m ) 。又 因为 θ必 须是 正数 , 所以只选 择 x( 0 ) i βi, m + t> 0 ( i = 1 , 2 , … , m ) 中比 值最 小的 等于 θ。 以上 描述 用 数学 式 表示为 :θ= minix( 0 ) i βi , m + tβi , m + t > 0 =x( 0 ) l βl, m + t这时 xi 为换出变量。按最小比值确定 θ值 , 称 为最小 比值 规则。将 θ=x( 0 ) l βl , m + t代 入 X 中 ,·52·便得到新的基可行解。X( 1 ) = x( 0 )1x( 0 ) l βl, m + tβ1 , m + t , … , 0 , … ,x( 0 )mx( 0 ) l βl , m + t↑ 第 l 个分量 x( 0 ) l βl, m + t ↑βm, m + t , 0 , … ,, … , 0第 m + t 个分量由此得到由 X( 0 ) 转换到 X( 1 ) 的各分量的转换公式x( 0 )ix( 0 ) l βl, m + tβi, m + ti≠ lx( 1 ) i =x( 0 ) l βl , m + ti = l这里 x( 0 ) i 是 新基 可行解 X ( 1 ) 的 各分 量 ;βi , m + t 是 换入 向 量 P m + t 的对应原来一组基 向量 的坐 标。现 在的 问题 是 , 这 个 新解 X( 1 ) 的 m 个 非零 分 量 对应的列向量是否 线性 独 立 ? 事实 上 , 因 X( 0 ) 的 第 l 个分 量 对 应 于 X ( 1 ) 的 相 应 分 量 是 零 , 即i 是原 基可 行解 X ( 0 ) 的 各分 量 ; x( 1 )x ( 0 )lθβl, m + t = 0其中 x( 0 ) ,θ均不为零 , 根据 θ规则 ( 最小比值 ) ,βl , m + t ≠0。 X( 1 ) 中的 m 个非 零分量 对应 的 m 个列向量是 P j ( j = 1 , 2 , … , m, j≠ l) 和 Pm + t 。若这组向量不是线性独立 , 则一定可以找 到不全为零的数 αj , 使lmPm + t = ∑αj P jj ≠ lj = 1成立。又因mPm + t = ∑βj , m+ t P jj = 1将 (1 -32 ) 式减 ( 1 -31 ) 式得到m∑(βj , m+ t - αj ) P j + βl , m+ t P l = 0j = 1 j≠ l由于上式中至少有 βl , m + t ≠0 , 所以上式表明 P1 , P2 , … , Pm 是线性相关 , 这与假设相矛盾。 由此可见 , X( 1 ) 的 m 个非零分量对应的列向量 P j ( j = 1 , 2 , … , m, j≠ l) 与 Pm + t 是线性 独立的 , 即经过基变换得到的解是基可行解。实际上 , 从一个基可行解到另一个基可行解 的变换 , 就是进行一次基变换。从几何意义上讲 , 就是从可行域的一个顶点转向另一个顶 点 ( 见 1 -2 图解法 ) 。3. 5 迭代 ( 旋转运算 )上述讨论的基可行解的转换方法是用向量方程来描述 , 在实际计算时不太方便 , 因此采用系数矩阵法。现考虑以下形式的约束方程组·62·( 1 -31 )( 1 -32 )x1x2+ a1 , m + 1 xm + 1 + … + a1 k x k + … + a1 n x n = b1 + a2 , m + 1 xm + 1 + … + a2 k x k + … + a2 n x n = b2wx l+ al , m + 1 x m + 1 + … + al k x k + … + al n x n = bl(1 -33)wx m + am, m + 1 x m + 1 + … + am k x k + … + am n x n = bm在一般线性规划问题的约束方程组中加入松 弛变 量或 人工变 量后 , 很 容易得 到上 述形式。设 x1 , x2 , … , xm 为基变量 , 对应的系数矩阵是 m× m 单位阵 I , 它是可 行基。令非 基变量 xm + 1 , xm + 2 , … , xn 为零 , 即可得到一个基可行解。若它不是最优解 , 则要另找一个 使目标函数值增大的基可行解。这时从非基变量中确定 xk 为换入变量。显然这时θ为θ= mi nibi ai kai k > 0 =bl al k在迭代过程中 θ可表示为θ= minib′i a′i ka′i k > 0 =b′l a′l k其中 b′i , a′i k 是经过迭代后对应于 bi , ai k 的元素值 ( 读者可自己验证 ) 。按 θ规则确定 x l 为换出变量 , xk , x l 的系数列向量分别为a1 k0a2 k⁝Pk =⁝al k⁝; Pl =10 ⁝←第 l 个分量am k0为了使 xk 与 x l 进行对换 , 须把 Pk 变为 单位 向量 , 这 可以通 过 (1 -33 ) 式系数 矩阵 的增广矩阵进行初等变换来实现。x1 … x l … xm x m + 1 … xk … xnb1 w 1a1 , m + 1 … a1 k … a1 nal , m + 1 … al k … al nb1bl(1 -34)w1 am, m + 1 … am k … am nbm变换的步骤是 : (1 ) 将增广矩阵 ( 1 -34) 式中的第 l 行除以 al k , 得到0 , … , 0 ,1 al k, 0 , … , 0 ,al, m + 1 al , k, … , 1 , …al n al kbl al k(1 -35)(2 ) 将 ( 1 -34) 式中 xk 列的各元素 , 除 al k 变换为 1 以外 , 其他 都应变换 为零。其他 行的变换是将 (1 -35 ) 式乘以 ai k ( i≠ l) 后 , 从 (1 -34) 式的第 i 行减去 , 得到新的第 i 行。0 , … , 0 , -ai k al k, 0 , … , 0 , ai , m + 1 -al, m + 1 al kai k , … , 0 , … , al n -al n al kai k bi -bl al kai k由此可得到变换后系数矩阵各元素的变换关系式 :·72·a′i j =al j al k a′i j , b′i 是变换后的新元素。ai j -al j al kai k ( i≠ l)( i = l); b′i =bi -bl al kai k al kbl( i≠ l)( i = l)(3 ) 经过初等变换后的新增广矩阵是x1 … x l … x m xm + 1 … xk … xnb1… -a1 k al k…0a′1 , m + 1 … 0 … a′1 nb′1 n⁝⁝⁝⁝0 … +⁝1 a1 k ⁝… 0a′l, m + 1 …1 … a′l n⁝b′l⁝0 … -am k al k…1 a′m, m + 1 …0 … a′m nb′m(4 ) 由 ( 1 -36) 式中可以 看到 x1 , x2 , … , xk , … , xm 的系 数 列向 量 构成 m× m 单 位 矩阵 , 它是可行基 , 当非基变量 xm + 1 , … , x1 , … , xn 为零时 , 就得到一个基可行解 X( 1 ) 。X( 1 ) = ( b′1 , … b′l - 1 , 0 , b′l + 1 … b′m , 0… b′k , 0 …0) T在上述系数矩阵的变换中 , 元素 al k 称为主元素 , 它所在列称为主元列 , 它所在行称为主元 行。元素 al k 位置变换后为 1。例 7 试用上述方法计算例 6 的两个基变换。 解 将例 6 的约束方程组的系数矩阵写成增广矩阵x1x2x3x4x5b1 2 1 0 084 0 0 1 0160 4 0 0 112当以 x3 , x4 , x5 为基变量 , x1 , x2 为非基变量 , 令 x1 , x2 = 0 , 可得到一个基可行解X( 0 ) = ( 0 , 0 , 8 , 16 , 12) T现用 x2 去替换 x5 , 于是将 x3 , x4 , x2 的系数矩阵变换为单位矩阵 , 经变换后为x1x2x3x4x5b1 0 1 01/ 224 0 0 10160 1 0 01/ 43令非基变量 x1 , x5 = 0 , 得到新的基可行解X( 1 ) = (0 , 3 , 2 , 16 , 0) T第 4 节 单纯形法的计算步骤根据以上讨论的结果 , 将求解线性规划问题的单纯形法的计算步骤归纳如下。·82·(1 -36)4. 1 单纯形表为了便于理解计算关系 , 现设计一种计算表 , 称为单纯形表 , 其功能与增广矩阵相似 ,下面来建立这种计算表。将 (1 -22 ) 式与目标函数组成 n + 1 个变量 , m + 1 个方程的方程组。x1x2+ a1 m + 1 xm + 1 + … + a1 n x n = b1 + a2 m + 1 xm + 1 + … + a2 n x n = b2wx m + am m + 1 xm + 1 + … + am n x n = bmz + c1 x1 + c2 x2 + … + cm x m + cm + 1 x m + 1 + … + cn x n = 0为了便于迭代运算 , 可将上述方程组写成增广矩阵z00x110x2 … xm 0 … 0 1 … 0x m + 1 … x n a1 , m + 1 … a1 n a2 , m + 1 … a2 nbb1b2⁝010c10 … 1 c2 … cmam, m + 1 … am n cm + 1 … cnbm0若将 z 看作不参与基变换的基变量 , 它与 x1 , x2 , … , xm 的系数构成一个基 , 这时可采用行初等变换将 c1 , c2 , … , cm 变换为零 , 使其对应的系数矩阵为单位矩阵。得到x2 … xm 0 … 0 1 … 0 ⁝ ⁝ ⁝ ⁝z x10100xm + 1a1 , m+ 1a2 , m+ 1⁝… ……xna1 na2 n⁝bb1b2 ⁝000 … 1am, m+ 1…am nbm100 … 0cm+ 1m∑ i = 1mci ai, m+ 1 … cn - ∑i = 1ci ai nm∑ i = 1ci bi可根据上述增广矩阵设计计算表 , 见表 1 -2 。表 1 -2cj →c1…cmcm+ 1…cnθiCB X Bbx1…xmxm + 1…xnc1x1b11…0a1 , m + 1…a1 nθ1c2x2b200a2 , m + 1a2 nθ2⁝ ⁝⁝⁝…⁝⁝…⁝⁝cmxmbm0…1am, m + 1…am nθmmmmz∑ i = 1ci bi0…0cm+ 1∑ i = 1ci ai, m+1…cn - ∑i = 1ci ai n·92·Ÿ§Á“E,ý¿Á“,Eý¿Á“Á“XB 列中填入基变量 , 这里是 x1 , x2 , … , xm ;CB 列中填入基变量的价值系数 , 这里是 c1 , c2 , … , cm ; 它们是与基变量相对应的 ; b 列中填入约束方程组右端的常数 ; cj 行中填入基变量的价值系数 c1 , c2 , … , cn ; θi 列的数字是在确定换入变量后 , 按 θ规则计算后填入 ; 最后一行称为检验数行 , 对应各非基变量 xj 的检验数是mcj∑ i = 1ci ai j ,j = 1 , 2 , … , n。表 1 -2 称为初始单纯形表 , 每迭代一步构造一个新单纯形表。4. 2 计算步骤(1 ) 找出初始可行基 , 确定初始基可行解 , 建立初始单纯形表。 (2 ) 检验各非基变量 xj 的检验数是mσj = cj∑ i = 1ci ai j ,若 σj ≤ 0 ,j = m + 1 , … , n则已得到最优解 , 可停止计算。否则转入下一步。(3 ) 在 σj > 0 , j = m + 1 , … , n 中 , 若有某个 σk 对应 x k 的系数列向量 P k ≤0 , 则此问 题是无界 , 停止计算。否则 , 转入下一步。(4 ) 根据 max(σj > 0 ) =σk , 确定 xk 为换入变量 , 按 θ规则计算θ= mi nbi ai kai k > 0 =bl al k可确定 xl 为换出变量 , 转入下一步。(5 ) 以 al k 为主元素进行迭代 ( 即用高 斯消 去法 或称为 旋转 运算 ) , 把 xk 所对 应的 列向量a1 k0a2 k0⁝变换为⁝Pk =al k1←第 l 行⁝⁝0am k 将 XB 列中的 x l 换为 x k , 得到新的单纯形表。重复 ( 2) ～ (5 ) , 直到终止。现用例 1 的标准型来说明上述计算步骤。 (1 ) 根据 例 1 的 标准 型 , 取 松弛 变量 x3 , x4 , x5 为 基变 量 , 它 对应 的单 位矩 阵 为基。这就得到初始基可行解X( 0 ) = ( 0 , 0 , 8 , 16 , 12) T将有关数字填入表中 , 得到初始单纯形表 , 见表 1 -3。·03·表 1 -3cj →23000θCBX Bbx1x2x3x4x50x381210040x416400100x5120[4]0013z023000表 1 -3 中左上角的 cj 是表示目标函数中各变量的价值系数。在 CB 列填 入初始基 变量的价值系数 , 它们都为零 , 各非基变量的检验数为σ1 = c1 - z1 = 2 - (0 ×1 + 0 ×4 + 0 ×0) = 2 σ2 = c2 - z2 = 3 - (0 ×2 + 0 ×0 + 0 ×4) = 3(2 ) 因检验数都大于零 , 且 P1 , P2 有正分量存在 , 转入下一步 ;(3 ) max(σ1 ,σ2 ) = max( 2 , 3) = 3 , 对应的变量 x2 为换入变量 , 计算 θθ= minbi ai2ai2 > 0 = min (8/ 2 , - , 12/ 4 ) = 3它所在行对应的 x5 为换出变量。 x2 所在列和 x5 所在行的交 叉处 [4 ] 称为主 元素或枢 元 素 ( pivo t elem en t ) 。(4 ) 以 [ 4] 为主元素进行旋转运算 , 即初等行变换 , 使 P2 变换为 ( 0 , 0 , 1) T , 在 x B 列中将 x2 替换 x5 , 于是得到新表 1 -4 。表 1 -4CBX Bcj →b2x13x20x30x40x5θi0 0 3zx3 x4 x22 16 3 9[ 1] 4 0 20 0 1 01 0 0 00 1 0 01/ 2 0 1/ 4 - 3/ 42 4 -b 列的数字是 x 3 = 2 , x4 = 16 , x2 = 3 于是得到新的基可行解 X( 1 ) = ( 0 , 3 , 2 , 16 , 0 ) T 目标函数的取值 z = 9 ( 5) 检查表 1 -4 的所有 cj - zj , 这时有 c1 - z1 = 2 ; 说明 x1 应为换入变量。重复 ( 2) ～(4 ) 的计算步骤 , 得表 1 -5。表 1 -5CBX Bcj →b2x13x20x30x40x5θi2 0 3zx1 x4 x22 8 3 - 131 0 0 00 0 1 01 - 4 0 - 20 1 0 01/ 2 [2] 1/ 4 1/ 44 12·13·‘‘’’¥¥§¦¦–(cid:144)ª‘‘’(cid:8)(cid:28)’‘ª‘’’‘’‘¥¥§¦¦–íª‘’‘(cid:8)(cid:28)–ªí’‘‘’(cid:8)(cid:28)‘’‘’íª’íª‘’‘’‘’‘§¥¥¦¦ØÀ’‘’í(cid:8)(cid:28)ØÀ–‘’’(cid:8)(cid:28)ØÀ’’í‘(cid:8)(cid:28)ÀØí’’‘cj →23000CBX Bbx1x2x3x4x52x141001/ 400x540021/ 213x22011/ 21/ 80z14003/ 21/ 80(6 ) 表 1 -5 最后一行的所有检验数都已为负或零。这表示目标 函数值已 不可能再 增大 , 于是得到最优解目标函数值X * = X( 3 ) = ( 4 , 2 , 0 , 0 , 4) T z* = 14第 5 节 单纯形法的进一步讨论5. 1 人工变量法在 3. 2 节中提到用人工变量法可以得到初始基可行解。这里加以讨论。设线性规划问题的约束条件是n∑P j x j = bj = 1分别给每一个约束方程加入人工变量 xn + 1 , … , xn + m , 得到a11 x1 + a12 x2 + … + a1 n x n + xn + 1 a21 x1 + a22 x2 + … + a2 n x n+ xn + 2= b1= b2…am1 x1 + am2 x2 + … + am n x n x1 , … , xn ≥0 , xn + 1 , … , xn + m ≥ 0+ xn + m = bm以 xn + 1 , … , xn + m 为基变量 , 并可得到一个 m× m 单位 矩阵。令 非基 变量 x1 , … , xn 为零 , 便可得到一个初始基可行解X( 0 ) = ( 0 , 0 , … , 0 , b1 , b2 , … , bm ) T 因为人工变量是后加入到原约束条件中的虚拟 变量 , 要求 经过 基的变 换将 它们从 基变 量 中逐个替换出来。基变量中不再含有非零的 人工变 量 , 这表 示原 问题有 解。若在 最终 表 中当所有 cj - zj ≤ 0 , 而在其中还有某个非零人工变量 , 这表示无可行解。1. 大 M 法在一个线性规划问题的约束条件中加进人工 变量 后 , 要求 人工变 量对 目标函 数取 值 不受影响 , 为此假定人工变量 在目 标函 数中 的系 数 为 ( - M) ( M 为任 意大 的 正数 ) , 这 样 目标函数要实现最大化时 , 必须把人工变量 从基 变量换 出。否 则目标 函数 不可能 实现 最 大化。例 8 现有线性规划问题·23·续表θi‘’‘’ë¥¥§¦Ø(cid:144)íî’’(cid:8)(cid:28)Ø(cid:144)î’’í(cid:8)(cid:28)Ø(cid:144)í’î’(cid:8)(cid:28)Ø(cid:144)î’’ímin z = - 3 x1 + x2 + x3x1 - 2 x2 + x3 ≤114 x1 + x2 + 2 x3 ≥32 x1 x1 , x2 , x3 ≥0+ x3 = 1试用大 M 法求解。解 在上述问题的约束条件中加入松弛变量 x4 , 剩余变量 x5 , 人工变量 x6 , x7 , 得到min z = - 3 x1 + x2 + x3 + 0 x4 + 0 x5 + M x6 + M x7x1 - 2 x2 + x3 + x4= 114 x1 + x2 + 2 x3 - x5 + x6= 32 x1 + x3 x1 , x2 , x3 , x4 , x5 , x6 , x7 ≥0+ x7 = 1这里 M 是一个任意大的正数。用单纯形法进行计算时 , 见表 1 -6。因 本 例是 求 min , 所 以用 所 有 cj - zj ≥ 0 来判 别目标函数是否实现了最小化。表 1 -6 中的最终表表明得到最优解是x1 = 4 , x2 = 1 , x3 = 9 , x4 = x5 = x6 = x7 = 0目标函数z = - 2表 1 -6cj31100MMθiCBXBbx1x2x3x4x5x6x70x411121100011Mx6341201103/ 2Mx7120[1 ]00011cj - zj3 + 6 M1 - M1 - 3 M0M000x4103201001Mx610[1 ]0011211x312010001cj - zj11 - M00M03 M - 10x412[ 3]00122541x2101001121x312010001cj - zj10001M - 1M + 13x141001/ 32/ 32/ 35/ 31x2101001121x390012/ 34/ 34/ 37/ 3cj - zj20001/ 31/ 3M - 1/ 3M - 2/ 3·33·ðcz’(cid:6)ŽÖ§x¥(cid:26)(cid:2)ÁÁd(cid:144)zcî!(cid:6)(cid:31)KÁÁ8czd(cid:144)î(cid:6)KÁÁ(cid:144)zîd(cid:6)(cid:10)KîÁÁ¿dczî(cid:31)(cid:6)KÁ¿dzîc(cid:6)(cid:10)KÁÁzcd¿î(cid:31)(cid:6)Kðcî(cid:6)cd¿¨î’(cid:10)(cid:31)(cid:6)KÁd¿c’î¨(cid:31)(cid:6)KÁc¿d’î¨(cid:6)(cid:31)KEðèzc’(cid:6)MNÁÖ4cí’(cid:28)KMÁÖc’4í(cid:31)(cid:28)KMÖÁ4’cí(cid:28)(cid:31)KMÁ4sc¨’(cid:22)2. 两阶段法用电子计算机求解含人工变量 的 线性 规划 问题 时 , 只 能用 很大 的数 来 代替 M , 这 就可能造成计算上的错误。故介绍两阶段法求线性规划问题。第一阶段 : 不考虑原问题是否存在基可行 解 ; 给原 线性 规划问 题加 入人工 变量 , 并 构造仅含人工变量的目标函数和要求实现最小化。如min ω= xn + 1 + … + xn + m + 0 x1 + … + 0 xn a11 x1 + … + a1 n x n + xn + 1 = b1 a21 x1 + … + a2 n x n + xn + 2 = b2…am1 x1 + … + am n x n + xn + m = bm x1 , x2 , … , xn + m ≥ 0然后用单纯形法求解上述模型 , 若得到 ω= 0 , 这说明原问题 存在基 可行解 , 可以进 行第二段计算。否则原问题无可行解 , 应停止计算。第二阶段 : 将第一阶段计算得到的最 终表 , 除去 人工 变量。将 目标 函数行 的系 数 , 换原问题的目标函数系数 , 作为第二阶段计算的初始表。各阶段的计算方法及步骤与第 3 节单纯形法相同。下面举例说明。 例 9 线性规划问题mi n z = - 3 x1 + x2 + x3x1 + 2 x2 + x3 ≤114 x1 + x2 + 2 x3 ≥32 x1x1 ,+ x3 = 1 x3 ≥0x2 ,试用两阶段法求解。解 先在上述线性规划问题的约束方程中加入人工变量 , 给出第一阶段的数学模型为 :min ω= x6 + x7x1 - 2 x2 + x3 + x4= 114 x1 + x2 + 2 x3x5 + x6= 32 x1+ x3+ x7 = 1 x6 , x7 ≥0x3 , x4 , x5 , 这里 x6 , x7 是人工变量。用单纯形法求解 , 见表 1 -7。第一阶段求得的结果是 ω= 0 , 得到 最优解是x2 ,x1 ,x1 = 0 , x2 = 1 , x3 = 1 , x4 = 12 , x5 = x6 = x7 = 0 因人工变量 x6 = x7 = 0 , 所以 ( 0 , 1 , 1 , 12 , 0 ) T 是这线性规划问题的基可行解。于是可以 进 行第二阶段运算。将第一阶 段 的最 终表 中的 人工 变 量取 消填 入原 问题 的 目标 函数 的 系数。进行第二阶段计算 , 见表 1 -8 。·43·表 1 -7cj →0000011θiCBXBbx1x2x3x4x5x6x70x4111211000111x6341201103/ 21x7120[1]00011cj - zj61301000x41032010011x610[ 1]0011210x312010001cj - zj01001030x41230012250x2101001120x312010001cj - zj00000011表 1 -8cj31100θiCBX Bbx1x2x3x4x50x412[3 ]001241x21010011x3120100cj - zj100013x141001/ 32/ 31x21010011x390012/ 34/ 3cj - zj20001/ 31/ 3从表 1 -8 中得到最优解为 x1 = 4 , x2 = 1 , x3 = 9 , 目标函数值 z = - 2。5. 2 退化单纯形法计算中用 θ规则确定换出变量时 , 有时存在两个以上相同的最小比 值 , 这 样在下一次迭代中就有一个或几个基变量等于零 , 这就 出现退化 解。这时换 出变量 x l = 0 , 迭代后目标函数值不变。这时不同基表示为 同一顶 点。有 人构造 了一 个特例 , 当 出现 退化时 , 进行多次迭代 , 而基从 B1 , B2 , …又返回到 B1 , 即出现计算 过程的 循环 , 便永远达 不到最优解。尽管计算过程的循环现象极少出现 , 但还是 有可 能的。 如何解 决这 问题 ? 先 后有 人·53·zbªî’(cid:6)(cid:30)Ž¾2v¦(cid:2)(cid:26)MNÀLbózî(cid:6)ªÖMÀNLzbîª(cid:10)(cid:6)ÖMNÜLzbªî(cid:6)ÖÀLzbªî(cid:6)MN(cid:144)ª’î¨(cid:6)ÖMÜN(cid:144)ª¨’î(cid:6)ÖMN(cid:144)’¨îª(cid:30)(cid:6)Öî¨ª’MN(cid:144)ªî¨’(cid:6)(cid:30)ÖMN(cid:144)¨î’ª(cid:30)(cid:6)ÖMN(cid:144)¨ªî’(cid:30)(cid:6)ÖM(cid:144)¨ªî’(cid:30)(cid:6)Àb3‘(cid:30)HÕw¦(cid:4)ÀÜ5(cid:144)‘‘|bÀ(cid:144)5‘ï|‘bÀ5(cid:144)‘ï|‘bÀ(cid:144)‘‘À(cid:144)«6‘(cid:144)ïbÀ«6(cid:144)ï(cid:144)‘bÀ(cid:144)«(cid:144)ï6‘bÀ6(cid:144)(cid:144)ï‘提出了“摄动法”,“ 字典序法”。1974 年由勃兰 特 ( Bland) 提出一 种简便 的规则 , 简称勃 兰 特规则 :(1 ) 选取 cj - zj > 0 中下标最小的非基变量 x k 为换入变量 , 即k = min( j | cj - z j > 0 )(2 ) 当按 θ规则计算存在两个 和两 个以上 最小 比值时 , 选取 下标 最小 的 基变 量为 换出变量。按勃兰特规则计算时 , 一定能避免出现循环。5. 3 检验数的几种表示形式本书以 m ax z = C X; A X = b, X≥0 为 标准型 ; 以 cj - zj ≤ 0 , ( j = 1 , 2 , … , n) 为最优 解的判别准则。还有其他的形式。为了避免混淆 , 现将几种情况归纳如下。设 x1 , x2 , … , xm 为约束方程的基变量 , 于是可得nx i = bi - ∑ai j x j , i = 1 , 2 , … , mj = m+ 1将它们代入目标函数后 , 可有两种表达形式mnmz = ∑ci bi + ∑cj - ∑ci ai jxji = 1j = m+ 1i = 1n= z0 + ∑( cj - zj ) x jj = m+ 1或mnmz = ∑ci bi - ∑∑ci ai jcjxji = 1j = m+ 1i = 1n= z0∑ j = m+ 1( zjcj ) x j要求目标函数实现最大化 时 , 若 用 ( 1 -37 ) 式 来分析 , 就得 到 cj - zj ≤ 0 , ( j = 1 , 2 , … , n) 的 判别准则。若用 (1 -38 ) 式来分析 , 就得到 zj - cj ≥0 , ( j = 1 , 2 , … , n) 的判别准则。同样 , 在要求目标函数实现最小化时 , 可用 (1 -37 ) 式或 ( 1 -38 ) 式来 分析 , 这时 分别 用 cj - zj ≥0 或 zj - cj ≤0 , ( j = 1 , 2 , … , n) 来判别目 标函数已达到最小。 现将几种情况汇 总 于表 1 -9。表 1 -9标准型max z = C Xmin z = C X检验数A X = b, X≥0A X = b, X≥0cj - zj≤0≥0zj - cj≥0≤05. 4 单纯形法小结(1 ) 根据实际问题给出数学模型 , 列出初始单纯形表。进行标准化 , 见表 1 -10。·63·(1 -37)(1 -38)Ÿ&Üc表 1 -10变量xj ≥0xj ≤0xj 无约束不需要处理令 x′j = - xj ; x′j ≥0令 xj = x′j - x″j ; x′j , x″j ≥0约 束 条 件b≥0 b < 0 ≤= ≥不需要处理 约束条件两端同乘 - 1 加松弛变量 xs i 加人工变量 xa i 减去剩余( 松弛 )变量 xs i , 加人工变量 xa i目 标 函 数max zmin z加入变量的系数松弛变量xs i 人工变量不需要处理 令 z′= - z, 求 max z′0xa iM分别以每个约束条件中的松弛变量或人工变量为基变量 , 列出初始单纯形表。(2 ) 对目标函数求 max 的线性规划问题 , 用单纯形法计算步骤的框图见图 1 -9。图 1 -9·73·É第 6 节 应 用 举 例一般讲 , 一个经济、管理问题凡满足以下条件时 , 才能建立线性规划的模型。 (1 ) 要求解问题的目标函数能用数值指标来反映 , 且为线性函数 ; (2 ) 存在着多种方案 ; (3 ) 要求达到的目标是在一 定约 束条件 下实 现的 , 这些 约束 条件 可用线 性等 式或 不等式来描述。下面举例说明线性规划在经济管理等方面的应用。例 10 合理利用线材问题。现要做 100 套钢架 , 每套用长为 2. 9 m , 2. 1 m 和 1. 5m 的元钢各一根。已知原料长 7. 4m , 问应如何下料 , 使用的原材料最省。解 最简单做法是 , 在每一根原材料上截取 2. 9m , 2. 1m 和 1. 5m 的元钢 各一根组 成 一套 , 每根原材料剩下料头 0. 9m。为了做 100 套钢架 , 需用原材 料 100 根 , 有 90m 料头。 若改为用套裁 , 这可以节约原材料。下面有几种套裁方案 , 都可以考虑采用。见表1-11。表 1-11下料根数方案长度( m )ⅠⅡⅢⅣⅤ2. 91212. 102211 . 5 合计3. 4 717. 32. 2 77. 136. 6料头00. 1. 2 00. 30. 8为了得到 100 套钢架 , 需要混合使用各 种下料 方案。设 按Ⅰ 方案 下料 的原材 料根 数 为 x1 , Ⅱ方案为 x2 , Ⅲ方案为 x3 , Ⅳ方案为 x4 , Ⅴ方案为 x5 。根据表 1 -11 的方案 , 可列出 以下数学模型 :min z = 0 x1 + 0. 1 x2 + 0. 2 x3 + 0. 3 x4 + 0. 8 x5x1 + 2 x2+ x4= 1002 x3 + 2 x4 + x5 = 1003 x1 + x2 + 2 x3 x1 , x2 , x3 , x4 , x5 ≥ 0+ 3 x5 = 100在以上约束条件中加入人工变量 x6 , x7 , x8 ; 然后用表 1 -12 进行计算。由计算得到最优下料方案是 : 按Ⅰ方案下料 30 根 ; Ⅱ方案下 料 10 根 ; Ⅳ方案下 料 50根。即需 90 根原材料可以制造 100 套钢架。例 11 配料问题 某工厂要用三种原材料 C、P、H 混 合调 配出 三种 不 同规 格的 产品 A 、B、D。 已知 产 品的规格要求 , 产 品 单 价 , 每 天 能 供 应 的 原 材 料 数 量 及 原 材 料 单 价 , 分 别 见 表 1 -13 和 表 1 -14 。该厂应如何安排生产 , 使利润收入为最大 ?解 如以 AC 表示产品 A 中 C 的成分 , AP 表示产品 A 中 P 的成分 , 依次类推。·83·”‰5‘(cid:7)”‰c"‘(cid:7)”‰c"5(cid:7)@5œ‘"nc(cid:18)@5œ‘" (cid:7)" (cid:7)nc根据表 1 -13 有 :AC ≥ 1 2A, AP ≤ 1 4A, BC ≥ 1 4B, BP ≤ 1 2B(1 -39)这里AC + AP + AH = A(1 -40)BC + BP + B H = B将 (1 -39 ) 逐个代入 ( 1 -40 ) 并整理得到1 2AC +1 2AP +1 2A H ≤0表 1 -12cj→00. 10. 20. 30. 8MMMθiCB XBbx1x2x3x4x5x6x7x8M x610012010100100 1M x710000221010M x8100[3]1203001100 34M - 0. 1 + 3 M - 0. 2 + 4M - 0. 3 + 3M - 0. 8 + 4 M000M x6200/ 305/ 32/ 311101/ 3200 3M x7100002[2]1010100 20x1100/ 311/ 32/ 301001/ 30. 1 +0. 2 +05/ 3M4/ 3M0. 3 + 3M0. 8004/ 3MM x650/ 30[5/ 3]5/ 303/ 211/ 21/ 3150 150. 3 x45000111/ 201/ 200x1100/ 311/ 32/ 301001/ 3100 100. 1 +5/ 3M. 1 - 05/ 3M00. 65 -3/ 2M00. 15 -3/ 2 M4/ 3M. 1 0x21001109/ 103/ 53/ 101/ 50. 3 x45000111/ 201/ 200x130101013/ 101/ 51/ 102/ 500000. 74M+ 0. 06 - M+ 0. 12 - M - 0. 02·93·C9LÉ¿€v(cid:6)üÜV%Ÿ`“b(cid:25)pŒOCLÉ€¨(cid:18)(cid:6)ÆŒOCL€É¨(cid:18)(cid:6)ÆpŒOC€É¨(cid:6)(cid:18)ÆŒOá×g]¤š(cid:20)(cid:30)(cid:18)pŒ©ÑLOdò(cid:6)ÆpŒCOLÉ€¨(cid:18)ÆŒ;Ñ©ÉOLú(cid:6)lÆWM(cid:26)ŒOÉ¿L¤špŒL½d (cid:27) (cid:27)ÆŒCL€xúð”ò(cid:18)(cid:6)ÆpŒO©É;LÑlú(cid:6)ÆWMèÞñç‹(cid:129)LŒ(cid:6)ÑÇ/Lµ”d€µ(cid:6)lÆŒCLò”úðx€(cid:18)(cid:6)ÆŒC;Þ€L”ú(cid:6)(cid:27)ÆÅ»CKALˆ~€´ª(cid:6)本例中存在多重最优解 , 请读者自检。表 1 -13产品名称规格要求单价 (元/ kg )A原材料 C 不少于 50%原材料 P 不超过 25% 原材料 C 不少于 25%50B原材料 P 不超过 50%35D不限251 4AC +3 4AP -1 4A H ≤03 4 1 2BC +BC +1 4 1 2BP +BP -1 4 1 2BH ≤0BH ≤0表 1 -14原材料名称每天最多供应量 ( kg )单价/ (元/ kg)C10065P10025H6035表 1 -14 表明这些原材料供应 数量 的限额。 加入 到产品 A、B、D 的原 材料 C 总量 每天不超过 100kg , P 的总量不超过 100kg , H 总量不超过 60kg。由此AC + BC + DC ≤ 100 AP + BP + D P ≤100AH + B H + DH ≤ 60在约束条件中共有 9 个变量 , 为计算和叙述方便 , 分别用 x1 , … , x9 表示。令x1 = AC x2 = AP x3 = A Hx4 = BC x5 = BP x6 = B H x7 = DC x8 = DP x9 = DH由此约束条件可表示为 :1 2x1 +1 2x2 +1 2x3 ≤01 4x1 +3 4x2 -1 4x3 ≤03 4x4 +1 4x5 +1 4x6 ≤01 2 x1 + x4 + x7 ≤100 x2 + x5 + x8 ≤100 x3 + x6 + x9 ≤60 x9 ≥ 0 x1 , … ,1 21 2x4 +x5 -x6 ≤0·04·ÅÅÅÅcÅcÅc我们的目的是使利润最大 , 即产品价格减去原材料的价格为最大。产品价格为 :原材料价格为 :50( x1 + x2 + x3 ) ———产品 A 35( x4 + x5 + x6 ) ———产品 B 25( x7 + x8 + x9 ) ———产品 D 65( x1 + x4 + x7 ) ———原材料 C 25( x2 + x5 + x8 ) ———原材料 P 35( x3 + x6 + x9 ) ———原材料 H目标函数max z = 50 ( x1 + x2 + x3 ) + 35( x4 + x5 + x6 ) + 25 ( x7 + x8 + x9 ) -65 ( x1 + x4 + x7 ) - 25( x2 + x5 + x8 ) - 35 ( x3 + x6 + x9 )= - 15 x1 + 25 x2 + 15 x3 - 30 x4 + 10 x5 - 40 x7 - 10 x9 为了得到初始解 , 在约束条件中加入松弛变量 x10 ～ x16 , 得到数学模型 :max z = - 15 x1 + 25 x2 + 15 x3 - 30 x4 + 10 x5 - 40 x7 - 10 x9 + 0· ( x10 + x1 1 + x1 2 + x13 + x14 + x15 + x16 )1 2x1 +1 2x2 +1 2x3 + x10 = 01 4x1 +3 4x2 -1 4x3 + x11 = 03 4x4 +1 4x5 +1 4x6 + x12 = 01 2x4 +1 2x5 -1 2x6 + x13 = 0x1 + x4 + x7 + x14 = 100x2 + x5 + x8 + x15 = 100x3 + x6 + x9 + x16 = 60 i = 1 , 2 , … , 16 xi ≥0 ,上述数学模型 , 可用单纯形法计算 , 计算结果是 : 每天只生产产品 A 为 200kg , 分别需要用原料 C 为 100kg ; P 为 50kg ; H 为 50 kg。总的利润收入是 z = 500 元/ 天。 例 12 生产与库存的优化安排 某工厂生产五种产品 ( i = 1 , … , 5 ) , 上 半年 各月 对每种 产品 的最大 市场 需求 量为 di j ( i = 1 , … , 5 ; j = 1 , … , 6 ) 。已知每件产品的单件售价为 Si 元 , 生 产每件 产品 所需要 工时 为 ai , 单件成本为 Ci 元 ; 该工厂上 半年各 月正 常生 产工时 为 rj ( j = 1 , … , 6 ) , 各 月内 允许 的 最大加班工时为 r′j ; C′i 为加班单件成本。 又每月 生产 的各 种产品 如当 月销售 不完 , 可 以 库存。库存费用为 H i ( 元/ 件·月 ) 。假设 1 月初 所有产 品的 库存为 零 , 要求 6 月 底各 产 品库存量分别为 ki 件。现要求为该工厂制定一个生产计划 , 在尽可 能利用生 产能力的 条 件下 , 获取最大利润。解 设 x i j , x′i j 分别为该工厂第 i 种产品的第 j 个月在正常时间和加班时间内的生产 量 ; yi j 为 i 种产品在第 j 月的销售量 , wi j 为第 i 种产品第 j 月 末的库 存量。根据 题意 , 可 用以下模型描述 :·14·(1 ) 各种产品每月的生产量不能超过允许的生产能力 , 表示为 :5∑ai x i j ≤ rj( j = 1 , … , 6 )i = 15∑ai x′i j ≤ r′j( j = 1 , … , 6 )i = 1(2 ) 各种产品每月销售量不超过市场最大需求量yi j ≤ di j( i = 1 , … , 5 ; j = 1 , … , 6 )(3 ) 每月末库存量等于上月末库存量加上该月产量减掉当月的销售量wi j = wi ,j - 1 + xi j + x′i j - yi j( i = 1 , … , 5 ; j = 1 , … , 6 ) ;其中wi 0 = 0 , wi 6 = ki(4 ) 满足各变量的非负约束x i j ≥0 , x′i j ≥0 , yi j ≥0 , wi j ≥0 ( i = 1 , … , 5 ; j = 1 , … , 5)( i = 1 , … , 5 ; j = 1 , … , 6)(5 ) 该工厂上半年总盈利最大可表示为 : 目标函数5655m ax z = ∑i = 1∑j = 1[ Si y i jCi x i jC′i x′i j ] - ∑ j = 1C′i x′i j ] - ∑ j = 1H i w i j例 13 连续投资问题 某部门在今后五年内考虑给下列项目投资 , 已知 : 项目 A , 从第一年到第四年每年年初需要投资 , 并于次年末回收本利 115 % ; 项目 B, 第三年初需要投资 , 到第 五年 末能 回收 本 利 125 % , 但规 定最 大 投资 额不 超过 4 万元 ;项目 C, 第二年初需要投资 , 到第 五年 末能 回收 本 利 140 % , 但规 定最 大 投资 额不 超过 3 万元 ;项目 D, 五年内每年初可购买公债 , 于当年末归还 , 并加利息 6 % 。 该部门现有资金 10 万元 , 问它应如何确定给 这些 项目 每年的 投资 额 , 使到第 五年 末拥有的资金的本利总额为最大 ?解(1 ) 确定变量 这是一个连续投资问题 , 与时间有关。但这里设法用线性规划方法 , 静态地处理。以 x i A , xi B , xi C , xi D ( i = 1 , 2 , … , 5) 分别表示第 i 年年初给项目 A , B, C, D 的投资额 , 它们 都 是待定的未知变量。根据给定的条件 , 将变量列于表 1 -15 中。表 1 -15项 目第一年第二年第三年第四年第五年Ax1 Ax2 Ax3 Ax4 ABx3 BCx2 CDx1 Dx2 Dx3 Dx4 Dx5 D·24·(2 ) 投资额应等于手中拥有的资金额由于项目 D 每年都可以投资 , 并且当年末即能回收本 息。所以 该部门每 年应把资 金全部投出去 , 手中不应当有剩余的呆滞资金。因此 第一年 : 该部门年初拥有 100000 元 , 所以有x1 A + x1 D = 100000第二年: 因第一年给项目 A 的投资要到第二年末才能回收。所以该部门在第二年初拥有资金额仅为项目 D 在第一年回收的本息 x1 D (1 + 6 % )。于是第二年的投资分配是x2 A + x2 C + x2 D = 1 .06 x1 D第三年 : 第三年初的资金额是从项目 A 第一年投资及项目 D 第二年投资中回收的本利总和 : x1 A ( 1 + 15 % ) 及 x2 D (1 + 6 % ) 。于是第三年的资金分配为x3 A + x3 B + x3 D = 1 .15 x1 A + 1 .06 x2 D第四年 : 同以上分析 , 可得x4 A + x4 D = 1 .15 x2 A + 1 .06 x3 D第五年 :x5 D = 1 .15 x3 A + 1 .06 x4 D此外 , 由于对项目 B、C 的投资有限额的规定 , 即 :x3 B ≤40000 x2 C ≤ 30000(3 ) 目标函数 问题是要求在第五年末该部门手中拥有的资金额达到最大 , 这个目标函数可表示为max z = 1 .15 x4 A + 1 .40 x2 C + 1 .25 x3 B + 1 .06 x5 D(4 ) 数学模型 经过以上分析 , 这个与时间有关的投资问题可以用以下线性规划模型来描述 :max z = 1 .15 x4 A + 1 .40 x2 C + 1 .25 x3 B + 1 .06 x5 D满足x1 A + x1 D= 1000001. 06 x1 D + x2 A + x2 C + x2 D= 01. 15 x1 A - 1. 06 x2 D + x3 A + x3 B + x3 D = 01. 15 x2 A - 1. 06 x3 D + x4 A + x4 D= 01. 15 x3 A - 1. 06 x4 D + x5 Dx2 C= 0 ≤30000x3 B xi A , x i B , x i C , xi D ≥0i = 1 , 2 , … , 5≤40000(5 ) 用单纯形法计算结果得到 第一年 : x1 A = 34783 元 , x1 D = 65217 元 第二年 : x2 A = 39130 元 , x2 C = 30000 元 , x2 D = 0 第三年 : x3 A = 0 , x3 B = 40000 元 , x3 D = 0 第四年 : x4 A = 45000 元 , x4 D = 0 第五年 : x5 D = 0·34·到第五年末该部门拥有资金总额为 143750 元 , 即盈利 43 .75 % 。习题1. 1 用图解法求解下列线性规划问题 , 并指 出问 题是 具有唯 一最 优解、无穷 多最 优解、无界解还是无可行解 ?(1 ) max z = x1 + 3 x2( 2) min z = x1 + 1. 5 x25 x1 + 10 x2 ≤50x1 + x2 ≥1 x2 ≤4x1 + 3 x2 ≥3 x1 + x2 ≥2 x1 , x2 ≥0x1 , x2 ≥ 0(3 ) max z = 2 x1 + 2 x2( 4) max z = x1 + x2x1 - x2 ≥ - 10. 5 x1 + x2 ≤2 x1 , x2 ≥0x1 - x2 ≥0 3 x1 - x2 ≤ - 3 x1 , x2 ≥01. 2 将下列线性规划问题变换成标准型 , 并列出初始单纯形表。(1 ) min z = - 3 x1 + 4 x2 - 2 x3 + 5 x44 x1 -x2 + 2 x3 -x1 + x2 + 3 x3 -x4 = - 2 x4 ≤142 x1 + 3 x2 -x3 + 2 x4 ≥2x1 , x2 , x3 ≥0 ,x4 无约束(2 ) max s = zk/ pknmzk = ∑∑αi k x i ki = 1k = 1m∑x i k = - 1( i = 1 , … , n)k = 1x i k ≥0 ( i = 1 , … , n; k = 1 , … , m)1. 3 在下面的线性规划问题中找出满 足约 束条件 的所 有基 解。指出 哪些是 基可 行解 , 并代入目标函数 , 确定哪一个是最优解。(1 ) max z = 2 x1 + 3 x2 + 4 x3 + 7 x4( 2) m ax z = 5 x1 - 2 x2 + 3 x3 - 6 x42 x1 + 3 x2 -x3 - 4 x4 = 8x1 + 2 x2 + 3 x3 + 4 x4 = 7x1 - 2 x2 + 6 x3 - 7 x4 = - 3 x1 , x2 , x3 , x4 ≥02 x1 + x2 + x3 + 2 x4 = 3 x1 , x2 , x3 , x4 ≥01. 4 分别用图解法和单纯形法求解下列线性规划问题 , 并指出单纯形法迭代的每一步相当于图形上哪一个顶点。·44·(1 ) max z = 2 x1 + x2( 2) max z = 2 x1 + 5 x23 x1 + 5 x2 ≤ 15 6 x1 + 2 x2 ≤ 24 x2 ≥ 0x1 ,x1≤4 2 x2 ≤123 x1 + 2 x2 ≤ 18 x1 , x2 ≥01. 5 以 1. 4 题 ( 1) 为例 , 具体说明当目标函数中变量的系数怎样改变时 , 使满足约束条件的可行域的每一个顶点 , 都有可能使目标函数值达到最优。1. 6 分别用单纯形法中的大 M 法和 两阶段 法求 解下 述线性 规划 问题 , 并指 出属 哪一类解。(1 ) max z = 2 x1 + 3 x2 - 5 x3(2 ) min z = 2 x1 + 3 x2 + x3x1 + x2 + x3 = 7 2 x1 - 5 x2 + x3 ≥10x1 ,x2 ,x3 ≥0x1 + 4 x2 + 2 x3 ≥8 ≥6 x3 ≥03 x1 + 2 x2x1 ,x2 ,(3 ) max z = 10 x1 + 15 x2 + 12 x3 5 x1 + 3 x2 + x3 ≤9 - 5 x1 + 6 x2 + 15 x3 ≤15(4 ) max z = 2 x1 - x2 + 2 x3 x1 + x2 + x3 ≥6 + x3 ≥22 x12 x1 + x2 + x3 ≥5 x3 ≥0x1 ,x2 ,2 x2 - x3 ≥0 x3 ≥0x1 , x2 ,1. 7 求下述线性规划问题目标函数 z 的上界 z * 和下界 z*max z = c1 x1 + c2 x2 a1 1 x1 + a1 2 x2 ≤ b1 a2 1 x1 + a2 2 x2 ≤ b2 x1 , x2 ≥0其中 : 1 ≤ c1 ≤3 , 4 ≤ c2 ≤ 6 , 8 ≤ b1 ≤ 12 , 10 ≤ b2 ≤ 14 , - 1 ≤ a11 ≤ 3 , 2 ≤ a12 ≤ 5 , 2 ≤ a21 ≤ 4 , 4≤ a22 ≤ 61. 8 表 1 -16 是某求极大化线性规划问 题计 算得到 的单 纯形表。 表中 无人工 变量 ,a1 、a2 、a3 、d、c1 、c2 为待定常数。试说明这些常数分别取何值时 , 以下结论成立。(1 ) 表中解为唯一最优解 ; (2 ) 表中解为最优解 , 但存在无穷多最优解 ; (3 ) 该线性规划问题具有无界解 ; (4 ) 表中解非最优 , 为对解改进 , 换入变量为 x1 , 换出变量为 x6 。表 1 -16基 bx1x2x3x4x5x6x3d4a110a20x4 2130110x6 3a350041cj - zjc1c20030·54·Õ§_1“(cid:3)Á(cid:127)(cid:29)ï\ÒÁey(cid:127)ïï(cid:29)ey(cid:127)ï(cid:29)ï¤y(cid:127)(cid:29)ïŸÍ1. 9 某昼夜服务的公交线路每天各时间区段内所需司机和乘务人员数如下 :班次12345时 间 6∶ 00～ 10∶ 00 10∶ 00～ 14∶ 00 14∶ 00～ 18∶ 00 18∶ 00～ 22∶ 00 22∶ 00～ 2∶ 00 2∶ 00～ 6∶ 00所需人数6070605020630设司机和乘务人员分别在各时间区段一开始时上班 , 并连续工作八小时 , 问该公交线路至 少配备多少名司机和乘务人员。列出这个问题的线性规划模型。1. 10 某糖果厂用原料 A、B、C 加工成三 种不同 牌号 的糖 果甲、乙、丙。已知 各种 牌 号糖果中 A、B、C 含量 , 原料 成本 , 各 种 原料 的每 月限 制用 量 , 三 种牌 号糖 果 的单 位加 工 费及售价如表 1 -17 表示。 表 1 -17原 料甲乙丙原料成本 ( 元/ 千克 )每月限制用量 ( 千克)A≥60 %≥15%2. 002000B C 加工费 (元/ 千克 ) 售 价≤20 % . 50 0 . 40 3≤60% . 40 0 . 85 2≤50 % . 30 0 . 25 21 1. 50 . 002500 1200问该厂每月应生产这三种牌号糖果各多 少千克 , 使 该厂 获利 最大 ? 试 建立这 个问 题的线性规划的数学模型。1. 11 某厂生产 三种产品 Ⅰ , Ⅱ , Ⅲ。每种产 品要经 过 A , B 两 道工序加 工。设该 厂 有两种规格的 设备 能完 成 A 工 序 , 它 们以 A1 , A2 表示 ; 有三 种规 格的 设 备能 完 成 B 工 序 , 它们以 B1 , B2 , B3 表示。产品Ⅰ可在 A , B 任何 一种规格 设备上 加工。产品 Ⅱ可在 任 何规格的 A 设备上加工 , 但完成 B 工序 时 , 只能 在 B1 设 备上 加 工 ; 产品 Ⅲ 只能 在 A2 与 B2 设备上加工。已知在各种机床设备的单件工时 , 原材料费 , 产品销售 价格 , 各种设备 有 效台时以及满负荷操作时机床 设备的 费用 如下表 ( 表 1 -18 ) , 要求 安排 最优 的 生产 计划 , 使该厂利润最大。 满负荷时的1. 11 某厂生产 三种产品 Ⅰ , Ⅱ , Ⅲ。每种产 品要经 过 A , B 两 道工序加 工。设该 厂 有两种规格的 设备 能完 成 A 工 序 , 它 们以 A1 , A2 表示 ; 有三 种规 格的 设 备能 完 成 B 工 序 , 它们以 B1 , B2 , B3 表示。产品Ⅰ可在 A , B 任何 一种规格 设备上 加工。产品 Ⅱ可在 任 何规格的 A 设备上加工 , 但完成 B 工序 时 , 只能 在 B1 设 备上 加 工 ; 产品 Ⅲ 只能 在 A2 与 B2 设备上加工。已知在各种机床设备的单件工时 , 原材料费 , 产品销售 价格 , 各种设备 有 效台时以及满负荷操作时机床 设备的 费用 如下表 ( 表 1 -18 ) , 要求 安排 最优 的 生产 计划 , 使该厂利润最大。 满负荷时的1. 11 某厂生产 三种产品 Ⅰ , Ⅱ , Ⅲ。每种产 品要经 过 A , B 两 道工序加 工。设该 厂 有两种规格的 设备 能完 成 A 工 序 , 它 们以 A1 , A2 表示 ; 有三 种规 格的 设 备能 完 成 B 工 序 , 它们以 B1 , B2 , B3 表示。产品Ⅰ可在 A , B 任何 一种规格 设备上 加工。产品 Ⅱ可在 任 何规格的 A 设备上加工 , 但完成 B 工序 时 , 只能 在 B1 设 备上 加 工 ; 产品 Ⅲ 只能 在 A2 与 B2 设备上加工。已知在各种机床设备的单件工时 , 原材料费 , 产品销售 价格 , 各种设备 有 效台时以及满负荷操作时机床 设备的 费用 如下表 ( 表 1 -18 ) , 要求 安排 最优 的 生产 计划 , 使该厂利润最大。 满负荷时的设 备ⅠⅡⅢ设备费用( 元 )A1 A2 B1 B2 B3 原料费 ( 元/ 件 ) 单价 (元/ 件)5 7 6 4 7 . 25 . 250 210 9 8. 35 . 000 21211. 50 . 806000 10000 4000 7000 4000300 321 250 783 200·64·ÜÝnÝÜnÝÜnÜÝnÝÜnÜÝnÛ{pÛ{pÛ{pÁ¶ðå(cid:20)(cid:31)Á¶ðå(cid:31)(cid:20)ÁÖ~c#ÁÖL~î#ÖÁL~!ÖÁ~î!ÖÁ~!(cid:7)ü|q’‡(cid:7)ü’‡|q第 2 章 对偶理论和灵敏度分析第 1 节 单纯形法的矩阵描述现在用矩阵描述单纯形法的计算过程。它 将有助 于对 单纯形 法的 理解 , 以及 学习 对偶理论和灵敏度分析。设线性规划问题 : max z = C X ; A X≤ b; X≥0。给这线性规划问 题的约束 条件加入 松弛变量 Xs = ( xs1 , xs2 , … , xs m ) T 以后 , 得到标准型 :m ax z = C X + O X S ; A X + I X S = b; X, X S ≥ 0这里的 I 是 m× m 单位矩阵。若以 X S 为基变量 , 这 时可标记 成 XB 。其 对应的单 位 矩阵就是基矩阵 B, 这时将系数矩阵 ( A , I) 分为 ( B, N) 两块。 N 是非基 变量的系 数矩阵 ,相应的决策变量被分为 X =X BX N, 同时目标函 数的系 数 C 分 为 CB , CN 分 别对应 于基 变量和非基变量 , 并记作 C = ( CB , CN ) 。经过迭代运算后 , 在基矩阵中可能还存 在松 弛变量 或全 无松 弛变量。 为了阐 述方 便起见 , 设XB =XB 1X S 1; X N =X N 1X S2; X S =X S 1X S 2; A =BN; N =N1S2B, N , S 分 别表示 对应基变 量、非基变量、松 弛变量的 系数矩 阵。这时线 性规划问 题可以表示为目标函数max z = CB X B + CN X N = CB X B + CN 1 X N 1 + CS 1 X S 1( 2 -1)约束条件 非负条件B X B + N X N = B X B + N1 X N 1 + S2 X S 2 = b XB , X N ≥0( 2 -2)( 2 -3)将 (2 -2) 式移项后 , 得到 B X B = b - N1 X N 1 - S2 X S 2 ; 然后给等式两边左乘 B - 1 后 , 得到X B = B - 1 b - B - 1 N1 X N1 - B - 1 S2 X S2( 2 -4)将 (2 -4) 式代入目标函数 (2 -1 ) 式 , 因 S2 是单位矩阵 , 得到z = CB B - 1 b + ( CN1 - CB B - 1 N1 ) X N 1 + ( CS 2 - CB B - 1 I) X S( 2 -5)令非基变量 XN = 0 , 可得到一个基可行解 X( 1 ) =B- 1 b 0, 这时目标函数 z = CB B - 1 b。从表达式中可以见到 : (1 ) 非基变量的系数 ( CN 1 - CB B - 1 N1 ) 就是第 1 章中用符号 cj - zj ( j = 1 , 2 , … , n) 表示的检验数。因为 CS 2 = 0 , I 是单位矩阵 , 所 以 X S 2 的系数 是 - CB B - 1 , X B 在 (2 -5 ) 式 中 的系数是 0 , 实质上是 CB - CB B - 1 B = 0 , 因此所 有检验数 可以用 C - CB B - 1 A 与 - CB B - 1 表示。(2 ) 用矩阵描述时 ,θ规则的表达式是·74·θ= mi ni( B - 1 b) i ( B - 1 P j ) i( B - 1 P j ) i > 0 =( B - 1 b) i ( B - 1 P j ) i这里的 ( B - 1 b) i 表示 ( B - 1 b) 中的第 i 个元素 , ( B - 1 P j ) i 表示向量 ( B - 1 P j ) 中的 第 i 个元素。这里的表达式的形式与第 1 章中有所不同 , 但其含义完全相同 , 这里不再重述。(3 ) 单纯形表与矩阵表示的关系 先将 (2 -4) 式 , ( 2 -5) 式改写成 :XB + B - 1 N1 X N 1 + B - 1 X S 2 = B - 1 b - z + ( CN 1 - CB B - 1 N1 ) X N 1 - CB B - 1 X S 2= - CB B - 1 b再将以上两式用矩阵关系式表示为z01B - 1 N1I 0 CN - CB B - 1 N1B - 1 - CB B - 1X BX N 1=B - 1 b - CB B - 1 bX S 2(2 -7 ) 式的分块矩阵也可用表 2 -1 表示 , 因 ( 0 , 1) T 这列不参 加运算 , 所以 在表中不 填这些数据。表 2 -1基变量 XBX N非基变量X S等式右边R H S系数矩阵B - 1 B = 1B - 1 N1B - 1B - 1 b检验数0CN 1 - CB B - 1 N1CB B - 1CB B - 1 b表 2 -1 即为 迭代后的 单纯形 计算表 , 各部 分的数字 都用 B - 1 来计算。此 外还可以 见到 , 在初始单位矩阵的位置经过迭代运算后 , 就是 B - 1 的位置。第 2 节 改进单纯形法当用单纯形表求解线性规划问题时 , 每行每列的数字都要计算 , 而有些行列的数字在 下一步计算时并不需要。改 进 单纯 形法 通过 矩阵 运 算求 解线 性规 划问 题 的关 键是 计 算 B - 1 。以下介绍一种比较简便的计算 B - 1 的方法。α11 α12 … α1 m设 : 系数矩阵 A =α21 α22 … α2 m⁝ ⁝⁝, 求其逆矩阵时 , 可以先从第 1 列开始。αm1 αm2 … αm mP1 =α11α21⁝αm1, 以 α11 为主元素 , 进行变换为 :ξ1 =1/ α11 - α21/ α11 ⁝ - αm1/ α11。然后构造含有该列而其他列都是单位列的矩阵·84·( 2 -6)( 2 -7)ŒFð÷E1 =1/ α1 1α21/ α11 ⁝αm1/ α110 … 01w1, 这时有 E1 P1 =10 ⁝0; E1 A =1 α( 1 ) 0 α( 1 ) ⁝ ⁝ 0 α( 1 )1 2 … α( 1 )1 m2 2 … α( 1 )2 m⁝m2 … α( 1 )m mα( 1 )1 2 / α( 1 )2 2再以第 2 列 的 α( 1 )22 为 主 元 素 , 进 行 变 换 为 : ξ2 =1/ α( 1 ) ⁝ m2 / α( 1 )22α( 1 )2 2, 然 后 构 造 E2 =10⁝α( 1 )1 2 / α( 1 ) 1/ α( 1 ) ⁝22 … 0 … 0 ⁝22, 这时 有 E2 E1 A =0 α( 2 ) 1 α( 2 ) ⁝ ⁝ ⁝13 … α( 2 )11 m23 … α( 2 )02 m⁝。 如此 一 步 步 地0α( 1 )m2 / α( 1 )22 … 100 α( 2 )m3 … α( 2 )m m1进行 , 直到获得 En … E2 E1 A =1w为 止。可见 En … E2 E1 = A - 1 。用该 方法 可1以求得单纯形表基矩阵 B 的逆矩阵 B - 1 。以下用例子说明具体计算过程。例 1 用改进单纯形法求解线性规划问题max z = 2 x1 + 3 x2 + 0 x3 + 0 x4 + 0 x5x1 + 2 x2 + x3 = 84 x1 +x4 = 164 x2 + x5 = 12 解 第 一步 : 利 用前 节 中矩 阵 描述 线 性 规划 问 题的 表 达式 , 给 出初 始 基 B0 = ( P3 ,100x3P4 , P5 ) =010。这是单位矩阵 , 其逆矩阵也是单位矩阵。初始基变量 XB0 =x4001x5对应的系数 CB0 = (0 , 0 , 0 ) ; 非基变量 X N0 =x1x2; 对应 的系数 CN0 = ( 2 , 3 ) 。计算 非基 变量的检验数。10012σN0 = CN0 - CB0 B - 10 N0 = ( 2 , 3) - (0 , 0 , 0 )01040= ( 2 , 3)由此可确定 x2 为换入变量 , 计算 θ= min0 ( B - 1 ( B - 100 b) i 0 P2 ) i104B - 10 P2 > 0 = mi n8 4, - ,12 4= 32对应的换出变量为 x5 , 由换入变量 x2 的系数向量 P2 =0, 确定 4 为主元素, 然后计算4·94·;- 1/ 210- 1/ 210010- 1/ 2ξ1 =0, 求逆矩阵 B- 1 = E1 B - 10 =010010=0101/ 4001/ 4001001/ 410计算非基变量 ( x1 , x5 ) 的系数矩阵 : 由 N1 =40; 变换为 :01101/ 21011/ 2B - 1 1 N1 =01040=40001/ 40101/ 4并且计算 :101/ 282B - 1 1 b =01016=160 于是得到新的基 B1 = ( P3 , P4 , P2 ) 。01/ 4123新基变量 X1 =x3x4x2, 非基变量 XN1 =x1x3; 相应的 CB1 = (0 , 0 , 3) , CN1 = ( 2, 0) 。第二步 : 计算非基变量的检验数 非基变量的检验数 :101/ 210σN1 = CN1 - CB1 B - 11 N1 = (2 , 0 ) - ( 0 , 0 , 3)01040001/ 401= ( 2 , - 3/ 4)确定对应的换入变量为 x1 , 计算 : ( B - 1 ( B - 11 b) i 1 P1 ) iθ= minB - 11 P1 > 1 = mi n2 1,16 4,3 0= 2对应的换出变量为 x3 , 由此 得到新 的基 B2 = ( P1 , P4 , P2 ) 。由 x1 的系 数 向量 P1 =114, 确定 以 1 为 主 元 素 , 计 算 ξ2 =4和 新 的 基 矩 阵 的 逆 矩 阵 B - 12= E2 B - 1100100101/ 2101/ 2410010=41200 并且计算 :0101/ 4001/ 4101/ 282B - 1 2 b =41216=8001/ 4123第三步 : 计算非基变量 ( x3 , x5 ) 的检验数 非基变量的检验数 :·05·=10- 1/ 210σN2 = CN2 - CB2 B - 12 N2 = ( 0 , 0) - (2 , 0 , 3 )41200001/ 401= ( - 2 , 1/ 4 )对应的换入变量为 x5 , 计算 ( B - 1 ( B - 13 b) i 3 P1 ) iθ= mi nB - 13 P1 > 0 = min,8 2,3 1/ 4= 4对应的换出变量为 x4 , 由此得到新的基 B3 = ( P1 , P5 , P2 ) 。1/ 2这时 换 入 变 量 x5 的 系 数 向 量 是 B - 12 P5 =2, 以 2 为 主 元 素 , 计 算 ξ3 =1/ 41/ 41/ 2。1/ 8B3 的逆矩阵11/ 40101/ 201/ 403 = E3 B - 1 B - 12 =01/ 20412=21/ 21再计算非基变量 X N0 3 = ( x3 , x4 ) 的检验数 :01/ 8101/ 41/ 21/ 8001/ 4010σN3 = CN3 - CB3 B - 13 N3 = (0 , 0 ) - ( 2 , 0 , 3)21/ 21011/ 21/ 8000= ( - 3/ 2 , - 1/ 8 )都是负值 , 得到了最优解为x101/ 4084X * =x5= B - 13 b =21/ 2116=4x21/ 21/ 801224目标函数的值 : z * = CB B - 13 b = ( 2 , 0 , 3)4= 142第 3 节 对偶问题的提出在第 1 章例 1 中讨论了工厂生产计划模型及其解法 , 现从另一角度来讨论这个问题。 假设该工厂的决策者决定不生产产品Ⅰ、Ⅱ , 而将其所有资源出租或外售。这时工厂的决 策者就要考虑给每种资源如何定价的 问题。 设用 y1 , y2 , y3 分 别表示 出租 单位设 备台 时 的租金和出让单位原材料 A , B 的附加 额。他 在做定 价决 策时 , 做如 下比 较 : 若用 1 个 单 位设备台时和 4 个单位原材料 A 可 以生 产一件 产品 Ⅰ , 可获 利 2 元 , 那么 生 产每 件产 品 Ⅰ的设备台时和原材料出租或出让的所有收入应不低于生产一件产品Ⅰ的利润 , 这就有 ·15·y1 + 4 y2 ≥2同理将生产每件产品Ⅱ的设备台时和原材料出租或出让的所有收入应不低于生产一件产品Ⅱ的利润 , 这就有2 y1 + 4 y3 ≥3把工厂所有设备台时和资源都出租或出让 , 其收入为ω= 8 y1 + 16 y2 + 12 y3从工厂的 决策 者来 看当然 ω愈大愈 好 , 但从 接受 者来看 他的 支付愈 少愈 好 , 所以 工 厂的决策者只能在满足大于等于所有产品的利 润条件 下 , 提出 一个尽 可能 低的出 租或 出 让价格 , 才能实现其原意 , 为此需解如下的线性规划问题min ω= 8 y1 + 16 y2 + 12 y3 ≥2 + 4 y3 ≥3y1 + 4 y22 y1yi ≥0 ,i = 1 , 2 , 3称这个线性规划问题为例 1 线性规划问题 ( 这里称原问题 ) 的对偶问题。下面再从另一角度来讨论。从第 1 节得到检验数的表达式是CN - CB B - 1 N 与 - CB B - 1在第 1 章已提到 , 当检验数CN - CB B - 1 N≤0CB B - 1 ≤0 (2 -10) 这表示线性规划问题已得到最优解。可见 (2 -9) 式 , ( 2 -10 ) 式是作为得到最优解的条件。 现在讨论这两个条件。CB B - 1 ≤0 (2 -10) 这表示线性规划问题已得到最优解。可见 (2 -9) 式 , ( 2 -10 ) 式是作为得到最优解的条件。 现在讨论这两个条件。(1 ) ( 2 -9 ) 式 , (2 -10) 式中都有 乘子 CB B - 1 , 称它为 单纯 形 乘子 , 并 用符 号 Y = CB B - 1表示。由 (2 -10 ) 式 , 可得到Y≥ 0(2 ) 对应基变量 X B 的检验数是 0。它是 CB - CB B - 1 B = 0。包 括基变量 在内的所 有检验数可用 C - CB B - 1 A≤ 0 表示。从此可得C - CB B - 1 A = C - Y A ≤0移项后 , 得到Y A ≥ C(3 ) Y 由 ( 2 -10 ) 式 , 得到Y = - CB B - 1将 (2 -11 ) 式两边右乘 b, 得到Y b = - CB B - 1 b Yb = CB B - 1 b = z因 Y 的上界为无限大 , 所以只存在最小值。 (4 ) 从这里可以得到另一个线性规划问题min ω= Yb·25·( 2 -8)(2 -11)(2 -12)Y A≥ C Y≥ 0称它为原线性规划问题{max z = CX | A X≤ b, X≥0}的对偶规划问题。从这两个规划问题的表达式可看出 : 根据原线性规划问题的系 数矩阵 A, C, b 就可 以写出它的对偶问题。如第 1 章的例 1 , 原线性规划问题的各系数矩阵是1 28A =4 0; C = ( 2 , 3) ; b =160 412那么它的对偶问题便是min ω= Y (8 , 16 , 12 ) T12Y40≥ ( 2 , 3)0 Y ≥04Y = ( y1 , y2 , y3 )即min ω= 8 y1 + 16 y2 + 12 y3≥2 + 4 y3 ≥3y1 + 4 y22 y1 y1 , y2 , y3 ≥0第 4 节 线性规划的对偶理论以上讨论可直观地了解到原线性规划问题与 对偶 问题 之间的 关系 ; 本 节将从 理论 上进一步讨论线性规划的对偶问题。4. 1 原问题与对偶问题的关系对于“≤”不等式约束条件的原问题与“≥”不等式约束条件的对偶问题的展开形式是原问题max z = c1 x1 + c2 x2 + … + cn x na12 … a1 n ⁝a11⁝ ⁝am1am2 … am mx1x2⁝xn≤b1⁝bmx1 , x2 , … , xn ≥ 0对偶问题min ω= y1 b1 + y2 b2 + … + ym b m·35·( y1 , y2 , … , ym )a12 … a1 n ⁝a11⁝ ⁝≥ ( c1 , c2 , … , cn )am1am2 … am ny1 , y2 , … , ym ≥0以上是原问题与对偶问题的标准形式 , 它们之间的关系可以用表 2 -2 表示。表 2 -2yjxjx1x2… xn原关系min ωy1a11a12 … a1 n≤b1y2a21a22 … a2 n≤b2⁝⁝ ⁝⁝⁝⁝ymam1am2 … am n≤bm对偶关系≥ ≥ … ≥max z = min ωmax zc1c2…cn表 2 -2 是将原问题与对偶 问题 的关 系汇 总 于一 个表 中 , 从 正 面看 是 原问 题 , 将 它 转 90°后看 是 对 偶 问 题。若 将 第 1 章 的 原 线 性 规 划 的 系 数 列 成 如 表 2 -2 的 形 式 , 这 就 是 表 2 -3。例 2 根据表 2 -3 写出原问题与对偶问题的表达式。表 2 -3yjxjx1x2by1128y24016y30412c23解 原问题max z = 2 x1 + 3 x2 x1 + 2 x2 ≤8 ≤ 16 4 x2 ≤ 124 x1x1 , x2 ≥ 0min ω= 8 y1 + 16 y2 + 12 y3≥2 + 4 y3 ≥3y1 + 4 y22 y1 y1 , y2 , y3 ≥0将上述原问题与对偶问题之间的变换关系称为对称形式。一般线性规划问题中遇到非对称形式时 , 处理如下。原问题的约束条件中含有等式约束条件时 , 按以下步骤处理。 设等式约束条件的线性规划问题·45·½(cid:27)©"(cid:7)x©"(cid:7)x©"(cid:7)x©(cid:7)nmax z = ∑cj x jj = 1n∑ai j x j = bi ,i = 1 , 2 , … , mj = 1xj ≥0 ,j = 1 , 2 , … , n第一步 : 先将等式约束条件分解为两个 不等 式约束 条件。 这时上 述线 性规划 问题 可表示为nmax z = ∑cj x jj = 1n∑ai j x j ≤ bi ,i = 1 , 2 , … , m(2 -13)j = 1n∑ j = 1ai j x j ≤ - bi ,i = 1 , 2 , … , m(2 -14)x j ≥0 ,j = 1 , 2 , … , m设 y′i 是对应 (2 -13) 式的对偶变量y″i 是对应 (2 -14) 式的对偶变量。这里 i = 1 , 2 , … , m。 第二步 : 按对称形式变换关系可写出它的对偶问题mmmin ω= ∑bi y′i + ∑( - bi y″i )i = 1i = 1mm∑ai j y′i + ∑( - ai j y″i ) ≥ cj ,j = 1 , 2 , … , ni = 1i = 1y′i , y″i ≥ 0 ,i = 1 , 2 , … , m将上述规划问题的各式整理后得到mmin ω= ∑bi ( y′i - y″i )i = 1m∑ai j ( y′i - y″i ) ≥ cj ,j = 1 , 2 , … , ni = 1令 yi = y′i - y″i , y′i , y″i ≥ 0。由此可见 , yi 不受正、负限制。将 y i 代入上述规划问题 , 便得 到 对偶问题mmin ω= ∑bi y ii = 1m∑ai j y i ≥ cj ,j = 1 , 2 , … , ni = 1yi 为无约束 ,i = 1 , 2 , … , m综合上述 , 线性规划的原问题与对偶问题的关系 , 其变换形式归纳为表 2 -4 中所示的对应关系。·55·表 2 -4原问题( 或对偶问题)对偶问题( 或原问题)目标函数 max z目标函数 min ωn 个n 个约变≥0≥束量≤0≤条无约束=件约m 个m 个束≤≥0变条≥≤0量件=无约束约束条件右端项目标函数变量的系数目标函数变量的系数约束条件右端项例 3 试求下述线性规划原问题的对偶问题min z = 2 x1 + 3 x2 - 5 x3 + x4x1 + x2 - 3 x3 + x4 ≥5 + 2 x3 - x4 ≤42 x1x2 + x3 + x4 = 6x1 ≤0 ; x2 , x3 ≥ 0 ; x4 无约束解 设对应于约束 条件① , ② , ③ 的对偶变 量分别为 y1 , y2 , y3 ; 则由 表 2 -4中 原问 题和对偶问题的对应关系 , 可以直接写出上述问题的对偶问题 , 即max z′= 5 y1 + 4 y2 + 6 y3y1 + 2 y2≥2y1+ y3 ≤33 y1 + 2 y2 + y3 ≤ - 5y1 -y2 + y3 = 1y1 ≥0 , y2 ≤0 , y3 无约束4. 2 对偶问题的基本性质(1 ) 对称性 对偶问题的对偶是原问题。 证 设原问题是m ax z = C X ; A X≤ b; X≥0根据对偶问题的对称变换关系 , 可以找到它的对偶问题是min ω= Yb ; Y A≥ C; Y≥ 0若将上式两边取负号 , 又因 min ω= max ( - ω) 可得到max( - ω) = - Y b; 根据对称变换关系 , 得到上式的对偶问题是 ·65·Y A ≤ - C; Y≥0①②③min( - ω′) = - CX ;- A X≥ - b; X≥0又因min( - ω′) = m ax ω′可得m ax ω′= max z = C X ; A X≤ b; X≥0这就是原问题。证毕。( 2) 弱对偶性 若 X 是原问题的可行解 , Y 是对偶问题的可行解。则存在 C X ≤Y b。 证 设原问题是m ax z = C X ; A X≤ b; X≥0因 X 是原问题的可行解 , 所以满足约束条件 , 即 A X ≤ b若 Y 是给定的一组值 , 设它是对偶问题的可行解 , 将 Y 左乘上式 , 得到Y A X ≤ Yb原问题的对偶问题是min ω= Yb ; Y A≥ C; Y≥ 0因为 Y 是对偶问题的可行解 , 所以满足Y A ≥ C将 X 右乘上式 , 得到Y A X ≥ C X于是得到C X ≤ Y A X ≤ Yb (3 ) 无界性 若原问题 ( 对偶问题 ) 为无界解 , 则其对偶问题 ( 原问题 ) 无可行解。 证 由弱对偶性显然得。 注意这个问题的性质不存在逆。当原问题 ( 对偶问题 ) 无可行解时 , 其对偶问题 ( 原问证毕。题 ) 或具有无界解或无可行解。例如下述一对问题两者皆无可行解。原问题 ( 对偶问题 ) min ω= - x1 - x2 x1 - x2 ≥ 1 - x1 + x2 ≥ 1 x1 , x2 ≥0对偶问题 ( 原问题 )max z = y1 + y2y1 - y2 ≤ - 1 - y1 + y2 ≤ - 1 y1 , y2 ≥0证毕。( 4) 可行解是最优解时的性质 设 X^ 是原问题的可行解 , Y^ 是对偶问题的可行解 , 当C X^ = Y^b 时 , X^ , Y^ 是最优解。证 若 C X^ = Y^ b, 根据 性质 2 可知 : 对 偶问 题 的所 有可 行解 Y 都 存在 Yb≥ C X^ , 因 C X^ = Y^ b , 所以 Yb≥ Y^ b。可见 Y^ 是使目 标函数 取值 最小 的可行 解 , 因而 是最优 解。同 样 可证明 : 对于原问题的所有可行解 X , 存在C X^ = Y^ b≥ C X所以 X^ 是最优解。证毕。·75·(5 ) 对偶定理 若原问题有最优解 , 那么对偶问题也有最优解 ; 且目标函数值相等。 证 设 X^ 是原问题的最 优解 , 它对 应 的基 矩 阵 B 必 存 在 C - CB B - 1 A ≤ 0。即 得 到Y^ A ≥ C, 其中 Y^ = CB B - 1 。若这时 Y^ 是对偶问题的可行解 , 它使ω= Y^ b = CB B - 1 b因原问题的最优解是 X^ , 使目标函数取值z = C Y^ = CB B - 1 b由此 , 得到Y^ b = CB B - 1 b = C X^可见 Y^ 是对偶问题的最优解。证毕。 (6 ) 互补 松 弛 性 若 X^ , Y^ 分 别 是 原 问 题和 对 偶 问 题 的可 行 解。 那么 Y^ X S = 0 和Y S X^ = 0 , 当且仅当 X^ , Y^ 为最优解。证 设原问题和对偶问题的标准型是原问题对偶问题m ax z = C Xmin ω= YbA X + X S = b X , XS ≥0Y A - Y S = C Y , Y S ≥0将原问题目标函数中的系数向量 C 用 C = Y A - Y S 代替后 , 得到z = ( Y A - Y S ) X = Y A X - Y S X将对偶问题的目标函数中系数列向量 , 用 b = A X + X S 代替后 , 得到ω= Y ( A X + X S ) = Y A X + Y X S若 Y S X^ = 0 , Y^ X S = 0 ; 则 Y^ b = Y^ A X^ = C X^ , 由性质 3 可知 X^ , Y^ 是最优解。 又若 X^ , Y^ 分别是原问题和对偶问题的最优解 , 根据性质 3 , 则有C X^ = Y^ A X^ = Y^ b 由 (2 -15 ) 式 , (2 -16) 式可知 , 必有 Y^ X S = 0 , Y S X^ = 0。(7 ) 设原问题是max z = C X ; A X + X S = b; X , X S ≥0它的对偶问题是min ω= Yb ; Y A - Y S = C; Y , Y S ≥ 0则原问题单纯形表的检验数行对应其对偶问题的一个基解 , 其对应关系见表 2 -5 。表 2 -5X BX NXS0CN - CB B - 1 NCB B - 1Y S1Y S2Y·85·(2 -15)(2 -16)证毕。ð这里 Y S1 是对应原问题中基变量 XB 的 剩余 变量 , Y S2 是 对应 原问 题 中非 基变 量 X N 的 剩 余变量。证 设 B 是原问题的一个可行基 , 于是 A = ( B, N) ; 原问题可以改写为max z = CB X B + CN X NB XB + N X N + X S = b XB , X , X S ≥0相应地对偶问题可表示为min ω= YbY B - Y S1 = CB(2 -17)Y N - Y S1 = CN Y , Y S1 , Y S2 ≥0(2 -18)这里 Y S = ( Y S1 , Y S2 ) 。 当求得原问题的一个解XB = B - 1 b 其相应的检验数为 CN - CB B - 1 N 与 - CB B - 1 。 现分 析 这些 检验 数与 对偶 问 题的 解之 间 的关系 : 令 Y = CB B - 1 , 将它代入 (2 -17) 式 , ( 2 -18) 式得Y S1 - Y S2 = CN - CB B - 1 N= 0证毕。例 4 已知线性规划问题m ax z = x1 + x2x1 + x2 + x3 ≤ 22 x1 + x2 - x3 ≤ 1 x1 , x2 , x3 ≥0试用对偶理论证明上述线性规划问题无最优解。证 首先看到该问题存在可行解 , 例如 X = ( 0 , 0 , 0) ; 而上述问题的对偶问题为 min ω= 2 y1 + y2y1 - 2 y2 ≥1 y1 + y2 ≥1 y2 ≥0 y2 ≥0y1 - 2 y2 ≥1 y1 + y2 ≥1 y2 ≥0 y2 ≥0由第一约束条件可知对偶问题无可行解 , 因原问题有可行解 , 故无最优解。证毕。例 5 已知线性规划问题min ω= 2 x1 + 3 x2 + 5 x3 + 2 x4 + 3 x5 x1 + x2 + 2 x3 + x4 + 3 x5 ≥4 2 x1 - x2 + 3 x3 + x4 + x5 ≥3已知其对 偶问 题 的最 优解 为 y * 优解。xj ≥0 , 1 = 4/ 5 , y *j = 1 , 2 , … , 52 = 3/ 5 ; z = 5。 试用 对偶 理论 找 出原 问题 的 最·95·解 先写出它的对偶问题m ax z = 4 y1 + 3 y2y1 + 2 y2 ≤ 2 y2 ≤ 3y1 -①②2 y1 + 3 y2 ≤ 5 y1 + y2 ≤ 2 3 y1 + y2 ≤ 3 ≥ 0y1 , y2③④⑤将 y * x * 4 = 0。因 y1 , y2 ≥0 ; 原问题的两个约束条件应取等式 , 故有, y *2 的值代入约束条件 , 得② , ③ , ④ 式为严 格不 等式 ; 由 互补 松弛 性得 x *12 = x *3 =求解后得到 x *1 = 1 , x *1 + 3 x * 1 + x * 5 = 1 ; 故原问题的最优解为x * 2 x *5 = 45 = 3X * = (1 , 0 , 0 , 0 , 1 ) T ;ω* = 5第 5 节 对偶问题的经济解释———影子价格前面讲到 , 在 单 纯 形 法 的 每 步 迭 代 中 , 目 标 函 数 取 值 z = CB B - 1 b, 和 检 验 数 CN -CB B - 1 N 中都有乘子 Y = CB B - 1 , 那么 Y 的经济意义是什么 ?设 B 是{max z = C X | A X≤ b, X≥0}的最优基 , 由 (2 -12) 式可知z* = CB B - 1 b = Y * b由此z * b= CB B - 1 = Y *所以变量 y * 的最优值的变化。i 的经济意义是在其 他条件 不变 的情况 下 , 单位 资源 变化 所引 起 的目 标函 数由第 1 章 例 1 的 最 终 计 算 表 ( 见 1 = 1. 5 , y *表 1 -5 ) 可 见 , y * 2 = 0. 125 , y * 3 = 0。这说明是其 他条 件 不变 的情 况 下 , 若设备 增 加 一台 时 , 该厂 按 最 优 计 划安排生产可多获利 1. 5 元 ; 原材 料 A 增加 1kg , 可 多 获 利 0. 125 元 ; 原 材 料 B 增 加 1kg , 对获 利 无影 响。 从图 2 -1 可看到 , 设 备 增 加一 台 时 , 代 表 该 约 束 条件的直 线 由 ① 移 至 ①′, 相 应 的 最 优 解由 ( 4 , 2 ) 变 为 ( 4 , 2 .5 ) , 目标函 数 z = 2× 4 + 3× 2. 5 = 15. 5 , 即比 原来的增 大 1. 5。又若原材料 A 增加 1kg 时 , 代 表该 约束 方程 的直 线 由② 移 至②′, 相 应 的最 优解 从图 2 -1·06·(4 , 2 ) 变 为 ( 4. 25 , 1. 875 ) , 目 标 函 数 z = 2 × 4. 25 + 3 × 1. 875 = 14. 125。 比 原 来 的 增 加 0. 125。原材料 B 增加 1kg 时 , 该约束方程的直线由③移至③′, 这时的最优解不变。i 的值代表对第 i 种资源的估价。这种估价是针对具体工厂的具体产品而存在的一 种特殊价格 , 称它为“ 影子价格”。在该厂现有资源和现有生产方案的条件下 , 设备的每小 时租费为 1. 5 元 , 1 kg 原材料 A 的出让费为除成本外再附加 0. 125 元 , 1kg 原材料 B 可按 原成本出让 , 这时该厂的收入与自己组织生产时获利相等。影子价格随具体情况而异 , 在 完全市场经济的条件下 , 当某种资源的市场价低于影子价格时 , 企业应买进该资源用于扩 大生产 ; 而当某种资源的 市场 价 高于 企业 影子 价格 时 , 则 企业 的决 策者 应 把已 有资 源 卖 掉。可见影子价格对市场有调节作用。y *第 6 节 对偶单纯形法前节讲到原问题与对偶问题的解之间的对应关系时指出 : 在单纯形表中进行迭代时 , 在 b 列中得到的是原问题的基可行解 , 而在 检验数 行得 到的 是对偶 问题 的基解。 通过 逐 步迭代 , 当在检验数行得到对偶问题的解也是基可行解时 , 根据性质 (2 ) 、(3 ) 可知 , 已得到 最优解。即原问题与对偶问题都是最优解。根据对偶问题的对称性 , 也可以这样考虑 : 若 保持对 偶问 题的解 是基 可行 解 , 即 cj - CB B - 1 P j ≤0 , 而原问题在非可行解的基础上 , 通过逐步迭代达到基可行 解 , 这 样也得到 了 最优解。其优点是原问题的初始解不一定是基可行解 , 可从非基可行解开始迭代 , 方法如 下。设原问题max z = C XA X = b X≥0又设 B 是一个基。不失一般性 , 令 B = ( P1 , P2 , … , Pm ) , 它对应的变量为X B = ( x1 , x2 , … , xm ) 当非基 变 量 都 为 零 时 , 可 以 得 到 X B = B - 1 b。 若 在 B - 1 b 中 至 少 有 一 个 负 分 量 , 设 ( B - 1 b) i < 0 , 并且在单纯形表的检验数行 中的 检验数 都为 非正 , 即对 偶问 题保 持可 行解 , 它的各分量是(1 ) 对应基变量 x1 , x2 , … , xm 的检验数是σi = ci - zi = ci - CB B - 1 P j = 0 ,i = 1 , 2 , … , m(2 ) 对应非基变量 xm + 1 , … , xn 的检验数是σj = cj - zj = cj - CB B - 1 Pj ≤0 ,j = m + 1 , … , n每次迭代是将基变量中的负分量 x l 取出 , 去替换非基变量中的 xk , 经基变换 , 所有检 验数仍保持非正。从原问题来看 , 经过每次迭代 , 原问题由非可行解往可行解靠近。当原 问题得到可行解时 , 便得到了最优解。 对偶单纯形法的计算步骤如下 : (1 ) 根据线性规划问题 , 列出初 始单纯 形表。 检查 b 列 的数 字 , 若 都为 非负 , 检验 数 都为非正 , 则已得到最优解。停止计算。 若检查 b 列的数 字时 , 至 少还 有一个 负分 量 , 检·16·验数保持非正 , 那么进行以下计算。(2 ) 确定换出变量 按 min{( B - 1 b) i | ( B - 1 b) i < 0} = ( B - 1 b) l 对应的基变量 x i 为换出变量。 (3 ) 确定换入变量 在单纯形表中检查 xl 所在行的各系数αl j ( j = 1 , 2 , … , n) 。若所 有 αlj ≥ 0 , 则 无可 行解 , 停止计算。若存在 αlj < 0( j = 1 , 2 , … , n) , 计算θ= minjcj - zj αl jαl j < 0 =ck - z k αl k按 θ规则所对应的列的非基变量 x k 为换入变量 , 这样才能保持得到的对偶问 题解仍为 可 行解。(4 ) 以 αl k 为主元素 , 按原单纯形法在表中进行迭代运算 , 得到新的计算表。 重复步骤 (1 ) ～ ( 4) 。 下面举例来说明具体算法。例 6 用对偶单纯形法求解min ω= 2 x1 + 3 x2 + 4 x3x1 + 2 x2 + x3 ≥ 3 x2 + 3 x3 ≥ 42 x1 -x1 , x2 , x3 ≥0解 先将此问题化成下列形式 , 以便得到对偶问题的初始可行基max z = - 2 x1 - 3 x2 - 4 x3x1 - 2 x2 -x3 + x4= - 32 x1 + x2 - 3 x3 + x5 = - 4 j = 1 , 2 , … , 5 xj ≥0 ,建立此问题的初始单纯形表 , 见表 2 -6 。表 2 -6cj →2340CBX Bbx1x2x3x40x4312110x54[ - 2 ]130cj - zj2340从表 2 -6 看到 , 检验数行对应的对偶问题的解是可行解。因 b 列数字为负 , 故需进 行迭代运算。换出变量的确定 : 按上述对偶单纯形法计算步骤 ( 2) , 计算min( - 3 , - 4) = - 4故 x5 为换出变量。换入变量的确定 : 按上述对偶单纯形法计算步骤 ( 3) , 计算θ= min2 - 2, - ,4 - 3=2 - 2= 1·26·0x5010ÀÀ¿–(cid:144)¥¥ª¦¦Á¥¥“¦¦ª§Á¥¥“¦ª§§故 x1 为换入变量。换入、换出变量的所在列、行的交叉处“ - 2”为主元素。按单纯形法 计 算步骤进行迭代 , 得表 2 -7 。由表 2 -7 看出 , 对偶问题仍是可行 解 , 而 b 列中 仍有 负分量。 故重 复上 述迭代 步骤 ,得表 2 -8。表 2 -7cj →23400CBX Bbx1x2x3x4x50x410[ - 5/ 2]1/ 211/ 22x1211/ 23/ 201/ 2cj - zj04101表 2 -8cj →23400CBX Bbx1x2x3x4x53x22/ 5011/ 52/ 51/ 52x111/ 5107/ 51/ 52/ 5cj - zj003/ 58/ 51/ 5表 2 -8 中 , b 列数字全为非负 , 检验数全为非正 , 故问题的最优解为X * = (11/ 5 , 2/ 5 , 0 , 0 , 0) T若对应两个约束条件的对偶变量分别为 y1 和 y2 , 则对偶问题的最优解为 , y *Y * = ( y *2 ) = ( 8/ 5 , 1/ 5) 从以上求解过程可以看到对偶单纯形法有以下优点 : (1 ) 初始解可以是非可行 解 , 当 检验 数都 为负数 时 , 就可 以进行 基的 变换 , 这 时不 需1要加入人工变量 , 因此可以简化计算。(2 ) 当变量多于约束条件 , 对这样的线性规划问题 , 用对偶单纯 形法计算 可以减少 计 算工作量 , 因此对变量较少 , 而约束条件很多的线性规划问题 , 可先将它变换成对偶问题 , 然后用对偶单纯形法求解。(3 ) 在灵敏度分析及求解整数规划的割平面法中 , 有时需要用对偶 单纯形法 , 这样 可 使问题的处理简化。对偶单纯形法的局限性主要是 , 对大多数线性规划问题 , 很难找到一 个初始可行基 , 因而这种方法在求解线性规划问题时很少单独应用。第 7 节 灵敏度分析在以前讨论线性规划问题时 , 假定 αi j , bi , cj 都是常 数。但 实际上 这些 系数往 往是 估计值和预测值。如市场条件一变 , cj 值 就会 变化 ;αi j 往往是 因工 艺条 件的改 变 而改 变 ; bi 是根据资源投入后的经济效果决定的一种决 策选择。 因此 提出这 样两 个问题 : 当 这些 系 数有一个或几个发生变化时 , 已求得的线性规划问题的最优解会有什么变化 ; 或者这些系 数在什么范围内变化时 , 线性规划问题的最 优解 或最优 基不 变。后一 个问 题将在 第 8 节·36·ÀÀ(cid:144)¿–¥¥¦ª¦Áò“¿’(cid:144)§ÁÂ¿(cid:144)’òî§(cid:144)¿óî’ÀÀ¿–(cid:144)¥¥¦¦ªÂ×ò‘íí’§Â×òí‘í’§òí’‘í参数线性规划中讨论。显然 , 当线性规划问题中某一个或几个系数发生变化后 , 原来已得结果一般会发生变 化。当然可以用单纯形法从头计算 , 以便得到新的最优解。这样做很麻烦 , 而且也没有必 要。因在单纯形法迭代时 , 每次运 算都和 基变 量 的系 数矩 阵 B 有 关 , 因此 可 以把 发生 变 化的个别系数 , 经过一定计算 后直接 填入 最终计 算表 中 , 并进 行检 查 和分 析 , 可按 表 2 -9 中的几种情况进行处理。表 2 -9原问题对偶问题结论或继续计算的步骤可行解可行解表中的解仍为最优解可行解非可行解用单纯形法继续迭代求最优解非可行解可行解用对偶单纯形法继续迭代求最优解非可行解非可行解引进人工变量 , 编制新的单纯形表 , 求最优解下面就各种情况进行讨论。7. 1 资源数量变化的分析资源数量变化是指系数 br 发生变化 , 即 b′r = br + Δbr 。并假设规划问题的其他系数都不变。这样使最终表中原问题的解相应地变化为X′B = B - 1 ( b + Δb) 这里 Δb = (0 , … ,Δbr , 0 , … , 0 ) T 。只要 X′B ≥0 , 因最终表中检验数不变 , 故最优基 不变 , 但 最优解的值发生了变化 , 所以 X′B 为新的最优解。新的最优解的值可允许变化 范围用以 下 方法确定。B - 1 ( b + Δb) = B - 1 b + B - 1Δb 0 ⁝ Δbr= B - 1 b + B - 1⁝0B - 10 ⁝ Δbr ⁝0=α-1 rΔbr ⁝ i rΔbr α-⁝ m r Δbr α-= Δbrα-1 r⁝α- i r⁝α- m r要求在最终表中求得的 b 列的所有元素 bi + α-i r Δbr ≥0 , i = 1 , 2 , … , m。由此可得α-i rΔbr ≥ - bi ,i = 1 , 2 , … , m当 α-i r > 0 时 ,Δbr ≥ - bi/ α-i r ;α-i r < 0 时 ,Δbr ≤ - bi/ α-i r ; 于是得到max{ - bi/ α-i r |α-i r > 0}≤Δbr ≤ min{ - bi/ α-i r | α-i r < 0}例如求第 1 章例 1 中第二个约束条件 b2 的变化范围 Δb2 时 , 可计算·46·B - 1 b + B - 10 Δb2=44+0. 250. 5Δb2 ≥00020. 1250可得 Δb2 ≥ - 4/ 0. 25 = - 16 ,Δb2 ≥ - 4/ 0. 5 = - 8 ,Δb2 ≤ 2/ 0. 125 = 16。 所以 Δb2 的变 化 范围是 [ - 8 , 16] ; 显然 b2 的变化范围是 [8 , 32] 。例 7 从表 1 -5 得知第 1 章例 1 中 , 每设备台时的影子价 格为 1. 5 元 , 若 该厂又从 其他处抽调 4 台时用于生产产品Ⅰ , Ⅱ。求这时该厂生产产品Ⅰ , Ⅱ的最优方案。解 先计算 B - 1Δb00. 25040B - 1Δb =20. 510=80 将上述结果反映到最终表 1 -5 中 , 得表 2 -10。0. 50. 12502表 2 -10cj →23000CBX Bbx1x2x3x4x52x14 + 01000. 2500x54 - 800[ - 2 ]0. 513x22 + 2010. 50. 1250cj - zj001. 50. 1250由于表 2 -10 中 b 列有负数,故用对偶单纯形法求新的最优解。计算结果见表 2 -11。表 2 -11cj →23000CBX Bbx1x2x3x4x52x141000. 2500x320010. 250. 53x2301000. 25cj - zj0000. 50. 75即该厂最优生产方案应改为生产 4 件产品Ⅰ , 生产 3 件产品Ⅱ , 获利z* = 4×2 + 3×3 = 17 ( 元 )从表 2 -11 看出 x3 = 2 , 即设备有 2 小时未被利用。7. 2 目标函数中价值系数 cj 的变化分析可以分别就 cj 是对应的非基变量和基变量两种情况来讨论。(1 ) 若 cj 是非基变量 x j 的系数 , 这时它在计算表中所对应的检验数是σj = cj - CB B - 1 Pj或·56·–(cid:144)‘’‘¥¥ª¦¦K@Ø–“‘’‘§K@Ø–“’‘§K@cXØ“‘–’§WL‘†–’‘(cid:144)–‘’‘¥¥¦¦ª(cid:157)’–“’‘‘’§¡–(cid:157)’“‘’‘’§¡–“‘‘’’’§¤™‘†‘’‘mσj = cj - ∑αi j y ii = 1当 cj 变化 Δcj 后 , 要保证最终表中这个检验数仍小于或等于零 , 即σ′j = cj + Δcj - CB B - 1 Pj ≤0 那么 cj + Δcj ≤ Y P j , 即 Δcj 的值必须小于或等于 Y P j - cj , 才可以 满足原最 优解条件。 这 就可以确定 Δcj 的范围了。(2 ) 若 cr 是基变量 x r 的系数。因 cr ∈ CB , 当 cr 变化 Δcr 时 , 就引起 CB 的变化 , 这时( CB + ΔCB ) B - 1 A = CB B - 1 A + ( 0 , … ,ΔCr , … , 0 ) B - 1 A= CB B - 1 A + ΔCr (αr1 ,αr2 , … ,αr n )可见 , 当 cr 变化 Δcr 后 , 最终表中的检验数是σ′j = cj - CB B - 1 A - Δcrα-r j ,j = 1 , 2 , … , n若要求原最优解不变 , 即必须满足 σ′j ≤0。于是得到当α-r j < 0 ,Δcr ≤σj/ α-r j ;α-r j > 0 ,Δcr ≥σj/ αr jj = 1 , 2 , … , nΔcr 可变化的范围是max j{σj/ α-r j | α-r j > 0}≤Δcr ≤ min{σj/ α-r j|α-r j < 0}例 8 试以第 1 章例 1 的最终表表 1 -5 为例。设基变 量 x2 的 系数 c2 变化 Δc2 , 在 原最优解不变条件下 , 确定 Δc2 的变化范围。解 这时表 1 -5 最终计算表便成为表 2 -12 所示。表 2 -12cj23 + Δc200CBX Bbx1x2x3x42x14100. 25 00x54002. 5 03 + Δc2x22010. 50. 125cj - zj001. 5Δc2/ 2Δc2 / 81/ 8从表 2 -12 可见有1. 5 - Δc2/ 2≤ 0 和 Δc2/ 8 - 1/ 8≤0由此可得 Δc2 ≥ - 1. 5/ 0. 5 ;Δc2 ≤1。Δc2 的变化范围为3≤Δc2 ≤ 1即 x2 的价值系数 c2 可以在 [0 , 4 ] 之间变化 , 而不影响原最优解。7. 3 技术系数 αi j 的变化分两种情况来讨论技术系数 αi j 的变化 , 下面以具体例子来说明。例 9 分析在原计划中是否应该安排一种新产品。以第 1 章例 1 为例。 设该厂除 了·66·0x50100–(cid:144)‘’(cid:2)¥¥¦ª¦bW“¿’ª’‘§bW¿“ª’‘’§cXcX‘ª’’(cid:4)§cX生产产品Ⅰ , Ⅱ外 , 现有一种 新产 品 Ⅲ。已知 生 产产 品 Ⅲ , 每 件 需消 耗 原材 料 A , B 各 为 6kg , 3kg , 使用设备 2 台时 ; 每件可获利 5 元。问该厂是否应生产该产品和生产多少 ?解 分析该问题的步骤是 : (1 ) 设生产产品Ⅲ为 x′3 台 , 其技术系数 向量 P′3 = (2 , 6 , 3 ) T , 然后 计算 最终表 中对 应x′3 的检验数σ′3 = c′3 - CB B - 1 P′3 = 5 - (1. 5 , 0. 125 , 0 ) ( 2 , 6 , 3) T = 1. 25 > 0说明安排生产产品Ⅲ是有利的。(2 ) 计算产品Ⅲ在最终表中对应 x′3 的列向量00. 25021. 5B - 1 P′3 =20. 516=20. 50. 125030. 25并将 (1 ) , (2 ) 中的计算结果填入最终计算表 1 -5 , 得表 2 -13( a ) 。表 2 -13(a)cj230005CBX Bbx1x2x3x4x5x′32x141000. 250. 5 10x540020. 51[ 2]3x22010. 50. 12500. 25cj - zj001. 50. 12501. 25由于 b 列的数字没有变化 , 原问题的解是可行解。但检验数行中还有正检验数 , 说明目 标 函数值还可以改善。(3 ) 将 x′3 作 为 换 入 变 量 , x5 作 为 换 出 变 量 , 进 行 迭 代 , 求 出 最 优 解。 计 算 结 果 见 表 2 -13 ( b) , 这时得最优解 : x1 = 1 , x2 = 1. 5 , x′3 = 2 。总的利润 为 16. 5 元。比 原计划增 加 了 2. 5 元。表 2 -13( b)cj230005CBX Bbx1x2x3x4x5x′32x11101. 50. 1250. 7500x′320010. 25. 5 013x21. 5010. 750. 18750. 1250cj - zj000. 250. 43750. 6250例 10 分析原计划生产产品的工艺结构发生变化。仍以 第 1 章例 1 为例 , 若原计 划 生产产品Ⅰ的工艺结构有了改进 , 这时 有关它 的技 术系数 向量 变为 P′1 = (2 , 5 , 2 ) T , 每 件 利润为 4 元 , 试分析对原最优计划有什么影响 ?解 把改 进工 艺结构 的产 品Ⅰ 看作 产品 Ⅰ′, 设 x′1 为 其产 量。于是 计算 在最 终表 中对应 x′1 的列向量 , 并以 x′1 代替 x1 。·76·ÀÜ3bï‘HwÕé¦(cid:4)¢—ÀÀ3ï4)|(cid:30)bÀÀ34)|ï(cid:30)b—ŒÀcX5*ï3|(cid:30)b—ŒcXÀ5*3ïÜÀ3bï‘HwÕð¦(cid:4)ÀcXÜ5*ï|(cid:30)(cid:18)(cid:29)bÀÜX5*|ï(cid:30)(cid:18)(cid:29)bÜcXÀ5*ïðå|(cid:18)(cid:29)bÀÜ5*odï(cid:18)(cid:29)00. 25021. 25B - 1 P′1 =20. 515=0. 50. 50. 125020. 375同时计算出 x′1 的检验数为c′1 - CB B - 1 P′1 = 4 - (1. 5 , 0. 125 , 0 ) ( 2 , 5 , 2) T= 0. 375将以上计算结果填入最终表 x1 的列向量位置 , 得表 2 -14。表 2 -14CBX Bbx′1x2x3x42x141. 25000. 250x540. 5020. 53x220. 3751. 5 00. 125cj - zj0. 37501. 50. 125由表 2 -14 可见 x′1 为换入变量 , 经过迭代得到表 2 -15。表 2 -15CBX Bbx′1x2x3x44x′13. 2100. 2 00x52. 4002. 4 03x20. 801. 5 00. 2cj - zj001. 50. 2表 2 -15 表明原问题和对偶问题的解 都是可 行解。 所以 表中的 结果 已是最 优解。 即应当生产产品Ⅰ′, 3. 2 单位 ; 生产产品Ⅱ , 0. 8 单位。可获利 15. 2 元。注意 : 若碰到原问题和对偶问题均为非可行解时 , 就需要引进人工变量后重新求解。 例 11 假设例 10 的产品Ⅰ′的技术系数向量变为 P′1 = ( 4 , 5 , 2) T , 而每件获利仍为 4元。试问该厂应如何安排最优生产方案 ?解 方法与例 10 相同 , 以 x′1 代替 x1 , 计算00. 25041. 25B - 1 P′1 =20. 515=3. 50. 50. 125021. 375x′1 的检验数为 c′1 - CB B - 1 P′1 = 4 - (1. 5 , 0. 125 , 0) ( 4 , 5 , 2 ) T = - 2. 625。将 这些数 字填 入 最终表 1 -15 的 x1 列的位置 , 得到表 2 -16。·86·x51100x50100¥¥¦¦ªK@MB–“‘’‘§MBK@–“’‘‘§MBK@œ‘–‘“’§WLMB‘†–‘¥¥¦ª¦bWdY“–‘’‘bWdY–“‘’‘§bWœ‘dY–‘“’§bW‘†–’‘表 2 -16CBX Bbx′1x2x3x4x52x141. 25000. 2500x543. 5020. 513x221. 3751. 5 00. 1250cj - zj2. 62501. 50. 1250将表 2 -16 的 x′1 替换基变量中 x1 , 得表 2 -17。表 2 -17CBX Bbx′1x2x3x4x54x′13. 2100. 2 000x515. 2002. 2 113x22. 401. 5 00. 40cj - zj001. 5. 4 00从表 2 -17 可 见 原 问 题 和 对 偶 问 题 都 是 非 可 行 解。 于 是 引 入 人 工 变 量 x6 。 因 在表 2 -17 中 x2 所在行 , 用方程表示时为0 x′1 + x2 + 0. 5 x3 - 0. 4 x4 + 0 x5 = - 2. 4引入人工变量 x6 后 , 便为x2 - 0. 5 x3 + 0. 4 x4 + x6 = 2. 4将 x6 作为基变量代替 x2 , 填入表 2 -17 , 得到表 2 -18。表 2 -18CBX Bbx′1x2x3x4x5x64x′13. 21000. 2000x515. 20021. 210Mx62. 4010. 5[ 0. 4 ]01cj - zj03 - M0. 5 M0. 800+ 0. 4 M这时可按单纯形 法 求 解。 x4 为 换入 变 量 , x6 为 换 出 变量。 经 基 变 换 运 算 后 , 得 到 表 2 -19的上表。在表 2 -19 的上表中 , 确定 x2 为 换入变 量 , x5 为换 出变 量。经基 变换 运 算后 , 得到表 2 -19 的下表。此表的所有检验 数都为 非正 , 已 得最 优解。最 优生产 方案 为 生产产品Ⅰ′, 0. 667 单位 ; 产品Ⅱ , 2. 667 单位 , 可得最大利润 10. 67 元。·96·¥¥ª¦¦MBK@“–‘’‘§MBK@“–‘’‘§K@MBœ‘“‘–’§cXdY‘†–‘¥¥¦¦ªbWdY“–’‘‘§bWdY“–‘‘’§bWœ‘dY“‘–’§bW–¡–’‘HwÕð¦(cid:4)Õ4)ðåðg3|(cid:4)bÕ4)ðåg3ð|(cid:4)bÕððå4)g\3(cid:4)bi^4)/表 2 -19cj43000MCBXBbx′1x2x3x4x5x64x′1210. 50. 25000. 50x580[3 ]0. 50130x4602. 51. 25102. 5cj - zj01100M + 24x′10. 667100. 3300. 3303x22. 667010. 16700. 3310x412. 667001. 66710. 830cj - zj000. 8300. 33M + 3除以上介绍的几项分析以外 , 还可以作增减约束条件等分析。留给读者自己考虑。第 8 节 *参数线性规划灵敏度分 析时 , 主 要讨论 在最 优基 不变情 况下 , 确 定系数 ai j , bi , cj 的变化 范围。 而 参数线性规划是研究这些参数中某一参数连续 变化时 , 使 最优 解发生 变化 的各临 界点 的 值。即把某一参数作为参变量 , 而目标函数在某区间内是这个参变量的线性函数 , 含这个 参变量的约束条件是线性等式或不等式。因此仍可用单纯形法和对偶单纯形法分析参数线性规划问题。其步骤是 :(1 ) 对含有某参变量 t 的参数线性规划问题。先令 t = 0 , 用单纯形法求出最优解 ; (2 ) 用灵敏度分析法 , 将参变量 t 直接反映到最终表中 ; (3 ) 当参变量 t 连续变大或变小时 , 观察 b 列和检验数行各数字的变化。若在 b 列首 先出现某负值时 , 则以它对应的变量为换出变量 ; 于是用对偶单纯形法迭代一步。若在检 验数行首先出现某正值时 , 则将它对应的变量为换入变量 ; 用单纯形法迭代一步 ;(4 ) 在经迭代一 步后得到的新表上 , 令参 变量 t 继续变大或变 小 , 重复 步骤 ( 3 ) , 直到b 列不能再出现负值 , 检验数行不能再出现正值为止。8. 1 参数 c 的变化例 12 试分析以下参数线性规划问题。当参数 t≥0 时的最优解变化。max z( t) = ( 3 + 2 t) x1 + ( 5 - t) x2 ≤4 2 x2 ≤12 3 x1 + 2 x2 ≤18 ≥0x1x1 , x2解 将此模型化为标准型·07·ÖL4ï‘H6eë¦(cid:3)ÖÁ¶LALeôé4ªLAÖL4eªLAÖÁ¶Lôé4eªÖL4¨NCLAÀµL"e4ïNCLAÀµLe"4ïNCÀµLAL"4eïÀµLAL4ï¨max z( t) = ( 3 + 2 t) x1 + ( 5 - t) x2x1 +x3= 42 x2 + x4= 123 x1 + 2 x2 +x5 = 18x j ≥0 , 令 t = 0 , 用单纯形法求解 , 见表 2 -20。j = 1 , 2 , … , 5表 2 -20cj35000CBX Bbx1x2x3x4x50x320011/ 31/ 35x260101/ 203x121001/ 31/ 3cj - zj0003/ 21将 c 的变化直接反映到最终表 2 -20 中 , 得表 2 -21。表 2 -21cj3 + 2 t5 - t000CBX Bbx1x2x3x4x50x320011/ 31/ 35 - tx260101/ 203 + 2 tx121001/ 31/ 30003/ 21cj - zj+7 6t2 3t当 t 增大 , t≥3/ 2 7/ 6=9 7时 , 首先出现 σ4 ≥0 , 在 σ4 ≤ 0 , 即 0≤ t≤ 9/ 7 时 , 得最优解 ( 2 , 6 ,2 , 0 , 0) T 。 t = 9/ 7 为第一临界点。当 t > 9/ 7 时 ,σ4 > 0 , 这时 x4 作 为换入变 量。用单纯 形 法迭代一步 , 得表 2 -22。表 2 -22cj3 + 2 t5 - t000CBXBbx1x2x3x4x50x46003115 - tx23013/ 201/ 23 + 2 tx1410100009/ 205/ 2cj - zj7 2t+1 2t·17·Àbó‘ïÕw¦(cid:8)(cid:4)ÀP(cid:144)|ï‘(cid:30)bÀP(cid:144)ï|‘(cid:30)bÀP(cid:144)ï‘|(cid:30)bÀ‘ïP(cid:5)(cid:5)e3|(cid:5)(cid:6)(cid:30)(cid:6)b3(cid:5)(cid:6)(cid:6)(cid:30)b3(cid:6)(cid:6)(cid:30)(cid:5)býp,<`@`PptŒ,Ž<\Ll(cid:144),ŽL˜l\(cid:144),<LŽl\(cid:144),L\[当 t 继续增大 t≥ 5/ 2 1/ 2= 5 时 , 首先出现 σ5 ≥0 , 在σ5 ≤0 , 即 9/ 7≤ t≤ 5 时 , 得最优解 ( 4 ,3 , 0 , 6 , 0) T 。 t = 5 为第二临 界点。当 t > 5 时 ,σ5 > 0 , 这时 x5 作为 换入 变量 , 用单 纯形 法 迭代一步 , 得表 2 -23。表 2 -23cj3 + 2 t5 - t000CBXBbx1x2x3x4x50x412020100x56023013 + 2 tx1410100cj - zj05 - t3 - 2 t00表 2 -23 中 t 继续增大时 , 恒有 σ2 ,σ3 < 0 , 故当 t≥5 时 , 最优解为 ( 4 , 0 , 0 , 12 , 6 ) T 。8. 2 参数 b 的变化分析例 13 分析以下线性规划问题 , 当 t≥0 时 , 其最优解的变化。m ax z = x1 + 3 x2x1 + x2 ≤6 - t - x1 + 2 x2 ≤6 + t x1 , x2 ≥0解 将上述模型化为标准型max z = x1 + 3 x2x1 + x2 + x3= 6 - tx1 + 2 x2 + x4 = 6 + t x1 , x2 , x3 , x4 ≥0令 t = 0 , 用单纯形法求解 , 见表 2 -24。表 2 -24cj1300CBXBbx1x2x3x41x12102/ 31/ 33x24011/ 31/ 3cj - zj005/ 32/ 3计算B - 1Δb =2/ 31/ 31/ 31/ 3tt=t0·27·,<`@P`ptŒ,L<\ƒ`(cid:144)Œ,Lƒ\`(cid:144),L<ƒ\`(cid:144),`\5c"‘w¥I6~5¿c(cid:7)«í~¿«c(cid:7)5í~c5将此计算结果反映到最终表 2 -24 , 得表 2 -25。表 2 -25cj1300CBXBbx1x2x3x41x12 - t102/ 31/ 33x24011/ 31/ 3cj - zj005/ 32/ 3在表 2 -25 中 , 当 t 增大至 t≥2 时 , 则 b≤0。即 0≤ t≤ 2 时 , 最优解为 ( 2 - t, 4 , 0 , 0) T 。当 t > 2 时 , 则 b1 < 0 ; 故将 x1 作为换出变量 , 用对偶单纯形法迭代一步 , 得表 2 -26。表 2 -26cj1300CBXBbx1x2x3x40x46 + 3 t30213x26 - t1110cj - zj2030从表 2 -26 可见 , 当 t > 6 时 , 问题无可行解 ; 当 2 ≤ t≤6 时 , 问题 的最优 解为 ( 0 , 6 - t,0 , - 6 + 3 t) T 。习题2. 1 用改进单纯形法求解以下线性规划问题。(1 ) max z = 6 x1 - 2 x2 + 3 x3 2 x1 - x2 + 2 x3 ≤2+ 4 x3 ≤ 4 ≥0x1x1 , x2 , x3(2 ) min z = 2 x1 + x23 x1 + x2 = 3 4 x1 + 3 x2 ≥ 6 x1 + 2 x2 ≤ 3 x1 , x2 ≥02. 2 已知 某 线 性 规 划 问 题 , 用 单 纯 形 法 计 算 时 得 到 的 中 间 某 两 步 的 计 算 表 见表 2 -27 , 试将表中空白处数字填上。·37·c5"‘wI¥6~¿5«cí~«c5(cid:7)¿í~c55"c‘w¥I6"c¿«ccc¿"«¿c"c表 2 -27cj354000CBXBbx1x2x3x4x5x6x28/ 32/ 3101/ 300x514/ 34/ 3052/ 310x620/ 35/ 3042/ 301cj - zj1/ 3045/ 300…x215/ 418/ 4110/ 41x36/ 415/ 414/ 41x12/ 4112/ 4115/ 41cj - zj2. 3 写出下列线性规划问题的对偶问题。(1 ) min z = 2 x1 + 2 x2 + 4 x3( 2) max z = x + 2 x2 + 3 x3 + 4 x42 x1 + 3 x2 + 5 x3 ≥2 3 x1 + x2 + 7 x3 ≤3 x1 + 4 x2 + 6 x3 ≤5 x1 , x2 , x3 ≥0mn(3 ) min z = ∑∑ci j x i jx1 + x2 - x3 - 3 x4 = 5 6 x1 + 7 x2 + 3 x3 - 5 x4 ≥8 12 x1 - 9 x2 - 9 x3 + 9 x4 ≤20 x1 x2 ≥0 , x3 ≤0 , x4 无约束 cj x jx1 + x2 - x3 - 3 x4 = 5 6 x1 + 7 x2 + 3 x3 - 5 x4 ≥8 12 x1 - 9 x2 - 9 x3 + 9 x4 ≤20 x1 x2 ≥0 , x3 ≤0 , x4 无约束 cj x j( 4) m ax z = ∑i = 1j = 1nn∑x i j = αi ,i = 1 , … , m∑αi j x j ≤ bi ,i = 1 , …, m1 ≤ mj = 1j = 1mn∑x i j = bj ,j = 1 , … , n∑αi j x j = bi ,i = m1 + 1 , m1 + 2 , … , mi = 1j = 1x i j ≥0x j ≥0 , x j 无约束 ,当 j = 1 , …, n1 ≤ n当 j = n1 + 1 , … , n2. 4 判断下列说法是否正确 , 为什么 ? (1 ) 如线性规划的原问题存在可行解 , 则其对偶问题也一定存在可行解 ; (2 ) 如线性规划的对偶问题无可行解 , 则原问题也一定无可行解 ; (3 ) 如果线性规划的原问题 和对 偶问题 都具 有可 行解 , 则该 线性 规划问 题一 定具 有有限最优解。2. 5 设线性规划问题 1 是nmax z1 = ∑cj x jj = 1n∑αi j x j ≤ bi ,i = 1 , 2 , … , mj = 1x j≥ 0 ,j = 1 , 2 , … , n( y *1, … , y *m ) 是其对偶问题的最优解。·47·ÖL4"ï‘Ha6ë¦(cid:3)ÖØ"bz‘ï(cid:28)ÖØb"z‘ï(cid:28)ÖØz"bï‘(cid:28)Ö"‘ïV¬¿(cid:28)V¬¿(cid:28)V¬¿(cid:28)又设线性规划问题 2 是nmax z2 = ∑ci x jj = 1n∑αi j x j ≤ bi + ki ,i = 1 , 2 , … , mj = 1xj ≥0 ,j = 1 , 2 , … , n其中 ki 是给定的常数 , 求证mmax z2 ≤ m ax z1 + ∑ki y *ii = 12. 6 已知线性规划问题max z = c1 x1 + c2 x2 + c3 x3α11α21x1 +α1 2α2 2x2 +α13α23x3 +10x4 +01x5 =b1b2xj ≥0 ,j = 1 , … , 5用单纯形法求解 , 得到最终单纯形表如表 2 -28 所示 , 要求 : (1 ) 求 α11 ,α12 ,α13 ,α2 1 ,α22 ,α2 3 , b1 , b2 的值 ; (2 ) 求 c1 , c2 , c3 的值。表 2 -28X Bbx1x2x3x4x5x33/ 21011/ 21/ 2x221/ 21012cj - zj300042. 7 已知线性规划问题max z = 2 x1 + x2 + 5 x3 + 6 x4对偶变量+ x3 + x4 ≤8 2 x1 2 x1 + 2 x2 + x3 + 2 x4 ≤12y1y2x j ≥0 ,j = 1 , … , 4其对偶问题的最优解为 y *1 = 4 , y * 2. 8 试用对偶单纯形法求解下列线性规划问题。2 = 1 , 试应用对偶问题的性质 , 求原问题的最优解。(1 ) min z = x1 + x2(2 ) min z = 3 x1 + 2 x2 + x3 + 4 x42 x1 + x2 ≥ 4x1 + 7 x2 ≥ 7 x1 , x2 ≥02 x1 + 4 x2 + 5 x3 + x4 ≥0 x2 + 7 x3 - 2 x4 ≥23 x1 - 5 x1 + 2 x2 + x3 + 6 x4 ≥15x1 , x2 , x3 , x4 ≥0·57·w¥I6(cid:27)~5¿c(cid:7)(cid:7)¿~5c¿(cid:7)(cid:7)¿c(cid:127)¿52. 9 现有线性规划问题max z = - 5 x1 + 5 x2 + 13 x3x1 + x2 + 3 x3 ≤20 12 x1 + 4 x2 + 10 x3 ≤90 x1 , x2 , x3 ≥0先用单纯形法求出最优解 , 然后分析在下列各种条件下 , 最优解分别有什么变化 ?(1 ) 约束条件①的右端常数由 20 变为 30 ; (2 ) 约束条件②的右端常数由 90 变为 70 ; (3 ) 目标函数中 x3 的系数由 13 变为 8 ;(4 ) x1 的系数列向量由112变为05;(5 ) 增加一个约束条件③2 x1 + 3 x2 + 5 x3 ≤ 50 ; (6 ) 将原约束条件②改变为 10 x1 + 5 x2 + 103 ≤100 。 2. 10 已知某工厂计划生产Ⅰ , Ⅱ , Ⅲ三种产品 , 各产 品需 要在 A, B, C 设备上 加工 ,有关数据见表 2 -29 。试回答 :表 2 -29设备代号ⅠⅡⅢ设备有效台时/ 每月A8210300B1058400C21310420单位产品利润/ 千元322. 9(1 ) 如何充分发挥设备能力 , 使生产盈利最大 ? (2 ) 若为了增加产量 , 可借用其他工厂的设备 B, 每 月可借 用 60 台时 , 租金为 1. 8 万元 , 问借用 B 设备是否合算 ?(3 ) 若另有两种新产品Ⅳ , Ⅴ , 其中Ⅳ需用设备 A - 12 台时 ; B - 5 台时 ; C - 10 台时 , 单位产品盈利 2. 1 千元 ; 新产品Ⅴ需用设备 A - 4 台时 , B - 4 台时 , C - 12 台时 , 单位产品 盈利 1. 87 千元。如 A, B, C 设备台时不增加 , 分 别回答这 两种 新产品 投产 在经济 上是 否 合算 ?(4 ) 对产品工艺重新进行 设计 , 改进 结构。 改进后 生产 每件产 品Ⅰ , 需 用设 备 A - 9 台时 , 设备 B - 12 台 时 , 设 备 C - 4 台 时 , 单 位 产 品盈 利 4. 5 千 元 , 问 这 对 原 计 划 有 何 影响 ?2. 11 分析下列参数规划中当 t 变化时最优解的变化情况。 (1 ) max z( t) = (3 - 6 t) x1 + (2 - 2 t) x2 + (5 - 5 t) x3 ( t≥0) x1 + 2 x2 + x3 ≤ 430 + 2 x3 ≤ 460 ≤ 4202. 11 分析下列参数规划中当 t 变化时最优解的变化情况。 (1 ) max z( t) = (3 - 6 t) x1 + (2 - 2 t) x2 + (5 - 5 t) x3 ( t≥0) x1 + 2 x2 + x3 ≤ 430 + 2 x3 ≤ 460 ≤ 420x1 + 4 x2 x1 , x2 , x3 ≥0·67·①②ÄÀ5bÄÀb5ÄÀ5bmbÀ5(2 ) max z( t) = (7 + 2 t) x1 + (12 + t) x2 + (10 - t) x3 ( t≥0)x1 + x2 + x3 ≤20 2 x1 + 2 x2 + x3 ≤30x1 , x2 , x3 ≥0 (3 ) max z( t) = 2 x1 + x2 ( 0≤ t≤25)≤ 10 + 2 tx1 x1 + x2 ≤ 25 - tx2 ≤ 10 + 2 tx1 , x2 ≥0(4 ) max z( t) = 21 x1 + 12 x2 + 18 x3 + 15 x4 ( 0≤ t≤59) 6 x1 + 3 x2 + 6 x3 + 3 x4 ≤30 + t 6 x1 - 3 x2 + 12 x3 + 6 x4 ≤78 - t9 x1 + 3 x2 - 6 x3 + 9 x4 ≤135 - 2 t x j ≥0 ,j = 1 , 2 , 3 , 4·77·第 3 章 运 输 问 题前两章讨论了一般线性规划问题的单纯 形法求 解方 法。但在 实际 工作中 , 往 往碰 到 有些线性规划问题 , 它们的约束方程组的系数矩阵具有特殊的结构 , 这就有可能找到比单 纯形法更为简便的求解方法。从而可节约计算时间和费用。本章讨论的运输问题就是属于这样一类特殊的线性规划问题。第 1 节 运输问题的数学模型在经济建设中 , 经常碰到大宗物资调 运问题。 如煤、钢 铁、木材、粮 食等物 资 , 在全 国 有若干生产基地 , 根据已有的交通网 , 应如何制订调运方案 , 将这些物资运到各消费地点 , 而总运费要最小。这问题可用以下数学语言描述。已知有 m 个生产地点 A i , i = 1 , 2 , … , m。 可供 应某 种物 资 , 其 供应 量 ( 产 量 ) 分别 为 ai , i = 1 , 2 , … , m, 有 n 个销地 B j , j = 1 , 2 , … , n, 其需要量分别为 bj , j = 1 , 2 , … , n, 从 A i 到 B j 运输单位物资的运价 ( 单价 ) 为 ci j , 这些数据可 汇总于 产销平衡 表和 单位 运价表 中 , 见 表 3 -1 , 表 3 -2。有时可把这两表合二为一。表 3 -1表 3 -2产地销地1 2 … n产量产地销地1 2 … n1a11c11 c12 … c1 n2a22c21 c22 … c2 n⁝⁝mam⁝⁝销量b1b2… bnmcm1 cm2… cm n若用 xi j 表示从 A i 到 B j 的运量 , 那么在产 销平衡 的条 件下 , 要求 得总 运费最 小的 调运方案 , 可求解以下数学模型mnmin z = ∑∑ci j x i ji = 1j = 1m∑xi j = bj ,j = 1 , 2 , … , ni = 1n∑xi j = ai ,i = 1 , 2 , … , mj = 1xi j ≥ 0这就是运输问题的数学模型。它包含 m× n 个 变量 , ( m + n) 个约束 方程。其 系数 矩阵的结构比较松散 , 且特殊。·87·( 3 -1)( 3 -2)«(cid:19)«(cid:19)x11 x12 … x1 n x 21 x22 … x2 n … xm1 xm 2 … x m nu111 … 1u211 … 1⁝wm 行um v111111 … 1v2111n 行⁝ vnw1w1w1该系数矩阵中对应于变量 xi j 的系数向量 P i j , 其分量中除第 i 个和第 m + j 个为 1 以外 , 其余的都为零。即P i j = ( 0…1 …0…1 …0) T = ei + em + j对产销平衡的运输问题 , 由于有以下关系式存在 :nmnnmm∑bj = ∑∑xi j = ∑∑x i j = ∑aij = 1i = 1j = 1j = 1i = 1i = 1所以模型最多只有 m + n - 1 个独 立约 束方 程。即 系数 矩 阵的 秩≤ m + n - 1 。由 于有 以 上特征 , 所以求解运输问题时 , 可用比较简便的计算方法 , 习惯上称为表上作业法。第 2 节 表上作业法表上作业法是单纯形法在求解运输问题 时的一 种简 化方法 , 其实质 是单 纯形法。 但具体计算和术语有所不同。可归纳为 :(1 ) 找出初始基可行解。即在 ( m× n) 产销平衡表上给出 m + n - 1 个数字格。 (2 ) 求各非基变量的检验数 , 即在表上计算空格的检验数 , 判 别是否达 到最优解。 如已是最优解 , 则停止计算 , 否则转到下一步。(3 ) 确定换入变量和换出变量 , 找出新的基可行解。在表上用闭回路法调整。 (4 ) 重复 ( 2) , ( 3) 直到得到最优解为止。 以上运算都可以在表上完成 , 下面通过例子说明表上作业法的计算步骤。 例 1 某公司经销甲产品。它下 设三个 加工 厂。每 日 的产 量分 别是 : A1 为 7 吨 , A2 为 4 吨 , A3 为 9 吨。该公司把这些产品分 别运 往四个 销售 点。各销 售点 每日销 量为 : B1 为 3 吨 , B2 为 6 吨 , B3 为 5 吨 , B4 为 6 吨。已知从各 工厂 到各 销售点 的单 位产品 的运 价 为表 3 -3 所示。问该公司应如何调运产品 , 在满足各销点的需要量的前提下 , 使总运费为 最少。解 先画出这问题的产销平衡表和单位运价表 , 见表 3 -3 , 表 3 -4 。·97·表 3 -3 单位运价表加工厂销地B1B2B3B4A1311310A21928A374105表 3 -4 产销平衡表产地销地B1B2B3B4产量A17A24A39销量36562. 1 确定初始基可行解这与一般线性规划问题不同。产销平衡的运输问题总是存在可行解。因有mn∑ai = ∑bj = di = 1j = 1必存在x i j ≥0 ,i = 1 , … , m,j = 1 , … , n这就是可行解。又因0 ≤ x i j ≤ min( aj , bj )故运输问题必存在最优解。确定初始基可行解的方法很多 , 一般希望的方法是既简便 , 又尽可能接近最优解。下面介绍两种方法 : 最小元素法和伏格尔 ( V ogel ) 法。1. 最小元素法这方法的基本思想是就近供应 , 即从单位运价表中最小的运价开始确定供销关系 , 然后次小。一直到给出初始基可行解为止。以例 1 进行讨论。第一步 : 从表 3 -3 中找出最小运价为 1 , 这表示先将 A2 的产品供应给 B1 。因 a2 > b1 , A2 除满足 B1 的全部需要外 , 还可多 余 1 吨产 品。在 表 3 -4 的 ( A2 , B1 ) 的 交 叉格 处填 上 3。得表 3 -5 。并将表 3 -3 的 B1 列运价划去。得表 3 -6。第二步 : 在表 3 -6 未划去的元素中再找出最小运价 2 , 确定 A2 多余的 1 吨供应 B3 , 并给出表 3 -7 , 表 3 -8。·08·ð×(cid:10)(cid:7)(cid:6)®×(cid:6)(cid:10)(cid:7)®×(cid:7)(cid:10)(cid:6)®MÃñ(cid:31)ó®ó®ó®Ø4ª(cid:6)表 3 -5加工厂销地B1B2B3B4产量A17A234A3 销量36569表 3 -6产地销地B1B2B3B4A1311310A21928A374105表 3 -7加工厂销地B1B2B3B4产量A17A2314A39销量3656表 3 -8产地销地B1B2B3B4A1311310A21928A374105第三步 : 在表 3 -8 未划去的元素 中再找 出最 小运 价 3 ; 这 样一 步步 地进 行下 去 , 直 到 单位运价表上的所有元素划去为 止 , 最后在 产销 平衡 表 上得 到一 个调 运方 案 , 见 表 3 -9。 这方案的总运费为 86 元。表 3 -9产地销地B1B2B3B4产量A1437A2314A3639销量3656用最小元素法给出的初始解是运输问题的基可行解 , 其理由为 : (1 ) 用最小元素法给出的初始解 , 是从单位运价表中逐次地挑选最 小元素 , 并比较 产·18·Ú“6ïP®ÁP®P®ÖÁz(cid:29)Á|(cid:12)z¨(cid:10)#có¨#ó¿c#Úeð{"#Á×"#"#ÁL×bÁ|(cid:12)z¨(cid:10)#¿có#Ú{ðe×b"#Á×"#Lb"#ÁL×b量和销量。当产大于销 , 划去该元素所在列。当产小于销 , 划去该元素所在行。然后在未 划去的元素中再找最小元素 , 再确定供应关系。这样在产销平衡表上每填入一个数字 , 在 运价表上就划去一行或一列。表中共有 m 行 n 列 , 总共可划 ( n + m) 条直线。但当表中只 剩一个元素时 , 这时当在 产销 平 衡表 上填 这个 数字 时 , 而 在运 价表 上同 时 划去 一行 和 一 列。此时把单价表上所有元素都划去了 , 相应地在产销平衡表上填 了 ( m + n - 1 ) 个数字。 即给出了 ( m + n - 1) 个基变量的值。(2 ) 这 ( m + n - 1 ) 个基变量对应的系数列向量是线性独立的。 它对应的系数列向量为 证 若表中确定的第一个基变量为 xij11Pi11 = ei1 + em + j1因当给定 xi11的值后 , 将划去第 i1 行 或 第 j1 列 , 即 其后 的 系数 列 向量 中 再 不出 现 ei1不可能用 解 中的 其 他向 量 的 线性 组 合 表示。 类 似 地给 出 第 二 个 , … , 第 em + j ( m + n - 1) 个。这 ( m + n - 1) 个向量都不 可能用解 中的其 他向量 的线性 组合 表示。故 这 ( m + n - 1) 个向量是线性独立的。1 , 因而 Pij11用最小元素法给出初始解时 , 有可能在产销平衡表上填入一个数字后 , 在单位运价表上同时划去一行和一列。这时就出现退化。关于退化时的处理将在 2. 4 中讲述。2. 伏格尔法最小元素法的缺点是 : 为了节省一处的 费用 , 有时 造成 在其他 处要 多花 几倍的 运费。 伏格尔法考虑到 , 一产地的产品假如不能按 最小运 费就 近供 应 , 就 考虑 次小 运费 , 这就 有 一个差额。差额越大 , 说明不能按最小运 费调运 时 , 运费 增加 越多。因 而对 差额最 大处 , 就应当采用最小运费调运。基于此 , 伏格尔法的步骤是 :第一步 : 在表 3 -3 中分别计算出各行和各列的最小运费和次最小运费的差额 , 并填入该表的最右列和最下行 , 见表 3 -10。表 3 -10产地销地B1B2B3B4行差额A13113100A219281A3741051列差额2513第二步 : 从行或列差额中选出最大者 , 选择它所在行或列中的最小元素。在表3 -10中 B2 列是最大差额所在列。 B2 列中最小元素为 4 , 可确定 A3 的产品先供应 B2 的需要。得 表 3 -11 。同时将运价表中的 B2 列数字划去。如表 3 -12 所示。·28·或ñ’|Øz(cid:144)î®Øz(cid:144)î®Ø(cid:144)zî®Øz(cid:144)î表 3 -11产地销地B1B2B3B4产量A17A24A369销量3656第三步 : 对表 3 -12 中未划去的元素再分别计 算出 各行、各 列的最 小运 费和次 最小 运 费的差额 , 并填入该表的最右列和最下行。重复第一、二步。直到给出初始解为止。用此 法给出例 1 的初始解列于表 3 -13 。表 3 -12产地销地B1B2B3B4行差额A13113100A219281A3741052列差额213表 3 -13产地销地B1B2B3B4产量A1527A2314A3639销量3656由以上可见 : 伏格尔法同最小元素法除在确定供求关系的原则上不同外 , 其余步骤相同。伏格尔法给出的初始解比用最小元素法给出的初始解更接近最优解。本例用伏格尔法给出的初始解就是最优解。2. 2 最优解的判别判别的方法是计算空格 ( 非基变量 ) 的检验 数 ci j - CB B - 1 P i j , i, , j∈ N。因运 输问 题 的目标函数是要求实现最小化 , 故当 所有 的 ci j - CB B - 1 Pi j ≥ 0 时 , 为 最优 解。下 面介 绍 两种求空格检验数的方法。1. 闭回路法在给出调运方案的计算表上 , 如表 3 -13 , 从 每一 空格 出发 找一 条 闭回 路。它 是以 某 空格为起 点。用 水平或 垂直 线向前 划 , 当碰 到一 数字格 时可 以转 90°后 , 继续 前进 , 直 到·38·&Nºâo®o®5o®É5¡(cid:13)Á6fM¿(cid:29)QM¨(cid:29)QM4¨QM5(cid:29)Ù6}’y"(cid:29)yd"Ày"€Àyd(cid:29)回到起始空格为止。闭回路如图 3 -1 的 ( a) , ( b) , ( c ) 等所示。图 3 -1从每一空格出发一定存在和可 以找 到唯一 的闭 回路。因 ( m + n - 1 ) 个 数字 格 ( 基 变 量 ) 对应的系数向量是一个基。任一空格 ( 非基变 量 ) 对应 的系 数向量 是这 个基的 线性 组 合。如 Pi j , i, j∈ N 可表示为Pi j = ei + em + j= ei + em + k - em + k + el - el + em + s - em + s + eu - eu + em + j= ( ei + em + k ) - ( el + em + k ) + ( el + em + s ) - ( eu + em + s ) + ( eu + em+ j )= Pi k - Pl k + Pl s - Pu s + Pu j其中 Pi k , P l k , Pl s , Pu s , Pu j ∈ B。而这些向量构成了闭回路 ( 见图 3 -2) 。闭回路法计算检验数的经济解释为 : 在已给出 初 始解的表 3 -9 中 , 可从任一空 格出 发 , 如 ( A1 , B1 ) , 若 让 A1 的产品调运 1 吨给 B1 。为了保持产销 平衡 , 就 要依次作调整 : 在 ( A1 , B3 ) 处减少 1 吨 , ( A2 , B3 ) 处 增 加 1 吨 , ( A2 , B1 ) 处减少 1 吨 , 即构成了以 ( A1 , B1 ) 空 格为起点 , 其他 为数 字格 的 闭回 路。如 表 3 -14 中 的 虚线所示。在这 表 中闭 回路 各顶 点所 在 格的 右上 角图 3 -2数字是单位运价。表 3 -14可见这调整的方案使运费增加( + 1) × 3 + ( - 1) × 3 + ( + 1) × 2 + ( - 1) × 1 = 1 ( 元 ) 这表明若这样调整运量将增加运费。将“1”这个数填入 ( A1 , B1 ) 格 , 这就是 检验数。按 以 上所述 , 可找出所有空格的检验数 , 见表 3 -15 。 ·48·表 3 -15空格闭 回 路检验数(11)( 11 ) - (13) - ( 23 ) - (21) - ( 11 )1(12)( 12 ) - (14) - ( 34 ) - (32) - ( 12 )2(22)( 22 ) - (23) - ( 13 ) - (14) - ( 34 ) - (32) - ( 22)1(24)( 24 ) - (23) - ( 13 ) - (14) - ( 24 )1(31)( 31 ) - (34) - ( 14 ) - (13) - ( 23 ) - (21) - ( 31)10(33)( 33 ) - (34) - ( 14 ) - (13) - ( 33 )12当检验数还存在负数时 , 说明原方案不是最优解 , 改进方法见 2. 3 小节。2. 位势法用闭回路法求检验数时 , 需给每一空格找一条闭回路。当产销点很多时 , 这种计算很繁。下面介绍较为简便的方法———位势法。设 u1 , u2 , … , um ; v1 , v2 , … , vn 是对 应运输 问题 的 m + n 个约 束条件 的对 偶变 量。 B 是含有一个人工变量 x a 的 ( m + n) × ( m + n) 初始基矩 阵。人工 变量 xa 在 目标函 数中 的 系数 ca = 0 , 从线性规划的对偶理论可知。CB B - 1 = ( u1 , u2 , … , um ; v1 , v2 , … , vn )而每个决策变量 xi j 的系数向量 P i j = ei + em + j , 所以 CB B - 1 P i j = ui + vj 。于是检验数σi j = ci j - CB B - 1 Pi j = ci j - ( ui + vj )由单纯形法得知所有基变量的检验数等于 0。即ci j - ( ui + vj ) = 0 ,i, j∈ B例如 , 在例 1 的由最小元素法得到的初始解中 x23 , x34 , x21 , x32 , x13 , x14 是基变 量。 xa为人工变量 , 这时对应的检验数是 :基变量检验数xax23ca - u1 = 0c23 - ( u2 + v3 ) = 0∵ ca = 0 ∴ u1 = 0 即 2 - ( u2 + v3 ) = 0x34c34 - ( u3 + v4 ) = 05 - ( u3 + v4 ) = 0x21c21 - ( u2 + v1 ) = 01 - ( u2 + v1 ) = 0x32c32 - ( u3 + v2 ) = 04 - ( u3 + v2 ) = 0x13c13 - ( u1 + v3 ) = 03 - ( u1 + v3 ) = 0x14c14 - ( u1 + v4 ) = 010 - ( u1 + v4 ) = 0从以上 7 个方程中由 u1 = 0 可求得u2 = - 1 ,u3 = - 5 ,v1 = 2 ,v2 = 9 ,v3 = 3 ,v4 = 10因非基变量的检验数σi j = ci j - ( ui + vj ) , 这就可以从已知的 ui , vj 值中求得。这些计算可在表格中进行。以例 1 说明。i, j∈ N第一步 : 按最小元素法给出表 3 -9 的初 始 解 , 做表 3 -16。在 对应 表 3 -9 的数 字格 处·58·PPPPPH°填入单位运价 , 见表 3 -16。表 3 -16产地销地B1B2B3B4A1310A212A345第二步 : 在表 3 -16 上增加一行一列 , 在列中填入 ui , 在行中填入 vj , 得表 3 -17。表 3 -17产地销地B1B2B3B4uiA13100A2121A3455vj29310i, j∈ B 相继地确定 ui , vj 。由表 3 -17 可见 , 当 u1 = 0 时 , 由 u1 + v3 = 3 可得 v3 = 3 , 由 u1 + v4 = 10 可得 v4 = 10 ; 在 v4 = 10 时 , 由 u3 + v4 = 5 可得 u3 = - 5 , 以此类推可确定所有的 ui , vj 的数值。先令 u1 = 0 , 然后按 ui + vj = ci j ,第三步 : 按 σi j = ci j - ( ui + vj ) i, j∈ N 计算所有空格的检验数。如 σ11 = c1 1 - ( u1 + v1 ) = 3 - ( 0 + 2 ) = 1 σ12 = c1 2 - ( u1 + v2 ) = 11 - (0 + 9) = 2这些计算可直接在表 3 -17 上进行。为了方便 , 特设计计算表 , 如表 3 -18。表 3 -18产地销地B1B2B3B4ui311310A1120001928A20101174105A31001205vj29310·68·Ú#ð(cid:7)!îÁî€×!Ù6’}P(cid:144)(cid:29)Pd(cid:29)ÀP(cid:144)€Àd(cid:144)(cid:29)Úeð{#TÉßjí#ÇÉTß(cid:28)#T÷j(cid:13)(cid:28)Á×Ly在表 3 -18 中还有负检验数。说明未得最优解 , 还可以改进。2. 3 改进的方法———闭回路调整法当在表中空格处出现负检验数时 , 表明 未得 最优解。 若有 两个和 两个 以上的 负检 验 数时 , 一般选其中最小的负检验数 , 以它对应的空格为调入格。即以它对应的非基变量为 换入变量。由表 3 -18 得 (2 , 4 ) 为调入格。以此格为出发点 , 作一闭回路 , 如表 3 -19 所示。表 3 -19产地销地B1B2B3B4产量A1A234 ( + 1) … 3 ( - 1)⁝ ⁝1 ( - 1) … ( + 1 )74A3639销量3656(2 , 4 ) 格的调入量 θ是选择闭回路上具有 ( - 1 ) 的数字 格中的 最小者。即 θ= min ( 1 , 3) = 1( 其原理与单纯 形法 中 按 θ规划 来确 定换 出变 量 相同 ) 。然 后按 闭 回路 上 的正、负 号 , 加入和减去此值 , 得到调整方案 , 如表 3 -20 所示。表 3 -20产地销地B1B2B3B4产量A1527A2314A3639销量3656对表 3 -20 给出的解 , 再用闭回路法或位势法求各空格 的检验数 , 见 表 3 -21。表中 的所有检验数都非负 , 故表 3 -20 中的解为最优解。这时得到的总运费最小是 85 元。表 3 -21产地销地B1B2B3B4A102A221A3912·78·Úe€ÁL#$ÁLÚðe{ÁLb"#Á×LbMRd74(cid:30)®K4®b(cid:30)®2. 4 表上作业法计算中的问题1. 无穷多最优解在本章 2. 1 节中提到 , 产销平衡的运输 问题 必定存 在最 优解。那 么有 唯一最 优解 还 是无穷多最优解 ? 判别依据与第 1 章 3. 3 节讲述的相同。即某个非基变量 ( 空格 ) 的检验 数为 0 时 , 该问题有无穷多最优解。表 3 -21 空格 ( 1 , 1) 的 检验数是 0 , 表明例 1 有无穷 多 最优解。可在表 3 -20 中以 ( 1 , 1 ) 为 调 入格 , 作闭 回 路 ( 1 , 1) +( 1 , 4 ) -( 2 , 4 ) +1) -( 1 , 1) + 。确定 θ= mi n(2 , 3 ) = 2 。经调整后得到另一最优解 , 见表 3 -22。表 3 -22产地销地B1B2B3B4产量A1257A2134A3639销量36562. 退化用表上作业法求解运输问题当出现退化时 , 在相应的格 中一定要 填一个 0 , 以表示 此格为数字格。有以下两种情况 :(1 ) 当确定初始解的各供需关系时 , 若在 ( i, j) 格填 入某数字 后 , 出 现 A i 处的 余量 等 于 B j 处的需量。这时在产销平衡表上填一个数 , 而在单位运价表上相应地要划去一行和 一列。为了使在产销平衡表上有 ( m + n - 1 ) 个 数字 格。这时 需要添 一个“ 0”。它 的位 置 可在对应同时划去的那行或那 列的 任一 空格 处。如 表 3 -23 , 表 3 -24 所示。 因第 一次 划 去第一列 , 剩下最小元素为 2 , 其对应的销 地 B2 , 需 要量为 6 , 而对 应的 产地 A3 未 分配 量 也是 6。这时在 产销表 ( 3 , 2 ) 交 叉格中 填入 6 , 这 时在单位 运价表 3 -24 中需同 时划去 B2 列和 A3 行。在表 3 -23 的空格 ( 1 , 2) , ( 2 , 2) , ( 3 , 3) , ( 3 , 4) 中任选一格添加一个 0 。表 3 -23产地销地B1B2B3B4产量A17A24A3369销量3656·88·( 2 ,Úðe{L"b#ÁL×bÚ{ðe"#"#ÁL"#Á×Lb表 3 -24产地销地B1B2B3B4A131145A27738A312106(2 ) 在用闭回路法调整时 , 在闭回路上出现两个和两个以上的具有 ( - 1 ) 标记的相 等 的最小值。这时只能选择其中一个作为调入 格。而 经调 整后 , 得到 退化 解。这时 另一 个 数字格必须填入一个 0 , 表明 它是基 变量。 当出现 退化 解后 , 并作 改进 调整 时 , 可 能在 某 闭回路上有标记为 ( - 1 ) 的取值为 0 的数字格 , 这时应取调整量 θ= 0。第 3 节 产销不平衡的运输问题及其求解方法前面讲的表上作业法 , 都是以产销平衡 , 即mn∑ai = ∑bji = 1j = 1为前提的 , 但是实际问题中产销往往是不平 衡的。就 需要 把产 销不平 衡的 问题化 成产 销 平衡的问题。当产大于销mn∑ai > ∑bji = 1j = 1时 , 运输问题的数学模型可写成mnmin z = ∑∑ci j x i ji = 1j = 1满足n∑x i j ≤ ai ,( i = 1 , 2 , … , m)j = 1m∑x i j = bj ,( j = 1 , 2 , … , n)i = 1xi j ≥0由于总的产量大 于 销 量 , 就 要 考 虑 多 余的 物 资 在 哪 一个 产 地 就 地 储存 的 问 题。 设x i, n + 1 是产地 Ai 的储存量 , 于是有 :nn + 1∑xi j + x i, n + 1 = ∑xi j = ai ,( i = 1 , … , m)j = 1j = 1m∑x i j = bj( j = 1 , … , n)i = 1mmn∑xi , n + 1 = ∑ai - ∑bj = bn + 1i = 1i = 1j = 1·98·“}õªÜd‘‘QÜzd‘QÜzd¨Q令c′i j = ci j , c′i j = 0 ,当 i = 1 , … , m, 当 i = 1 , … , m,j = 1 , … , n 时 j = n + 1 时将其分别代入 , 得到mn+ 1mnmmin z′= ∑∑ci j′x i j = ∑∑ci j′x i j + ∑c′i , n + 1 xi ji = 1j = 1i = 1j = 1i = 1mn= ∑∑ci j x i ji = 1j = 1满足n+ 1∑x i j = aij = 1m∑x i j = bji = 1xi j ≥0由于这个模型中mnn+ 1∑ai = ∑bj + bn + 1 = ∑bji = 1j = 1j = 1所以这是一个产销平衡的运输问题。若当产大于销时 , 只要增加一个假想的销地 j = n + 1 ( 实 际上是储 存 ) , 该 销地总需 要量为mn∑ai - ∑bji = 1j = 1而在单位运价表中从各产地到假想销地的 单位 运价 为 c′i, n + 1 = 0 , 就转 化成 一个产 销平 衡 的运输问题。类似地 , 当销大于产时 , 可以 在产 销平 衡表中 增加 一个假 想的 产地 i = m + 1 , 该地产量为nm∑bj - ∑aij = 1i = 1在单位运价表上令从该假想产地到各销地的运价 c′m + 1 , j = 0 , 同样可 以转化 为一个 产销 平 衡的运输问题。例 2 设有三个化肥厂 ( A, B, C) 供 应四个 地区 ( Ⅰ , Ⅱ , Ⅲ , Ⅳ ) 的 农用 化肥。 假定 等 量的化肥在这些地区使用效果相同。各化肥厂年 产量 , 各 地区 年需要 量及 从各化 肥厂 到 各地区运送单位化肥的运价如表 3 -25 所示。试求出总的运费最节省的化肥调拨方案。表 3 -25化肥厂需求地区ⅠⅡⅢⅣ产量 (万吨 )A1613221750B1413191560C 最低需求 (万吨 )193020702301050最高需求 (万吨 )507030不限·09·Øcy9îØc9yîØ9cîØ×cyØcî解 这是 一个 产销不 平衡 的运输 问题 , 总 产量 为 160 万吨 , 四 个地区 的 最低 需求 为 110 万吨 , 最高需求为无限。根据现有产量 , 第Ⅳ个地区每年 最多能分 配到 60 万 吨 , 这 样 最高需求为 210 万吨 , 大于产量。为了求得平衡 , 在产销平衡表中增加一个假想的化肥厂 D, 其年产量为 50 万吨。由于各 地区 的需要 量包 含两 部分 , 如 地区 Ⅰ , 其中 30 万 吨是 最 低需求 , 故不能由假想化肥厂 D 供给 , 令相应 运价 为 M( 任意 大正数 ) , 而 另一 部分 20 万 吨满足或 不满足 均可 以 , 因此 可以由 假想 化肥厂 D 供给 , 按前 面讲 的 , 令相 应运 价为 0。 对凡是需求分两种情况的地区 , 实际上可按 照两 个地区 看待。 这样可 以写 出这个 问题 的 产销平衡表 ( 表 3 -26) 和单位运价表 ( 表 3 -27) 。表 3 -26 产销平衡表产地销地Ⅰ′Ⅰ″ⅡⅢⅣ′Ⅳ″产量A50B60C50D50销 量302070301050表 3 -27 单位运价表产地销地Ⅰ′Ⅰ″ⅡⅢⅣ′Ⅳ″A161613221717B141413191515C19192023MMDM0M0M0根据表上作业法计算 , 可以求得这个问题的最优方案如表 3 -28 所示。表 3 -28产地销地Ⅰ′Ⅰ″ⅡⅢⅣ′Ⅳ″产量A5050B20103060C3020050D302050销 量302070301050第 4 节 应 用 举 例由于在变量个数相等的情况下 , 表上作 业法 的计算 远比 单纯 形法简 单得 多。所以 在 解决实际问题时 , 人们常常尽可能把某些线 性规 划的问 题化 为运 输问题 的数 学模型。 下·19·ggggÀb3ï‘(cid:30)M©×g{(cid:5)M©×{g(cid:5)M©×{ÀPdÀgÀ3gbÀgï(cid:30)3g‘À3bï‘(cid:30)面介绍几个典型的例子。例 3 某厂按合同规定须于当年每个季度末分别提 供 10 , 15 , 25 , 20 台同 一规格的 柴 油机。已知该厂各季度的生产能力及生产每 台柴 油机的 成本 如表 3 -29 所示。又 如果 生 产出来的柴油机当季不交货的 , 每台每积 压一 个季度 需储 存、维护 等费用 0. 15 万元。 要 求在完成合同的情况下 , 作出使该厂全年生产 ( 包括储存、维护 ) 费用最小的决策。表 3 -29季 度生产能力 (台 )单位成本 (万元 )Ⅰ2510. 8Ⅱ3511. 1Ⅲ3011. 0Ⅳ1011. 3解 由于每个季度生产出来的柴油机不一定当季交货 , 所以 设 xi j 为第 i 季度生产 的用于第 j 季度交货的柴油机数。 根据合同要求 , 必须满足 :x11= 10x12 + x22= 15x13 + x23 + x33= 25x14 + x24 + x34 + x44 = 20又每季度生产的用于当 季和 以后 各季 交货 的 柴油 机数 不可 能超 过 该季 度 的生 产 能力 , 故又有 :x11 + x1 2 + x13 + x14 ≤25 x22 + x2 3 + x24 ≤35 x33 + x3 4 ≤30x44 ≤10第 i 季度生产的用于 j 季度交货的每台柴油机的实际成本 ci j 应该是该季度单位成本加上储存、维护等费用。 ci j 的具体数值见表 3 -30 。表 3 -30 ci j 值ijⅠⅡⅢⅣⅠ10. 810. 9511. 1011. 25Ⅱ11. 1011. 2511. 40Ⅲ11. 0011. 15Ⅳ11. 30设用 ai 表示该 厂 第 i 季 度 的 生 产 能 力 , bj 表 示 第 i 季 度 的 合 同 供 应 量 , 则 问 题 可写成 :44min z = ∑∑ci j x i ji = 1j = 1·29·©ôé©ôé©ôé©ôé:/ÙÎªŸ’‡ªŸ:/’‡:/’‡:/满足4∑x i j ≤ aij = 14∑x i j = bji = 1xi j ≥0显然 , 这是一个产大于销的运输问题模 型。注意 到这 个问 题中当 i > j 时 , xi j = 0 , 所 以应令对应的 ci j = M , 再加上一个 假想 的需求 D, 就 可 以把 这个 问题 变成 产 销平 衡的 运 输模型 , 并写出产销平衡表和单位运价表 ( 合在一起 , 见表 3 -31) 。表 3 -31产地销地ⅠⅡⅢⅣD产量Ⅰ10. 810. 9511. 1011. 25025ⅡM11. 1011. 2511. 40035ⅢMM11. 0011. 15030ⅣMMM11. 30010销量1015252030经用表上作业法求解 , 可得多个最优方 案 , 表 3 -32 中列出 最优 方案 之一。即 第Ⅰ 季 度生产 25 台 , 10 台当季交货 , 15 台Ⅱ季度交 货 ; Ⅱ 季度 生产 5 台 , 用于 Ⅲ季 度交货 ; Ⅲ 季 度生产 30 台 , 其中 20 台于当 季交货 , 10 台 于 Ⅳ季 度交 货。Ⅳ 季度 生产 10 台 , 于 当季 交 货。按此方案生产 , 该厂总的生产 ( 包括储存、维护 ) 的费用为 773 万元。表 3 -32生产季度销售季度ⅠⅡⅢⅣD产量Ⅰ1015025Ⅱ53035Ⅲ201030Ⅳ1010销量1015252030例 4 某航运公司承担六个港口城市 A、B、C、D、E、F 的四条固定航线的物资运输 任 务。已知各条航线的起点、终点城市及每天航班数见表 3 -33 。假定 各条航线 使用相同 型 号的船只 , 又各城市间的航程天数见表 3 -34。又知每条船只每次装卸货的时间各需 1 天 , 则该航运公司至少应配备多少条船 , 才能满足所有航线的运货需求 ?·39·~3(cid:6)û(cid:6)û(cid:7)ü(cid:30)(cid:19)~3(cid:6)û(cid:7)ü(cid:6)û~(cid:6)û(cid:6)û3~(cid:6)û3ü3ûû(cid:19)KL~LK~JKK~K~KKLLJ表 3 -33航 线起点城市终点城市每天航班数1ED32BC23AF14DB1表 3 -34从到ABCDEFA0121477B1031388C2301555D14131501720E7851703F7852030解 该公司所需配备船只分两部分。 (1 ) 载货 航程 需要 的周 转 船只 数。例 如航 线 1 , 在港 口 E 装 货 1 天 , E→ D 航 程 17 天 , 在 D 卸货 1 天 , 总计 19 天。每天 3 航班 , 故该航线周转船 只需 57 条。各 条航线周 转 所需船只数见表 3 -35 。以上累计共需周转船只数 91 条。表 3 -35航线装货天数 航程天数 卸货天数小计航班数需周转船只数11171193572131521031719194113115115(2 ) 各港口间调度所需船只数。有些港口每天到达船数多于需 要船数 , 例如港 口 D, 每天到达 3 条 , 需求 1 条 ; 而有些港口到达 数少 于需 求数 , 例如 港口 B。各 港口每 天余 缺 船只数的计算见表 3 -36 。表 3 -36港口城市每天到达每天需求余缺数A011B121C202D312E033F101·49·“99“9““9ÁK4“(cid:127)ïÁK4“(cid:127)ïÁK(cid:127)4“ïÁK(cid:127)“4ïKÁ“(cid:127)4ïKÁ(cid:127)“4ïÙó45(cid:28)(cid:30)(cid:29)Ù5ó4(cid:29)(cid:30)(cid:28)Ù45ó(cid:30)(cid:29)(cid:28)Ù45ó(cid:28)(cid:29)(cid:30)©9(cid:7)©9(cid:7)©9(cid:7)©9(cid:7)©9(cid:7)©9(cid:7)为使配备船只数最少 , 应做到周转的空船数为最少。因此建立以下运输问题 , 其产销平衡表见表 3 -37 。表 3 -37港 口ABE每天多余船只C2D2F1每天缺少船只113单位运价表应为相应各港口之间的船只航程天数 , 见表 3 -38。表 3 -38港 口ABEC235D141317F783用表上作业法求出空船的最优调度方案见表 3 -39 。表 3 -39港 口ABE每天多余船只C112D112F11每天缺少船只113由表 3 -39 知最少需周转的空船数为 40 条。这样在不考虑维修、储备等情况下 , 该公司至少应配备 131 条船。例 5 在本章的例 1 中 , 如果假定 ①每个工厂生产的产品不一定直接发运到销售点 , 可以将其中几个产地集中一起运 ; ②运往各销地的产品可以先运给其中几个销地 , 再转运 给其他销地 ; ③除产、销地之外 , 中间还可以 有几个 转运 站 , 在产地 之间、销 地之间 或产 地 与销地间转运。已知各产地、销地、中间转运站 及相互 之间 每吨产 品的 运价 如表 3 -40 所 示 , 问在考虑到产销地之间直接运输和非直接运输的各种可能方案的情况下 , 如何将三个 厂每天生产的产品运往销售地 , 使总的运费最少。解 从表 3 -40 中看出 , 从 A1 到 B2 每 吨产 品的 直接运 费为 11 元 , 如 从 A1 经 A3 运 往 B2 , 每吨运价为 3 + 4 = 7 元 , 从 A1 经 T2 运往 B2 只需 1 + 5 = 6 元 , 而从 A1 到 B2 运 费 最少的路径是从 A1 经 A2 , B1 到 B2 , 每吨产品的运费只需 1 + 1 + 1 = 3 元。可见这个问题 中从每个产地到各销地之间的运输方案是很多的。为了把这个问题仍当作一般的运输问题处理 , 可以这样做 :·59·hhhØÀðPL(cid:29)PL(cid:29)LP(cid:29)"{(cid:5)À"(cid:5)"(cid:5)À{(cid:5)表 3 -40产 地中间转运站销 地项 目A1A2A3T1T2T3T4B1B2B3产A11321433113地A21352192A331237410中 间 转 运 站T1T2T32143512131131212241858422T432321212B1317241114销B2119485812地B33210422242B410856746213(1 ) 由于问题中所有产地、中 间转 运站、销地 都可 以看作 产地 , 又 可看 作销 地。因 此把整个问题当作有 11 个产地和 11 个销地的扩大的运输问题。(2 ) 对扩大的运输问题建 立单 位运价 表。方 法将表 3 -40 中不 可能 的运 输方 案的 运价用任意大的正数 M 代替。(3 ) 所有中间转运站的产量等于销量。由于运费最少时不可能 出现一批 物资来回 倒 运的现象 , 所以每个转运站的转运数 不超过 20 吨。可以 规定 T1 , T2 , T3 , T4 的产 量和 销 量均为 20 吨。由于实际的转运量nm∑x i j ≤ ai 、∑x i j ≤ bjj = 1i = 1可以在每个约束条件中增加一个松弛变量 xi i , xi i 相当 于一个 虚构 的转 运站 , 意义 就是自己运给自己。 (20 - xi i ) 就是每个转运站的实际转运量 , x i i 的对应运价 ci i = 0。(4 ) 扩大的运输问题中原来 的产 地与销 地因 为也 有转运 站的 作用 , 所以 同样 在原 来 产量与销量的数字上加 20 吨 , 即三个厂每天糖果产量改成 27 , 24 , 29 吨 , 销量均为 20 吨 ; 四个销售 点 的 每天 销 量 改 为 23 , 26 , 25 , 26 吨 , 产 量 均 为 20 吨 , 同 时 引 进 xi i 作 为 松 弛 变量。下面写出扩大运输问题的产销平衡表与单位运价表 ( 见表 3 -41 ) , 由于这 是一个产 销平衡的运输问题 , 所以可以用表上作业法求解 ( 计算略 ) 。表 3 -41产地销地A1A2A3T1T2T3T4B1B2B3B4A10132143311310A210M35M21928A33M01M2374105·69·B410856746213产量272429Ü©O8!õó{’f(cid:10)ÜKÁb4y(cid:6)hÁØÜ4b(cid:144)ï(cid:29)(cid:6)hØKby(cid:144)4ï(cid:6)(cid:29)fÄLÛ5òh(cid:127)–(cid:7)(cid:30)MÀÄ©d×{J(cid:28)’î(cid:28)ÆM©Ä×Jdî’(cid:28)(cid:28)ÆMÄÀ×{Jî’(cid:28)(cid:28)Æ续表产地销地A1A2A3T1T2T3T4B1B2B3B4产量T12310132284620T215M1011452720T34M23102182420T432321201M2620B13172411014220B21194858M102120B332104222420320B410856746213020销量2020202020202023262526习题3. 1 判断表 3 -42 到表 3 -43 中给出的调运方案 能否 作为 用表上 作业 法求解 时的 初始解 ? 为什么 ?表 3 -42产地销地1234产量1015152151025355销量5151510表 3 -43产地销地12345产量1150250400220030050032505030049021030058020100销量240410550330703. 2 表 3 -44 和表 3 -45 中分别给出两个运输问题的产销平衡表和单位运价表 , 试用伏格尔 ( Vogel) 法直接给出近似最优解。·79·ÄÛL(cid:127)5h–ò(cid:30)(cid:7)M©ÀÄ{×d3(cid:5)’î(cid:28)ÅMÀÄ©d×3î(cid:28)’(cid:5)ÅM©ÄÀ{×3’(cid:28)î(cid:5)ÅMÀ©Ä3×{dî’(cid:28)ÅMÀ©Ä{×d3(cid:28)î’(cid:5)ÄMÀÄ©d{3’(cid:28)î(cid:5)ÄMÄ©À{×3d(cid:28)’î(cid:5)ÄMÄÀ©3×{d(cid:5)’î(cid:28)ÄMÀ©×{d3î’(cid:28)(cid:5){‘(cid:6)(cid:28)e–{(cid:6)–e‘(cid:28){e–{‘(cid:6)(cid:28)KÁ“ï(cid:29)“(cid:29)(cid:8)Áï(cid:8)Kï(cid:8)Á“(cid:8)K(cid:29)(cid:8)KÁ“ï(cid:29)表 3 -44产地销地123产量15181222411433674销量91011表 3 -45产地销地12345产量11023159252510152430315514715204 销量202015201330M10825303. 3 用表上作业法求表 3 -46 到表 3 -49 中 给 出的 运输 问题 的最 优 解 ( 表 中数 字 M为任意大正数 ) 。表 3 -46产地销地甲乙丙丁产量137645224322343853销量3322表 3 -47产地销地甲乙丙丁产量11067124216105993 销量55421041064表 3 -48产地销地甲乙丙丁戊产量11020591052210830663120710424 销量84643672549·89·zª’Üze’ªÜzeª’Üezª’zª’M©×{(cid:5)M©×e{ó(cid:5)M©×óe{(cid:5)M©×e{ó(cid:5)M©eó{(cid:5)M©×{(cid:5)e{(cid:127)‘(cid:28)(cid:6){e(cid:127)‘(cid:28)(cid:6){(cid:127)e‘(cid:6)(cid:28){‘(cid:28)(cid:6)e3(cid:127)’‘(cid:6)(cid:127)e3‘’(cid:6)(cid:127)3e‘’(cid:6)3’‘(cid:6)MÀÙP{’(cid:5)MÙÀP{’(cid:5)MÙÀP{’(cid:5)MÀÙP{’(cid:5)MÀ{’(cid:5)表 3 -49产地销地甲乙丙丁戊产量11018291322100213M211416120306113M1404911231819805 销量24100281203610030603480603. 4 已知 运 输 问题 的 产销 平 衡表、单 位运 价 表及 最 优调 运 方 案分 别 见 表 3 -50 和表 3 -51 , 试回答下列问题。表 3 -50 产销平衡表及最优调运方案产地销地B1B2B3B4产量A151015A20101525A355销量5151510表 3 -51 单位运价表产地销地B1B2B3B4A11012011A2127920A32141618(1 ) 从 A2 → B2 的单位运价 c22 在什么范围变化时 , 上述最优调运方案是否变化 ? (2 ) A2 → B4 的单位运价 c24 变为何值时 , 有无穷多 最优调运 方案。除表 3 -50 中方 案外 , 至少再写出其他两个。3. 5 某百货公司去外地采购 A、B、C、D 四种规格的服装 , 数量 分别为 : A—1500 套 , B—2000 套 , C—3000 套 , D—3500 套。有三个城 市可 供应 上 述规 格服 装 , 各 城市 供应 数 量分别为 : Ⅰ—2500 套 , Ⅱ— 2500 套 , Ⅲ—5000 套。由于这 些城市 的服装质 量、运 价和 销 售情况不同 , 预计售出后的利润 ( 元/ 套 ) 也不同 , 详见表 3 -52 。请帮 助该公司 确定一个 预 期盈利最大的采购方案。 表 3 -52ABCDⅠ10567Ⅱ8276Ⅲ93483. 6 甲、乙、丙三个城市每年需要煤炭分 别为 : 320、250、350 万吨 , 由 A、B 两 处煤 矿 负责供应。已知煤炭年供应量分别为 : A—400 万吨 , B— 450 万吨。由煤矿至各城市的 单 ·99·M©Ù~×{(cid:5)M©Ù×~(cid:5)MÙ©~×{M©Ù×~{(cid:5)M©Ù~×{(cid:5)M©×{(cid:5)5”ª5–(cid:31)”–ª(cid:31)–””5ª(cid:31)Ã“Þ«ÃÞ«“€ÃÞ“«€ÃÞ“«€Pbï(cid:29)Pbï(cid:29)Pbï(cid:29)位运价 ( 万元/ 万吨 ) 见 表 3 -53 。由 于需 大 于 供 , 经 研究 平 衡决 定 , 甲 城 市 供应 量 可 减 少 0～30万吨 , 乙城市需要量应全部满足 , 丙 城市供 应量 不少于 270 万吨。试 求将供 应量 分 配完又使总运费为最低的调运方案。表 3 -53甲乙丙A151822B2125163. 7 某造船厂根据合同要从当年起连续 三年末 各提 供三 条规格 型号 相同的 大型 客货轮。已知该厂这三年内生产大型客货轮的能力及每艘客货轮成本如表 3 -54 所示。表 3 -54年 度正常生产时间内可完成的客货轮数加班生产时间内可完成的客货轮数正常生产时每艘成本 (万元 )123500242600313550已知加班生产时 , 每艘客货轮成本比正常生产时高出 70 万元。又知造出来的客货轮 如当年不交货 , 每艘每积压一年造成积压损 失为 40 万元。 在签订 合同 时 , 该厂已 储存 了 两艘客货轮 , 而该厂希望在第三年末完成合 同后 还能储 存一 艘备 用。问该 厂应如 何安 排 每年客货轮的生 产 量 , 使 在 满 足 上 述 各 项 要 求 的 情 况 下 , 总 的 生 产 费 用 加 积 压 损 失 为 最少 ?·001·Ø(cid:127)zØ(cid:127)zNÜ6’NÜ6’NÜ6’第 4 章 目 标 规 划第 1 节 目标规划的数学模型为了具体说明目标规划与线性规划在处理 问题的 方法 上的区 别 , 先通 过例子 来介 绍目标规划的有关概念及数学模型。例 1 某工 厂 生 产 Ⅰ , Ⅱ 两 种 产 品 , 已 知 有 关 数 据 见 下 表。 试 求 获 利 最 大 的 生 产方案。ⅠⅡ拥有量原材料( kg)2111设备 ( hr)1210利润( 元/ 件 )810解 这是求获利最大的单目标的规划问题 , 用 x1 , x2 分别表 示Ⅰ , Ⅱ 产品 的产 量 , 其线性规划模型表述为 :m ax z = 8 x1 + 10 x22 x1 + x2 ≤11 x1 + 2 x2 ≤10 x1 , x2 ≥0用图解法求得最优决策方案为 : x *1 = 4 , x *2 = 3 , z * = 62 ( 元 ) 。但实际上工厂在作决策时 , 要考虑市场等一系列其他条件。 (1 ) 根据市场信息 , 产品 Ⅰ 的销 售 量有 下 降的 趋 势 , 故 考 虑产 品 Ⅰ 的产 量 不大 于 产品Ⅱ。(2 ) 超过计划供应的原材料时 , 需用高价采购 , 会使成本大幅度增加。 (3 ) 应尽可能充分利用设备台时 , 但不希望加班。 (4 ) 应尽可能达到并超过计划利润指标 56 元。 这样在考虑产品决策时 , 便为多目标决 策问 题。目标 规划 方法是 解这 类决策 问题 的方法之一。下面引入与建立目标规划数学模型有关的概念。1. 设 x1 , x2 为决策变量 , 此外 , 引进正、负偏差变量 d + , d -正偏差变量 d+ 表示决策值超过目标值的部分 ; 负偏 差变 量 d - 表 示决 策值未 达到 目 标值的部分。因决策值不可能既超过目标值同时又未达到目标值 , 即恒有 d+ × d - = 0。2. 绝对约束和目标约束绝对约束是指必须严格满足的等式约束和不 等式 约束 ; 如 线性规 划问 题的所 有约 束·101·Ác(cid:127)Ác(cid:127)Ác条件 , 不能满足这些约束条件的解称为非可行解 , 所以它们是硬约束。目标约束是目标规 划特有的 , 可把约束右端项看作要追求的目 标值。在 达到 此目 标值时 允许 发生正 或负 偏 差 , 因此在这些约束中加入正、负偏差变量 , 它们是软约束。线性规划问题的目标函数 , 在 给定目标值和加入正、负偏差变量后可变换 为目 标约束。 也可 根据问 题的 需要将 绝对 约束变换为目标约束。如 : 例 1 的目标函数 z = 8 x1 + 10 x2 可变 换为 目标约 束 8 x1 + 10 x2 + d -d+1 = 56。约束条件 2 x1 + x2 ≤11 可变换为目标约束 2 x1 + x2 + d -d+2 = 11。123. 优先因子 ( 优先等级 )与权系数一个规划问题常常有若干目标。但决策者在 要求 达到 这些目 标时 , 是 有主次 或轻 重 缓急的不同。要求第一位达到的目标赋予优先因子 P1 , 次位的目标赋予优先因子 P2 , … , 并规定 Pk m Pk + 1 , k = 1 , 2 , … , K。表示 Pk 比 P k + 1 有更大的优先权。即首先保证 P1 级目 标的实现 , 这时可不考虑次级目标 ; 而 P2 级目标是在实现 P1 级 目标的基 础上考 虑的 ; 依 此类推。若要区别具有相同优先因子的两个目标 的差 别 , 这时 可分别 赋予 它们不 同的 权 系数 ωj , 这些都由决策者按具体情况而定。4. 目标规划的目标函数目标规划的目标函数 ( 准则函数 ) 是按各目 标约束 的正、负 偏差变 量和 赋予相 应的 优 先因子及权系数而构造的。当每一目标值确定后 , 决 策者 的要 求是尽 可能 缩小偏 离目 标 值。因此目标规划的目标函数只能是 min z = f ( d+ , d - ) 。其基本形式有三种 :(1 ) 要求恰好达到目标值 , 即正、负偏差变量都要尽可能地小 , 这时min z = f ( d+ + d - )(2 ) 要求不超过目标值 , 即允许达不到目标值 , 就是正偏差变量要尽可能地小。这时min z = f ( d+ ) (3 ) 要求超过目标值 , 即超过量不限 , 但必须是负偏差变量要尽可能地小 , 这时 min z = f ( d - )对每一个具体目标规划问题 , 可根据决策 者的要 求和 赋予 各目标 的优 先因子 来构 造目标函数 , 以下用例子说明。例 2 例 1 的决策者在原材料 供应 受严格 限制 的基 础上 考虑 : 首 先是 产 品Ⅱ 的产 量 不低于产品Ⅰ的产量 ; 其 次 是充 分 利用 设 备有 效 台 时 , 不 加班 ; 再次 是 利润 额 不小 于 56 元。求决策方案。解 按决策者所要求的 , 分 别赋予 这三 个目 标 P1 , P2 , P3 优 先因 子。这 问题 的数 学模型是 :min z = P1 d +1 + P2 ( d -2 x1 + x22 + d+2 ) + P3 d - ≤113x2 + d - x1 - x1 + 2 x2 + d - 8 x1 + 10 x2 + d - x1 , x2 , d -d+ - d+ - d+1 = 012 = 1023 = 563, d+i ≥0 ,i = 1 , 2 , 3i目标规划的一般数学模型为·201·LKmin z = ∑Pl ∑(ω-l k d -k + ω+l k d +k )( 4 -1)l = 1k = 1式中 ω-l k ,ω+l k 为权系数。n∑ck j x j + d -kd+k = gk ,k = 1 , … , K( 4 -2)j = 1n∑ai j x j ≤ ( = , ≥ ) bi ,i = 1 , … , m( 4 -3)j = 1x j ≥0 , , d + d -j = 1 , … , nk ≥0 ,k = 1 , … , Kk( 4 -4)建立目标规划的数学模型时 , 需要确定目标值、优先等级、权系数等 , 它都具有一定的主观性和模糊性 , 可以用专家评定法给以量化。第 2 节 解目标规划的图解法对只具有两个决策变量的目标规 划的 数学 模型 , 可 以用 图解 法 来分 析求 解。用 例 2来说明。先在平面 直 角 坐 标 系 的 第 一 象 限 内 , 做 各约束条件。绝对 约束 条件 的作 图与 线 性规划相同。本例中满 足绝 对约 束的 可行 域 为三 角形 OA B。做目标约束 时 , 先令 d - , d + i = 0 , , d+ 做相应的直线 , 然后在这直 线旁标上 d - 如图 4 -1所 示。这 表 明 目标 约 束 可 以 沿 d - d+ i 所示 方 向 平 移。下 面 根 据 目 标 函 数 中 的 优先因子 来 分 析求 解。 首 先 考 虑 具 有 P1 优 先因子的 目 标 的 实 现 , 在 目 标 函 数 中 要 求 实 现 min d+ , 从图中可见 , 可以满足 d+ 1 = 0。这 时 x1 , x2 只能在三角形 O BC 的边界和其中取 值 , 接着 考 虑 具 有 P2 优 先 因 子 的 目 标 的 实 现。在目 标 函 数 中 要 求 实 现 min ( d +ii1,,2 + d -2 ) ,图 4 -1当 d+2, d -2 = 0 时 , x1 、x2 可在 线 段 E D 上取 值。 最后 考 虑 具有 P3 优 先 因子 的 目标 的 实现 , 在目标函数中要求实现 min d - 3 = 0 , 这就 使 x1 、x2 取值范围缩小到线段 GD 上 , 这就是该 目标规 划问 题的解。 可求 得 G 的 坐标 是 (2 , 4 ) , D 的坐标是 (10/ 3 , 10/ 3 ) , G, D 的凸线性组合都是该目标规划问题的解。3 。 从图 4 -1 中可 以 判断 可 以使 d -注意目标规划问题求解时 , 把绝对约束 作最 高优先 级考 虑。在本 例中 能依先 后次 序 3 = 0 , 因而 z* = 0。但在大多数问 题中并 非如此 , 会出现 某都满足 d+ 些约束得不到满足 , 故将目标规划问题的最优解称为满意解。1 = 1 , d+2 + d - = 0 , d -例 3 某电视机厂装配 黑白 和彩 色 两种 电视 机 , 每装 配 一台 电视 机需 占 用装 配 线 1 小时 , 装配线每周计划开动 40 小时。预计市场每周彩色电视机的销量是 24 台 , 每台可获·301·利 80 元 ; 黑白电视机的销量是 30 台 , 每台可获利 40 元。该厂确定的目标为 :第一优先级 : 充分利用装配线每周计划开动 40 小时 ; 第二优先级 : 允许装配线加班 ; 但加班时间每周尽量不超过 10 小时 ; 第三优先级 : 装配电视机的数量尽量满足市场需要。因彩色电视机的利润高 , 取其权系数为 2。试建立这问题的目标规划模型 , 并求解黑 白和彩色电视机的产量。解 设 x1 , x2 分 别表 示 黑 白和 彩 色电 视 机的产量。这个问题的目标规划模型为 mi n z = P1 d -1 + P2 d+2 + P3 ( 2 d - - d + - d + - d+ - d+x1 + x2 + d - x1 + x2 + d - + d - x2 + d -1 = 4012 = 502x13 = 2434 = 3043 + d -4 )图 4 -2i ≥ 0 , 用图解法求解 , 见图 4 -2 。x1 , x2 , d -, d+ii = 1 , … , 4从图 4 -2 中看到 , 在考虑具有 P1 、P2 的目标实现后 , x1 、x2 的取值范围为 A B CD。考 3 = 0 ; 这时 x1 、x2 的取值 范围 为 4 取 值 最 小。故 取 E 点 为 满 意 解。其 坐 标 为 ( 24 ,虑 P3 的目标要求时 , 因 d - A B E F。在 A B E F 中只有 E 点 使 d - 26 ) , 即该厂每周应装配彩色电视机 24 台 , 黑白电视机 26 台。3 的权系数大于 d -, 故先 取 d -4第 3 节 解目标规划的单纯形法目标规划的数学模型结构与线性规划的数学 模型 结构 形式上 没有 本质的 区别 , 所 以可用单纯形法求解。但要考虑目标规划的数学模型一些特点 , 作以下规定 :(1 ) 因目标规划问题的目标函数都是求最 小化 , 所以以 cj - zj ≥ 0 , j = 1 , ( 2 , … , n) 为最优准则。(2 ) 因非基变量的检验数中含有不同等级的优先因子 , 即cj - zj = ∑ αk j P k ,j = 1 , 2 , … , n; k = 1 , 2 , … , K因 P1 m P2 m …m PK ; 从每个 检验 数 的整 体 来看 : 检验 数 的 正、负 首先 决 定于 P1 的 系 数 α1 j 的正、负。若 α1 j = 0 , 这时此 检验数的 正、负就决定 于 P2 的系数 α2 j 的 正、负 , 下 面可 依 此类推。解目标规划问题的单纯形法的计算步骤 : (1 ) 建立初始单纯形表 , 在表中将检验数行按优先因子个数分别列成 K 行 , 置 k = 1。 (2 ) 检查该行中是否存在负数 , 且对应的前 k - 1 行的系数是 零。若有负 数取其中 最小者对应的变量为换入变量 , 转 ( 3) 。若无负数 , 则转 ( 5) 。(3 ) 按最小比值规则确定换出变量 , 当存在两个和两个以上相同的 最小比值 时 , 选 取·401·具有较高优先级别的变量为换出变量。(4 ) 按单纯形法进行基变换运算 , 建立新的计算表 , 返回 ( 2) 。 (5 ) 当 k = K 时 , 计算结束。表中的解即为满意解。否则置 k = k + 1 , 返回到 ( 2) 。 例 4 试用单纯形法来求解例 2。 将例 2 的数学模型化为标准型 :min z = P1 d +1 + P2 ( d - 2 x1 + x2 + xs x2 + d - x1 - x1 + 2 x2 + d - 8 x1 + 10 x2 + d - x1 , x2 , xs , d -2 ) + P3 d - = 112 + d+3d+ - d+ - d+1 = 012 = 1023 = 563, d+ 3 为初始基变量 , 列初始单纯形表 , 见表 4 -1 。i ≥0 ,i = 1 , 2 , 3i(1 ) 取 xs , d - (2 ) 取 k = 1 , 检查检验数的 P1 行 , 因该行无负检验数 , 故转 ( 5) 。, d -, d -12表 4 -1cjP1P2P2P3θCBX Bbx1x2xsd -1d+1d -2d +2d -3d+3P2P3xs d - d - 2 d - 311101056211811[2 ]10111111111/ 110/ 256/ 10P11cj - zjP2122P38101(3 ) 因 k( = 2 ) < K ( = 3 ) , 置 k = k + 1 = 3 , 返回到 (2 ) 。 (4 ) 查出检验数 P2 行中有 - 1、- 2 ; 取 min ( - 1 , - 2 ) = - 2。它对 应的变 量 x2 为 换入变量 , 转入 ( 3) 。表 4 -2CBcjX Bbx1x2xsd - 1P1 d + 1P2 d - 2P2 d+ 2P3 d - 3d + 3θP3xs d - x2 d -1365563/ 23/ 21/ 2[ 3]11111/ 21/ 21/ 251/ 21/ 21/ 2511410/ 3106/ 3P11cj - zjP211P33551(5 ) 在表 4 -1 上计算最小比值 :θ= min (11/ 1 , 0 , 10/ 2 , 56/ 10 ) = 10/ 2它对应的变量 d -2 为换出变量 , 转入 ( 4) 。·501·NÙ“(cid:8)Æ;2°€õí(cid:11)Øc²f(cid:30)Ø©²(cid:30)(cid:29)lØ4²f¨IlØ3²¿(cid:30)IlgL¨(cid:7)gL3(cid:7)gÂ7|(cid:7)a¯ô$ÞiÁ95¿’(cid:4)KÁ~×5¿(cid:4)ƒÁLP5(cid:4)¿(cid:144)aÁ‘g¨íPƒ~b¨~Öb53~(6 ) 进行基变换 运 算 , 得表 4 -2 , 返 回 到 ( 2 ) 。依 此 类 推 , 直至 得 到 最 终 表为 止。 见表 4 -3。表 4 -3 所示的解 x *1 = 2 , x *2 = 4 为例 1 的满意解。此 解相当于 图 4 -1 的 G 点。检 查表 4 -3 的检验数行 , 发现非基变量 d+3 的检验数为 0 , 这 表示存在多重解。在表 4 -3 中以非基变量 d+3 为换入变量, d -1 为换出变量 , 经迭代得到表 4 -4。由表4 -4得到解 x*1 = 10/ 3 , x*2= 10/ 3 , 此解相当于图 4 -1 的 D 点, G、D 两点的凸线性组合都是例 1 的满意解。表 4 -3CBcjX Bbx1x2xsd -1P1 d +1P2 d -2P2 d+2P3 d -3d +3θxs31221/ 21/ 26d - 1211331/ 21/ 24x2414/ 34/ 31/ 61/ 624x1215/ 35/ 31/ 31/ 3P11cj - zjP211P31表 4 -4CBcjX Bbx1x2xsd - 1P1 d + 1P2 d - 2P2 d+ 2P3 d - 3d + 3θxs111111d +34226611x210/ 311/ 31/ 31/ 31/ 3x110/ 312/ 32/ 31/ 31/ 3P11cj - zjP211P31第 4 节 灵敏度分析目标规划的灵敏度分析方法与线性规划相似 , 这里除分析各项系数的变化外 , 还有优先因子的变化问题 , 下面举例说明。 改变目标优先等级的分析。例 5 已知目标规划问题min z = P1 (2 d+1 + 3 d+2 ) + P2 d -3 + P3 d+4·601·Â7|(cid:7)$Þô¯aiÖÁ9J(cid:143)b’ÖÁK×Jb(cid:143)9ƒÁLPJ¿(cid:143)(cid:4)(cid:144)Á¿J(cid:143)(cid:4)(cid:7)(cid:144)~b¨~~íÂ7|(cid:7)Þ$¯aôi¿c4’î(cid:7)3c4¿(cid:28)î(cid:7)ƒL4c¿(cid:7)îƒ4c¿î(cid:7)(cid:7)ƒ~b¨~~íx1 + x2 + d - + d - x1 5 x1 + 3 x2 + d - x1 + x2 + d - , d+ x1 , x2 , d -d+ - d+ - d+ - d+ i ≥ 0 , 41 = 1012 = 423 = 564 = 12i = 1 , … , 4在得到最终表后 , 见表 4 -5 。目标函数的优先等级变化为 : (1 ) min z = P1 (2 d+ (2 ) min z = P1 d - 试分析原解有什么变化。1 + 3 d+ 3 + P2 (2 d+2 ) + P2 d+ 1 + 3 d+4 + P3 d - 2 ) + P3 d+34解 分析 ( 1 ) , 实 际 是 将 原 目 标 函 数 中 d+4, d -3 的 优 先 因 子 对 换 了 一 下。 这 时 将表 4 -5的检验数中的 P2 、P3 行和 cj 行的 P2 、P3 对换即 可。这 时可见 原解 仍满足 最优 解 条件。表 4 -5cj2 P13 P1P2P3CBX Bbx1x2d -1d +1d -2d +2d -3d+3d -4d+4x2611111x14111P2d - 3 d -418213131221111P123cj - zjP233221P31分析 (2) , 将变化了的优先等级直接反映到表 4 -5。再计算检验数 , 得表 4 -6。然后进行迭代 , 直到求得新的满意解为止。从表 4 -7 中得到新的满意解 x *1 = 4 , x*2 = 12。表 4 -6cj2 P23 P2P1P3CBX Bbx1x2d -1d +1d -2d +2d -3d+3d -4d+4x2611111x14111P1d - 318332211d -421[ 1]11P133221cj - zjP223P31·701·ÂS“(cid:8)a(cid:27)™@$Þô:¯i™ÁÞai$(cid:144)Á$i(cid:27)(cid:144)ÀKØ×¨b(cid:28)PƒÀÁ×g(cid:7)3ƒ×b~~í’9~Â“S(cid:8)@™:Þ¯$ôai(cid:27)™ÁÞ$ia(cid:144)Á$i(cid:27)(cid:144)™Á$Þô¯iP(cid:144)@™Á:(cid:144)~í’×b~9~表 4 -7cj2 P23 P2P1CBX Bbx1x2d - 1d + 1d - 2d + 2d - 3d+ 3d - 4x281111x14111P1d - 312221132 P2d+12111P12213cj - zjP223P3x21215/ 35/ 31/ 31/ 3x14111P3d+442/ 32/ 31/ 31/ 31d+ 16112/ 32/ 31/ 31/ 3P11cj - zjP223P32/ 32/ 31/ 31/ 3第 5 节 应 用 举 例例 6 某单位领导在考虑本单位职工的升级调资方案时 , 依次遵守以下规定 : (1 ) 不超过年工资总额 60000 元 ; (2 ) 每级的人数不超过定编规定的人数 ; (3 ) Ⅱ , Ⅲ级的升级面尽可能达到现有人数的 20 % , 且无越级提升 ; (4 ) Ⅲ级不足编制的人数可录用新职工 , 又Ⅰ级的职工中有 10 % 要退休。 有关资料汇总于表 4 -8 中 , 问该领导应如何拟订一个满意的方案。表 4 -8等 级工资额 (元/ 年 )现有人数编制人数Ⅰ20001012Ⅱ15001215Ⅲ10001515合 计3742解 设 x1 、x2 、x3 分别表示提升到Ⅰ、Ⅱ级和录用到Ⅲ级的新职工人数。对各目标 确定的优先因子为 :P1 ———不超过年工资总额 60000 元 ;P2 ———每级的人数不超过定编规定的人数 ; P3 ———Ⅱ、Ⅲ级的升级面尽可能达到现有人数的 20 % 。·801·P3d+ 41[ 3]13211Â“S(cid:8)@™:ôÞ$¯ai(cid:27):Áa$ig(cid:144)Á$i(cid:27)(cid:144):Á$ôi¯P(cid:144)™Á:Þg(cid:144)g3g‘í(cid:29)~g’‘~g~ØÖLyJ(cid:144)(cid:144)Ø(cid:144)y(cid:7)(cid:144)ÖØ(cid:144)yaJ9P(cid:144)ØÖÀ×yJ(cid:144)(cid:144)~î×¨~Jy¨î~×¨×¨×¨¨先分别建立各目标约束。年工资总额不超过 60000 元 :2000( 10 - 10× 0. 1 + x1 ) + 1500( 12 - x1 + x2 ) + 1000( 15 - x2 + x3 ) + d -1d +1 = 60000每级的人数不超过定编规定的人数 : 10 (1 - 0. 1) + x1 + d - 对Ⅰ级有 - d+ 12 - x1 + x2 + d - 对Ⅱ级有 - d+ 15 - x2 + x3 + d - 对Ⅲ级有 Ⅱ , Ⅲ级的升级面不大于现有人数的 20 % , 但尽可能多提 ; 5 = 12×0. 2 对Ⅱ级有 6 = 15×0. 2 对Ⅲ级有 目标函数 : min z = P1 d+ 3 + d+ 以上目标规划模型可用单纯形法求解 , 得到多重解。 现将这些 解汇总于 表 4 -9 , 这 单d +2 = 1223 = 1534 = 154x1 + d - x2 + d -d + - d +562 + d+1 + P2 ( d+4 ) + P3 ( d -5 + d -6 )位的领导再按具体情况 , 从表 4 -9 中选一个执行方案。表 4 -9变 量含 义解 1解 2解 3解 4x1晋升到Ⅰ级的人数2. 42. 433x2晋升到Ⅱ级的人数3335x3新招收Ⅲ级的人数0335d - 1工资总额的结余额6300330030000d -2Ⅰ级缺编人数0. 60. 600d - 3Ⅱ级缺编人数2. 42. 431d -4Ⅲ级缺编人数300. 60d+ 5Ⅱ级超编人数0000. 6d+6Ⅲ级超编人数0002例 7 已知有三个产地给四个 销地 供应某 种产 品 , 产销 地之 间的 供需 量 和单 位运 价 见表 4 -10 。有关部门在研 究 调 运方 案 时依 次 考虑 以 下七 项 目 标 , 并 规定 其 相应 的 优 先 等级 :P1 ——— B4 是重点保证单位 , 必须全部满足其需要 ; P2 ——— A3 向 B1 提供的产量不少于 100 ; P3 ———每个销地的供应量不小于其需要量的 80 % ; P4 ———所定调运方案的总运费不超过最小运费调运方案的 10 % ; P5 ———因路段的问题 , 尽量避免安排将 A2 的产品往 B4 ; P6 ———给 B1 和 B3 的供应率要相同 ; P7 ———力求总运费最省。 试求满意的调运方案。·901·œ†\(cid:17)œ‘†\(cid:28)(cid:17)‘œ†\(cid:17)‘œ†\(cid:17)‘œ†\(cid:17)ƒœ‘†\(cid:17)(cid:28)ƒœ‘†\(cid:28)(cid:17)ƒ§œ†\(cid:17)ƒœ†g\(cid:17)ƒœ†\(cid:17)ƒ表 4 -10产地销地B1B2B3B4产量A15267300A23546200A34523400销 量200100450250900/ 1000解 用表上作 业法 求 得 最 小 运费 的 调 运 方 案见 表 4 -11。 这 时 得 最 小 运 费 为 2950元 , 再根据提出的各项目标的要求建立目标规划的模型。表 4 -11产地销地B1B2B3B4产量A1200100300A20200200A3250150400虚设点100100销量2001004502501000/ 1000供应约束x11 + x12 + x13 + x1 4 ≤300 x21 + x22 + x23 + x2 4 ≤200 x31 + x32 + x33 + x3 4 ≤400需求约束x11 + x21 + x31 + d - x12 + x22 + x32 + d - x13 + x23 + x33 + d - x14 + x24 + x34 + d -1234d+ - d+ - d+ - d+1 = 2002 = 1003 = 4504 = 250A3 向 B1 提供的产品量不少于 100d+ 每个销地的供应量不小于其需要量的 80 % x11 + x21 + x3 1 + d - x12 + x22 + x3 2 + d - 5 = 100x31 + d -d+ - d+6 = 200 ×0. 8 7 = 100 ×0. 8x13 + x23 + x3 3 + d - x14 + x24 + x3 4 + d -89d+ - d+8 = 450 ×0. 89 = 250 ×0. 8调运方案的总运费不超过最小运费调运方案的 10 %34∑ 因路段的问题 , 尽量避免安排将 A2 的产品运往 B4∑10 - d+ci j x i j + d -1 0 = 2950( 1 + 10 % )i = 1j = 1x2 4 + d -11 - d+11 = 0给 B1 和 B3 的供应率要相同( x11 + x21 + x31 ) -200 450( x13 + x23 + x33 ) + d -12 - d+12 = 0·011·Ú{ðeÚP{eð#ÚP{ðe#ÚP{ðe#ÚPeð{Úð{eÚPe#ÚPð#P{ð#P{ÚPð{e力求总运费最省34∑∑ci j x i j + d -13 - d+13 = 2950i = 1j = 1目标函数为 :min z = P1 d - P5 d+4 + P2 d - 1 1 + P6 ( d -5 + P3 ( d - 12 + d+6 + d - 12 ) + P7 d+7 + d -8 + d -9 ) + P4 d+1 310 +计算结果 , 得到满意调运方案见表 4 -12。总运费为 3360 元。表 4 -12产地销地B1B2B3B4产量A1100200300A290110200A310025050400虚设点1090100销 量2001004502501000/ 1000注记用单纯形法求解线性规划问题是令人满意的算法。但在 1972 年 V .Klee 和 G . Mint y 构造了一个 n 个变量 2 n 个不等约束的例子。用单纯形法求解此线性规划问题时 , 其计算次数为 2 n 。从计算复杂性的 标准来看 , 凡算法所需计 算工 作量是 问题 规模 (变 量数 或方 程数 ) n 的多 项式 函数 时 , 这 算法 为 有效 算 法 , 如高斯消去法的计算量为 n3 / 3 的 加法 , n3/ 2 的乘 法 , n2/ 2 的除法。即 为 0 ( kn3 )。 若某算 法的计 算 量是问题规模的指数式函数 an 时 , 就不是有效算法。因而不能肯定单纯形法是有 效算法。于是就 产生一问题 , 能否找到一种解 线性 规划问 题的 肯定 的多 项式 算法。1979 年苏 联 科学 院 计算 中心 的 哈奇 扬 ( XAЧИЯН) 发表了求解线性规划问题的多项式算 法一文 , 解 决了这 问题。他提 出的椭 球算法 , 并证 明 了线性规划问题存在多项式算法。但哈奇扬的椭球算法在应用时 , 迭代次数比单纯形法要 多得多 , 因此实用价值不大 , 但理论 上 意义 很大。 此后 卡玛 卡 尔 ( N . Kar marka r) 又提 出 了一 种 新的 投影 尺 度算 法 [11 ]。它本质上是一种内点算法 , 也属多项式算法。习题4. 1 若用以下表达式作为目标规划的目标函数 , 试述其逻辑是否正确 ? (1 ) max z = d - + d+ (3 ) min z = d - + d+ 4. 2 用图解法找出以下目标规划问题的满意解。 2 + d + min z = P1 ( d -d + - d+1 ) + P2 (2 d+ - d+ - d+ - d+1 + d+3 )(1 )x1 - 10 x2 + d - 3 x1 + 5 x2 + d - 8 x1 + 6 x2 + d - x1 , x2 , d -1 = 5012 = 2023 = 100 i ≥0 , i = 1 , 2 , 33, d+i·111·Ú{ðeP{e#ÚPð#ÚP{ð#ÚPðÚÚeð{(2 )min z = P1 ( d+3 + d+4 ) + P2 d+ - d+ 1 = 40 - d+ - d+1 + P3 d -x1 + x2 + d - x1 + x2 + d - + d -12 = 10023 = 30x132 + P4 ( d -3 + 1. 5 d -4 )x2 + d -4d+4 = 15(3 )x1 , x2 , d -, d+ 1 + d+i ≥0 , i = 1 , 2 , 3 , 4 2 + P3 d+ 1 ) + P2 d -imin z = P1 ( d -3x1 + x2 + d - 3 x1 + 4 x2 + d - 8 x1 + 10 x2 + d - x1 , x2 , d -d+ - d+ - d+1 = 1012 = 5023 = 300 i ≥0 , i = 1 , 2 , 33, d+i4. 3 用单纯形法求解以下目标规划问题的满意解。(1 )(2 )min z = P1 d+2 + P1 d -2 + P2 d - - d+ - d+1x1 + 2 x2 + d - 10 x1 + 12 x2 + d -1 = 1012 = 62. 4 ≤82x22 x1 + x1 , x2 , d -, d+ 1 + P2 d+i ≥0 , i = 1 , 2 2 + P3 (5 d - - d+ - d+ - d+ - d+i3 + 3 d -min z = P1 d -4 ) + P4 d+x1 + x2 + d - x1 + x2 + d - + d - x2 + d -1 = 8012 = 902x13 = 7034 = 4541(3 ), d+ 1 + d+ x1 + x2 + d - 2 x1 + 2 x2 + d - 6 x1 - 4 x2 + d - , d+ x1 , x2 , d -x1 , x2 , d -i ≥0 , i = 1 , 2 , 3 , 4 2 ) + P2 d - - d+ - d+ - d+imin z = P1 ( d+31 = 112 = 423 = 503i ≥0 , i = 1 , 2 , 3i4. 4 以下目标规划问题min z = P1 d -1 + P2 d+ x1 + x2 + d - + d - x2 + d - 1 + d - d+ x1 , x2 , d -4 + P3 (5 d -2 + 3 d -3 ) + P3 (3 d+d+ - d+ - d+ - d+ i ≥0 ,1 = 8012 = 70x123 = 4534 = 104, d+i = 1 , 2 , 3 , 4i2 + 5 d+3 )(1 ) 用单纯形法求这问题的满意解。 (2 ) 若目标函数变为min z = P1 d -1 + P2 (5 d -2 + 3 d -3 ) + P2 (3 d+2 + 5 d+3 ) + P3 d +4·211·问原满意解有什么变化 ?(3 ) 若第一个目标约束的右端项改为 120 , 这时原满意解又有什么变化 ? 4. 5 某工厂生产两种产品 , 每件产品Ⅰ可获利 10 元 , 每件产品Ⅱ可获利 8 元。每生产一件产品Ⅰ, 需要 3 小 时; 每生产 一件产 品Ⅱ, 需要 2. 5 小时。每 周总的有 效时间 为 120 小时。 若加班生产 , 则每件产品Ⅰ的利润降低 1. 5 元 ; 每件产品Ⅱ的利润降低 1 元。决策者希望在允 许的工作及加班时间内取最大利润, 试建立该问题的目标规划模型, 并求解。4. 6 某商标的酒是用三种等级的酒兑 制而 成。若这 三种 等级的 酒每 天供应 量和 单位成本为 :等 级日供应量( kg)成本 ( 元/ kg)Ⅰ1 5006Ⅱ2 0004. 5Ⅲ1 0003设该种牌号酒有三种商 标 ( 红、黄、蓝 ) , 各 种 商标 的酒 对原 料 酒的 混 合比 及 售价 , 见 表 4 -13 。决策者规定 : 首先必须严格按规定比例兑制各商标 的酒 ; 其次是 获利最 大 ; 再 次 是红商标的酒每天至少生产 2000kg , 试列出数学模型。表 4 -13商 标兑制要求售价 ( 元/ kg)红Ⅲ少于 10 %Ⅰ多于 50%5. 5黄Ⅲ少于 70 %Ⅰ多于 20%5. 0蓝Ⅲ少于 50 %Ⅰ多于 10%4. 8参 考 资 料[1] Gas s S I .Linea r Programming Met hods and A pplications , Fif th Edition Mc-Gr aw Hill Book Com pa-ny , 1984[2] 管梅谷等 . 线性规划 . 济南 : 山东科技出版社 , 1983[3] 赵凤治 . 线性规划计算方法 . 北京 : 科学出版社 , 1981[4] 裘宗沪 .解线性规划的单纯形算法中避免循环的几种方法 . 数学的实践与认识 , 1978 年 , 第 4 期[5] H adley G . Linea r P rogramming , Addison Wesley .Ten th pr inting , 1978[6] Baza raa . M S .Lin ear P rogr amming and Network Flow .Second ed .John Wiley & Sons , 1990[7] Williams H P . Model Building in Ma thematical Programming . Th ird ed Wiley , 1990[8] J .P .Ignizio .Goal Programming and E xtensions , D .C .H eat h a nd Com pany , 1976[9] H .A .Tah e, Op erations Research - An In troduction , Seve nt h ed .Pear son Education Ine .2003[10 ] 越民义、椭球算法介绍。运筹学杂志 , 1983 年 , 第 1 期[11 ] N .Kar marka r .A New Polyno mial Time A rgor it hm for Linear Progamming .Proceedings of 16 thAnnual ACM Symposium on T heory of Com pu ting .1984 .·311·D"D"D"®£®£®£三、整 数 规 划第 5 章 整 数 规 划第 1 节 整数规划问题的提出在 前面 讨论的 线性 规划问 题中 , 有 些最 优解可 能是 分数 或小数 , 但 对于 某些 具体 问 题 , 常有要求解答必须是整数的情形 ( 称为整 数解 ) 。例如 , 所求解 是机 器的台 数、完成 工 作的人数或装货的车数等 , 分数或小数的解答就不合要求。为了满足整数解的要求 , 初看 起来 , 似乎只要把已得到的带有分数或小数 的解经 过“舍 入化整”就可以 了。但这 常常 是 不行的 , 因为化整后不见得是可行解 ; 或虽是可行解 , 但不一定是最优解。因此 , 对求最优 整数解的问题 , 有必要另行研究。我们称这样的问题为整数规划 ( integer progr amming) , 简称 IP , 整数规划是最近几十年来发展起来的规划论中的一个分支。整数规划中如果所有的变数都 限制 为 ( 非 负 ) 整数 , 就 称为 纯 整数 规划 ( pure in tege r progra mmi ng ) 或称为全整数规划 ( all in tege r progra mming) ; 如果仅一部分变数限制为整 数 , 则称为混合整数计划 ( mixed in teger progr amming) 。整数规划的一种特殊情形是 0 - 1 规划 , 它的变数取值仅限于 0 或 1 。本章最后讲到的指派问题就是一个0 - 1 规划问题。现举例说明用前述单纯形法求得的解不能保证是整数最优解。例 1 某厂拟用集装箱托运甲乙 两种 货物 , 每 箱的 体积、重量、可 获利 润 以及 托运 所受限制如表 5 -1 所示。问两种货物各托运多少箱 , 可使获得利润为最大 ?表 5 -1货 物甲体积 ( 米3 / 箱 ) 5重量 ( 百公斤/ 箱)2利润 ( 百元/ 箱 )20乙托运限制4 24 米35 13 百公斤10现在我们解这个问题 , 设 x1 , x2 分别为甲、乙 两种货 物的 托运箱 数 ( 当 然都是 非负 整数 ) 。这是一个 ( 纯 ) 整数规划问题 , 用数学式可表示为 :max z = 20 x1 + 10 x2 5 x1 + 4 x2 ≤242 x1 + 5 x2 ≤13 x1 , x2 ≥0 x1 , x2 整数·411·①②③④⑤( 5 -1)©"(cid:7)©"(cid:7)它和线性规 划 问 题 的 区 别 仅 在 于 最 后 的 条 件 ⑤。 现 在 我 们 暂 不 考 虑 这 一 条 件 , 即 解 ①～④ ( 以后我们称这样的问题为与原问题相应的线性规划问题 ) , 很容易求得最优解为x1 = 4. 8 , x2 = 0 , m ax z = 96但 x1 是托运甲种货物的箱数 , 现在它不是整数 , 所以不合条件⑤的要求。是不是可以把所得的非整数的最优解经过“化整”就可得到合于条件⑤的整数最优解呢 ? 如将 ( x1 = 4. 8 , x2 = 0 ) 凑整 为 ( x1 = 5 , x2 = 0) , 这样 就破坏 了条 件② ( 关于体 积的 限 制 ) , 因而它不是可行解 ; 如将 ( x1 = 4. 8 , x2 = 0) 舍去 尾数 0. 8 , 变 为 ( x1 = 4 , x2 = 0 ) , 这 当 然满足各约束条件 , 因而是可行解 , 但不是最优解 , 因为当 x1 = 4 , x2 = 0 时 z = 80 , 但当 x1 = 4 , x2 = 1 ( 这也是可行解 ) 时 , z = 90 。 本例还可以用图 解法 来 说明。见 图 5 -1 非整 数的最优解在 C( 4. 8 , 0) 点达到。图中画 ( + ) 号的 点表示可 行 的整 数 解。 凑整 的 ( 5 , 0 ) 点 不在 可 行 域内 , 而 C 点 又不 合 于 条 件 ⑤。为 了 满 足题 中 要 求 , 表示目 标函 数 的 z 的 等 值 线必 须 向 原 点 平 行 移动 , 直到第一次遇到带“ + ”号 B 点 ( x1 = 4 , x2 = 1) 为止。这样 , z 的等值线就由 z = 96 变到 z = 90 , 它们的差值图 5 -1Δz = 96 - 90 = 6表示利润的降低 , 这是由于变量的不可分性 ( 装箱 ) 所引起的。由上例看出 , 将其相应的线性规划的最优解“ 化整”来解原整数规划 , 虽是最容易想到 的 , 但常常得不到整数规划的最优解 , 甚至根本不是可行解。因此有必要对整数规划的解 法进行专门研究。第 2 节 分支定界解法在求解整数规划时 , 如果可行域是有界的 , 首先容易想到的方法就是穷举变量的所有 可行的整数组合 , 就像在图 5 -1 中画出所有“ + ”号的点那样 , 然后比较它们的目标函数值 以定出最优解。对于小型的问题 , 变量数很少 , 可 行的 整数 组合数 也是 很小时 , 这 个方 法 是可行的 , 也是有效的。在例 1 中 , 变量只有 x1 和 x2 ; 由条件② , x1 所能取的整数值为 0、 1、2、3、4 共 5 个 ; 由条 件③ , x2 所能取 的整 数值 为 0、1、2 共 3 个 , 它的 组合 ( 不都 是可 行 的 ) 数是 3× 5 = 15 个 , 穷举法还是勉强可用的。对于大型的问题 , 可行的整数组合数是很 大的。例如在本章第 5 节的指派问题 ( 这也是 整数规划 ) 中 , 将 n 项任 务指派 n 个 人去 完 成 , 不同的指派方案共有 n ! 种 , 当 n = 10 , 这个数就超过 300 万 ; 当 n = 20 , 这 个数就超 过 2×1018 , 如果一一计 算 , 就是 用每秒百万次的 计算机 , 也要几万年的功 夫 , 很 明显 , 解 这样 的题 , 穷举法是不可取的。所以我们的方法一般应是仅检查可行的整数组合的一部分 , 就 能定出最优的整数解。分支定界解法 ( br anch and bound met hod ) 就是其中的一个。分支定界法可 用于解 纯整数或 混合的整 数规划 问题。在 20 世 纪 60 年代 初由 Land Doig 和 Dakin 等人提出。由于这方法灵活且便于用计算 机求解 , 所 以现在它 已是解整 数·511·规划的重要方法。设有最大化的整数规划问题 A, 与它相应的线性规划为问题 B, 从解 问 题 B 开始 , 若其最优解不符合 A 的整数条件 , 那么 B 的最优目标函数必是 A 的最优目 标 函数 z * 的上界 , 记作 z- ; 而 A 的任意可行解的目 标函数 值将 是 z * 的一 个下 界 z。分支 定 界法就是将 B 的可行域分成子区域 ( 称为分 支 ) 的 方法 , 逐步减 小- 和增大 z, 最终 求到 z * 。 现用下例来说明 : 例 2 求解 Amax z = 40 x1 + 90 x2 9 x1 + 7 x2 ≤56 7 x1 + 20 x2 ≤70①②③x1 , x2 ≥0 x1 , x2 整数④⑤解 先不考虑条件⑤ , 即解相应的线性规划 B①～④ ( 见图 5 -2 ) , 得最优解x1 = 4. 81 ,x2 = 1. 82 ,z0 = 356图 5 -2可见它不符合整数条件⑤。这时 z0 是问题 A 的最 优目标函 数值 z * 的 上界 , 记作 z0= z。而 x1 = 0 , x2 = 0 时 , 显 然是 问 题 A 的 一个 整 数可 行 解 , 这 时 z = 0 , 是 z * 的一 个 下 界 , 记作 z = 0 , 即 0≤ z* ≤356。分支定界法的解法 , 首先注意 其中 一个 非整 数 变量 的解 , 如 x1 , 在问 题 B 的 解中 x 1= 4. 81 。于是对原问题增加两个约束条件x1 ≤ 4 , x1 ≥ 5 可将原问题分解为两个子问题 B1 和 B2 ( 即两支 ) , 给每支 增加一个 约束条 件 , 如图 5 -3 所 示。这并不影响问题 A 的可行域 , 不考虑整数条 件解问题 B1 和 B2 , 称此 为第一次 迭代。 得到最优解为 :问题 B1问题 B2z1 = 349z2 = 341x1 = 4. 00x1 = 5. 00x2 = 2. 10x2 = 1. 57·611·( 5 -2)¯¤««¯¤显 然 没 有 得 到 全 部 变 量 是 整 数 的 解。 因 z1 >z2 , 故将 z 改 为 349 , 那 么 必 存 在 最 优 整 数 解 , 得 到 z*, 并且0 ≤ z * ≤ 349 继续对问题 B1 和 B2 进行分解 , 因 z1 > z2 , 故 先分解 B1 为两支。增加 条件 x2 ≤ 2 者 , 称 为 问 题 B3 ; 增 加 条件 x2 ≥ 3 者 称 为 问 题 B4 。 在 图 5 -3 中 再 舍 去 x2 > 2与 x3 < 3 之 间 的 可 行 域 , 再 进 行 第 二 次 迭 代。 解题过程的结 果 都 列 在 图 5 -4 中。 可见 问 题 B3 的 解已都是整数 , 它 的目 标 函 数值 z3 = 340 , 可 取 为 z ,图 5 -3而它大于 z4 = 327。所以再分解 B4 已无必要。而问题 B2 的 z2 = 341 , 所以 z* 可能在 340 ≤ z* ≤341 之间有整数 解。于是对 B2 分解 , 得 问题 B5 , 既 非整数解 , 且 z5 = 308 < z3 , 问题 B6 为无可行解。于是可以断定z3 = z = z * = 340问题 B3 的解 x1 = 4. 00 , x2 = 2. 00 为最优整数解。图 5 -4·711·从以上解题过程可得用分支定界法求解整数规划 ( 最大化 ) 问题的步骤为 : 将要求解的整数规划问题称为问题 A , 将与它相应的线性规划问题称为问题 B。 (1 ) 解问题 B, 可能得到以下情况之一。 ① B 没有可行解 , 这时 A 也没有可行解 , 则停止。 ② B 有最优解 , 并符合问题 A 的整数条件 , B 的最优解即为 A 的最优解 , 则停止。 ③ B 有最优解 , 但不符合问题 A 的整数条件 , 记它的目标函数值为 z0 。 (2 ) 用观察法找问题 A 的一 个整数 可行 解 , 一般 可取 x j = 0 , j = 1 , … , n, 试探 , 求 得其目标函数值 , 并记作 z。以 z * 表示问题 A 的最优目标函数值 ; 这时有z≤ z* ≤ z进行迭代。第一步 : 分支 , 在 B 的最 优 解 中 任 选一 个 不 符 合 整 数 条 件 的 变 量 x j , 其值 为 bj , 以[ bj ] 表示小于 bj 的最大整数。构造两个约束条件x j ≤ [ bj ] 和 xj ≥ [ bj ] + 1 将这两个约束条件 , 分别加入问题 B, 求两个后继规划问题 B1 和 B2 。不考虑 整数条件 求 解这两个后继问题。定界 , 以每个后继问题为一分支标明求解 的结 果 , 与其 他问题 的解 的结果 中 , 找出 最 优目标函数值最大者作为新的上界 z- 。从 已符合 整数 条件 的各分 支中 , 找 出目标 函数 值 为最大者作为新的下界 z, 若无可行解 , z = 0。第二步 : 比较与剪支 , 各分支的最优目标函数中若有小于 z 者 , 则剪掉 这支 ( 用打× 表 示 ) , 即以后不再考虑了。若大于 z, 且不符合 整数条 件 , 则重 复第 一步骤。 一直到 最后 得 到 z * = z 为止 , 得最优整数解 x *, j = 1 , … , n。j用分支定界法可解纯整数规划问题和混合整数规划问题。它比穷举法优越。因为它仅在一部分可行解的整数解中寻求最优解 , 计算量比穷举法小。若变量数目很大 , 其计算 工作量也是相当可观的。第 3 节 割平面解法这个方法的基础仍然是用解线性规划的方法去 解整数规 划问题 , 首先 不考 虑变量 xi 是整数这一条件 , 但增加线性约束条件 ( 用几何术语 , 称为割平面 ) 使得由原可行域中切割 掉一部分 , 这部分只包含非整数解 , 但没有切割掉任何整数可行解。这个方法就是指出怎 样找到适当的割平面 ( 不见得一次就找到 ) , 使切割后最终得到这样的可行域 , 它的一个有 整数坐标的极点恰好是问题的最优解。这个方法是 R .E .Gomory 提出 来的 , 所以又称 为 Gomory 的割平面法。以下只讨论纯整数规划的情形 , 现举例说明。例 3 求解max z = x1 + x2x1 + x2 ≤ 1 3 x1 + x2 ≤ 4 x1 , x2 ≥0 x1 , x2 整数·811·①②③④⑤( 5 -3)如不考虑条件⑤ , 容易求得相应的线性规划的最优解 :x1 =3 4, x2 =7 4, max z =10 4它就是图 5 -5 中域 R 的极点 A , 但不合于整数条件。现设想 , 如能找到像 CD 那样的直线去切割域 R( 图 5 -6 ) , 去掉三角形域 ACD, 那么具有整数坐标的 C 点 ( 1 , 1) 就是域 R′ 的一个极点 , 如在域 R′上求解①～④ , 而得 到的 最优解 又恰 巧在 C 点 就得 到原问 题的 整 数解 , 所以解法的关键就是怎样构造一个这样的“ 割平面”CD, 尽管它可能不是唯 一的 , 也 可能不是一步能求到的。下面仍就本例说明 :图 5 -5图 5 -6在原问题的前两个不等式中增加非负松弛变量 x3 、x4 , 使两式变成等式约束 :x1 + x2 + x3= 1⑥3 x1 + x2 + x4 = 4⑦不考虑条件⑤ , 用单纯形表解题 , 见表 5 -2。从表 5 -2 的最终计算表中 , 得到非整数的最优解 :表 5 -2cj1100CBXBbx1x2x3x40x311110初始计算表0x443101cj - zj011001x13/ 4101/ 41/ 4最终计算表1x27/ 4013/ 41/ 4cj - zj5/ 2001/ 21/ 2x1 =3 4, x2 =7 4, x3 = x4 = 0 , max z =5 2由最终计算表中得到变量间的关系式 :x1 -1 4x3 +1 4x4 =3 4x2 +3 4x3 +1 4x4 =7 4·911·KPz(cid:28)1e(cid:143)`ØKp(cid:127)(cid:7)zíØKpz(cid:127)K~×z(cid:7)yíKzy将系数和常数项都分解成整数和非负真分数之和 , 移项以上两式变为x1 - x3 =3 43 4x3 +1 4x43 4 现考虑整数条件⑤ , 要求 x1 、x2 都是非负 整数 , 于 是由 条件⑥、⑦可 知 x3 、x4 也都 是 非负整数 ① 。在上式中 ( 其实只考 虑一式 即可 ) 从等 式左 边 看是 整数 ; 在 等 式右 边的 ( · ) 内是正数 ; 所以等式右边必是负数。就是说 , 整数条件⑤可由下式所代替 ;3 41 4x2 - 1 =x3 +x43 43 4x3 +1 4x4 ≤0即3 x3 - x4 ≤ - 3这就得到一个切割方程 , 将它作为增加约束条件 , 再解例 3。 引入松弛变量 x5 , 得到等式3 x3 - x4 + x5 = - 3将这新的约束方程加到表 5 -2 的最终计算表 , 得表 5 -3。从表 5 -3 的 b 列中可看到 , 这时得到的是非可行解 , 于是需要用对偶单纯形法继续 进行计算。选择 x5 为换出变量 , 计算θ= minjcj - zj αl jαl j < 0 = min1 2 - 3,1 2 - 1=1 6表 5 -3cj1100CBX Bbx1x2x3x41x13/ 4101/ 41/ 41x27/ 4013/ 41/ 40x530031cj - zj5/ 2001/ 21/ 2将 x3 做为换入变量 , 再按原单纯形法进行迭代 , 得表 5 -4。表 5 -4cj1100CBX Bbx1x2x3x41x111001/ 31x2101000x310011cj - zj20001/ 3① 这一 点对以 下推导 是必 要的 , 如 不都是 整数 , 则 应在引 入 x3 、x4 之前乘 以适 当常数 , 使 之都 是整数 。·021·0x500100x51/ 121/ 41/ 31/ 6⑧–(cid:144)‘‘’¥¥¦ª¦À¾“–‘’í§À¾“–’‘í§¾À“–í‘’§–í‘í’–(cid:144)’‘‘¥¥¦ª¦¾Û“‘’’‘§Û¾“’‘‘’§Û¾“’’‘‘§‘’‘由于 x1 、x2 的值已都是整数 , 解题已完成。注意 : 新得到的约束条件⑧3 x3 - x4 ≤ - 3如用 x1 、x2 表示 , 由⑥、⑦式得3 (1 + x1 - x2 ) + ( 4 - 3 x1 - x2 ) ≥3 x2 ≤1 这就是 ( x1 , x2 ) 平 面 上 平 行 于 x1 轴 的 直 线 下 的 区 域 , 见 图 5 -7。但从解题过程来看 , 这一步是不必要的。现把求一个切割方程的步骤归纳为 : (1 ) 令 xi 是相应线性规划最优解中为分数值的一个基 变图 5 -7量 , 由单纯形表的最终表得到xi + ∑αi k x k = bi( 5 -4)k其中 i∈ Q( Q 指构成基变量号码的集合 )k∈ K( K 指构成非基变量号码的集合 ) (2 ) 将 bi 和αi k 都分解成整数部分 N 与非负真分数 f 之和 , 即bi = Ni + f i , 其中 0 < f i < 1 αi k = Ni k + f i k , 其中 0≤ f i k < 1( 5 -5)而 N 表示不超过 b 的最大整数。例如 : 若 b = 2. 35 , 若 b = - 0. 45 ,则 N = 2 , f = 0. 35则 N = - 1 , f = 0. 55代入 (5 -4) 式得x i + ∑N i k x k - Ni = f i - ∑f i k x k( 5 -6)kk(3 ) 现在提出变量 ( 包括松弛变量 , 参阅例 3 的注 ) 为整数的条件 ( 当然还 有非负的 条件 ) , 这时 , 上式由左边看必须是整数 , 但由右边看 , 因为 0 < f i < 1 , 所以不能为正 , 即f i - ∑f i k x k ≤0( 5 -7)k这就是一个切割方程。由 (5 -4) 式 , ( 5 -6) 式 , ( 5 -7) 式可知 : ① 切割方程 (5 -7) 式真正进行了切割 , 至少把非整数最优解这一点割掉了。 ② 没有割掉整数解 , 这是因为 相应 的线性 规划 的任 意整数 可行 解都满 足 (5 -7 ) 式 的缘故。Gomory 的切割法自 1958 年被提出后 , 即引起人 们广泛的 注意。但至 今完全 用它 解 题的仍是少数 , 原因就是经常遇到收敛很慢 的情形。 但若 和其他 方法 ( 如 分枝 定界 法 ) 配 合使用 , 也是有效的。·121·第 4 节 0 - 1 型整数规划0 - 1 型整数规划是整数 规划中 的特 殊情 形 , 它 的 变量 xi 仅取 值 0 或 1。这 时 xi 称为0 - 1 变量 , 或称二进制变量 ①。 xi 仅取值 0 或 1 这个条件可由下述约束条件所代替。 xi ≤ 1 xi ≥ 0 , 整数 它和一般整数规划的约束条件形式是一致的。 在实 际问题 中 , 如果 引入 0 - 1 变量 , 就可以把有各种情况需要分别讨论的线性规划问题统一在一个问题中讨论了。在本节我们先介绍引入 0 - 1 变量的实际问题 , 再研究解法。4. 1 引入 0 - 1 变量的实际问题1. 投资场所的选定———相互排斥的计划例 4 某公司拟在市东、西、南 三区 建 立门 市 部。拟 议 中有 7 个 位置 ( 点 ) Ai ( i = 1 ,2 , … , 7 ) 可供选择。规定 :在东区 , 由 A1 , A2 , A3 三个点中至多选两个 ; 在西区 , 由 A4 , A5 两个点中至少选一个 ; 在南区 , 由 A6 , A7 两个点中至少选一个。 如选用 A i 点 , 设备投资估计为 bi 元 , 每 年可 获利润 估计 为 ci 元 , 但投 资总额 不能 超过 B 元。问应选择哪几个点可使年利润为最大 ? 解题时先引入 0 - 1 变量 xi ( i = 1 , 2 , … , 7)令x i =1 , 当 A i 点被选用 , 0 , 当 A i 点没被选用。i = 1 , 2 , … , 7于是问题可列成 :7max z = ∑ci x ii = 17∑bi x i ≤ Bi = 1x1 + x2 + x3 ≤2 x4 + x5 ≥ 1 x6 + x7 ≥ 1 x i = 0 或 1① 如果 变量 x i 不 是仅 取 值 0 或 1 , 而 是 可取 其 他范 围 的非 负 整数 , 这 时可 利 用二 进 制的 记 数法 将 它用 若 干个0 - 1变 量来 代替。 例如 , 在 给定的 问题 中 , 变量 x 可任取 0 与 10 之 间的 任意整 数时 , 令x = 2 0 x0 + 21 x1 + 22 x2 + 2 3 x3这时 , x 就可用 4 个 0 - 1 变量 x0 , x1 , x2 , x3 来代 替。·221·( 5 -8)2. 相互排斥的约束条件在本章开始的例 1 中 , 关于运货的体积限制为 5 x1 + 4 x2 ≤24 ( 5 -9) 今设运货有车运和船运两种方式 , 上面的条件系用车运时的限制条件 , 如用船运时关于体 积的限制条件为7 x1 + 3 x2 ≤45(5 -10)这两条件是互相排斥的。为了统一在一个问题中 , 引入 0 - 1 变量 y, 令y =0 , 当采取车运方式 1 , 当采取船运方式于是 (5 -9) 式和 (5 -10) 式可由下述的条件 (5 -11) 式和 (5 -12 ) 式来代替 :5 x1 + 4 x2 ≤24 + y M 7 x1 + 3 x2 ≤ 45 + (1 - y) M (5 -12) 其中 M 是充分大的数。读者可以验证 , 当 y = 0 时 , ( 5 -11 ) 式就是 ( 5 -9 ) 式 , 而 (5 -12) 式 自 然成立 , 因而是多余的。当 y = 1 时 ( 5 -12 ) 式就是 (5 -10 ) 式 , 而 (5 -11 ) 式 是多 余的。引 入 的变量 y 不必出现在目标函数内 , 即认为在目标函数式内 y 的系数为 0。(5 -11)如果有 m 个互相排斥的约束条件 ( ≤型 ) :αi 1 x1 +αi 2 x2 + … + αi n x n ≤ bi ,i = 1 , 2 , … , m为了保证这 m 个约束条 件只有一 个起作 用 , 我 们引入 m 个 0 - 1 变 量 yi ( i = 1 , 2 , … , m) 和一个充分大的常数 M , 而下面这一组 m + 1 个约束条件αi 1 x1 + αi 2 x2 + … + αi n x n ≤ bi + yi M ,i = 1 , 2 , … , m(5 -13)y1 + y2 + … + ym = m - 1(5 -14)就合于上述 的要 求。这是 因为 , 由 于 ( 5 -14 ) 式 , m 个 y i 中只有 一个 能取 0 值 , 设 y * 代入 (5 -13 ) 式 , 就只有 i = i* 的约束条件起作用 , 而别的式子都是多余的。i = 0 ,3. 关于固定费用的问题 (fixed cost problem)在讨论线性规划时 , 有些问题是要求使成本为最小。那时总设固定成本为常数 , 并在 线性规划的模型中不必明显列出。但有些固定费用 ( 固定成本 ) 的问题不能用一般线性规 划来描述 , 但可改变为混合整数规划来解决 , 见下例。例 5 某工厂为了生产某种产品 , 有几种不同的生 产方式可 供选择 , 如选 定投资高 的 生产方式 ( 选购自动化程度高的设备 ) , 由于产量大 , 因而分配到每件产品的变动成本就降 低 ; 反之 , 如选定投资低的生产方式 , 将来分配到每件产品的变动成本可能增加 , 所以必须 全面考虑。今设有三种方式可供选择 , 令x j 表示采用第 j 种方式时的产量 ; cj 表示采用第 j 种方式时每件产品的变动成本 ; kj 表示采用第 j 种方式时的固定成本。为了说明成本的特点 , 暂不考虑其他约束条件。采用各种生产方式的总成本分别为 kj + cj x j , 当 xj > 0 当 x j = 0P j =j = 1 , 2 , 30 ,·321·在构成目标函数时 , 为了统一在一个问题中讨论 , 现引入 0 - 1 变量 y i , 令yi =1 , 当采用第 j 种生产方式 , 即 x j > 0 时 ,0 , 当不采用第 j 种生产方式 , 即 x j = 0 时。于是目标函数mi n z = ( k1 y1 + c1 x1 ) + ( k2 y2 + c2 x2 ) + ( k3 y3 + c3 x3 )(5 -15 ) 式这个规定可由下述 3 个线性约束条件 :x j ≤ y j M ,(5 -16) 其中 M 是个充分大的常数。 (5 -16) 式说明 , 当 x j > 0 时 yi 必须 为 1 ; 当 x j = 0 时只 有 yi 为 0 时才有意义 , 所以 ( 5 -16) 式完全可以代替 (5 -15) 式。j = 1 , 2 , 34. 2 0 - 1 型整数规划的解法解 0 - 1 型整数规划最容易想到的方法 , 和一般整数规划的情形一样 , 就是穷举法 , 即 检查变量取值为 0 或 1 的每一种组合 , 比较目标函数值以求得最优解 , 这就需要检查变量 取值的 2 n 个组合。对于变量个数 n 较大 ( 例如 n > 10 ) , 这几乎是 不可能的。因此常 设计 一些方法 , 只检查变量取值的组合的一部分 , 就能求到问题的最优解。这样的方法称为隐 枚举法 ( implicit enume ration ) , 分枝定界法也是一种隐枚举法。 当然 , 对有些 问题隐枚 举 法并不适用 , 所以有时穷举法还是必要的。下面举例说明一种解 0 - 1 型整数规划的隐枚举法。 例 6max z = 3 x1 - 2 x2 + 3 x5 x1 + 2 x2 - x3 ≤2 x1 + 4 x2 + x3 ≤4 ≤3 x3 ≤6 4 x1 + x1 , x2 , x3 = 0 或 1x1 + x2①②③④⑤解题时先通过试探的 方 法找 一个 可行 解 , 容易 看 出 ( x1 , x2 , x3 ) = ( 1 , 0 , 0 ) 就是 合 于①～④条件的 , 算出相应的目标函数值 z = 3。我们求最优解 , 对于极大化问题 , 当然希望 z≥3 , 于是增加一个约束条件 :3 x1 - 2 x2 + 5 x3 ≥3 后加的条件称为过滤的条件 ( filt ering constr ain t ) 。这 样 , 原问 题的线 性约 束条件 就变 成 5 个。用全部枚举的方法 , 3 个变量共有 23 = 8 个解 , 原来 4 个约束条件 , 共 需 32 次运算。 现在增加了过滤条件◎ , 如按下述方法进行 , 就可减少运算次数。将 5 个约束条件按◎～ ④顺序排好 ( 表 5 -5 ) , 对每个解 , 依次代入约束条件左侧 , 求出数 值 , 看是否适 合不等式 条 件 , 如某一条件不适合 , 同行以下各条件就不 必再检 查 , 因而 就减 少了运 算次 数。本例 计 算过程如表 5 -5 , 实际只作 24 次运算。于是求得最优解( x1 , x2 , x3 ) = (1 , 0 , 1 )max z = 8在计算过程中 , 若遇到 z 值已超过条件 ◎右边 的值 , 应 改变条 件◎ , 使 右边为 迄今 为止最大者 , 然后继续作。例如 , 当检查点 (0 , 0 , 1 ) 时因 z = 5( > 3) , 所以应将条件◎换成3 x1 - 2 x2 + 5 x3 ≥5·421·(5 -15)(5 -17)◎◎这种对过滤条件的改进 , 更可以减少计算量。表 5 -5点◎①条②件③④满足条件 ?是() 否 ()z 值(0 , 0 , 0)0(0 , 0 , 1)511015(0 , 1 , 0)2(0 , 1 , 1)315(1 , 0 , 0)311103(1 , 0 , 1)802118(1 , 1 , 0)1(1 , 1 , 1)626注意 : 一般常重新排 列 xi 的 顺 序使 目 标函 数 中 x i 的 系数 是 递 增 ( 不 减 ) 的 , 在 上 例中 , 改写 z = 3 x1 - 2 x2 + 5 x3 = - 2 x2 + 3 x1 + 5 x3因为 - 2 , 3 , 5 是递增的 , 变量 ( x2 , x1 , x3 ) 也按 下述 顺序取 值 : ( 0 , 0 , 0 ) , (0 , 0 , 1 ) , ( 0 , 1 , 0) , ( 0 , 1 , 1) , … , 这样 , 最优解容易比较早的发现。再结合过滤条件的改进 , 更可使计算 简化。在上例中m ax z = - 2 x2 + 3 x1 + 5 x32 x2 + 3 x1 + 5 x3 ≥ 3 x3 ≤ 2 + x1 - + x1 + x3 ≤ 4 ≤3 x3 ≤62 x2 + 3 x1 + 5 x3 ≥ 3 x3 ≤ 2 + x1 - + x1 + x3 ≤ 4 ≤3 x3 ≤62 x24 x2x2◎①②③④(5 -18)表 5-6( a)点( x2 , x1 , x3 )◎①条 件②③④是否满足条件z 值( 0 , 0 , 0 )0( 0 , 0 , 1 )511015表 5 -6 (b)点( x2 , x1 , x3 )◎′①条 件②③④是否满足条件z 值( 0 , 1 , 0 )3( 0 , 1 , 1 )802118·521·ªLîªª(cid:29)ÙL{ªL{ªî(cid:29)L{ªî(cid:29)ªL{ªÜK©z(cid:7)(cid:7)KØ©Üz(cid:7)改进过滤条件 , 用2 x2 + 3 x1 + 5 x3 ≥ 5代替◎ , 继续进行。 再改进过滤条件 , 用2 x2 + 3 x1 + 5 x3 ≥8 代替◎′, 再继续进行。至此 , z 值已不能改进 , 即得到最优解 , 解答如前 , 但计算已简化。表 5 -6 ( c)点条 件是否满足条件( x2 , x1 , x3 )◎″①②③④( 1 , 0 , 0 )2( 1 , 0 , 1 )3( 1 , 1 , 0 )1( 1 , 1 , 1 )6第 5 节 指 派 问 题在生活中经常遇到这样的问题 , 某单位需完成 n 项任务 , 恰好有 n 个人可承担这些任 务。由于每人的专长不同 , 各人完成任务不同 ( 或所费时间 ) , 效率也不同。于是产生应指 派哪个人去完成哪项任务 , 使完成 n 项任务的总效 率最 高 ( 或所 需总 时间最 小 ) 。这类 问 题称为指派问题或分派问题 ( as signmen t problem ) 。例 7 有 一份 中文说 明书 , 需 译成 英、日、德、俄四 种文字。 分别 记作 E、J、G、R。 现 有甲、乙、丙、丁四人。他们将中文说明书翻译 成不同 语种 的说 明书所 需时 间如表 5 -7 所 示。问应指派何人去完成何工作 , 使所需总时间最少 ?表 5 -7人员任务EJGR甲215134乙1041415丙9141613丁78119类似有 : 有 n 项加工任务 , 怎样指派到 n 台机床上分别完成的问题 ; 有 n 条航线 , 怎样 指定 n 艘船去航行问题……。对应每个指派问题 , 需有类似表 5 -7 那样的数表 , 称为效率 矩阵或系数矩阵 , 其元素 ci j > 0( i, j = 1 , 2 , … , n) 表示 指派 第 j 人去完 成第 j 项任 务时 的 效率 ( 或时间、成本等 ) 。解题时需引入变量 xi j ; 其取值只能是 1 或 0。并令xi j =1 当指派第 i 人去完成第 i 项任务 0 当不指派第 i 人去完成第 j 项任务·621·◎′◎″z 值©Å‘ªÅ©ª‘Å©‘ªÅ©ª‘当问题要求极小化时数学模型是 :min z = ∑∑ci j x i j①∑x i j = 1 ,j = 1 , 2 , … , n②∑x i j = 1 ,i = 1 , 2 , … , n③(5 -19)xi j = 1 或 0④约束条件②说明第 j 项任 务只能由 1 人 去完成 ; 约束 条件③ 说明第 i 人只能 完成 1 项 任 务。满足约束条件②～④的可行解 xi j 也可写成表格或矩阵形式 , 称为解矩阵。如例 7 的 一个可行解矩阵是0100( x i j ) =010010000001显然 , 这不是最优。解矩阵 ( x i j ) 中各行各列的元素之和都是 1。指派问题是 0 - 1 规划的特例 , 也是运输问题的 特例 ; 即 n = m, aj = bi = 1。当 然可 用 整数规划 , 0 - 1 规划或运输问题 的解 法去求 解 , 这就 如同用 单纯 形法 求解 运 输问 题一 样 是不合算的。利用指派问题的特点可有更简便的解法。指派问题的最优解有这样性质 , 若从系数 矩阵 ( ci j ) 的 一行 ( 列 ) 各 元素 中分别 减去 该 行 ( 列 ) 的最小元素 , 得到新矩阵 ( bi j ) , 那么以 ( bi j ) 为 系 数矩 阵求 得的 最优 解 和用 原系 数 矩阵求得的最优解相同。利用这个性质 , 可使原系数矩阵变换为含有很多 0 元素的新系数矩阵 , 而最优解保持 不变 , 在系数矩阵 ( bi j ) 中 , 我们关心位于不同行不 同列的 0 元素 , 以下 简称 为独立 的 0 元 素。若能在系数矩阵 ( bi j ) 中找出 n 个独立的 0 元素 ; 则令解矩阵 ( xi j ) 中对应这 n 个独 立 的 0 元素的元素取值为 1 , 其他元素取值为 0 。将其代入目标函数中得到 zb = 0 , 它一定是 最小。这就是以 ( bi j ) 为系数矩阵的指派问题的最优解。也就得到了原问题的最优解。库恩 ( W .W .Ku hn) 于 1955 年提出了 指派 问题的 解法 , 他引 用了 匈牙 利 数学 家康 尼 格 ( D .K nig) 一个关于矩阵中 0 元素 的定 理 : 系数矩 阵中 独立 0 元素 的最 多 个数 等于 能 覆盖所有 0 元素的最少直线数。这解法称为 匈牙利 法。以 后在方 法上 虽有不 断改 进 , 但 仍沿用这名称。以下用例 7 来说明指派问题的解法。第一步 : 使指派问题的系数矩阵经变换 , 在各行各列中都出现 0 元素。 (1 ) 从系数矩阵的每行元素减去该行的最小元素 ; (2 ) 再从所得系数矩阵的每列元素中减去该列的最小元素。 若某行 ( 列 ) 已有 0 元素 , 那就不必再减了。例 7 的计算为min215134201311201370( ci j ) =1094141416151349600510711460056392= ( bi j )781197014201004 2 min·721·第二步 : 进行试指派 , 以寻求最优解。为此 , 按以下步骤进行。 经第一步变 换后 , 系 数矩阵 中每 行每 列都已 有了 0 元 素 ; 但需 找出 n 个独 立的 0 元 素。若能找出 , 就以这些独立 0 元素对 应解 矩阵 ( xi j ) 中 的元 素为 1 , 其 余为 0 , 这 就得 到 最优解。当 n 较小时 , 可用观察法、试探法去找 出 n 个独 立 0 元 素。若 n 较 大时 , 就必 须 按一定的步骤去找 , 常用的步骤为 :(1 ) 从只有一个 0 元素的行 ( 列 ) 开始 , 给这个 0 元素加圈 , 记 作◎。这表 示对这行 所 代表的人 , 只有一种任务可指派。然后划去◎所在列 ( 行 ) 的其他 0 元素 , 记作 Φ。这表 示 这列所代表的任务已指派完 , 不必再考虑别人了。(2 ) 给只有一个 0 元素 列 ( 行 ) 的 0 元素 加圈 , 记作◎ ; 然 后划去 ◎所在 行的 0 元素 ,记作 Φ。(3 ) 反复进行 ( 1) , ( 2) 两步 , 直到所有 0 元素都被圈出和划掉为止。 (4 ) 若仍有没有划圈的 0 元素 , 且同行 ( 列 ) 的 0 元素至少有两个 ( 表示对 这个可以 从 两项任务中指派其一 ) 。这可用不同的方案去试探。从剩有 0 元素最少的行 ( 列 ) 开始 , 比 较这行各 0 元素所在列中 0 元素的数目 , 选择 0 元素少的那列的这个 0 元素加圈 ( 表示选 择性多的要“礼让”选择性少的 ) 。然后划掉同行同列的其他 0 元素。可反复进行 , 直到所 有 0 元素都已圈出和划掉为止。(5 ) 若◎元素 的 数 目 m 等 于 矩阵 的 阶 数 n , 那 么这 指 派 问 题 的 最 优 解 已 得 到。 若m < n, 则转入下一步。现用例 7 的 ( bi j ) 矩阵 , 按上述步骤进行运算。按步骤 (1 ) , 先 给 b22 加圈 , 然后给 b31 加圈 , 划掉 b1 1 , b41 ; 按步骤 ( 2) , 给 b43 加圈 , 划掉 b4 4 , 最后给 b1 4 加圈 , 得到Φ 13 6 ◎ 6 ◎ 5 2 Φ 1 ◎ Φ7 ◎93可见 m = n = 4 , 所以得最优解为0001( x i j ) =011000000010这表示 : 指定甲译出俄文 , 乙译出日文 , 丙译出英文 , 丁译出德文。所需总时间最少min zb = ∑∑bi j x i j = 0min z = ∑∑ci j x i j = c31 + c22 + c4 3 + c1 4 = 28 ( 小时 )例 8 求表 5 -8 所示效率矩阵的指派问题的最小解。·821·表 5 -8人员任务ABCDE甲127979乙89666丙71712149丁15146610戊4107109解题时按上述第一步 , 将这系数矩阵进行变换。mi n12797975020289666623000717121497010572151466106980044107109406365经一次运算即得每行每列都有 0 元素的系数矩阵 , 再按上述步骤运算 , 得到5 ◎ 2 Φ 2 3 Φ ◎ Φ2 ◎ 102 8 ◎ Φ 4579 Φ 6365①这里◎的个数 m = 4 , 而 n = 5 ; 所以解题没有完成 , 这时应按以下步骤继续进行。第三步 : 作最少的直线覆盖所有 0 元素 , 以确定该系数矩阵中能找到最多的独立元素数。为此按以下步骤进行 :(1 ) 对没有◎的行打 号 ; (2 ) 对已打 号的行中所有含 Φ元素的列打 号 ; (3 ) 再对打有 号的列中含◎元素的行打 号 ; (4 ) 重复 ( 2) , ( 3) 直到得不出新的打 号的行、列为止 (5 ) 对没有打 号的行画一横线 , 有打 号的列画一纵线 , 这就 得到覆盖 所有 0 元 素的最少直线数。令这直线数为 l。若 l < n, 说明必须再变 换当前 的系 数矩 阵 , 才 能找 到 n 个独 立的 0元素 , 为此转第四步 : 若 l = n, 而 m < n, 应回到第二步 (4 ) , 另行试探。在例 8 中 , 对矩阵①按以下次序进行 : 先在第五行旁打 , 接着可判断应在第 1 列下打 , 接着在第 3 行旁打 。经检查不 再能打 了。对 没有 打 行 , 画一 直线 以覆盖 0 元 素 , 已打 的 列画 一直 线以 覆盖 0 元 素。得·921·ÀØÜ¨(cid:7)ØÀÜ¨(cid:7)ØÜÀ¨(cid:7)ÀÜØ¨(cid:7)ÜÀØ¨(cid:7)—|—5—◎— 2 —Φ —2——|——2— 3 —Φ—◎—Φ—| ◎ 10 5 7 2 |——9— 8 —◎—Φ—4——|Φ 63 6 5由此可见 l = 4 < n。所以应继续对②矩阵进行变换。转第四步。 第四步 : 对②矩阵进行变换的目的是增 加 0 元素。为 此在 没有被 直线 覆盖的 部分 中 找出最小元素。然后在打 行各元素中都减去 这最小 元素 , 而 在打 列的 各元素 都加 上 这最小元素 , 以保证原来 0 元素不变。这样得到新系数矩阵 ( 它的最优解和原问题相同 ) 。 若得到 n 个独立的 0 元素 , 则已得最优解 , 否则回到第三步重复进行。在例 8 的矩阵②中 , 在没有被覆盖部分 ( 第 3、5 行 ) 中找出最小元素为 2 , 然后在第 3、 5 行各元素分别减去 2 , 给第 1 列各元素加 2 , 得到新 矩阵③。按 第二步 , 找出 所有独立 的 0 元素 , 得到矩阵④。702024300008350118004041437 ◎ 2 Φ 2 3 Φ ◎ Φ 5 ◎ 8 ◎ Φ 44 Φ 8311 ◎ 4143它具有 n 个独立 0 元素。这就得到了最优解 , 相应的解矩阵为0100000010000010010010000由解矩阵得最优指派方案甲— B, 乙— D, 丙— E, 丁— C, 戊— A本例还可以得到另一最优指派方案甲— B, 乙— C, 丙— E, 丁— D, 戊— A所需总时间为 min z = 32当指派问题的系数矩阵 , 经过变换得到了同 行和 同列中 都有 两个 或两个 以上 0 元 素 时。这时可以任选一行 ( 列 ) 中某一个 0 元素 , 再划 去同 行 ( 列 ) 的 其他 0 元素。这 时会 出 现多重解。·031·②③④以上讨论限于极小化的指派问题。对极大化的问题 , 即求m ax z = ∑∑ci j x i j(5 -20)i bi j = M - ci jj可令 其中 M 是足够大的常数 ( 如选 ci j 中最大元素为 M 即可 ) , 这时系数矩阵可变换为B = ( bi j )这时 bi j ≥0 , 符合匈牙利法的条件。目标函数经变换后 , 即解min z′= ∑∑bi j x i j(5 -21)所得最小解就是原问题的最大解 , 因为∑∑bi j x i j = ∑∑( M - ci j ) xi j= ∑∑M x i j∑ i∑ci j x i j= n M - ∑∑ci j x i j因 nM 为常数 , 所以当 ∑∑bi j x i j 取最小时 , ∑∑ci j x i j 便为最大。习题5. 1 对下列整数规划问题 , 问用先解相应的线性规划然后凑整的办法能否求到最优整数解 ?(1 ) max z = 3 x1 + 2 x2(2 ) max z = 3 x1 + 2 x22 x1 + 3 x2 ≤ 14. 5 4 x1 + x2 ≤ 16. 5 x1 , x2 ≥0 x1 , x2 整数2 x1 + 3 x2 ≤14 2 x1 + x2 ≤9 x1 , x2 ≥ 0 x1 , x2 整数5. 2 用分支定界法解 :max z = x1 + x29 x2 ≤ 51 14 14 - 2 x1 + x2 ≤ 1 3x1 +x1 , x2 , ≥0 x1 , x2 整数5. 3 用 G omory 切割法解 : (1 ) max z = x1 + x2(2 ) max z = 3 x1 - x22 x1 + x2 ≤ 6 4 x1 + 5 x2 ≤ 20 x1 , x2 ≥0x1 , x2 整数3 x1 - 2 x2 ≤35 x1 - 4 x2 ≤ - 10 2 x1 + x2 ≤5 x1 , x2 ≥ 0 x1 , x2 整数·131·5. 4 某 城市 的消 防 总部 将全 市划 分 为 11 个 防 火 区 , 设 有 4 个 消 防 ( 救 火 ) 站。 图 5 -8表示各 防 火 区 域 与 消 防 站 的 位 置 , 其 中①②③ ④ 表示 消 防 站 , 1、2、…、11 表 示 防 火区域。根据历 史 的资 料 证实 , 各 消防 站 可 在事先规定的允许时间内对所负责的地区 的 个消防站 负 责 ( 没 有 虚 线 连 系 , 就 表 示 不 负 责 ) 。现 在 总 部 提 出 : 可 否 减 少 消 防 站 的 数 目 , 仍能同 样负 责 各地 区 的防 火 任务 ? 如 果图 5 -8可以 , 应当关闭哪个 ?提示 : 对每个消防站定义一个 0 - 1 变量 xi ,令xj =1,0,当某防火区域可由第 j 消防站负责时, 当某防火区域不由第 j 消防站负责时,j = 1 , 2 , 3 , 4然后对每个防火区域列一个约束条件。5. 5 在有互相排 斥的 约 束 条 件 的问 题 中 , 如果 约 束 条 件 是 ( ≤ ) 型 的 , 我 们 用 加 以 yi M 项 ( yi 是 0 - 1 变量 , M 是很 大的 常数 ) 的 方法 统一在 一个 问题 中。如 果 约束 条件 是 ( ≥ ) 型的 , 我们将怎样利用 y i 和 M 呢 ?5. 6 解 0 - 1 规划 :(1 ) min z = 4 x1 + 3 x2 + 2 x3(2 ) min z = 2 x1 + 5 x2 + 3 x3 + 4 x42 x1 - 5 x2 + 3 x3 ≤44 x1 + x2 + x3 + x4 ≥04 x1 + x2 + 3 x3 ≥3 x2 + x3 ≥12 x1 + 4 x2 + 2 x3 + 4 x4 ≥4 x3 + x4 ≥1 x1 + x2 -x1 , x2 , x3 = 0 或 1x1 , x2 , x3 , x4 = 0 或 15. 7 有 4 个工人 , 要指派他们分别完成 4 种工作 , 每 人做 各种工 作所 消耗的 时间 如下表所示 , 问指派哪个人去完成哪种工作 , 可使总的消耗时间为最小 ?工人工种ABCD甲15182124乙19232218丙26171619丁19212317参 考 资 料[1] A .Kaufmann : Infeger and mixed progr amming .Th eory and App eicafien .Academie pres s .INC( Lon-don) LTD .·231·©ÁÜ‘ÁÜ©‘©ÜÁ‘Á©Ü‘四 * 、非线性规划由前面几章知道 , 在科 学管 理和 其他 领域 中 , 很 多实 际问 题可 以 归 结为 线 性规 划 问 题 , 其目标函数和约束条件都是自变量的 一次函 数。但是 , 还有另 外一 些问题 , 其 目标 函 数和 ( 或 ) 约束条件很难用线性函数表达。如果 目标函 数或 约束条 件中 含有 非线性 函数 , 就称这种规划问题为非线性规划问题。解这种问题要用非线性规划的方法。由于很多实际问题要求进一步精确化以及电子计算机的发 展 , 使 非线 性规 划在近 几十 年来得 以长 驱 进展。目前 , 它已成为运筹学的重要分支之一 , 并在最优设计、管理科学、系统控制等许多 领域得到越来越广泛的应用。一般说来 , 由于非线性函数的复杂性 , 解非线性规划问题要比解线性规划问题困难得 多。而且 , 也不像线性规划有单纯形法等通用方法 , 非线性规划目前还没有适于各种问题 的一般算法 , 各个方法都有自己特定的适用 范围。这 是需 要人 们更深 入地 进行研 究的 一 个领域。在以下两章中 , 除了简要地介绍非线性规划的基本概念和一维搜索法之外 , 着重说明 无约束极值问题和约束极值问题 的主 要解 法。为了 叙述方 便 , 我们 常用 大写 字 母代 表 n 维欧氏空间中的向量 ( 点 ) , 而以相应的小写字母代表该向量的分量 ( 点的坐标 ) 。此外 , 在 这一部分所用到的向量 , 均规定为列向量。第 6 章 *无约束问题第 1 节 基 本 概 念1. 1 引言1. 问题的提出让我们先看两个例子。例 1 某公司经营两种产 品 , 第 一种 产品 每件 售 价 30 元 , 第 二种 产 品 每件 售 价 450 元。根据统计 , 售出一件 第一 种产 品所 需要 的 服务 时间 平均 是 0 .5 小时 , 第 二 种产 品 是(2 + 0 .25 x2 ) 小时 , 其中 x2 是第二种产品的 售出数 量。已 知该 公司在 这段 时间内 的总 服 务时间为 800 小时 , 试决定使其营业额最大的营业计划。 下面我们来分析这个例子 , 并为其建立数学模型。 设该公司计划经营第一种产品 x1 件 , 第二种产品 x2 件。根据题意 , 其营业额为·331·f ( X) = 30 x1 + 450 x2由于服务时间的限制 , 该计划必须满足0 .5 x1 + (2 + 0 .25 x2 ) x2 ≤800此外 , 这个问题还应满足x1 ≥0 ,x2 ≥0如此 , 得到这个问题的数学模型如下 :max f ( X) = 30 x1 + 450 x20 .5 x1 + 2 x2 + 0 .25 x2 x1 ≥0 ,x2 ≥02 ≤800例 2 为了进行多属性问题 ( 假 设有 n 个 属性 ) 的 综合评 价 , 就需 要确 定 每个 属性 的 相对重要性 , 即求它们的权重。为此将各属性 的重要 性 ( 对评 价者 或决策 者而 言 ) 进行 两 两比较 , 从而得出如下判断矩阵J =α11… α1 n ⁝ … αn n⁝ αn1其中元素 ai j 是第 i 个属性的重要性与第 j 个属性的重要性之比。现需从判断矩阵求出各属性的权重 wi ( = 1 , 2 , … , n) 。为了使求出的权向量W = ( w1 , w2 , … , wn ) T在最小二乘意义上能最好的反映判断矩阵的估计 , 由 αi j ≈ wi/ wj , 可得nnmin ∑∑(αi j w j - wi ) 2i = 1j = 1n∑wi = 1i = 1例 1 的目标函数为自变量的线性函数 , 但其第一个约束条件却是自变量的二次函数 , 因而它是非线性规划问题。例 2 的目标函数是 自变量 的非 线性函 数 , 所以 它也是 非线 性 规划问题。2. 非线性规划问题的数学模型非线性规划的数学模型常表示成以下形式min f ( X )hi ( X) = 0 , = 1 , 2 , … , m gj ( X) ≥ 0 , j = 1 , 2 , … , l( 6 -3) 其中自变量 X = ( x1 , x2 , … , xn ) T 是 n 维欧 氏空间 E n 中的 向量 ( 点 ) ; f ( X) 为 目标 函数 , hi ( X) = 0 和 gj ( X) ≥0 为约束条件。由于 m ax f ( X) = - min[ - f ( X) ] , 当需使目标函数极大化 时 , 只需使其 负值极小 化即可。因而仅考虑目标函数极小化 , 这无损于一般性。若某约束条件是“≤”不等式时 , 仅需用“ - 1”乘该 约束 的两端 , 即 可将 这个约 束变 为“≥”的形式。由于等式约束·431·( 6 -1)( 6 -2)hi ( X) = 0等价于下述两个不等式约束 :hi ( X) ≥0 - hi ( X) ≥0 因而 , 也可将非线性规划的数学模型写成以下形式min f ( X)( 6 -4)gj ( X ) ≥0 ,j = 1 , 2 , … , l( 6 -5)3. 非线性规划问题的图示图示法可以给人以直观概念 , 当只有两个自变量时 , 非线性规划问题也可像线性规划那样用图示法来表示 ( 如图 6 -1 所示 ) 。考虑非线性规划问题min f ( X) = ( x1 - 2) 2 + ( x2 - 2 ) 2( 6 -6)h( X) = x1 + x2 - 6 = 0( 6 -7)若令其目标函数( 6 -8) f ( X) = c 其中 c 为 某一常数 , 则 ( 6 -8 ) 式 代表目 标函数值 等于 c 的 点的集合 , 它 一般为一 条曲线 或 一张曲面 , 通常称其为等值线或等值面。 对于这 个例 子来说 , 若 令目 标函数 ( 6 -6) 式分 别 等于 2 和 4 , 就得到相应的两条圆形等值线 ( 图 6 -1 ) 。由图可见 , 等值线 f ( X) = 2 和 约束 条件直线 AB 相切 , 切点 D 即为此 问题 的最优 解 : x * 2 = 3 , 其目标函数值 f ( X * ) = 2。 x *1 =在这个例子 中 , 约 束条 件 ( 6 -7 ) 式 对 最优 解 是 有影响的。现若以h( X) = x1 + x2 - 6≤ 0 代替约 束 条 件 ( 6 -7 ) 式 , 则 非 线 性 规 划 问 题 ( 6 -6 ) 式、 (6 -9) 式的最优解 是 x1 = x2 = 2 , 即 图 6 -1 中的 C 点 ( 这 时 f ( X) = 0 ) 。由 于 最优 点位 于可 行域 的 内部 , 故 对这 个问题的最优解 来说 , 约束 ( 6 -9 ) 式 事实 上 是不 起 作用 的。在求这个问题的最优解时 , 可不考虑约束条件 ( 6 -9 ) 式 , 就相当于没有这个约束一样。 由第一章知道 , 如果线性规划问题的最优解存在 , 其最优解只能在其可行域的边界上 达到 ( 特别是在可行域的顶点上达到 ) ; 而非 线性规划 问题 的最优 解 ( 如果 最优 解存 在 ) 则 可能在其可行域中的任意一点达到。( 6 -9)图 6 -11. 2 极值问题在高等数学课程中 , 已学过一元函数和多元函数的极值问题 , 现仅扼要说明如下。·531·1. 局部极值和全局极值由于线性规划的目标函数为线性函数 , 可行域为凸集 , 因而求出的最优解就是在整个 可行域上的全局最优解。非线性规划却不然 , 有时求 出的 某个 解虽是 一部 分可行 域上 的 极值点 , 但却并不一定是整个可行域上的全局最优解。设 f ( X) 为定 义在 n 维欧氏 空间 E n 的 某一区 域 R 上的 n 元实 函数 , 其 中 X = ( x1 , x2 , … , xn ) T 。对于 X * ∈ R , 如果存在某个 ε> 0 , 使 所有与 X * 的距离 小于 ε的 X ∈ R( 即 X∈ R 且‖ X - X * ‖ <ε) 均满足不等式 f ( X) ≥ f ( X * ) , 则称 X * 为 f ( X) 在 R 上的局 部 极小点 ( 或相对极小点 ) , f ( X * ) 为局部极小值。若对于所有 X≠ X * 且与 X * 的距离小 于 f ( X) > f ( X * ) , 则称 X * 为 f ( X) 在 R 上的 严格 局格 极小 点 , f ( X * ) 为严 格 ε的 X ∈ R, 局部极小值。若点 X * ∈ R, 而对于所有 X∈ R 都有 f ( X) ≥ f ( X * ) , 则称 X * 为 f ( X) 在 R 上的全局 极小点 , f ( X * ) 为全局极小值。若对于所有 X∈ R 且 X≠ X * , 都有 f ( X) > f ( X * ) , 则称 X * 为 f ( X) 在 R 上的严格全局极小点 , f ( X * ) 为严格全局极小值。如将上述不等式反向 , 即可得到相应的极大点和极大值的定义。 下面仅就极小点及极小值加以说明 , 而且主要研究局部极小。2. 极值点存在的条件现说明极值点存在的必要条件和充分条件。定理 1 ( 必要条件 ) 设 R 是 n 维欧氏空间 E n 上的某一开集 , f ( X) 在 R 上有一阶连续偏导数 , 且在点 X *∈ R 取得局部极值 , 则必有f ( X * ) x1=f ( X * ) x2= … =f ( X * ) xn= 0或f ( X * ) = 0上式中f ( X * ) =f ( X * ) x1,f ( X * ) x2, … ,f ( X * ) x nT为函数 f ( X) 在点 X * 处的梯度。由数学分析知道 ,f ( X) 的方向为 f ( X) 的等值面 ( 等值线 ) 的法 线 ( 在点 X 处 ) 方向 ,沿这个方向函数值增加最快。满足式 (6 -10 ) 或式 ( 6 -11 ) 的点称为平稳 点或驻 点 , 在区 域内部 , 极 值点 必为平 稳点 ,但平稳点不一定是极值点。定理 2 ( 充分条件 ) 设 R 是 n 维欧氏空间 E n 上的某一开集 , f ( X) 在 R 上具有二阶连续偏导数 , X * ∈ R,若 f ( X * ) = 0 , 且对任何非零向量 Z∈ En 有ZT H ( X * ) Z > 0·631·(6 -10)(6 -11)(6 -12)(6 -13)则 X * 为 f ( X) 的严格局部极小点此处 H ( X * ) 为 f ( X) 在点 X * 处的海赛 ( Hesse) 矩阵 :2 f ( X * ) x212 f ( X * )x1x2…2 f ( X * ) xnx1H ( X * ) =2 f ( X * )x2x12 f ( X * ) xn x12 f ( X * ) x2 … 2 f ( X * )2xnx2……2 f ( X * ) xnx22 f ( X * ) x2n(6 -14)证明从略。需要指出 , 定理 2 中的充分条件 ( 6 -13 ) 式 并不是 必要 的。可 以举出 这样 的例子 : X * 是 f ( X) 的极小点 , 但却不满足条件 ( 6 -13 ) 式。例如 , f ( x) = x4 , 它的极小点 是 x * = 0 , 但f″( x * ) = 0 , 这不满足式 ( 6 -13 ) 。二次型是 X = ( x1 , x2 , … , xn ) T 的二次奇次函数 , 它在研 究非线 性最优化 中具有重 要作用。现考虑二次型 ZT H Z。若对于任意 Z≠0 ( 即 Z 的元素不全为零 ) , 二次型 ZT H Z 的值总是正的 , 即 ZT H Z > 0 , 则称该二次型是正定的 ; 若 对于任 意 Z≠ 0 总 有 ZT H Z≥ 0 , 则称其为半正定 ; 若对于任意 Z≠ 0 总有 ZT H Z < 0 , 则称其 为负 定 ; 若 对于 任意 Z≠ 0 总 有 ZT H Z≤ 0 , 则称其为半负定。如果对某些 Z≠0 , ZT H Z > 0 , 而对另一些 Z≠0 , ZT H Z < 0 , 即它既非正定 , 也非负定 , 则称其为不定的。由线性代 数学知道 , 二 次型 ZT H Z 为正定 的 充要条件 , 是它的矩阵 H 的左上角各阶主子式都大于零 ; 而它为负定的充要条件 , 是它 的 矩阵 H 的左上角各阶主子式依次负正相间。现以 hi j 表示矩阵 H 的元素 , 上述条件为 , 当二次型正定时 :h11 > 0 ;h11h21h12h22> 0 ;… ;h11hn1… h1 n … … hn n> 0当二次型负定时 :h11 < 0 ;h11h21h1 2h2 2> 0 ;h11h21h31h1 2h2 2h3 2h13h23h33< 0 ;… ; ( - 1 ) nh11hn1… h1 n … … hn n> 0二次型 ZT H Z 为正 定、负定 或不定 时 , 其对 称矩 阵 H 分别 称为 正定的、负定 的或 不定的。定理 2 中的条件 (6 -13 ) 式 , 就等于说其海赛阵在 X * 处正定。1. 3 凸函数和凹函数凸集、凸 函 数 以 及 凸 函 数 的 极 值 的 性 质 , 是 研 究 非 线 性 规 划 问 题 所 不 可 缺 少的内容。凸集的概念在讲线 性 规 划 时 已作 过 说 明 , 因 而 这 里 简 要 说 明 凸 函 数 的 有 关 问题。·731·1. 什么是凸函数和凹函数设 f ( X) 为定义在 n 维欧氏空间 E n 中某个凸集 R 上的函数 , 若对任何实数 α( 0 <α<1) 以及 R 中的任意两点 X ( 1 ) 和 X( 2 ) , 恒有f (αX( 1 ) + ( 1 - α) X( 2 ) ) ≤αf ( X( 1 ) ) + (1 - α) f ( X( 2 ) )则称 f ( X) 为定义在 R 上的凸函数。若对任意 α(0 < α< 1 ) 和 X( 1 ) ≠ X( 2 ) ∈ R 恒有f (αX( 1 ) + ( 1 - α) X( 2 ) ) < αf ( X( 1 ) ) + (1 - α) f ( X( 2 ) )则称 f ( X) 为定义在 R 上的严格凸函数。将 (6 -15 ) 式和 ( 6 -16 ) 式中的不等号反向 , 即可得 到凹 函数 和严 格凹 函数 的定义。 显然 , 若函数 f ( X) 是凸函数 ( 严格凸函数 ) , 则 -f ( X) 一定是凹函数 ( 严格凹函数 ) 。凸函数和凹函数的几何意义十分明显 , 若 函数图 形上 任两 点的联 线处 处都不 在这 个 函数图形的 下 方 , 它 当 然 是 下 凸 的 ( 图 6 -2 ( a ) ) 。凹 函 数 则 是 下 凹 的 ( 上 凸 的 ) ( 图 6 -2 ( b ) ) 。线性函数既可看作凸函数 , 也可看作凹函数。图 6 -22. 凸函数的性质凸函数具有如下性质 : 性质 1 设 f ( X) 为定义在凸集 R 上的凸函数 , 则对任意实数 β≥ 0 , 函数 βf ( X) 也 是·831·(6 -15)(6 -16)定义在 R 上的凸函数。性质 2 设 f 1 ( X) 和 f2 ( X) 为定义在凸集 R 上的两个凸函数 , 则其和 f ( X) = f1 ( X)+ f 2 ( X) 仍为定义在 R 上的凸函数。因为 f1 ( X) 和 f2 ( X) 都是定义在 R 上的凸函数 , 故对 R 上的任两点 X ( 1 ) 和 X( 2 ) 以及任意实数 α(0 < α< 1 ) 恒有f1 (αX( 1 ) + ( 1 - α) X( 2 ) ) ≤αf1 ( X( 1 ) ) + (1 - α) f 1 ( X( 2 ) ) f2 (αX( 1 ) + ( 1 - α) X( 2 ) ) ≤αf2 ( X( 1 ) ) + (1 - α) f 2 ( X( 2 ) )将上式两端分别相加得f (αX( 1 ) + ( 1 - α) X( 2 ) ) ≤αf ( X( 1 ) ) + (1 - α) f ( X( 2 ) )故 f ( X) 也是 R 上的凸函数。由以上两个性质立刻推得 : 有限个凸函数的非负线性组合 β1 f1 ( X) +β2 f2 ( X) + … +βm f m ( X)βi ≥ 0 ,i = 1 , 2 , … , m仍为凸函数。性质 3 设 f ( X) 为定义在凸集 R 上的凸函数 , 则对任一实数 β, 集合Sβ = { X | X∈ R, f ( X ) ≤β}(6 -17)是凸集 ( Sβ 称为水平集 ) 。证明 任取 X( 1 ) ∈ Sβ 和 X ( 2 ) ∈ Sβ , 则有 f ( X( 1 ) ) ≤β, f ( X( 2 ) ) ≤β。 由于 R 为凸集 , 故对任意实数 α(0 < α< 1 ) ,αX( 1 ) + ( 1 - α) X( 2 ) ∈ R, 又因 f ( X) 为凸函数 , 故f (αX( 1 ) + ( 1 - α) X( 2 ) ) ≤αf ( X( 1 ) ) + ( 1 - α) f ( X( 2 ) ) ≤β这就表明点 αX( 1 ) + ( 1 - α) X( 2 ) ∈ Sβ , 于是 , Sβ 为凸集。3. 函数凸性的判定现在来研究怎样判断一个函数是凸函数 , 当 然可以 直接 依据 定义去 判别。对 于可 微凸函数 , 也可利用下述两个判别定理。定理 3 ( 一阶条件 ) 设 R 为 n 维欧氏空间 E n 上的开凸集 , f ( X) 在 R 上具有一阶连续偏导数 , 则 f ( X) 为R 上的凸函数的充要条件是 , 对任意两个不同点 X( 1 ) ∈ R 和 X ( 2 ) ∈ R , 恒有f ( X( 2 ) ) ≥ f ( X( 1 ) ) + f ( X( 1 ) ) T ( X( 2 ) - X( 1 ) )(6 -18)证明 : 必要性 : 设 f ( X) 为 R 上的凸函数 , 则对任何 α(0 < α< 1 ) 有f (αX( 2 ) + ( 1 - α) X( 1 ) ) ≤αf ( X( 2 ) ) + (1 - α) f ( X( 1 ) )于是f ( X( 1 ) +α( X( 2 )X( 1 ) ) ) - αf ( X( 1 ) )≤ f ( X( 2 ) ) - f ( X( 1 ) )令 α→ + 0 , 上式左端的极限为f ( X( 1 ) ) T ( X( 2 )X( 1 ) )·931·即f ( X( 2 ) ) ≥ f ( X( 1 ) ) + f ( X( 1 ) ) T ( X( 2 ) - X( 1 ) )充分性 : 任取 X( 1 ) ∈ R 及 X ( 2 ) ∈ R, 现令X = αX( 1 ) + (1 - α) X( 2 ) ,0 <α< 1分别以 X( 1 ) 和 X( 2 ) 为式 (6 -18) 中的 X( 2 ) , 以 X 为式 (6 -18 ) 中的 X( 1 ) , 则f ( X( 1 ) ) ≥ f ( X) + f ( X) T ( X( 1 ) - X) f ( X( 2 ) ) ≥ f ( X) + f ( X) T ( X( 2 ) - X) 用 α乘上面的第一式 , 用 (1 - α) 乘上面的第二式 , 然后两端相加 :αf ( X( 1 ) ) + ( 1 - α) f ( X( 2 ) ) ≥ f ( X) + f ( X) T ×[αX( 1 ) - αX + (1 - α) ( X( 2 ) - X) ] = f ( X) = f (αX( 1 ) + ( 1 - α) X( 2 ) )从而可知 f ( X) 为 R 上的凸函数。若式 (6 -18) 为严格不等式 , 它就是严 格凸函数 的充要条件。凸函数的定义式 (6 -15) , 本质上是说 凸函数上 两 点间的线性插值不低于这个函数的值 ; 而 定理 3 则 是 说 , 基 于 某点 导 数 的 线 性近 似 不 高 于 这个 函 数 的 值 ( 图 6 -3 ) 。图 6 -3定理 4 ( 二阶条件 ) 设 R 为 n 维欧氏空间 E n 上的某一开凸集 , f ( X) 在 R 上具有二阶连续偏导数 , 则 f ( X) 为 R 上的凸 函数的充要条件是 : f ( X) 的海赛矩阵 H ( X) 在 R 上处处半正定。证明 先证必要性。 设 f ( X) 为 R 上的凸函数。任取 X∈ R 和 Z∈ En , 现证ZT H ( X) Z≥0因 R 为开集, 故存在 α- > 0 , 使当 α- ∈ [ - α- ,α- ] 时, 有 X +αZ∈ R。由定理 3 可得f ( X + αZ) ≥ f ( X) + α f ( X) T Z再由泰勒公式f ( X + αZ) = f ( X) + α f ( X) T Z +1 2α2 ZT H ( X) Z + o(α2 )其中lim α→ 0o(α2 ) α2= 0由以上两式得1 2α2 ZT H ( X) Z + o(α2 ) ≥0从而1 2ZT H ( X) Z +o(α2 ) α2 ≥0令 α→ 0 , 则得 ·041·ZT H ( X) Z≥0即 H ( X) 为半正定矩阵。下面证明充分性。设对任意 X∈ R, H ( X) 为半正定矩阵 , 任取X∈ R, 由泰勒公式 , 有f ( X) = f ( X) + f ( X) T ( X -X) +1 2( X - X)T H (X+λ( X -X) ) ( X - X)其中 λ∈ (0 , 1 ) 。因 R 为凸集 ,X+ λ( X -X) ∈ R。再由假设知 H (X+λ( X -X) ) 为半正定 , 从而f ( X) ≥ f (X) + f ( X) T ( X -X)由定理 3 , f ( X) 为 R 上的凸函数。若对一切 X∈ R, f ( X) 的海赛矩阵都是正定的 , 则 f ( X) 是 R 上的严格凸函数。 对于凹函数可以得到和上述类似的结果。 例 3 试证明 f ( X) = - x2 证 首先由定义证明 f1 ( x1 ) = - x2 任意指定两点 a1 和 a2 , 看下述各式是否成立 ? - [αa1 + (1 - α) a2 ] 2 ≥α( - a21 - x22 为凹函数。1 为凹函数。1 ) + (1 - α) ( - a22 )或1 (α- α2 ) - 2 a1 a2 (α- α2 ) + a2 a22 (α- α2 ) ≥0或(α- α2 ) ( a1 - a2 ) 2 ≥0 由于 0 <α< 1 , 故 α- α2 > 0 。显然 , 不管 a1 和 a2 取什 么值 , 总 有 (α- α2 ) ( a1 - a2 ) 2 ≥ 0 成 立 , 从而证明 f1 ( x1 ) = - x2 2 也 是凹 函 数。根据性质 2 , f ( X) = - x21 为凹函数。用 同样 的方 法可以 证明 f2 ( x2 ) = - x21 - x22 为凹函数。再用定理 3 证明。任意选取第一点 X( 1 ) = ( a1 , b1 ) T , 第二点 X( 2 ) = ( a2 , b2 ) T 。如此 ,f ( X( 1 ) ) = - a21 - b21f ( X( 2 ) ) = - a22 - b22f ( X) = ( - 2 x1 , - 2 x2 ) T f ( X( 1 ) ) = ( - 2 a1 , - 2b1 ) T现看下述各式是否成立 ?a22 - b22 ≤ - a21 - b21 + ( - 2 a12b1 )a2 - a1 b2 - b1或a22 - b22 ≤ - a21 - b21 - 2 a1 ( a2 - a1 ) - 2b1 ( b2 - b1 )或( a22 - 2 a1 a2 + a21 ) - ( b22 - 2 b1 b2 + b21 ) ≤0或( a2 - a1 ) 2 - ( b2 - b1 ) 2 ≤0不管 a1 、a2 、b1 和 b2 取什么值 , 上式均成立 , 从而得证。下面用定理 4 证明。由于f ( X) x1= - 2 x1f ( X ) x2= - 2 x2·141·2 f ( X) x21= - 2 < 02 f ( X) x22= - 22 f ( X) x2 x1=2 f ( X) x1 x2= 02| H | =2 其海赛矩阵处处负定 , 故 f ( X) 为 ( 严格 ) 凹函数。 00= 4 > 04. 凸函数的极值前已指出 , 函数的局部极小值并不一定等于它的最小值 , 前者只不过反映了函数的局 部性质。而最优化的目的 , 往往是要求函数在整个域中的最小值 ( 或最大值 ) 。为此 , 必须 将所得的全部极小值进行比较 ( 有时尚需考虑边界值 ) , 以便从中选出最小者。然而 , 对于 定义在凸集上的 凸 函 数 来 说 , 则 用 不 着 进 行 这 种 麻 烦 的 工 作 , 它 的 极 小 值 就 等 于 其 最 小值。定理 5 若 f ( X) 为定义在凸 集 R 上 的凸 函数 , 则它 的任 一极 小点就 是 它在 R 上 的最小点 ( 全局极小点 ) , 而且它的极小点形成一个凸集。证明设 X * 是一个局部极小点 , 则对于充分小的邻域 Nδ( X * ) 中的一切 X , 均有f ( X) ≥ f ( X * )令 Y 是 R 中的任一点 , 对于充分小的 λ, 0 < λ< 1 , 就有 ( (1 - λ) X * +λY) ∈ Nδ( X * )从而f ( (1 - λ) X * +λY) ≥ f ( X * )由于 f ( X) 为凸函数 , 故( 1 - λ) f ( X * ) + λf ( Y ) ≥ f ( (1 - λ) X * + λY)将上述两个不等式相加 , 移项后除以 λ, 得到f ( Y ) ≥ f ( X * )这就是说 , X * 是全局极小点。由性质 3 , 所有极小点的集合形成一个凸集。 定理 6 设 f ( X) 是定义在凸集 R 上的可微凸函数 , 若存在点 X * ∈ R , 使得对于所有的 X∈ R 有f ( X * ) T ( X - X * ) ≥0则 X * 是 f ( X) 在 R 上的最小点 ( 全局极小点 ) 。证明 由定理 3f ( X) ≥ f ( X * ) + f ( X * ) T ( X - X * )如此 , 对所有 X∈ R 有f ( X) ≥ f ( X * )一种极为重要的情形是 , 当点 X * 是 R 的 内点 时 , 这时 ( 6 -19 ) 式对 任意 X - X * 都 成立 , 这就意味着可将 ( 6 -19) 式改为 ·241·(6 -19)f ( X * ) = 0以上两个定理说明 , 定义在凸集上的凸函数的平稳点 , 就是其全局极小点。全局极小点并不一定是唯一的 , 但若为严格凸函数 , 则其全局极小点就是唯一的了。1. 4 凸规则现在再回到非线性规划 (6 -1) 式、( 6 -2) 式和 ( 6 -3 ) 式。 和线性 规划 类似 , 把满 足约 束 条件 (6 -2) 式和 (6 -3 ) 式的点称做可行点 ( 可行解 ) , 所有 可行 点的 集合称 做可 行域。若 某 个可行解使目标函数 (6 -1) 式为最小 , 就称它为最优解。考虑非线性规划min X∈ Rf ( X)R = { X | gj ( X) ≥0 ,j = 1 , 2 , … , l}假定其中 f ( X) 为凸函数 , gj ( X) ( j = 1 , 2 , … , l) 为 凹函 数 ( 或者 说 - gj ( X) 为凸 函数 ) , 这 样的非线性规划称为凸规划。可以证明 , 上述凸规划的可行域为凸集 , 其局部最优解即为 全局最优解 , 而且其最优解的集 合形成 一个 凸 集。当 凸规 划的 目标 函数 f ( X) 为 严格 凸 函数时 , 其最优解必定唯一 ( 假定最优解存在 ) 。由此可见 , 凸规划是一类比较简单而又具 有重要理论意义的非线性规划。由于线性函数既可视为凸函数 , 又可视为凹函数 , 故线性规划也属于凸规划。 例 4 试分析非线性规划min f ( X) = x21 + x22 - 4 x1 + 4g1 ( X) = x1 - x2 + 2≥ 0 g2 ( X) = - x2 x1 , x2 ≥01 + x2 - 1≥ 0解f ( X) 和 g2 ( X) 的海赛矩阵的行列式分别是| H | =2 f ( X) x2 2 f ( X) x1 x212 f ( X ) x2 x12 f ( X ) x22| g2 | ==2 0= 4 > 00 2 2 g2 ( X ) x2 2 g2 ( X ) x12 g2 ( X) x2x112 g2 ( X) x2x22=2 00 2= 0图 6 -4知 f ( X) 为严格凸函数 , g2 ( X ) 为凹函数。 由于其 他约 束条 件均为 线性 函数 , 所以 这是 一 个凸规划问题 ( 见图 6 -4 ) 。 C 点为 其最 优点 : X * = ( 0 .58 , 1 .34 ) T , 目 标函 数 的最 优值 为 f ( X * ) = 3 .8。·341·1. 5 下降迭代算法为了求某可微函数 ( 假定无约束 ) 的最优解 , 根 据前面 的叙 述 , 可如 下进行 : 令 该函 数 的梯度等于零 , 由此求得平稳点 ; 然后用充分 条件进 行判 别 , 求出 所要的 解。对某 些较 简 单的函数 , 这样做有时是可行的 ; 但对一般 n 元函数 f ( X) 来说 , 由 条件 f ( X) = 0 得到 的 常是一个非线性方程组 , 解它相当困难。对 于不可 微函 数 , 当然谈 不上 使用 这样的 方法。 为此 , 常直接使用迭代法。迭代法的基本思想是 : 为了求函 数 f ( X ) 的最 优解 , 首 先 给定 一个 初始 估 计 X( 0 ) , 然 后按某种规划 ( 即算法 ) 找出 比 X( 0 ) 更好 的解 X( 1 ) ( 对 极小化 问题 , f ( X( 1 ) ) < f ( X( 0 ) ) ; 对 极大化问题 , f ( X( 1 ) ) > f ( X( 0 ) ) ) , 再按此种规则找出 比 X( 1 ) 更 好的解 X( 2 ) , …。如此即 可 得到一个解的序列{ X( k) }。若这个解序列有极限 X * , 即 ‖ X( k) - X * ‖ = 0 ,lim k→ ∞则称它收敛于 X * 。若这算法是有效的 , 那么它所产生的解的序列将收敛于该问题的最优解。不过 , 由于 计算机只能进行有限次迭代 , 一般说很难得到准确解 , 而只能得到近似解。当满足所要求 的精度时 , 即可停止迭代。若由某算法所产生的 解 的序 列 { X( k) } 使 目 标函数值 f ( X( k) ) 逐步减少 , 就称这算法为下 降 算法。“下降”的要 求 比较 容 易 实 现 , 它 包 含 了 很多种具体 算法。 显 然 , 求 解极 小 化问 题 应 采 用下降算法。现假 定 已 迭 代 到 点 X( k) ( 见 图 6 -5 ) , 若 从 X( k) 出发沿任何方向移动都不能使目标函数值下 降, 则 X( k) 是 一 局 部 极 小 点 , 迭 代 停 止。 若 从 X( k) 出发至少存在一个方向可使目标函数值 有所下降 , 则可选 定能使目标函数 值下降的某 方向 P( k) , 沿 这 个 方 向 迈 进 适 当 的 一 步 , 得 到 下 一 个 迭 代 点 X( k + 1 ) , 并 使 f ( X( k + 1 ) ) < f ( X( k) ) 。这相当于在射线图 6 -5X = X( k) +λP( k )上选定新点X( k + 1 ) = X( k) +λk P ( k)其中 , P( k) 称为搜索方向 ;λk 称为步长或步长因子。下降迭代算法的步骤可总结如下 : (1 ) 选定某一初始点 X( 0 ) , 并令 k: = 0 ; (2 ) 确定搜索方向 P( k) ; (3 ) 从 X( k) 出发 , 沿方向 P( k) 求步长 λk , 以产生下一个迭代点 X( k + 1 ) ; (4 ) 检查得到的新点 X( k + 1 ) 是否为极小 点或近似 极小点。若 是 , 则 停止迭 代。否则 ,令 k: = k + 1 , 转回 ( 2) 继续进行迭代。在以上步骤中 , 选取搜索方向 P( k) 是最关 键的 一步 , 各 种算法 的区 分 , 主要在 于确 定·441·搜索方向的方法不同。确定步长 λk 可选用不同 的方 法。最 简单 的 一种 是 令它 等 于某 一 常 数 ( 例 如 令 λk = 1) , 这样做计算简便 , 但不能保证使目标函数 值下 降。第二 种称为 可接 受点 算法 , 只要 能 使目标函数值下降 , 可任意选取步长 λk 。第三 种方法是 基于沿 搜索方 向使 目标函 数值 下 降最多 , 即沿射线 X = X( k) + λP( k) 求目标函数 f ( X) 的极小 :λk : min f ( X( k) + λP( k) ) (6 -20) 由于这项工作是求以 λ为变量 的一 元函 数 f ( X( k) + λP( k) ) 的 极小 点 λk , 故 常 称这 一过 程 为 ( 最优 ) 一维搜索或线搜索 , 这样确定的步长为最佳步长。一维搜索有个十分重要的性质: 在搜索方向上所得最优点处的梯度和该搜索方向正交。 定理 7 设目标函数 f ( X) 具有一阶连续偏导数 , X( k + 1 ) 按下述规则产生λk : mi nλf ( X( k) + λP( k) )则有X( k + 1 ) = X( k) + λk P( k ) f ( X( k + 1 ) ) T P( k ) = 0(6 -21)证明 构造函数 φ(λ) = f ( X( k) + λP( k) ) , 则得φ(λk ) = minλφ(λ)X( k + 1 ) = X( k) + λk P( k )即 λk 为φ(λ) 的极小点。此外 φ′(λ) = f ( X( k) +λP( k) ) T P( k) 由 φ′(λ) |λ= λk = 0 , 可得 f ( X( k) + λk P( k) ) T P( k) = f ( X( k + 1 ) ) T P( k ) = 0定理得证。(6 -21 ) 式的几何意义见图 6 -6。 对一个好的算法 , 不仅要求它 产生的点 列能收敛 到 问题的最 优 解 , 还 要 求 具 有 较 快 的 收 敛 速 度。 设 序 列 { X( k) }收敛于 X * , 若 存 在 与 迭代 次 数 k 无 关 的 数 0 < β< ∞和α≥1 , 使 k 从某个 k0 > 0 开始都有‖ X( k + 1 ) - X * ‖≤β‖ X( k) - X * ‖α(6 -22)成立 , 就称{ X( k) }收敛的阶为 α, 或{ X( k) }α阶收敛。当 α= 2 时 , 称为二 阶收 敛 , 也可 说 { X( k) } 具 有二 阶敛速。图 6 -6当 1 <α< 2 时 , 称超线性收敛。 当 α= 1 , 且 0 <β< 1 时 , 称线性收敛或一阶收敛。 一般讲 , 线性收敛的敛速是比较慢的 , 二阶收敛是很快的 , 超级性收敛介于两者之间。若一个算法具有超线性或更高的收敛速度 , 就认为它是一个很好的算法。因为真正的最优解事先并不知道 , 为决定什么时候停止计算 , 只能根据相继两次迭代的结果。常用的终止计算准则有以下几种 : (1 ) 根据相继两次迭代的绝对误差‖ X( k + 1 ) - X( k) ‖ <ε1(6 -23)| f ( X( k + 1 ) ) -f ( X( k) ) | <ε2(6 -24)(2 ) 根据相继两次迭代的相对误差·541·‖ X( k + 1 ) - X( k) ‖ ‖ X( k) ‖<ε3| f ( X( k + 1 ) ) -f ( X( k) ) || f ( X( k) ) |<ε4这时要求分母不接近于零。(3 ) 根据目标函数梯度的模足够小‖ f ( X( k) ) ‖ <ε5其中ε1 ,ε2 ,ε3 ,ε4 ,ε5 为事先给定的足够小的正数。第 2 节 一 维 搜 索前已述及 , 当用上述迭代法求函数的极小 点时 , 常 常要 用到一 维搜 索 , 即沿某 一已 知方向求目标函数的极小点。一维搜索的方法很多 , 常用的有 : (1 ) 试探法 (“成功 - 失败”法 , 斐波那契法 , 0 .618 法等 ) ; (2 ) 插值法 ( 抛物线插值法 , 三次插值法等 ) ; (3 ) 微积分中的求根法 ( 切线法 , 二分法等 ) 。 限于篇幅 , 以下仅介绍斐波那契法和 0 .618 法。2. 1 斐波那契 (Fibonacci) 法 (分数法 )设 y = f ( t)是区间[ a, b] 上的下单峰函数 (图 6 -7) , 在此区间内它有唯一极小点 t* 。若在此区间内任取两点 a1 和 b1 , a1 < b1 , 并计算函数值 f ( a1 ) 和 f ( b1 ) ,可能出现以下两种情形:(1 )(2 )f ( a1 ) < f ( b1 ) ( 图 6 -7 ( a ) ) , 这时极小点 t* 必在区间 [ a, b1 ] 内。 f ( a1 ) ≥ f ( b1 ) ( 图 6 -7 ( b) ) , 这时极小点 t* 必在区间 [ a1 , b] 内。图 6 -7这说明 , 只要在区间 [ a, b] 内取两个不同点 , 并算出它们的函数值加以比较 , 就可以 把 搜索区间 [ a, b] 缩小成 [ a, b1 ] 或 [ a1 , b] ( 缩小后的区 间仍需 包含极小 点 ) 。 现在 , 如果要 继 续缩小搜索区间 [ a, b1 ] ( 或 [ a1 , b] ) , 就 只 需在 上 述区 间 内再 取 一 点算 出 其函 数 值 , 并 与 f ( a1 ) 或 f ( b1 ) 加以比较即可。只要缩小后的 区间包 含极 小点 t* , 则区 间缩小 得越 小 , 就 越接近于函数的极小点 , 但计算函数值的次 数也 就越多。 这就 说明区 间的 缩短率 和函 数 值的计算次数有关。现在要问 , 计算函数值 n 次 , 能把包含有极小点的区间缩小到什么程 度呢 ? 或者换一种说法 , 计算函数值 n 次能把原来多 大的 区间 缩小成 长度 为一个 单位 的 区间呢 ?如果用 Fn 表示计算 n 个函数值能缩短为单位区间的最大原区间长度 , 显然·641·(6 -25)(6 -26)(6 -27)(6 -28) F0 = F1 = 1 其原因是 , 只有当原区间长度本来就是一个 单位长 度时 才不 必计算 函数 值 ; 此外 , 只计 算 一次函数值无法将区间缩短 , 故只有区间长度本来就是单位区间时才行。现考虑计算函数值两次的情形 , 今后我们把计算函数值的点称做试算点或试点。 在区间 [ a, b] 内取两个不同点 a1 和 b1 ( 图 6 -8 ( a ) ) , 计 算 其函 数值 以缩 短区 间 , 缩 短 后的区间为 [ a, b1 ] 或 [ a1 , b] 。显然 , 这两个区间长度之和 必大于 [ a, b] 的长度 , 也 就是说 , 计算两次函数值一般无法把长度大于二个单 位的区 间缩 成单位 区间。 但是 , 对于 长度 为 两个单位的区间 , 可以如图 6 -8( b ) 那样选取试点 a1 和 b1 , 图中ε为任意小的正数 , 缩短后 的区间长度为 1 +ε。由于ε可任意选取 , 故 缩短 后的区 间长 度接 近于一 个单 位长度。 由 此可得 F2 = 2。图 6 -8根据同样的分析 ( 见图 6 -9 ) 可得F3 = 3 ,F4 = 5 ,F5 = 8 , …序列{ Fn }可写成一个递推公式 :n≥ 2(6 -29) 利用公 式 ( 6 -29 ) , 可依 次 算 出 各 Fn 的 值 , 见 表 6 -1。 这些 Fn 就 是 通 常 所 说 的 斐 波 那 契数。Fn = Fn - 1 + Fn - 2表 6 -1n0123456789101112Fn1123581321345589144233由以上讨论可知 , 计 算 n 次 函数 值所 能获得的最大缩短率 ( 缩短后的 区间 长度 与原区间长度之比 ) 为 1/ Fn 。例 如 F20 = 10946 , 所以计算 20 个函 数值即 可把 原长 度为 L 的区间缩短为L 10946= 0 .00009 L的区间。 现在 , 要 想计 算 n 个 函 数 值 , 而 把区间 [ a0 , b0 ] 的长 度缩 短为 原来 长 度的图 6 -9δ倍 , 即缩短后的区间长度为bn - 1 - an - 1 ≤ ( b0 - a0 )δ则只要 n 足够大 , 能使下式成立即可 :Fn ≥ 1 δ(6 -30)式中δ为一个正小数 ,称为区间缩短的相对精度。有时给出区间缩短的绝对精度 η, 即要求·741·%DÔÈ©Šcµçk‚(cid:10)(cid:6)ÈX©wµ9k–Šçé(cid:30)(cid:6)bn - 1 - an - 1 ≤η(6 -31)显然 , 上述相对精度和绝对精度之间有如下关系 :η= ( b0 - a0 )δ(6 -32)用这个方法缩短区间的步骤如下 : ( 1) 确定试点的个数 n。根据相对精度 δ, 即 可用式 ( 6 -30 ) 算 出 Fn , 然 后由 表 6 -1 确 定 最 小 的 n。( 2) 选取前两个试点的位置。 由 ( 6 -29 ) 式 可 知 第一 次 缩 短 时的 两 个 试 点图 6 -10位置分别是 ( 见图 6 -10 ) :t1 = a0 +Fn - 2 Fn( b0 - a0 )= b0 +Fn - 1 Fn( a0 - b0 )(6 -33)t′1 = a0 +Fn - 1 Fn( b0 - a0 )它们在区间内的位置是对称的。(3 ) 计算函数值 f ( t1 ) 和 f ( t′1 ) , 并比较它们的大小。 若 f ( t1 ) < f ( t′1 ) , 则取a1 = a0b1 = t′1t′2 = t1并令t2 = b1 +Fn - 2 Fn - 1( a1 - b1 )否则 , 取a1 = t1b1 = b0t2 = t′1并令t′2 = a1 +Fn - 2 Fn - 1( b1 - a1 )(4 ) 计算 f ( t2 ) 或 f ( t′2 ) ( 其中的一 个已经 算出 ) , 如 第 3 步那 样一步步 迭代。计算 试点的一般公式为 :tk = bk - 1 +Fn - k F n - k + 1( ak - 1 - bk - 1 )t′k = ak - 1 +Fn - k F n - k + 1( bk - 1 - ak - 1 )(6 -34)其中 k = 1 , 2 , … , n - 1。(5 ) 当进行至 k = n - 1 时 ,tn - 1 = t′n - 1 =1 2( an - 2 + bn - 2 )这就无法借比较函数值 f ( tn - 1 ) 和 f ( t′n - 1 ) 的大小以确定最终区间 , 为此 , 取·841·tn - 1 =1 2( an - 2 + bn - 2 )1 2 其中ε为任意小的数。在 tn - 1 和 t′n - 1 这两点中 , 以函数值较 小者为近似极小 点 , 相应 的函 数值为近似极小值 , 并得最终区间 [ an - 2 , t′n - 1 ] 或 [ tn - 1 , bn - 2 ] 。t′n - 1 = an - 2 ++ε ( bn - 2 - an - 2 )(6 -35)由上述分析可知 , 斐波那契法使用对称搜 索的 方法 , 逐 步缩短 所考 察的区 间 , 它能 以尽量少的函数求值次数 , 达到预定的某一缩短率。例 5 试用斐波那契法求函数 f ( t) = t2 - t + 2 的 近似 极小 点和极 小值 , 要求 缩短 后的区间长度不大于区间 [ - 1 , 3 ] 的 0 .08 倍。解 容易验证 , 在此区间上函数 f ( t) = t2 - t + 2 为严格凸函数。为了进行比较 , 我们给出其精确解是 : t* = 0 .5 ,f ( t* ) = 1 .75。 已知 δ= 0 .08 , Fn ≥1/ δ= 1/ 0 .08 = 12 .5 查表 6 -1 , n = 6 , a0 = - 1 , b0 = 3t1 = b0 +F5 F6( a0 - b0 ) = 3 +8 13( - 1 - 3 ) = 0 .538t′1 = a0 +F5 F6( b0 - a0 ) = - 1 +8 13( - 3 - ( - 1) ) = 1 .462f ( t1 ) = 0 .5382 - 0 .538 + 2 = 1 .751 f ( t′1 ) = 1 .4622 - 1 .462 + 2 = 2 .675 由于 f ( t1 ) < f ( t′1 ) , 故取 a1 = - 1 , b1 = 1 .462 , t′2 = 0 .538t2 = b1 +F4 F5( a1 - b1 ) = 1 .462 +5 8( - 1 - 1 .462 ) = - 0 .077f ( t2 ) = ( - 0 .077) 2 - ( - 0 .077 ) + 2 = 2 .083由于 f ( t2 ) > f ( t′2 ) = 1 .751 , 故取 a2 = - 0 .077 , b2 = 1 .462 , t′3 = 0 .538t′3 = a2 +F3 F4( b2 - a2 ) = - 0 .077 +3 5( 1 .462 + 0 .077 ) = 0 .846f ( t′3 ) = 0 .8462 - 0 .846 + 2 = 1 .870由于 f ( t′3 ) > f ( t3 ) = 1 .751 , 故取 a3 = - 0 .077 , b3 = 0 .846 , t′4 = 0 .538t4 = b3 +F2 F3( a3 - b3 ) = 0 .846 +2 3( - 0 .077 - 0 .846) = 0 .231f ( t4 ) = 0 .2312 - 0 .231 + 2 = 1 .822由于 f ( t4 ) > f ( t′4 ) = 1 .751 , 故取 a4 = 0 .231 , b4 = 0 .846 , t5 = 0 .538。现令 ε= 0 .01 , 则t′5 = a4 +1 2+ε ( b4 - a4 )= 0 .231 + ( 0 .5 + 0 .01) (0 .846 - 0 .231) = 0 .545 f ( t′5 ) = 0 .5452 - 0 .545 + 2 = 1 .752 > f ( t5 ) = 1 .751故取 a5 = 0 .231 , b5 = 0 .545。由于 f ( t5 ) = 1 .751 < f ( t′5 ) = 1 .752 , 所 以以 t5 为近 似极小点 , 近似极小值为 1 .751。缩短后的区间长度为 0 .545 - 0 .231 = 0 .314 ,0 .314/ 4 = 0 .0785 < 0 .08 , 其 整个 计算过程示于图 6 -11 中。·941·图 6 -112. 2 0 .618 法 ( 黄金分割法 )由上节的论述可知 , 当用斐波那契法以 n 个试点来缩短某一区间时 , 区间长度的第一次缩短率为 Fn - 1/ Fn , 其后各次分别为Fn - 2 Fn - 1,Fn - 3 Fn - 2,… ,F1 F2现将以上数列分为奇数项 F2 k - 1/ F2 k 和偶数 项 F2 k/ F2 k + 1 , 可 以证明 , 这 两个 数列收 敛于 同 一个极限。设当 k→∞时F2 k - 1 F2 k→λF2 k F2 k + 1→μ由于F2 k - 1 F2 k=F2 k - 1 F2 k - 1 + F2 k - 2=1 +1 F2 k - 2 F2 k - 1故当 k→∞时lim k→ ∞F2 k - 1 F2 k=1 1 + μ=λ同理可证μ=1 1 + λ将 (6 -36 ) 式代入 ( 6 -37 ) 式得μ=1 + μ 2 + μ即μ2 + μ- 1 = 0·051·(6 -36)(6 -37)从而可得μ=5 - 1 2若把 (6 -37 ) 式代入 ( 6 -36 ) 式 , 则得λ2 +λ- 1 = 0故有λ= μ=5 - 1 2= 0 .6180339887418948(6 -38)现用不变的区间缩短率 0 .618 , 代替斐波那契法每次 不同的 缩短率 , 就得 到了黄金 分 割法 (0 .618 法 ) 。这个方法可以看成是斐波那契法的近似 , 实现 起来比 较容易 , 效果也 相 当好 , 因而易于为人们所接受。当用 0 .618 方法时 , 计算 n 个试点 的函 数值可 以把 原区 间 [ a0 , b0 ] 连 续缩 短 n - 1 次 ,因为每次的缩短率均为 μ, 故最后的区间长度为( b0 - a0 )μn - 1这就是说 , 当已知缩短的相对精度为 δ时 , 可用下式计算试点个数 n:μn - 1 ≤δ(6 -39) 当然 , 也可以不预先计算试点的 数目 n, 而 在计算 过程 中 逐次 加以 判断 , 看是 否已 满足了提出的精度要求。0 .618 法是一种等速对称进行试探 的方 法 , 每 次的 试点 均取 在区 间 长度 的 0 .618 倍和 0 .382 倍处。第 3 节 无约束极值问题的解法本节研究无约束极值问题的解法 , 这种问题可表述为X∈ En(6 -40) 前面曾指出 , 在求解上述问题时常使用迭代法 , 迭代法可大体分为两大类。一类要用到函 数的一阶导数和 ( 或 ) 二阶导数 , 由于用到了 函数的 解析 性质 , 故称 为解 析法 ; 另一 类在 迭 代过程中仅用到函数值 , 而不要求函数的解 析性 质 , 这类 方法称 为直 接法。一 般说 来 , 直 接法的收敛速度较慢 , 只是在变量较少时才适用。但是直接法的迭代步骤简单 , 特别是当 目标函数的解析表达式十分复杂 , 甚至写不 出具体 表达 式时 , 它们 的导 数很 难求得 , 或 者 根本不存在 , 这时解析法就无能为力了。min f ( X) ,本节仅介绍几种常用的基本方法 , 其中前三种属解析法 , 后面一种属直接法。3. 1 梯度法 (最速下降法 )在求解无约束极值问题的解析法中 , 梯度 法是最 为古 老但 又十分 基本 的一种 数值 方 法。它的迭代过程简单 , 使用方便 , 而且又是理解 某些 其他 最优化 方法 的基础 , 所 以我 们 先来说明这一方法。·151·1. 梯度法的基本原理假定无约束极值问题 (6 -40 ) 式中 的目 标函 数 f ( X) 有 一 阶连 续偏 导数 , 具有 极小 点 X * 。以 X( k) 表示极小点的第 k 次近似 , 为了求其第 k + 1 次近似 点 X( k + 1 ) , 我们在 X( k) 点 沿方向 P( k) 做射线X = X( k) + λP( k)(λ≥ 0)现将 f ( X) 在 X( k) 点处展成泰勒级数f ( X) = f ( X( k) + λP( k) )= f ( X( k) ) +λ f ( X( k) ) T P( k) + o(λ)其中lim λ→ 0o(λ) λ = 0对于充分小的 λ, 只要f ( X( k) ) T P( k) < 0即可保证 f ( X( k) + λP( k) ) < f ( X( k) ) 。这时若取X( k + 1 ) = X( k) + λP( k)就能使目标函数值得到改善。现考查不同的方向 P( k) 。假 定 P( k ) 的模 一 定 ( 且 不 为零 ) , 并 设 f ( X( k) ) ≠ 0 ( 否 则 , X( k) 是平稳点 ) , 使式 ( 6 -41 ) 成 立的 P( k) 有无限 多个。为了使目标函 数值能得到尽量 大的 改善 , 必须寻求使 f ( X( k) ) T P( k) 取最小值的 P( k) 。由线性代数学知道 f ( X( k) ) T P( k) = ‖ f ( X( k) ) ‖·‖ P( k) ‖cosθ (6 -42) 式中 θ为向量 f ( X( k) ) 与 P( k) 的夹角。当 P( k) 与 f ( X( k) ) 反向时 ,θ= 180°, cosθ= - 1。 这 时 (6 -41 ) 式成立 , 而且其左端取最小值。我们称方向 f ( X( k) )P( k) = -为负梯度方向 , 它是使函数值下降最快的方向 ( 在 X( k ) 的某一小范围内 ) 。为了得到下一个近似极小点 , 在选定了搜索方 向之后 , 还要 确定步长 λ。 当采用可 接受点算法时 , 就是取某一 λ进行试算 , 看是否满足不等式f ( X( k) - λ f ( X( k) ) ) < f ( X( k) ) (6 -43) 若上述不等式成立 , 就可以迭代下去。否则 , 缩小 λ使满足不等式 ( 6 -43 ) 式。由于采用 负 梯度方向 , 满足 ( 6 -43) 式的 λ总是存在的。另一种方法是通过在负梯度方向的一维搜索 , 来确定使 f ( X ) 最 小的 λk , 这种梯度 法就是所谓最速下降法。2. 计算步骤现将用梯度法解无约束极值问题的步骤简要总结如下 : (1 ) 给定初始近似点 X( 0 ) 及精度ε> 0 , 若‖ f ( X( 0 ) ) ‖2 ≤ε, 则 X( 0 ) 即为近似极小点。 (2 ) 若‖ f ( X( 0 ) ) ‖2 >ε, 求步长 λ0 , 并计算 X( 1 ) = X( 0 ) - λ0f ( X( 0 ) )·251·(6 -41)求步长可用一维搜索法、微分法或试算法。若求最佳步长 , 则应使用前两种方法。(3 ) 一般地 , 设已迭代到点 X( k ) , 若‖ f ( X( k) ) ‖2 ≤ε, 则 X( k) 即为 所求的 近似 解 ; 若‖ f ( X( k) ) ‖2 >ε, 则求步长 λk , 并确定下一个近似点X( k + 1 ) = X( k ) - λkf ( X( k) )(6 -44)如此继续 , 直至达到要求的精度为止。若 f ( X) 具有二阶连续偏导数 , 在 X( k) 作 f ( X( k) - λ f ( X( k) ) ) 的泰勒展开 :f ( X( k) - λ f ( X( k) ) ) ≈ f ( X( k) ) -f ( X( k) ) Tλ f ( X( k) ) +1 2λ f ( X( k) ) T H ( X( k) )λ f ( X( k) )对 λ求导并令其等于零 , 则得近似最佳步长λk =f ( X( k) ) T f ( X( k ) ) T H ( X( k) )f ( X( k) )f ( X( k) )(6 -45)可见近似最佳步 长不 只 与 梯 度 有关 , 而 且 与海 赛 矩 阵 H 也 有 关 系 , 计 算 起 来 比 较麻烦。确定步长 λk 也可不用公式 (6 -45 ) , 而采用任一种一维搜索法 ( 例如 0 .618 法等 ) 。 有时 , 将搜索方向 P( k) 的模规格化为 1 , 在这种情况下P( k ) =f ( X( k) ) ‖ f ( X( k) ) ‖(6 -46)同时 , 式 ( 6 -45) 变为λk =f ( X( k) ) Tf ( X( k) ) ‖ f ( X( k) ) ‖f ( X( k ) ) T H ( X( k) )f ( X( k) )(6 -47)例 6 试用梯度法求f ( X) = ( x1 - 1) 2 + ( x2 - 1 ) 2的极小点 , 已知 ε= 0 .1。解 取初始点 X( 0 ) = ( 0 , 0) Tf ( X ) = [ 2( x1 - 1 ) , 2( x2 - 1) ] T f ( X( 0 ) ) = ( - 2 , - 2 ) T‖ f ( X( 0 ) ) ‖2 = (( - 2) 2 + ( - 2 ) 2 ) 2 = 8 >εH ( X) =2 00 2由式 (6 -45 )λ0 =f ( X( 0 ) ) T f ( X( 0 ) ) T H ( X( 0 ) )f ( X( 0 ) )f ( X( 0 ) )=( - 2 , - 2 )( - 2 , - 2 )2 00 22222=8 16=1 2X( 1 ) = X( 0 ) - λ0f ( X( 0 ) ) =001 222=11f ( X( 1 ) ) = [2 (1 - 1) , 2 (1 - 1) ] T = (0 , 0 ) T·351·故 X( 1 ) 即为极小点。注意 , 计算步长 λ0 时也可不用海赛矩阵。由于X( 1 ) = X( 0 )λ f ( X( 0 ) ) =00λ22=2λ 2λ代入目标函数可得f ( X( 1 ) ) = ( 2λ- 1 ) 2 + ( 2λ- 1) 2 = 2( 2λ- 1 ) 2令d f ( X( 1 ) )/ dλ= 0即得所求步长 λ0 = 1/ 2。由这个例子可知 , 对于 目标 函数 的等 值线 为 圆的 问题 来说 , 不 管 初 始点 位 置取 在 哪 里 , 负梯度方向总是直指圆心 , 而圆心即为极值点。这样 , 只要一次迭代即可达到最优解。例 7 试求 f ( X) = x2 解 取初始点 X( 0 ) = ( 2 , 2) T , f ( X( 0 ) ) = 104 。本例使用规格化搜索方向法。 现先取用固定步长 λ= 1 , 其迭代过程示如表 6 -2 。1 + 25 x22 的极小点。表 6 -2步骤点x1x2f ( X( k) ) x1f ( X( k) ) x2‖ f ( X( k) )‖0X(0 )224100～1001X(1 )1.961.003.925050.12X(2 )1.8803.7603.763X(3 )0.8801.7601.764X(4 )0.1200.2400.245X(5 )0.880继续计算下去可以看出 , x1 将来回振荡 , 难以收敛到极 小点 (0 , 0 ) 。为使 迭代过程 收敛 , 必须不断减小步长 λ的值。采用最佳步长时收敛较快 , 而且相邻两 步的 搜索方 向互 相垂 直。下面 用最佳 步长 进行搜索。其迭代过程列于表 6 -3 中。表 6 -3步骤点λkx1x2f ( X( k) ) x1f ( X( k) ) x2f ( X( k) )0X( 0 )2.0032241001041X( 1 )1.8501.920.0033.840.153.692X( 2 )0.0700.0700.0700.143.500.133X( 3 )0.0700.000·451·I~5¿c«(cid:7)~c¿5«(cid:7)~«5c¿(cid:7)~«¿c5(cid:7)~5¿c«(cid:7)«5(cid:7)Õ(cid:4)ÂÀ(cid:144)‘!|ïÂÀ(cid:144)|ï‘!ÀÂ(cid:144)|!‘ïÀ|ï为直观起见 , 将上述两种迭代过程分别画于图 6 -12 及图 6 -13 中。图 6 -12图 6 -13可以证明 , 当 f ( X) 是具有一阶连续偏导数的 凸函数时 , 如 果由最速 下降法所 得的 点 列{ X( k) }有界 , 则必有 : ①数列{ f ( X( k) )}单 调下降 ; ②序 列{ X( k ) } 的极限 X * 满足 f ( X * ) = 0 ; ③ X * 为全局极小点。由于负梯度方向的最速下降性 , 很容易使人们认为负梯度方向是理想的搜索方向 , 最 f ( X) , 仅在 X速下降法是一种理想 的极 小化 方法。 必须 指出 , X 点处 的负 梯度 方向 - 点附近才具有这种“最速下降”的性质 , 而对于 整个极小化过 程来 说 , 那 就 是 另外 一 回事 了。 由例 6 可知 , 若目标函数的等值线为 一族同心 圆 ( 或同心球 面 ) , 则 从任 一 初始 点 出发 , 沿最 速下降方向一 步 即可 达 到极 小 点。但 通 常的情况并不是这 样 , 例 如 , 一 般二 元 二次 凸 函数 的等值线为一族共心椭圆 , 当用最速 下降法趋 近 极 小 点 时 , 其 搜 索 路 径 呈 直 角 锯 齿 状 ( 图 6 -14) 。在开 头 几 步 , 目 标 函 数 值 下 降 较 快 , 但接近极小点 X * 时 , 收敛速度就不理想了。特别是当目 标函数 的等值线 椭圆比较 扁 平时 , 收敛速度就更慢了。因此 , 在实用中 , 常将梯度法和其他方法联合起来应用 , 在前期 使用梯度法 , 而在接近极小点时 , 则使用收敛较快的其他方法。图 6 -143. 2 共轭梯度法1. 共轭方向设 X 和 Y 是 n 维欧氏空间 E n 中的两个向量 , 若有XT Y = 0就称 X 和 Y 正交。再设 A 为 n× n 对称正定阵 , 如果 X 和 A Y 正交 , 即有XT A Y = 0(6 -48)则称 X 和 Y 关于 A 共轭 , 或 X 和 Y 为 A 共轭 ( A 正交 ) 。·551·一般地 , 设 A 为 n× n 对称正定阵 , 若非零向量组 P( 1 ) , P( 2 ) , … , P( n ) ∈ En 满足条件( P( i ) ) T A P( j) = 0 ( i≠ j;i, j = 1 , 2 , … , n)(6 -49) 则称该向量组为 A 共轭。如果 A = I( 单位阵 ) , 则上 述条件即 为通常 的正交条 件。因此 , A 共轭概念实际上是通常正交概念的推广。定理 8 设 A 为 n× n 对称正 定阵 , P( 1 ) , P( 2 ) , … , P( n) 为 A 共 轭的 非零 向 量 , 则这 一组向量线性独立。证明 设向量 P( 1 ) , P( 2 ) , … , P( n) 之间存在如下线性关系 α1 P( 1 ) + α2 P( 2 ) + … +αn P( n) = 0对 i = 1 , 2 , … , n, 用 ( P( i) ) T A 左乘上式得αi ( P( i ) ) T A P( i) = 0但 P( i) ≠0 , A 为正定 , 即( P( i) ) T A P( i ) > 0故必有αi = 0 ,i = 1 , 2 , … , n从而 P( 1 ) , P( 2 ) , … , P( n) 线性独立。无约束极值问题的一个特殊情形是min f ( X) =1 2XT A X + BT X + c式中 A 为 n× n 对称正定阵 ; X , B∈ En ; c 为常数。 问题 (6 -50 ) 式称为 正定 二次函 数极 小 问题 , 它在整个最优化问题中起着极其重要的作用。定理 9 设向 量 P( i) , i = 0 , 1 , 2 , … , n - 1 , 为 A 共轭 , 则从 任 一点 X( 0 ) 出 发 , 相 继 以P( 0 ) , P( 1 ) , … , P( n - 1 ) 为搜索方向的下述算法mi n λf ( X( k) + λP( k) ) = f ( X( k) + λk P ( k) )X( k + 1 ) = X( k) +λk P ( k)经 n 次一维搜索收敛于问题 ( 6 -50 ) 式的极小点 X * 。证明 由式 (6 -50 )f ( X) = A X + B设相继各次搜索得到的近似解分别为 X( 1 ) , X( 2 ) , … , X( n) , 则f ( X( k) ) = A X( k) + B f ( X( k + 1 ) ) = A X( k + 1 ) + B = A( X( k) + λk P( k) ) + B= f ( X( k) ) +λk A P( k)假定 f ( X( k) ) ≠0 , k = 0 , 1 , 2 , … , n - 1 , 则有f ( X( n) ) = f ( X( n - 1 ) ) + λn - 1 A P( n - 1 ) = …= f ( X( k + 1 ) ) +λk + 1 A P( k + 1 ) +λk + 2 A P( k + 2 ) + … +λn - 1 A P( n - 1 )由于在进行一维搜索时 , 为确定最佳步长 λk , 令 d f ( X( k + 1 ) )d f [ X( k) + λP( k) ] dλdλ == f ( X( k + 1 ) ) T P( k) = 0故对 k = 0 , 1 , 2 , … , n - 1 有 ·651·(6 -50)(6 -51)( P( k) ) Tf ( X( n) ) = ( P( k) ) Tf ( X( k + 1 ) ) + λk + 1 ( P( k) ) T A P( k + 1 ) + … +λn - 1 ( P( k) ) T A P( n - 1 ) = 0这就是就 , 而必有f ( X( n) ) 和 n 个线性独立的向量 P( 0 ) , P( 1 ) , … , P( n - 1 ) ( 它们为 A 共 轭 ) 正交 , 从f ( X( n) ) = 0即 X( n ) 为 f ( X) 的极小点 X * 。下面我们就二维 正定 二次 函数 的情 况 加以 说 明 , 以 便对上述定理有个直观认识。二维正定二次函 数的 等值 线 , 在 极小 点附 近 可用 一 族 共心椭圆来代表 ( 图 6 -15 ) 。 大家 知道 , 过 椭 圆族 中 心 X * 引任意直线 , 必 与诸 椭圆 相交 , 各 交点 处 的切 线互 相平 行。 如果在两个互相平 行的 方向 上进 行 最优 一维 搜索 , 则可 得f ( X) 在此方向上的极小点 X( 1 ) 和X( 1 ) , 此两 点必为椭 圆族 中某椭圆与该平行直 线的 切点 , 而且 联结 X( 1 ) 和X( 1 ) 的直 线 必图 6 -15通过椭圆族的中心 X * 。现从任一点 X( 0 ) 出发 , 沿射 线 P( 0 ) 作一 维搜 索 , 则 可得 问题 ( 6 -50 ) 式的 目 标函 数 f( X) 在射线 X( 0 ) +λP( 0 ) 上的极小点X( 1 ) = X( 0 ) + λ0 P( 0 )其中 λ0 满足f ( X( 1 ) ) T P( 0 ) = 0同样 , 从另一点X( 0 ) 出发也沿 P( 0 ) 方向作一维 搜索 , 可得 ( 6 -50) 式中 f ( X) 在射 线λP( 0 ) 上的极小点X( 1 ) =X( 0 ) + λ0 P( 0 )其中 λ0 满足f ( X( 1 ) ) T P( 0 ) = 0从而[f ( X( 1 ) ) -f ( X( 1 ) ) ] T P( 0 ) = 0但由式 (6 -50 )f ( X) = A X + B若令P( 1 ) =X( 1 ) - X( 1 )则有( P( 1 ) ) T A P( 0 ) = 0即 P( 1 ) 和 P( 0 ) 为 A 共轭。上述分析说明 , 对于二维正定二次函数来 说 , 从任 一点 X( 0 ) 出 发 , 沿相 互共轭 的方 向 ·751·X( 0 ) +P( 0 ) 和 P( 1 ) 进行两次一维搜索 , 即可收敛到函数的极小点。2. 正定二次函数的共轭梯度法对于问题 (6 -50) 式来说 , 由于 A 为对称正定阵 , 故存在唯一极小点 X * , 它满足方程组f ( X) = A X + B = 0且具有形式X * = - A - 1 B(6 -53) 如果已知某共轭向量组 P( 0 ) , P( 1 ) , … , P( n - 1 ) , 由定理 9 可知 , 问题 (6 -50 ) 式的 极小 点X * 可通过下列算法得到 :X( k + 1 ) = X( k) +λk P( k) , f ( X( k) +λP( k) )λk : minλk = 0 , 1 , 2 , … , n - 1X( n) = X *算法 (6 -54 ) 式称为共轭方向法。它要求 : 搜索方 向 P( 0 ) , P( 1 ) , … , P( n - 1 ) 必须共 轭 ; 确定各近似极小点时必须按最优一维搜索进行。共轭梯度法是共轭方向法的一种 , 它的搜 索方向 是利 用一 维搜索 所得 极小点 处函 数的梯度生成的 , 我们现在就来构造正定二次函数的共轭梯度法。由于 f ( X) = A X + B, 故有f ( X( k + 1 ) ) -f ( X( k) ) = A( X( k + 1 ) - X( k) )但X( k + 1 ) = X( k) + λk P( K)故f ( X( k + 1 ) ) -f ( X( k) ) =λk A P ( k) ,k = 0 , 1 , 2 , … , n - 1任取初始近似点 X( 0 ) , 并取初始搜索方向为此点的负梯度方向 , 即P( 0 ) = -f ( X( 0 ) )沿射线 X( 0 ) + λP( 0 ) 进行一维搜索 , 得X( 1 ) = X( 0 ) + λ0 P( 0 ) λ0 : minf ( X( 0 ) + λP( 0 ) )λ算出 f ( X( 1 ) ) , 由 (6 -51) 式知f ( X( 1 ) ) T P( 0 ) = -f ( X( 1 ) ) Tf ( X( 0 ) ) = 0从而可知 f ( X( 1 ) ) 和 f ( X( 0 ) ) 正 交 ( 这 里 假 设 f ( X( 1 ) ) 和 f ( X( 0 ) ) 均 不 等 于 零 ) 。 f ( X( 0 ) ) 和 f ( X( 1 ) ) 构成一正 交 系 , 我 们 可 以 在 由 它 们 生 成 的 二 维 子 空 间 中 寻 求 P( 1 ) 。为此 , 可令P( 1 ) = - 式中 α0 为待定系数。欲使 P( 1 ) 与 P( 0 ) 与 A 共轭 , 由 (6 -55) 式 , 必须f ( X( 1 ) ) +α0f ( X( 0 ) )[ -f ( X( 1 ) ) + α0f ( X( 0 ) ) ] T [f ( X( 1 ) ) -f ( X( 0 ) ) ] = 0故α0 =f ( X( 1 ) ) T f ( X( 0 ) ) Tf ( X( 1 ) ) f ( X( 0 ) )·851·(6 -52)(6 -54)(6 -55)令β0 = - α0 =f ( X( 1 ) ) T f ( X( 0 ) ) Tf ( X( 1 ) ) f ( X( 0 ) )(6 -56)由此可得P( 1 ) = -f ( X( 1 ) ) +β0 P( 0 )(6 -57)以 P( 1 ) 为搜索方向进行最优一维搜索 , 可得X( 2 ) = X( 1 ) + λ1 P( 1 ) λ1 : minf ( X( 1 ) + λP( 1 ) )λ算出 f ( X( 2 ) ) , 假定 f ( X( 2 ) ) ≠0 , 因 P( 0 ) 和 P( 1 ) 为 A 共轭 , 故f ( X( 0 ) ) T [f ( X( 2 ) ) -f ( X( 1 ) ) ] = 0但f ( X( 0 ) ) Tf ( X( 1 ) ) = 0故f ( X( 0 ) ) Tf ( X( 2 ) ) = 0由于f ( X( 2 ) ) T P( 1 ) = f ( X( 2 ) ) T [ -f ( X( 1 ) ) + α0f ( X( 0 ) ) ] = 0所以f ( X( 2 ) ) Tf ( X( 1 ) ) = 0即 f ( X( 2 ) ) 、 f ( X( 1 ) ) 和 f ( X( 0 ) ) 构成一 正交 系。现由 它们 生成的 三维 子空 间中 , 寻求 与 P( 0 ) 和 P( 1 ) 为 A 共轭的搜索方向 P( 2 ) 。令P( 2 ) = -f ( X( 2 ) ) + α1f ( X( 1 ) ) + α0f ( X( 0 ) )式中 α0 和 α1 均为待定系数。由于 P( 2 ) 应与 P( 0 ) 和 P( 1 ) 为 A 共轭 , 故须 f ( X( 1 ) ) + α0 f ( X( 1 ) ) + α0f ( X( 2 ) ) +α1 f ( X( 2 ) ) +α1f ( X( 1 ) ) - f ( X( 2 ) ) -f ( X( 0 ) ) ] T [ f ( X( 0 ) ) ] T [[ -[ -f ( X( 0 ) ) ] = 0 f ( X( 1 ) ) ] = 0从而α1f ( X( 1 ) ) T f ( X( 2 ) ) Tf ( X( 1 ) ) - α0 f ( X( 2 ) ) - α1f ( X( 0 ) ) T f ( X( 1 ) ) Tf ( X( 0 ) ) = 0 f ( X( 1 ) ) = 0解之得α1 =α0 =α1f ( X( 2 ) ) T f ( X( 1 ) ) T f ( X( 1 ) ) T f ( X( 0 ) ) Tf ( X( 2 ) ) f ( X( 1 ) ) f ( X( 1 ) ) f ( X( 0 ) )令 β1 = - α1 , 则 α0 = - β1β0 , 于是P( 2 ) = -= -= -= -f ( X( 2 ) ) - β1 f ( X( 2 ) ) + β1 [ - f ( X( 2 ) ) + β1 [ - f ( X( 2 ) ) + β1 P( 1 )f ( X( 1 ) ) - β0β1 f ( X( 1 ) ) - β0 f ( X( 1 ) ) +β0 P( 0 ) ]f ( X( 0 ) ) f ( X( 0 ) ) ](6 -58)·951·继续上述步骤 , 可得一般公式如下 :P( k + 1 ) = -f ( X( k + 1 ) ) +βk P( k)βk =f ( X( k + 1 ) ) T f ( X( k) ) Tf ( X( k + 1 ) ) f ( X( k) )对于正定二次函数来说 ,f ( X) = A X + B, 由 ( 6 -55 ) 式 f ( X( k + 1 ) ) = f ( X( k) ) +λk A P( k)由于进行的是最优一维搜索 , 故有f ( X( k + 1 ) ) T P( k ) = 0从而λk = -f ( X( k ) ) T P( k) ( P( k) ) T A P( k)如此 , 即可得共轭梯度法的一组计算公式如下 :X( k + 1 ) = X( k) + λk P ( k) f ( X( k) ) T P( k) ( P( k) ) T A P( k)λk = -P( k + 1 ) = -f ( X( k + 1 ) ) +βk P( k)βk =f ( X( k + 1 ) ) T f ( X( k) ) Tf ( X( k + 1 ) ) f ( X( k) )k = 0 , 1 , 2 , … , n - 1其中 X( 0 ) 为初始近似 , P( 0 ) = -f ( X( 0 ) ) 。由于 P( k) = -f ( X( k) ) +βk - 1 P( k - 1 ) 以及 f ( X( k) ) T P( k - 1 ) = 0 , 故式 (6 -60) 也可写成 f ( X( k) )f ( X( k) ) Tλk =( P( k) ) T A P( k) (6 -62 ) 式最先由弗莱彻 ( Fletcher ) 和瑞夫斯 ( Reeves) 提出 , 故此法 亦称为 F R 共轭 梯度法。上述公式还有其他等价形式。例如 , 借助于 ( 6 -55) 式 , 可将它变为βk =f ( X( k + 1 ) ) T A P( k) ( P( k) ) T A P( k)现将共轭梯度法的计算步骤总结如下 : (1 ) 选择初始近似 X( 0 ) , 给出允许误差 ε> 0。 (2 ) 计算P( 0 ) = - 并用(6 -59)式和 (6 -60)式算出 X( 1 ) 。计算步长也可使用以前介绍过的一维搜索法。 (3 ) 一般地 , 假定已得出 X( k ) 和 P( k) , 则可计算其第 k + 1 次近似 X( k + 1 ) :f ( X( 0 ) )X( k + 1 ) = X( k) + λk P( k ) λk : mi nf ( X( k) + λP( k) )λ(4 ) 若‖ f ( X( k + 1 ) ) ‖2 ≤ε, 停止 计算 , X( k + 1 ) 即为 要求的 近似 解。否 则 , 若 k < n - 1 ,则用 (6 -62 ) 式和 ( 6 -61 ) 式计算 βk 和 P( k + 1 ) , 并转向第 3 步。应当指出 , 对于二次函数的情形 , 从理论上说 , 进行 n 次迭代即可达到极小点。但是 , 在实际计算中 , 由于数据的舍 入以及 计算 误差 的积累 , 往 往做 不到 这 一点。此 外 , 由 于 n ·061·(6 -59)(6 -60)(6 -61)(6 -62)(6 -63)(6 -64)维问题的共轭方向最多只有 n 个 , 在 n 步以后继续如上进行是没有意义的。因此 , 在实际 应用时 , 如迭代到 n 步还不收敛 , 就将 X( n) 作 为新 的初始 近似 , 重 新开始 迭代。根 据实 际 经验 , 采用这种再开始的办法 , 一般都可得到较好的效果。 例 8 试用共轭梯度法求下述二次函数的极小点 :f ( X) =3 2x2 1 +1 2x2 2 - x1 x2 - 2 x1解 将 f ( X) 化成 (6 -50) 式的形式 , 得A =3111现从 X( 0 ) = ( - 2 , 4) T 开始 , 由于f ( X) = [ (3 x1 - x2 - 2 ) , ( x2 - x1 ) ] T故f ( X( 0 ) ) = ( - 12 , 6 ) TP( 0 ) = -f ( X( 0 ) ) = ( 12 , - 6 ) Tλ0 = -f ( X( 0 ) ) T P( 0 ) ( P( 0 ) ) T A P( 0 ) = -( - 12 , 6 )( 12 , - 6 )31126 - 11126=180 612=5 17于是X( 1 ) = X( 0 ) + λ0 P( 0 ) =24+5 17126=26 17,38 17Tf ( X( 1 ) ) = ( 6/ 17 , 12/ 17 ) Tβ0 =f ( X( 1 ) ) T f ( X( 0 ) ) Tf ( X( 1 ) ) f ( X( 0 ) )=6 17,12 17( - 12 , 6)6/ 1712/ 17 - 126=1 289P( 1 ) = -f ( X( 1 ) ) +β0 P( 0 ) = -6/ 1712/ 17+1 289126=90 289, -210 289Tλ1 = -f ( X( 1 ) ) T P( 1 ) ( P( 1 ) ) T A P( 1 )= -90 289, -6 17 210 289,12 173190 289 - 1, -1210 289T90 289, -210 289T==6×17×90 + 12×17×210 ( - 60 , - 120 ) ( - 90 , - 210 ) T = 17 1017( 6×90 + 12×210 ) 60× 90 + 120×210故X( 2 ) = X( 1 ) +λ1 P( 1 ) =26/ 1738/ 17+17 1090/ 289210/ 289=11·161·这就是 f ( X) 的极小点。图 6 -16 表明了本例的 搜 索方向和步骤。3. 非二次函数的共轭梯度法可将共轭梯度法推广到求 解一般无 约束极 值问题 ( 6 -40 ) 式。图 6 -16设 f ( X) 为某一严格凸函数 , 它具有二阶连 续 偏 导数 , 其 唯 一 极小 点 为 X * 。 现 任取 初 始 近 似 X( 0 ) , 计算 f ( X( 0 ) ) , 选取 P( 0 ) = - f ( X( 0 ) ) 为 初 始 搜 索 方 向 , 做 射 线 X( 0 ) + λP( 0 ) (λ≥ 0 ) , 并 将 f ( X) = f ( X( 0 ) + λP( 0 ) ) 于 X( 0 ) 附近做泰勒展开 :f ( X( 0 ) +λP( 0 ) ) ≈ f ( X( 0 ) ) +λ f ( X( 0 ) ) T P( 0 ) +1 2λ2 ( P( 0 ) ) T H ( X( 0 ) ) P( 0 )上式为λ的二次函数,因 ( P( 0 ) )T H( X( 0 ) ) P( 0 ) > 0, 故使该二次函数沿 P(0 ) 方向取极小值的 λ为λ0 = -f ( X( 0 ) ) T P( 0 ) ( P( 0 ) ) T H ( X( 0 ) ) P( 0 )显然 , 它近似满足 minλf ( X( 0 ) +λP( 0 ) ) 。令X( 1 ) = X( 0 ) + λ0 P( 0 )则 X( 1 ) 近似满足f ( X( 1 ) ) T P( 0 ) = 0现构造向量P( 1 ) = -f ( X( 1 ) ) +β0 P( 0 )使满足 ( P( 1 ) ) T H ( X( 0 ) ) P( 0 ) = 0 , 则得β0 =f ( X( 1 ) ) T H ( X( 0 ) ) P( 0 ) ( P( 0 ) ) T H ( X( 0 ) ) P( 0 )这就确定了 P( 1 ) 。按此手续可构造各次迭代的搜索方向及近似点。一般地 , 我们有 :X( k + 1 ) = X( k) + λk P( k)λk = -f ( X( k) ) T P( k) ( P( k) ) T H ( X( k) ) P( k)( 6 -65 )P( k + 1 ) = -f ( X( k + 1 ) ) +βk P( k) f ( X( k + 1 ) ) T H ( X( k) ) P( k) ( P( k) ) T H ( X( k) ) P( k)βk =( 6 -66 )这就是推广到非二次函数的共轭梯度法的计算公式。由于在导出上述公式的过 程中 利 用了 一些 近 似 关系 , 以及 H ( X( k ) ) 的逐 次 变化 , 使 P( 0 ) , P( 1 ) , … , P( n - 1 ) 的共轭性遭受破坏 , 因而对 于一 般非 二次函 数来 说 , 要以 n 步 迭代 取 得收敛常常是不可能的。所以在实际应用时 , 如 迭代 步数 k≤ n 已 达到 要求 的精度 , 则 以 X( k) 作为要求的近似解。否则可将 前 n 步作 为一 个循环 , 同 时 以所 得到 的 X( n) 作 为新 的 初始近似重新开始 , 进行第二个循环。重复进行 , 直至满足要求的精度为止。 ·261·3. 3 变尺度法变尺度法是近 30 多年来发展起来的 , 它是求解无约束极值问题的一种有效方法。由 于它既避免了计算二阶导数矩阵及其求逆过程 , 又比梯度法的收敛速度快 , 特别是对高维 问题具有显著的优越性 , 因而使变尺度法获得了很高的声誉 , 至今仍被公认为求解无约束 极值问题最有效的算法 之一。 下面 我们 就来 简要 地 介绍 变尺 度法 的基 本 原理 及其 计 算过程。1. 基本原理假定无约束极值问题的目标函数 f ( X) 具有二阶连续偏导数 , X( k) 为其极 小点的某 一近似。在这个点附近取 f ( X) 的二阶泰勒多项式逼近f ( X) ≈ f ( X( k) ) + f ( X( k) ) T Δ+1 2ΔXT H ( X( k) )Δ X(6 -67)则其梯度为f ( X) ≈ f ( X( k) ) + H ( X( k) )ΔX(6 -68)这个近似函数的极小点满足f ( X( k) ) + H ( X( k) )ΔX = 0从而X = X( k) - H ( X( k) ) - 1f ( X( k) )(6 -69)其中 H ( X( k) ) 为 f ( X) 在 X( k) 点的海赛矩阵。如果 f ( X) 是二次函数 , 则 H ( X) 为常数 阵。这时 , 逼近 (6 -67) 式是 准确 的。在这 种 情况下 , 从任一点 X( k) 出发 , 用 (6 -69) 式只要一步即可求出 f ( X) 的极小点 ( 假定 H ( X( k) ) 正定 ) 。当 f ( X) 不是二次函 数时 , ( 6 -67) 式仅 是 f ( X ) 在 X( k) 点 附近的 近 似表 达式。 这时 , 按 (6 -69 ) 式 求 得 的 极 小 点 , 只 是 f ( X ) 的 极 小 点 的 近 似。 在 这 种 情 况 下 , 人 们 常 取 - H ( X( k) ) - 1f ( X( k) ) 为搜索方向 , 即P( k) = - H ( X( k) ) - 1 X( k + 1 ) = X( k) +λk P ( k) λk : minf ( X( k) +λP( k ) )λf ( X( k) )(6 -70)按照这种方式求函数 f ( X) 的 极 小点 的方 法 , 称 做广 义牛 顿法。 ( 6 -70 ) 式确 定的 搜 索方向 , 为 f ( X) 在点 X( k) 的牛 顿方 向。牛顿 法的 收敛速 度很 快 , 当 f ( X) 的 二阶 导数 及 其海赛矩阵的逆阵便于计算时 , 使用这一方法非常有效。问题在于 , 实际问题中的目标函数往往 相当复 杂 , 计算 二阶导 数的 工作 量或者 太大 , 或者根本不可能。况且 , 在 X 的维 数很高 时 , 计算 逆阵也 相当 费事。 为了 不 计算 二阶 导数矩阵 H ( X( k) ) , 从而也不必计 算其逆 阵 H ( X( k) ) - 1 , 我 们设 法构 造另 一 个矩 阵H( k) , 用 它来直接逼近二阶导数矩阵的逆阵 H ( X( k) ) - 1 。下面就来研究如何构造 H ( X( k) ) - 1 的近 似矩阵H( k ) 。我们 要求 , 在 每一 步 都能 以现 有·361·的信息来确定下一个搜索方向 ; 每做一次迭代 , 目标函数值均有所下降 ; 而且 , 这些近似矩 阵最后应收敛于解点处的海赛矩阵的逆阵。当 f ( X) 是二次函数时 , 其海赛矩阵为常 数阵 , 可 知其 在任两 点 X( k) 和 X( k + 1 ) 处的 梯度之差等于f ( X( k + 1 ) ) -f ( X( k) ) = A( X( k + 1 ) - X( k) )或X( k + 1 ) - X( k) = A - 1 [f ( X( k + 1 ) ) -f ( X( k) ) ](6 -71) 对于非二次函数 , 仿照二次函数的情形 , 要求 其海赛 矩阵 的逆阵 的第 k + 1 次 近似 矩阵 H( k + 1 ) 满足关系式X( k + 1 ) - X( k) =( k + 1 ) [f ( X( k + 1 ) ) -f ( X( k) ) ]H此式就是所谓的拟牛顿条件。若令ΔG( k) = f ( X( k + 1 ) ) - Δ X( k ) = X( k + 1 ) - X( k)f ( X( k) )则 (6 -72 ) 式变为ΔX( k) =H( k + 1 ) ΔG( k)现设 H( k) 已知 , 并用下式求H( k + 1 ) ( 假定H( k) 和H( k + 1 ) 都为对称正定阵 ) :H( k + 1 ) =H( k) +ΔH( k)上式中 Δ H( k) 为第 k 次校正矩阵 ,H( k + 1 ) 应满足拟牛顿条件 , 即要求ΔX( k) = (H( k) + Δ -H( k) )ΔG( k)或Δ - H( k) ΔG( k) = Δ X( k ) -H( k) ΔG( k)由此可以设想 Δ H( k) 的一种较简单形式为Δ H( k) = Δ X( k) ( Q( k) ) T -H( k ) ΔG( k) ( W ( k) ) T式中 Q( k) 和 W ( k) 为两个待定向量。将表达式 (6 -76 ) 代入 ( 6 -75 ) 式得ΔX( k) ( Q( k) ) T ΔG( k)- H( k) ΔG( k) ( W ( k) ) TΔG( k) = ΔX( k) -H( k) ΔG( k)这就是说 , 应使( Q( k) ) T ΔG( k) = ( W( k) ) T ΔG( k) = 1由于 Δ H( k) 应为对称阵 , 最简单的办法就是取Q( k) = ηkΔX( k) W ( k) =ξk( k) ΔG( k)H·461·(6 -72)(6 -73)(6 -74)(6 -75)(6 -76)(6 -77)(6 -78)由 (6 -77 ) 式ηk (Δ X( k ) ) T ΔG( k) =ξk (ΔG( k) ) TH( k) ΔG( k) = 1设 (Δ X( k) ) T ΔG( k) 以及 (ΔG( k) ) TH( k) ΔG( k) 皆不为零 , 则有ηk =ξk =1 (ΔX( k) ) T ΔG( K) = 1 -1 (ΔG( k) ) TΔ X( k)(6 -79)(ΔG( k) ) TH( k) ΔG( k)于是得到校正矩阵Δ H( k) =Δ X( k) (Δ X( k) ) T (ΔG( k) ) TΔ X( k)H( k) ΔG( k) (ΔG( k) ) TH(ΔG( k) ) TH( k) ΔG( k)( k)(6 -80)从而得到H( k + 1 ) =H( k) +ΔX( k) (ΔX( k) ) T (ΔG( k) ) T ΔX( k)H( k) ΔG( k) (ΔG( k ) ) TH(ΔG( k) ) TH( k) ΔG( k)( k )(6 -81)上述矩阵称为尺度矩阵 , 在 整个 迭代 过 程中 它是 在不 断变 化 的。有了 尺 度矩 阵 , 即 可 依 (6 -70 ) 式进行迭代计算。2. 计算步骤现将变尺度法的计算步骤总结如下 : (1 ) 给定初始点 X( 0 ) 及梯度允许误差ε> 0。 (2 ) 若‖ f ( X( 0 ) ) ‖2 ≤ε则 X( 0 ) 即为近似极小点 , 停止迭代。否则 , 转向下一步。(3 ) 令H( 0 ) = I( 单位阵 )P( 0 ) = -H( 0 )f ( X( 0 ) )在 P( 0 ) ( 0) 方向进行一维搜索 , 确定最佳步长 λ0 :min λf ( X( 0 ) + λP( 0 ) ) = f ( X( 0 ) + λ0 P( 0 ) )如此可得下一个近似点X( 1 ) = X( 0 ) + λ0 P( 0 )(4 ) 一般地 , 设已得到近似点 X( k ) , 算出 f ( X( k) ) , 若‖ f ( X( k) ) ‖2 ≤ε则 X( k ) 即为所求的近似解 , 停止迭代 ; 否则 , 按式 ( 6 -81) 计算H( k) , 并令P( k) = -H( k)f ( X( k) )在 P( k) 方向进行一维搜索 , 确定最佳步长 λk :min λf ( X( k) +λP( k ) ) = f ( X( k) +λk P( k) )·561·其下一个近似点为X( k + 1 ) = X( k) +λk P ( k)(5 ) 若 X( k + 1 ) 点满足精度要求 , 则 X( k + 1 ) 即为所求的近似解。否则 , 转回第 4 步 , 直到求出某点满足精度要求为止。和共轭梯度法相类似 , 如果迭代 n 次 仍不 收敛 , 则以 X( n) 为 新的 X( 0 ) , 以这 时的 X( 0 )为起点重新开始一轮新的迭代。上述方法首先由戴维顿 ( Davidon ) 提出 , 后经 弗莱 彻 ( Fletcher ) 和 鲍 威尔 ( Powell ) 加以改进 , 故称 DFP 法 , 或 DFP 变尺度法。例 9 试用 DFP 法重新计算例 3 。 解 和例 3 一样 , 仍从 X( 0 ) = ( - 2 , 4 ) T 开始 , 并取H( 0 ) =1 00 1f ( X) = [ (3 x1 - x2 - 2 ) , ( x2 - x1 ) ] T f ( X( 0 ) ) = ( - 12 , 6 ) TP( 0 ) = -H( 0 )f ( X( 0 ) ) = -1 00 1126=126利用一维搜索 , 即 minλf ( X( 0 ) +λP( 0 ) ) , 可算得λ0 =5 17X( 1 ) = X( 0 ) + λ0 P( 0 ) =24f ( X( 1 ) ) =+5 176 17,12 17126 T=26 17,38 17TT26 17 ΔG( 0 ) = f ( X( 1 ) ) -38 17ΔX( 0 ) = X( 1 ) - X( 0 ) =,( - 2 , 4 ) T =f ( X( 0 ) )60 17, -30 17T=6 17,12 17T( - 12 , 6) T =210 17, -90 17TH( 1 ) =H( 0 ) +ΔX( 0 ) (ΔX( 0 ) ) T (ΔG( 0 ) ) T ΔX( 0 )H( 0 ) ΔG( 0 ) (ΔG( 0 ) ) TH(ΔG( 0 ) ) TH( 0 ) ΔG( 0 )( 0 )=1 00 1+60 17 210 17, -, -30 17 90 17T 60 17 60 17, -, -30 17 30 17T1 00 1210 17210 17, -, -90 1790 17T 210 17, -1 00 1210 1790 17, -90 171 00 1 T=1 00 1+1 1742211 584921219·661·=1 986385 241241 891P( 1 ) = -H( 1 )f ( X( 1 ) ) = -1 986385 241241 8916/ 1712/ 17= -9/ 2921/ 29再由一维搜索 minλf ( X( 1 ) + λP( 1 ) ) , 得λ1 =29 17从而26/ 1729 17X( 2 ) = X( 1 ) + λ1 P( 1 ) =+38/ 17 f ( X( 2 ) ) = (0 , 0 ) T9/ 2921/ 29=11可知 X( 2 ) = ( 1 , 1) T 为极小点。在以上讨论中, 我们取第一个尺度矩阵H( 0 ) 为对称正定阵 , 以后的尺度矩阵由 (6 -81) 式逐步形成。可以证 明, 这 样构成 的尺 度矩阵 均为 对称 正定 阵。由 此 可知 其搜 索方 向 P( k) =- H( k)f ( X( k) ) 为下降方向 , 这就可以保证每次迭代均能使目标函数值有所改善。当把 DF P 变尺度法用于正定二次 函数时 , 产 生的 搜索 方向为 共轭 方向 , 因而 也具 有 有限步收敛的性质。若将初始尺 度矩 阵也 取为 单位 矩 阵 , 对这 种函 数 来说 , DF P 法就 与 共轭梯度法一样了。还要指出 , 可以采用不同的方法来构造尺度矩阵H( k) , 从而就有不同的 变尺度 法。DFP法属于拟牛顿法的一种。开始时取 H( 0 ) = I, 这相当于第一步采用最速下降法。 以后的H( k) 接近于 H ( X( k) ) - 1 , 当达到极小点时 , 从 理论 上讲 , 这时 的尺 度矩 阵应等 于该 点处海 赛阵 的 逆阵。例 10 试用 DFP 法求min f ( X) = 4 ( x1 - 5 ) 2 + ( x2 - 6) 2解取H( 0 ) =1 00 1,X( 0 ) =89由于f ( X ) = [ 8( x1 - 5 ) , 2( x2 - 6) ] T f ( X( 0 ) ) = (24 , 6) T故X( 1 ) = X( 0 ) +λ0 P( 0 ) = X( 0 ) + λ0 [ -( 0 )f ( X( 0 ) ) ]==8λ09 8 - 24λ0 9 - 6λ01 00 1246=H 89λ0246·761·f ( X( 1 ) ) = 4[ (8 - 24λ0 ) - 5] 2 + [ ( 9 - 6λ0 ) - 6 ] 2令d f ( X( 1 ) ) dλ0= 0可得λ0 =17 130X( 1 ) = [ (8 - 24λ0 ) , ( 9 - 6λ0 ) ] T = ( 4 .862 , 8 .215) T ΔX( 0 ) = X( 1 ) - X( 0 ) = ( - 3 .138 , - 0 .785 ) T f ( X( 1 ) ) = 4 .985 f ( X( 1 ) ) = ( - 1 .108 , 4 .431) TΔG( 0 ) = f ( X( 1 ) ) -f ( X( 0 ) ) = ( - 25 .108 , - 1 .569) T由此可得H( 1 ) =H( 0 ) +Δ X( 0 ) (ΔX( 0 ) ) T (ΔG( 0 ) ) T ΔX( 0 )H( 0 ) ΔG( 0 ) (ΔG( 0 ) ) TH(ΔG( 0 ) ) TH( 0 ) ΔG( 0 )( 0 )=1 00 1+( - 3 .138 , - 0 .785 ) T ( - 3 .138 , - 0 .785 ) ( - 25 .108 , - 1 .569) ( - 3 .138 , - 0 .785 ) T1 00 1( - 25 .108 , - 1 .569) T ( - 25 .108 , - 1 .569 )( - 25 .108 , - 1 .569 )1 00 1( - 25 .108 , - 1 .569) T=1 00 1+0 .1231 0 .03080 .0308 0 .00770 .9961 0 .06220 .0622 0 .0039=0 .12700 .03150 .03151 .0038故X( 2 ) = X( 1 ) - λ1( 1 )f ( X( 1 ) )H=4 .8628 .215λ10 .12700 .03150 .0315 1 .00381 .1084 .431如上求最佳步长 , 可得λ1 = 0 .4942代入上式得X( 2 ) = ( 5 , 6) T这就是极小点。若将该问题的目标函数 f ( X) 表示成 (6 -50) 式的形式 , 可知A =8 00 2而·861·1 00 1A - 1 =1/ 8 00 1/ 2现计算出该问题的 H ( 2 ) :H( 2 ) =1 .25× 10 - 1 - 8 .882×10 - 1 68 .882× 10 - 16 5 .00 ×10 - 1可知二者实际相等。在以上几节中 , 我们介绍了求解无约束极值问题的解析法 , 这些方法只是众多算法中 的一部分。一般认为 , 从迭代次数上考虑 , 变尺度法所需迭代次数较少 , 共轭梯度法次之 , 最速下降法 ( 一阶梯度法 ) 所需迭代次数最多。 但从每 次迭 代所需 的计 算工 作量来 看 , 却 正好相反 , 最速下降法最简单 , 变尺度法比它们都繁。3. 4 步长加速法步长加 速 法 亦 称 模 式 法 或 模 矢 法 ( Pat tern Sea rch ) , 由 胡 克 ( H ooke ) 和 基 夫 斯 ( Jeeves ) 于 1961 年提 出 , 是 一 种直 接 法。它 易 于编 制 计 算 机程 序 , 且 具有 追 寻 谷 线 ( 脊 线 ) 加速移向最优点的性质。1. 基本原理假定欲求某实值函数 f ( X) 的极小点 , 为 此 , 任选 一基点 B1 ( 初 始近似 点 ) , 算 出此 点的目标函数值。然后沿第 i 个坐标方向以某一 步长 Δi 进行 探索 , 即 在 B1 + Δi 和 B1 - Δi 这两点中寻求能使目标函数值下降的点 , 并把它作为临时矢点 ; 再由此点出发沿另一坐标 方向进行同样的探索 , 如能得到比以前更好的点 , 就以该点代替前面的点作为新的临时矢 点。如此沿各 个 坐 标方 向 轮 流 探 查一 遍 , 并 选这一轮探 索 得到 的 最好 的 点 ( 最 后 的 临 时 矢点 ) 为 第 二 个 基 点 B2 。 由 第 一 个 基 点 B1 到第二 个基 点 B2 构 成了 第 一个 模 矢。对 第 一个基点来 说 , 可 以认 为 这 个 模矢 的 方 向 可 能是使目标函数值得以改善 的最有 利的移 动方向 , 沿这 一方 向 前进 , 目 标函 数 值 下 降“ 最 快”( 就 B1 附 近 而 言 ) 。显 然 , 这 一 方向 近 似 于目标函数 的 负梯 度 方向 ( 从 而可 知 这 一 方 法为近似 最速 下 降法 ) 。 现 假 定在 第 二 个 基 点 B2 附近进行类似的探索 , 其结 果可能 和在 B1 处的情形相同 , 故略 去这 步探 索而 把第 一 个模矢加长一倍 ( 即所谓加速 ) 。现 设其 端点 T20 是 第二 个 模矢 的终 点 ( 下 一 步迭 代的 初 始临时矢点 ) , 这样 B2 T20 就构成了假定的第二个模矢。然后 , 在 T20 附近进行如上类似 的 探索 , 得出新的最好的点———第三 个基点 B3 。据 此修 改假定 的第 二个 模矢 , 使它 的起 点 为 B2 , 终点为 B3 。其后 , 再把第二个 模矢 延 长一 倍…… 如 此继 续进 行探 索 和加 速 , 即 可 得到越来越好的目标函数下降点 ( 请参看图 6 -17) 。图 6 -17·961·如果探索进行到某一步 时得 不出 新的 下降 点 , 则 应缩 小步 长 以进 行 更精 细 的 探索。 当步长已缩小到某一精度要求 , 但仍得不到新的下降点时 , 即可将该点作为所求的近似极 小点 , 就此停止迭代。图 6 -17 示出了一个在二维空 间中 用模 矢法 探求 极 小点 X * 的 例 子。该 例从 初始 基 点 B1 开始 , 用模矢法相继得出基点 B2 、B3 、B4 和 B5 。这 时如不 缩小步长 , 就 得不出新 的 基点 ( 图中的基点 B6 和 B5 是同一个点 ) 。2. 计算步骤根据上述分析 , 现将用模矢法求解无约束极值问题 ( 6 -40) 式的计算步骤总结如下。 (1 ) 任选初始近似点 B1 , 以它为初始基点进行探索。 (2 ) 为每一独立变量 xi ( i = 1 , 2 , … , n) 选定步长0 ⁝Δi =0 δi←第 i 个分量0 ⁝0上式中 Δi 为第 i 个分量是δi , 而其他所有分量均为零的向量。(3 ) 算出初始基点 B1 的目标函数值 f ( B1 ) , 考虑点 B1 + Δ1 , 若 f ( B1 + Δ1 ) < f ( B1 ) , 就 以 B1 +Δ1 为临时矢点, 并记为 T11 。这里的 第一个下标表示 现在是在建立第 一个模矢 , 第 二个下标表示变量 x1 已被摄动。若 B1 + Δ1 不比 B1 点好 , 就试验 B1 - Δ1 , 如果它比 B1 点 好, 就以它比临时矢点 , 否则, 以 B1 为临时矢点。即T11 =B1 + Δ1 , 若 f ( B1 + Δ1 ) < f ( B1 ) B1 - Δ1 , 若 f ( B1 - Δ1 ) < f ( B1 ) ≤ f ( B1 + Δ1 )B1 ,若 f ( B1 ) ≤ min [ f ( B1 + Δ1 ) , f ( B1 - Δ1 ) ]对于下一个独立变量 x2 进行类似的摄动 , 这时 , 用临时矢点 T11 代替原来的基点 B1 。一般地T1 , j + 1 =T1 j + Δj + 1 , 若 f ( T1 j + Δj + 1 ) < f ( T1 j ) T1 j - Δj + 1 , 若 f ( T1 j - Δj + 1 ) < f ( T1 j ) ≤ f ( T1 j + Δj + 1 )T1 j ,若 f ( T1 j ) ≤ min[ f ( T1 j + Δj + 1 ) , f ( T1 j - Δj + 1 ) ]上式中 , 0 ≤ j≤ n - 1 , T10 = B1 。n 个变量都摄动之后 , 得临时矢点 T1 n , 并令T1 n = B2原来的基点 B1 和新基点 B2 确定了第一个模矢。(4 ) 将第一个模矢延长一倍 , 得第二个模矢的初始临时矢点 T2 0(6 -86) (5 ) 在 T20 附近进行和上面类似的探索 , 建立临时矢点 T21 , T2 2 , … , T2 n , 以 T2 n 为第三T2 0 = B1 + 2 ( B2 - B1 ) = 2 B2 - B1个基点 B3 。这样 , B2 、B3 就确立了第二个模矢。第三个模矢的初始临时矢点为·071·(6 -82)(6 -83)(6 -84)(6 -85)T3 0 = B2 + 2 ( B3 - B2 ) = 2 B3 - B2注意 , 如上述进行探索时 , 若在一个方向上重复见效 , 就会使模矢增长 , 这一点可由下式看出 :B3 - B2 = 2 ( T20 - B2 ) = 2 ( B2 - B1 )(6 -87)(6 ) 继续上述过程。对于第 i 个模矢 , 如果f ( T i0 ) < f ( B i ) 但沿各坐标方向的所有摄动均得不 出比 T i0 更 好的 点 , 则以 T i0 为 Bi + 1 , 而 且 不把 这个 模 矢延长。若 f ( T i0 ) ≥ f ( Bi ) , 且由 Ti0 产生不出比 Bi 更好的点 , 则应退回到 Bi , 并在 Bi 附近 进 行探索。如能得出新的下降点 , 即可引出新的模矢 ; 否则 , 将步长缩小 , 以进行更精细的探 查。当步长缩小到要求的精度时 , 即可停止迭代。对于比较复杂的目标函数 , 为了防止把局部极值误认为全局最优值 , 应分区域进行探 查 , 并从各区域搜索得到的局部极值和极值点中选取最优者 ; 或者从任意选取的不同点开 始 , 至少引入两个独立的搜索 , 如果它们都收敛 于同一 个点 , 则 这个点 作为 最优点 的把 握 就大大增加了。·171·第 7 章约束极值问题实际工作中遇到的大多数极值问题 , 其变量的取值多受到一定限制 , 这种限制由约束 条件来体现。带有约束条件的极值问题称为 约束极 值问 题 , 也叫 规划问 题。非线 性规 划 的一般形式为min f ( X)hi ( X) = 0 , gj ( X) ≥ 0 ,i = 1 , 2 , … , m j = 1 , 2 , … , l或min f ( X)gj ( X) ≥0 ,j = 1 , 2 , … , l问题 (7-2) 也常写成min f ( X) , X∈ R EnR = { X | gj ( X) ≥ 0 ,j = 1 , 2 , … , l}求解约束极值问题要比 求 解无 约束 极值 问题 困 难得 多。对有 约 束 的极 小 化问 题 来说 , 除了要使目标函数在每次迭代有所下降之 外 , 还要 时刻注 意解 的可行 性问 题 ( 某些 算 法的中间步骤除外 ) , 这就给寻优工作带来了很大困难。为了实际求解和 ( 或 ) 简化其优化 工作 , 可采用以下方法 : 将约束问题化为无约束 问题 ; 将非 线性 规划问 题化 为线性 规划 问 题 , 以及能将复杂问题变换为较简单问题的其他方法。第 1 节 最优性条件1. 1 起作用约束和可行下降方向的概念现考虑上述一般非线性规划 , 假定 f ( X) 、hi ( X ) 和 gj ( X) ( i = 1 , 2 , … , m; j = 1 , 2 , … ,l) 具有一阶连续偏导数。设 X( 0 ) 是非线性规划的一个可行解 , 它 当然 满足所 有约 束。现考 虑某 一不等 式约 束 条件 gj ( X) ≥ 0 , X( 0 ) 满足它有两种可能 : 其一为 gj ( X( 0 ) ) > 0 , 这时 , 点 X( 0 ) 不 是处于由 这 一约束条件形成的可行域边界上 , 因而这一约束对 X( 0 ) 点的微小摄动不起限制作用 , 从而 称这个约束条件是 X( 0 ) 点的不起作用约束 ( 或 无效 约束 ) ; 其二 是 gj ( X( 0 ) ) = 0 , 这时 X( 0 ) 点处于该约束条件形成的可行域边界上 , 它对 X( 0 ) 的摄动起到了某种限制作用 , 故称这个 约束是 X( 0 ) 点的起作用约束 ( 有效约束 ) 。显而易见 , 等式约束对所有可行点来说都是起作用约束。 假定 X( 0 ) 是非线性规划 ( 7 -3) 式的一个可行点 , 现 考虑此 点的 某一方 向 D, 若 存在 实数 λ0 > 0 , 使对任意 λ∈ [ 0 ,λ0 ] 均有X( 0 ) +λD∈ R·271·(7-1)(7-2)(7-3)( 7 -4)就称方向 D 是 X ( 0 ) 点的一个可行方向。若 D是 可 行点 X ( 0 ) 处 的 任 一 可 行 方 向 ( 参 看 图 7 -1 ) , 则 对 该 点 的所 有 起 作 用 约 束均有gi ( X) ≥0 gj ( X( 0 ) ) T D≥0 ,j∈ J其中 J 为这个点所有起作用约束下标的集合。 另一方面 , 由泰勒公式 gj ( X( 0 ) +λD) = gj ( X( 0 ) ) +λ gj ( X( 0 ) ) T D + o(λ) 对所有起作用约束 , 当 λ> 0 足够小时 , 只要gj ( X( 0 ) ) T D > 0 , gj ( X( 0 ) + λD) ≥0 ,j∈ J j∈ J就有 此外 , 对 X( 0 ) 点的不起作 用约 束 , 由约 束 函数 的连 续 性 , 当 λ> 0 足够小时亦有上式成立。从而 , 只要方向 D 满足 ( 7 -6) 式 , 即可保 证它是 X( 0 ) 点的可行方向。图 7 -1考虑非线性规划的某一可行点 X( 0 ) , 对该点的任一方向 D 来说 , 若存在 实数 λ′0 > 0 ,使对任意 λ∈ [0 ,λ′0 ] 均有f ( X( 0 ) + λD) < f ( X( 0 ) )就称方向 D 为 X ( 0 ) 点的一个下降方向。将目标函数 f ( X) 在点 X( 0 ) 处作一阶泰勒展开 , 可知满足条件f ( X( 0 ) ) T D < 0的方向 D 必为 X ( 0 ) 点的下降方向。如果方向 D 既是 X ( 0 ) 点的可行 方向 , 又是 这个 点的 下降 方向 , 就 称它 是 该点 的可 行 下降方向。假如 X( 0 ) 点不是极小点 , 继续寻优时的搜 索方 向就 应从该 点的 可行下 降方 向 中去找。显然 , 若某点存在可行下降方向 , 它 就不会 是极 小点。另 一方 面 , 若某点 为极 小 点 , 则在该点不存在可行下降方向。定理 1 设 X * 是非线性规划 ( 7 -3) 式的一个局部极小点 , 目标函数 f ( X) 在 X * 处 可微 , 而且gj ( X) 在 X * 处可微 , 当 j∈ J gj ( X) 在 X * 处连续 , 当 j(cid:925) J则在 X * 点不存在可行下降方向 , 从而不存在向量 D 同时满足 :f ( X * ) T D < 0 gj ( X * ) T D > 0 ,j∈ J这个定理显然是成立的。事实上 , 若存在 满足 (7 -8) 式的 方向 D, 则沿 该方向 搜索 可找到更好的点 , 从而与 X * 为极小点的假设矛盾。(7 -8 ) 式的几何意义十分明显。满足该条件的方向 D, 与 点 X * 处目标函 数负梯度 方向的夹角为锐角 , 与点 X * 处起作用约束梯度方向的夹角也为锐角。1. 2 库恩 - 塔克条件假定 X * 是非线性规划 (7 -3) 式 的极 小点 , 该 点可 能位 于 可行 域的 内部 , 也可 能处 于 ·371·( 7 -5)( 7 -6)( 7 -7)( 7 -8)可行域的边界上。若为前者 , 这事实上是个无约束问题 , X * 必满足条件 f ( X * ) = 0 ; 若为 后者 , 情况就复杂得多了 , 现在我们来讨论后一种情形。不失一般性 , 设 X * 位于第一个约束条件形成的可行 域边界 上 , 即第一个 约束条件 是 X * 点的起作用约束 ( g1 ( X * ) = 0) 。若 X * 是极 小点 , 则 g1 ( X * ) 必与 - f ( X * ) 在一 条 直线上且方向相反 ( 我们在这里假定向量 g1 ( X * ) 和 f ( X * ) 皆 不为零 ) , 否 则 , 在 该点 就 一定存在可行下降方向 ( 图 7 -2 中的 X * 点 为极 小点 ; X 点不 满足 上述 要求 , 它不 是极 小 点 , 角度 β表示了该点可行下降方向的范围 ) 。上面的论述说明 , 在上述条件下 , 存在实 数 γ1 ≥ 0 , 使f ( X * ) - γ1g1 ( X * ) = 0若 X * 点有两个起作用约束 , 例如说有 g1 ( X * ) = 0 和 g2 ( X * ) = 0 。在这种情况下 ,f ( X * ) 必处于 g1 ( X * ) 和 g2 ( X * ) 的夹角之内。如 若不然 , 在 X * 点必 有可行下 降方向 , 它就不会是极小点 ( 图 7 -3 ) 。由此 可见 , 如 果 X * 是 极小 点 , 而且 X * 点的 起 作用 约束 条 件的梯度 g1 ( X * ) 和 g2 ( X * ) 线性无关 , 则可将 f ( X * ) 表示成 g1 ( X * ) 和 g2 ( X * ) 的 非 负线性组合。也就是说 , 在这种情况下存在实数 γ1 ≥0 和 γ2 ≥0 , 使f ( X * ) - γ1g1 ( X * ) - γ2g2 ( X * ) = 0图 7-2图 7-3如上类推 , 可以得到f ( X * ) - ∑j∈ Jγjgj ( X * ) = 0为了把不起作用约束也包括进式 (7-9) 中 , 增加条件 γj g j ( X * ) = 0 γj ≥0当 gj ( X * ) = 0 时 ,γj 可不为零 ; 当 gj ( X * ) ≠0 时 , 必有 γj = 0 。如此即可得到著名的库恩 - 塔克 ( Kuhn - Tucker , 简写为 K - T) 条件。库恩 - 塔克条件是非线性规划领域中最重要 的理 论成 果之一 , 是 确定 某点为 最优 点 的必要条件。只要是最优点 ( 而且该点起作 用约 束的梯 度线 性无 关。满足 这种要 求的 点 称为正则点 ) , 就必须满足这个条件。但一般说 它并不 是充 分条件 , 因 而满 足这个 条件 的 点不一定就是最优点 ( 对于凸规划 , 它既是最优点存在的必要条件 , 同时也是充分条件 ) 。现可将库恩 - 塔克条件叙述如下 : 设 X * 是非线性规划 (7 -3 ) 式的极小点 , 而 且在 X * 点 的各起 作用 约束 的梯度 线性 无·471·(7-9)关 , 则存在向量 Γ* = (γ*1,γ*2, … ,γ*l ) T , 使下述条件成立 :f ( X * ) - ∑γ*jgj ( X * ) = 0j = 1γ*j g j ( X * ) = 0 , j ≥ 0 ,γ*j = 1 , 2 , … , l j = 1 , 2 , … , l( 7-10)条件 (7-10 ) 式常简称为 K - T 条件。满 足这 个条件 的点 ( 它 当然 也满 足非线 性规 划的 所 有约束条件 ) 称为库恩 - 塔克点 ( 或 K - T 点 ) 。为了得出非线性规划 (7-1) 式的库恩 - 塔克条件 , 我们用hi ( X) ≥0 - hi ( X) ≥0 代替约束条件 hi ( X ) = 0 , 这 样 即 可 使用 条 件 ( 7 -10 ) , 从 而 得 到这 时 的 库 恩 - 塔 克 条 件 如下 :设 X * 是非 线 性 规 划 ( 7 -1 ) 式 的 极 小 点 , 而 且 X * 点 的 所 有 起 作 用 约 束 的 梯 度hi ( X * ) ( i = 1 , 2 , … , m) 和 gj ( X * ) ( j∈ J ) 线性无关 , 则存在向量 , … ,γ*Λ* = (λ*,λ*, … ,λ*m ) T 和 Γ* = (γ*,γ*2112l ) T使下述条件成立 :mf ( X * ) - ∑λ*ihi ( X * ) - ∑γ*jgj ( X * ) = 0i = 1j = 1γ*j g j ( X * ) = 0 ,j = 1 , 2 , … , l(7 -11)γ*j ≥0 ,j = 1 , 2 , … , l当然 , 满足条件 ( 7 -11) 式的点也称为库恩 - 塔克点。在条件 (7 -10 ) 式和 ( 7 -11 ) 式中 ,λ*1,λ*2, … ,λ*m 以 及 γ*1, γ*2, … ,γ*l 称 为 广义 拉格 朗日 ( Lagr ange ) 乘子。例 1 用库恩 - 塔克条件解非线性规划min f ( x) = ( x - 3 ) 20≤ x≤5 解 先将该非线性规划问题写成以下形式min f ( x ) = ( x - 3 ) 2 g1 ( x) = x≥ 0 g2 ( x) = 5 - x≥0写出其目标函数和约束函数的梯度 :f ( x ) = 2 ( x - 3 ) ,g1 ( x ) = 1 , g2 ( x) = - 1对第一个和第二个约束 条 件 分别 引 入 广 义 拉格 朗 日 乘 子 γ*1 和 γ*2, 设 K - T 点 为x *, 则可写出该问题的 K - T 条件如下 :2 ( x * 1 x * = 0 γ* 2 ( 5 - x * ) = 0 γ* γ* 2 ≥ 03 ) - γ*1 + γ*2 = 0,γ*1·571·为解上述方程组 , 考虑以下几种情形 :(1 ) 令 γ* (2 ) 令 γ* (3 ) 令 γ* (4 ) 令 γ* 由于该非线性规划问题为凸规划 , 故 x * = 3 就是其全 局极小 点。该点是 可行域的 内1 ≠0 ,γ* 1 ≠0 ,γ* 1 = 0 ,γ* 1 =γ*2 ≠0 , 无解。 2 = 0 , 解之 , 得 x * = 0 ,γ* 2 ≠0 , 解之 , 得 x * = 5 ,γ*1 = - 6 , 不是 K - T 点。 2 = - 4 , 不是 K - T 点。2 = 0 , 解之 , 得 x* = 3 , 此为 K - T 点 , 其目标函数值 f ( x * ) = 0。点 , 它也可直接由梯度等于零的条件求出。第 2 节 二 次 规 划若某非线性规划的目标函数为 自变量 X 的二 次函数 , 约 束条 件又 全是 线 性的 , 就 称 这种规划为二次规划。二次规划是非线性规 划中比 较简 单的一 类 , 它较 容易 求解。由 于 很多方面的问题都可以抽象成二次规划的模型 , 而且它和线性规划又有直接联系 , 因而此 处专门提出来简要做一说明。二次规划的数学模型可表述如下 :nmin f ( X) = ∑j = 1cj k = ck j ,cj x j +nn1 2 ∑ k = 1 , 2 , … , n∑cj k x j x kj = 1k = 1n∑ai j x j + bi ≥ 0 ,i = 1 , 2 , … , mj = 1xj ≥0 ,j = 1 , 2 , … , n( 7-14) (7-12 ) 式右端的第二项为二 次型。如 果该 二次型 正定 ( 或 半正 定 ) , 则 目标 函数为 严格 凸 函数 ( 或凸函数 ) ; 此外 , 二次规划的可行域为凸 集 , 因而 , 上述 规划 属于凸 规划 ( 在 极大 化 问题中 , 如果上述二次型为负定或半负定 , 则也属于凸规划 ) 。在第 6 章中已经指出 , 凸规 划的局部极值即为其全局极值。对于这种问题 来说 , 库恩 - 塔 克条件 不但 是极值 点存 在 的必要条件 , 而且也是充分条件。将库恩 - 塔克条件 (7-10 ) 式中的第一个条件应用于二次规划 ( 7-12) 式至 (7-14 ) 式 , 并用 y 代替库恩 - 塔克条件中的 γ, 即可得到nm∑ k = 1cj k x k + ∑i = 1ai j y n+ i + y j = cj ,j = 1 , 2 , … , n在 (7-13 ) 式中引入松弛变量 xn + i , (7 -13) 式即变为 ( 假定 bi ≥0 )n∑ai j x jxn+ i + bi = 0 ,i = 1 , 2 , … , mj = 1再将库恩 - 塔克条件中的第二个条件应用于上述二次规划 , 并考虑到 ( 7-16) 式 , 这就得到x j y j = 0 ,j = 1 , 2 , … , n + m此外还有x j ≥0 ,y j ≥ 0 ,j = 1 , 2 , … , n + m(7 -18) 联立求解 (7 -15 ) 式和 ( 7 -16) 式 , 如果 得到 的解 也满 足 ( 7 -17 ) 式 和 (7 -18 ) 式 , 则 这 样 的解就是原二次规划问题的解。但是 , 在 (7 -15 ) 式中 , cj 可能为 正 , 也可 能为 负。为了 便·671·( 7-12)( 7-13)( 7-15)( 7-16)(7 -17)于求解 , 先引入人工变 量 zj ( zj ≥ 0 , 其 前 面 的 符号 可 取 正 或 负 , 以 便 得 出 可行 解 ) , 这 样 (7 -15 ) 式就变成了mn∑i = 1ai j y n+ i + yj∑ k = 1cj k x k + sgn( cj ) zj = cj,j = 1 , 2 , … , n(7 -19)其中 sgn( cj ) 为符号函数 , 当 cj ≥ 0 时 , sgn ( cj ) = 1 ; 当 cj < 0 时 , sgn ( cj ) = - 1。这样 一来 , 可立刻得到初始基本可行解如下 :zj = sgn( cj ) cj ,xn + i = bi ,x j = 0 ,yj = 0 ,j = 1 , 2 , … , n i = 1 , 2 , … , m j = 1 , 2 , … , n j = 1 , 2 , … , n + m但是 , 只有当 zj = 0 时才能得到 原来 问题的 解 , 故必 须对上 述问 题进行 修 正 , 从而 得到如下线性规划问题 :nmin φ( Z) = ∑zjj = 1mn∑i = 1ai j y n+ i + yj∑ k = 1cj k x k + sgn( cj ) zj = cj,j = 1 , 2 , … , nn∑ai j x j - xn+ i + bi = 0 ,i = 1 , 2 , … , m(7 -20)j = 1x j ≥0 yj ≥0j = 1 , 2 , … , n + m j = 1 , 2 , … , n + mzj ≥0j = 1 , 2 , … , n该线性规划尚应满足 ( 7 -17 ) 式。这 相当 于 说 , 不 能 使 x j 和 y j ( 对 每一 个 j ) 同 时为 基 变 量。解线性规划 (7 -20 ) 式 , 若得到最优解 : , x *( x * , … , x * 例 2 求解二次规划n + m , y *n + m , z1 = 0 , z2 = 0 , … , zn = 0 ), y *, … , y *, … , x *1122则 ( x *, x *n ) 就是原二次规划问题的最优解。21m ax f ( X) = 8 x1 + 10 x2 - x21 - x223 x1 + 2 x2 ≤6 x1 , x2 ≥ 0解 将上述二次规划改写为min f ( X) = x21 + x22 - 8 x1 - 10 x2 =1 2( 2 x21 + 2 x22 ) - 8 x1 - 10 x26 - 3 x1 - 2 x2 ≥ 0 x1 ≥0 ,x2 ≥0可知目标函数为严格凸函数。此外c1 = - 8 ,c2 = - 10 ,c1 1 = 2 ,c22 = 2 ,c12 = c21 = 0 ,b1 = 6 ,a11 = - 3 ,a12 = - 2由于 c1 和 c2 小于零 , 故引入的人工变 量 z1 和 z2 前面 取负 号 , 这样就 得到 线性规 划问 题 如下 :·771·min φ( Z) = z1 + z23 y3 + y1 - 2 x1 - z1 = - 82 y3 + y2 - 2 x2 - z2 = - 103 x1 - 2 x2 - x3 + 6 = 0x1 , x2 , x3 , y1 , y2 , y3 , z1 , z2 ≥0或min φ( Z) = z1 + z22 x1 + 3 y3 - y1 + z1 = 82 x2 + 2 y3 - y2 + z2 = 103 x1 + 2 x2 + x3 = 6 x1 , x2 , x3 , y1 , y2 , y3 , z1 , z2 ≥0此外尚应满足x j y j = 0 ,j = 1 , 2 , 3用线性规划的单纯形法解之 ( 注意 , 在转换过程 中应满 足条件 x j y j = 0 ) , 得该 线性 规划问题的解如下 :x1 = 4/ 13 ,x2 = 33/ 13 ,x3 = 0 ,y1 = 0 ,y2 = 0 ,y3 = 32/ 13 ,z1 = 0 ,z2 = 0由此得到原二次规划问题的解为1 = 4/ 13 , x * x *2 = 33/ 13 ,f ( X * ) = 21. 3读者可以验证 ,1 = 4/ 13 , x * x *2 = 33/ 13 , γ*1 = 0 , γ*2 = 0以及 γ*3 = 32/ 13 满足库恩 - 塔克条件。第 3 节 可行方向法现考虑非线性规划 (7-3) 式 , 设 X( k) 是它 的一个 可行 解 , 但不是 要 求的 极小 点。为 了 求它的极小点或近似极小点 , 根据以前所说 , 应在 X( k ) 点的可行下降方向中选取某一方向 D( k) , 并确定步长 λk , 使X( k + 1 ) = X( k) + λk D ( k) ∈ R f ( X( k + 1 ) ) < f ( X( k) )若满足精度要求 , 迭代停止 , X( k + 1 ) 就是 所要的 点。否 则 , 从 X( k + 1 ) 出发 继续进 行迭 代 , 直 到满足要求为止。上述这种方法称为可行方向法 , 它具有下述特点 : 迭代过程中所采用的 搜索方向为可行方向 , 所产生 的迭代 点列 { X( k) } 始终 在可 行域 内 , 目标 函数 值 单调 下降。 由此可见 , 很多方法都可以归入可行方向法一类。但我们通常所说的可行方向法 , 一般指 的是 Zou tendijk 在 1960 年 提 出 的 算 法 及 其 变 形 , 下 面 就 来 说 明 Zou tendijk 的 可 行 方 向法。设 X( k ) 点的起作用约束集非空 , 为求 X( k) 点的可行下降方向 , 可由下述不等式组确定向量 D: ·871·(7 -21)f ( X( k) ) T D < 0 gj ( X( k) ) T D > 0 ,j∈ J(7 -22)这等价于由下面的不等式组求向量 D 和实数η: f ( X( k) ) T D≤ηgj ( X( k) ) T D≤η,η< 0j∈ J(7 -23)现使 f ( X( k) ) T D 和 -gj ( X( k) ) T D( 对所有 j∈ J ) 的最大 值极 小化 ( 必 须同时 限制 向量 D 的模 ) , 即可将上述选取搜索方向的工作 , 转换为求解下述线性规划问题 :mi n ηf ( X( k) ) T D≤η,gj ( X( k) ) T D≤η,- 1≤ di ≤1 ,j∈ J ( X( k) ) i = 1 , 2 , … , n(7 -24)式中 di ( i = 1 , 2 , … , n) 为 向量 D 的分 量。在 (7 -24 ) 中 加入 最后 一个限 制条 件 , 为 的是 使 该线性规划有有限最优解 ; 由于 我们 的目的 在于 寻找 搜索方 向 D, 只 需知 道 D 的 各分 量 的相对大小即可。将线性规划 (7 -24 ) 式的最优解记为 ( D( k) ,ηk ) , 如果 求出的 ηk = 0 , 说明在 X( k) 点不 存 在可行下降方向 , 在 gj ( X( k) ) ( 此处 j∈ J ( X( k) ) ) 线 性无关 的条 件下 , X( k) 为一 K - T 点。 若解出的 ηk < 0 , 则得到可行下降方向 D( k ) , 这就是我们所要的搜索方向。上述可行方向法的迭代步骤如下 : (1 ) 确定允许误差 ε1 > 0 和 ε2 > 0 , 选初始近似点 X( 0 ) ∈ R, 并令 k: = 0。 (2 ) 确定起作用约束指标集J ( X( k) ) = { j | gj ( X( k) ) = 0 , 1≤ j≤ l}① 若 J ( X( k) ) = ② 若 J ( X( k) ) =( 为空集 ) , 而且‖ f ( X( k) ) ‖2 ≤ε1 , 停止迭代 , 得点 X( k) 。 , 但‖ f ( X( k) ) ‖2 >ε1 , 则 取搜 索方 向 D( k) = -f ( X( k) ) , 然后 转向第 (5 ) 步。③ 若 J ( X( k) ) ≠ , 转下一步。 (3 ) 求解线性规划min ηf ( X( k) ) T D≤ηgj ( X( k) ) T D≤η,- 1≤ di ≤ 1 ,j∈ J ( X( k) ) i = 1 , 2 , … , n设它的最优解是 ( D( k) ,ηk ) 。 (4 ) 检验是否满足|ηk | ≤ε2若满足则停止迭代 , 得到点 X( k) ; 否则 , 以 D( k) 为搜索方向 , 并转下一步。(5 ) 解下述一维极值问题λk : min 0 ≤λ≤λf ( X( k) +λD( k) )此处·971·λ= max{λ| gj ( X( k) + λD( k) ) ≥ 0 ,j = 1 , 2 , … , l}(6 ) 令X( k + 1 ) = X( k) + λk D ( k)k: = k + 1转回第 (2 ) 步。例 3 用可行方向法解下述非线性规划问题max f ( X) = 4 x1 + 4 x2 - x21 - x22x1 + 2 x2 ≤4解 先将该非线性规划问题写成min f ( X) = - 4 x1 - 4 x2 + x21 + x22g1 ( X) = - x1 - 2 x2 + 4≥ 0取初始可行点 X( 0 ) = ( 0 , 0) T , f ( X( 0 ) ) = 0f ( X) =2 x1 - 42 x2 - 4,f ( X( 0 ) ) =44g1 ( X) = ( - 1 , - 2) Tg1 ( X( 0 ) ) = 4 > 0 , 从而 J ( X( 0 ) ) =( 空集 ) 。由于‖ f ( X( 0 ) ) ‖2 = ( - 4) 2 + ( - 4 ) 2 = 32所以 X( 0 ) 不是 ( 近似 ) 极小点。现取搜索方向D( 0 ) = -f ( X( 0 ) ) = (4 , 4 ) T从而X( 1 ) = X( 0 ) +λD( 0 ) =00+λ44=4λ 4λ将其代入约束条件 , 并令 g1 ( X( 1 ) ) = 0 , 解得 λ= 1/ 3。f ( X( 1 ) ) = - 16λ- 16λ+ 16λ2 + 16λ2 = 32λ2 - 32λ令 f ( X( 1 ) ) 对 λ的导数等于零 , 解得λ= 1/ 2。因 λ大于 λ(λ= 1/ 3) , 故取 λ0 =λ= 1/ 3。X( 1 ) =4 3,4 3T,f ( X( 1 ) ) = -64 9f ( X( 1 ) ) =4 3, -4 3T,g1 ( X( 1 ) ) = 0现构成下述线性规划问题 :min η4 3d1 -4 3d2 ≤ηd1 + 2 d2 ≤η - 1≤ d1 ≤1 ,1≤ d2 ≤ 1为便于用单纯形法求解 , 令y1 = d1 + 1 ,y2 = d2 + 1 ,y3 = - η从而得到 : ·081·min ( - y3 )4 4 3 3 y1 + 2 y2 + y3 ≤ 3 y1 ≤2 y2 ≤2y2 - y3 ≥ 8 3y1 +y1 , y2 , y3 ≥0引入剩余变量 y4 , 松弛变量 y5 、y6 和 y7 以及人工变量 y8 , 得线性规划问题如下 :min( - y3 + M y8 )4 3y1 +4 3y2 - y3 - y4 + y8 =8 3y1 + 2 y2 + y3 + y5 = 3y1 + y6 = 2y2 + y7 = 2 y j ≥0 ,j = 1 , 2 , … , 8其最优解为 :y1 = 2 ,y2 = 3/ 10 ,y3 = 4/ 10 ,y4 = y5 = y6 = 0 ,y7 = 17/ 10从而得到 ,η= - y3 = - 4/ 10 , 搜索方向D( 1 ) =d1d2=y1 - 1y2 - 1=1. 00. 7由此4/ 3 + λ 4/ 3 - 0. 7λ f ( X( 2 ) ) = 1. 49λ2 - 0. 4λ- 7. 111X( 2 ) = X( 1 ) + λD( 1 ) =令 d f ( X( 2 ) )dλ= 0 , 得到 λ= 0. 134。现暂用该步长 , 算出X( 2 ) =4/ 3 + 0. 134 4/ 3 - 0. 7×0. 134=1. 4671. 239因 g1 ( X( 2 ) ) = 0. 055 > 0 , 上面算出的 X( 2 ) 为可行点 , 说明选取 λ1 = 0. 134 正确。继续迭代下去 , 可得最优解为 X * = ( 1. 6 , 1. 2) T , 原来问题的最优解不变 , 其目标函数值 f ( X * ) = -f ( X * ) = 7. 2f ( X * ) = - 7. 2。第 4 节 制约函数法本节介绍求解非线性规划问题的制约函 数法。使 用这 种方法 , 可 将非 线性规 划问 题 的求解 , 转化为求解一系 列无 约 束极 值问 题 , 因而 也 称这 种方 法为 序列 无 约束 极小 化 技 术 , 简记为 SU M T ( sequential unconst rained minimization technique ) 。常用 的 制约 函 数 基本上 有 两 类 : 一 为 惩 罚 函 数 ( 或 称 罚 函数 ( penalty function ) ) , 一 为 障 碍 函 数 ( barrie r·181·function ) , 对应于这两种函数 , SU M T 有外点法和内点法。4. 1 外点法考虑非线性规划问题 (7-3) 式 , 为求其最优解 , 构造一个函数 ψ( t)ψ( t) =0 , 当 t≥0 ∞ , 当 t < 0现把 gj ( X) 视为 t, 显然当 X∈ R 时 , 当 X(cid:925) R 时 , 再构造函数ψ( gj ( X) ) = 0 , ψ( gi ( X) ) = ∞。j = 1 , 2 , … , l;φ( X) = f ( X) + ∑ψ( gj ( X) )j = 1现求解无约束问题mi n φ( X) (7 -27) 若该问题有解 , 假定其解为 X * , 则由 ( 7 -25 ) 式 应 有 ψ( gj ( X * ) ) = 0 。这 就是 说点 X * ∈ R。因而 , X * 不仅是 问 题 ( 7 -27 ) 式 的 极小 解 , 它 也 是原 问 题 ( 7 -3 ) 式 的 极 小 解。这 样 一 来 , 就把有约束问题 ( 7 -3 ) 式的求解化成了求解无约束问题 ( 7 -27 ) 式。但是 , 用上述方法构造的函数 ψ( t) 在 t = 0 处不连续 , 更没有导数。为此 , 将该函数 修改为ψ( t) =0 , 当 t≥0 t2 , 当 t < 0修改后的函数 ψ( t) , 当 t = 0 时导数等于零 , 而且 ψ( t) 和 ψ′( t) 对任意 t 都 连续。当 X∈ R 时仍有∑ψ( gj ( X) ) = 0j = 1当 X(cid:925) R 时0 < ∑ψ( gj ( X) ) < ∞j = 1我们取一个充分大的数 M > 0 , 将 φ( X) 改为P( X , M) = f ( X) + M∑ψ( gj ( X) )j = 1或等价地P( X , M) = f ( X) + M∑[ min (0 , gj ( X) ) ] 2j = 1从而可使 min P ( X , M ) 的 解 X ( M ) 为 原 问 题 的 极 小 解 或 近 似 极 小 解。 若 求 得 的 X( M) ∈ R , 则它必定是原问题的极小解。事实上 , 对于所有 X∈ Rf ( X ) + M∑ψ( gj ( X) ) = P( X , M)j = 1≥ P( X( M) , M) = f ( X( M) )·281·(7 -25)( 7-26)(7 -28)( 7-29)( 7-30)即当 X∈ R 时 , 有 f ( X) ≥ f ( X ( M) ) 。函数 P( X , M) 称 为 惩 罚 函 数 , 其 中 的第二项 M∑ψ( gj ( X) ) 称 惩罚项。图 7-4 示j = 1出了这种惩罚项的例子 , 图中左 半部表示 约 束条件 g( x ) = x - a≥ 0 的 情 形 , 右 半 部 则 表示 g( x) = b - x≥0 的情形。图 7 -4若对于 某 一 个 ( 惩 ) 罚 因 子 M , 例 如 说 M1 , X( M1 ) (cid:925) R, 就加大罚因子的值 , 随着 M 值的 增加 , 惩 罚函 数中的 惩罚 项所起 的作 用 随之增大 , min P( X , M) 的解 X( M) 与约束集 R 的“ 距离”就越来越近。当0 < M1 < M2 < … < Mk < … 趋于无穷大时 , 点列{ X( Mk ) }就从可行域 R 的外部趋于原问题 ( 7 -3 ) 式的 极小点 Xm in ( 此 处假设点列{ X( Mk ) }收敛 ) 。可对外点法作如下经济解释 : 把 目标函 数 f ( X) 看 成“ 价格”, 约 束条 件看 成 某种“ 规 定”, 采购人可在规定 范围 内购 置最 便宜 的 东西。此 外 对违 反规 定制 定了 一 种“ 罚款”政 策 , 若符合规定 , 罚款为零 ; 否则 , 要收罚款。此时 , 采 购人 付出 的总代 价应 是价格 和罚 款 的总和。采购者的目标是使总代价最小 , 这 就是 上述的 无约 束问 题。当罚 款规定 得很 苛 刻时 , 违反规定支付的 罚款 很高 , 这就 迫使 采购 人符 合 规定。在 数学 上 表现 为 当罚 因 子 Mk 足够大时 , 上述无约束问题的最优解应满足约束条件 , 而成为约束问题的最优解。外点法的迭代步骤如下 : (1 ) 取 M1 > 0( 例如说取 M1 = 1) , 允许误差 ε> 0 , 并令 k: = 1。 (2 ) 求无约束极值问题的最优解 :min X∈ E nP( X , Mk ) = P( X( k) , Mk )其中P( X , Mk ) = f ( X) + Mk∑[ min( 0 , gj ( X) ) ] 2j = 1(3 ) 若对某一个 j (1 ≤ j≤ l) 有gj ( X( k) ) ≥ε 则取 Mk + 1 > Mk ( 例如 , Mk + 1 = cMk , c = 5 或 10 ) , 令 k: = k + 1 , 并转 向第 2 步。否则 , 停 止 迭代 , 得 Xmin ≈ X( k)gj ( X( k) ) ≥ε 则取 Mk + 1 > Mk ( 例如 , Mk + 1 = cMk , c = 5 或 10 ) , 令 k: = k + 1 , 并转 向第 2 步。否则 , 停 止 迭代 , 得 Xmin ≈ X( k)min f ( X) = x1 + x2g1 ( X) = - x2 g2 ( X) = x1 ≥01 + x2 ≥0解 构造罚函数P( X , M) = x1 + x2 + M{[ min (0 , ( - x21 + x2 ) ) ] 2 + [ min( 0 , x1 ) ] 2 }P x1= 1 + 2 M[ min( 0 , ( - x21 + x2 ) ( - 2 x1 ) ) ] + 2 M[ min (0 , x1 ) ]·381·P x2= 1 + 2 M[ min (0 , ( - x21 + x2 ) ) ]对于不满足约束条件的点 X = ( x1 , x2 ) T , 有x21 + x2 < 0 ,x1 < 0令P x1=P x2= 0得 min P( X , M) 的解为X( M) =1 2 (1 + M),1 4 (1 + M) 2 -1 2 MT取 M = 1 , 2 , 3 , 4 , 可得出以下结果 :M = 1 :M = 2 :M = 3 :M = 4 :X = ( - 1/ 4 , - 7/ 16 ) T X = ( - 1/ 6 , - 2/ 9) T X = ( - 1/ 8 , - 29/ 192 ) T X = ( - 1/ 10 , - 23/ 200) T可知 X( M) 从 R 的外面逐步逼近 R 的边界 , 当 M→∞时 , X( M) 趋于原问题的极小解 Xm in = (0 , 0 ) T ( 见图7-5) 。以上叙述说明 , 外点法的 一个重 要特 点 , 就是 函数 P( X , M) 是在整个 En 空间 内进行 优化 , 初始 点可 任意 选择 , 这给 计算 带 来了 很 大方 便。而 且 外 点 法也 可 用 于非凸规划的最优化。最后还要指出 , 外点 法 不 只适 用 于 含 有 不等 式 约 束条 件的 非线 性规 划问 题 , 对 于等 式 约束 条件 或同 时 含有等式和 不 等 式 约 束 条 件 的 问 题 也 同 样 适 用。 此外 , 惩罚函数也可以采用其他形式。图 7-54. 2 内点法如果要求每次迭代得到的近似解都在可行域内 , 以便观察目标函数值的变化情况 ( 有 时也可能使用它 ) ; 或者 , 如果 f ( X ) 在 可行 域 外的 性质 比较 复杂 , 甚至 没有 定义 , 这时 就 无法使用外点法。内点法和外点法不同 , 它要求迭代过程始终在可行域内部进行。为此 , 我们把初始点 取在可行域内部 ( 即既不在可行域外 , 也不在可 行域边 界上 , 这 种可行 点称 为内点 或严 格 内点 ) , 并在可行域的边界上设置一道“障碍”, 使迭代点靠近可行域的边界时 , 给出的新目 标函数值迅速增大 , 从而使迭代点始终留在可行域内部。我们仿照外点法 , 通过 函数 叠加 的办 法来 改 造原 目标 函数 , 使 得 改 造后 的 目标 函 数 ( 称为障碍函数 ) 具有这种性质 : 在可行 域 R 的内 部与 其边 界 面较 远的 地方 , 障碍 函数 与 原来的目标函数 f ( X) 尽可能 相近 ; 而 在接近 R 的 边界 面时 可以有 任意 大的值。 可以 想 见 , 满足这种要求的障碍函数 , 其极小解自然不会在 R 的边界 上达到。这 就是说 , 用障 碍 函数来代替 ( 近似 ) 原目标函数 , 并在可行域 R 内部使其极小化 , 虽然 R 是一个闭 集 , 但 因 ·481·极小点不在闭集的边界上 , 因而实际上是具有无约束性质的极值问题 , 可借助于无约束最 优化的方法进行计算。根据上述分析 , 即可将 非线 性规 划 ( 7 -3 ) 式转 化为 下述 一系 列 无约 束性 质 的极 小 化问题 :min X ∈ R 0P( X , rk )( 7-31)其中P( X , rk ) = f ( X) + rk∑j = 11 gj ( X),( rk > 0)( 7-32)或P( X , rk ) = f ( X) - rk∑log( gj ( X) ) ,( rk > 0)( 7-33)j = 1j = 1 , 2 , … , l}(7 -34) (7 -32 ) 式和 ( 7 -33 ) 式 右端 第 二 项 称 为障 碍 项。 易 见 , 在 R 的 边 界上 ( 即 至 少 有 一 个 gjR0 = { X | gj ( X) > 0 ,( X) = 0) , P( X, rk ) 为正无穷大。如果从可行域内部的某一点 X( 0 ) 出发 , 按无约束极小化方法对 (7 -31) 式进行迭代 ( 在 进行一维搜索时要适当控制步长 , 以免迭 代点 跑到 R0 之外 ) , 则 随着 障碍 因子 rk 的逐 步 减小 , 即r1 > r2 > … > rk > … > 0障碍项所起的作用也越来越小 , 因而 , 求出的 min P( X , rk ) 的解 X( rk ) 也逐步 逼近原问 题 (7 -3) 式的极小解 Xm in 。若原来问题的极小解在可行域的边界上 , 则随着 rk 的减 小 , 障 碍 作用逐步降低 , 所求出的障碍函数的极小解不断靠近边界 , 直至满足某一精度要求为止。内点法的迭代步骤如下 : (1 ) 取 r1 > 0( 例如取 r1 = 1) , 允许误差 ε> 0。 (2 ) 找出一可行内点 X( 0 ) ∈ R0 , 并令 k: = 1 。 (3 ) 构造障 碍 函 数 , 障 碍 项 可采 用 倒 数 函 数 ( ( 7 -32 ) 式 ) , 也 可 采 用 对 数函 数 ( 例 如(7 -33 ) 式 ) 。(4 ) 以 X( k - 1 ) ∈ R0 为初始点 , 对障碍函数进行无约束极小化 ( 在 R0 内 ) :min x ∈ R 0P( X , rk ) = P( X( k) , rk )(7 -35)X( k) = X ( rk ) ∈ R0其中 P( X , rk ) 见 ( 7 -32 ) 式或 ( 7 -33) 式。(5 ) 检验是否满足收敛准则rk∑j = 11 gj ( X( k) )≤ ε或rk∑log( gj ( X( k) ) ) ≤εj = 1如满 足上 述准 则 , 则 以 X( k) 为 原问 题的 近似 极 小解 Xmin ; 否 则 , 取 rk + 1 < rk ( 例 如 取rk + 1 = rk/ 10 或 rk/ 5 ) , 令 k: = k + 1 , 转向第 (3 ) 步继续进行迭代。·581·值得指出的是 , 根据情况 , 收敛准则也可采用不同的形式 , 例如 :‖ X( k) - X( k - 1 ) ‖ <ε或| f ( X( k) ) -f ( X( k - 1 ) ) | <ε例 5 试用内点法求解1 3 g1 ( X) = x1 - 1 ≥0( x1 + 1 ) 3 + x2min f ( X) =g2 ( X) = x2 ≥0解 构造障碍函数P( X , r) =1 3( x1 + 1) 3 + x2 +r x 1 - 1+r x2P x1= ( x1 + 1) 2 -r ( x1 - 1 ) 2 = 0P x2= 1 -r x 22= 0联立解上述两个方程 , 得x1 ( r) =1 + r ,x2 ( r) = r如此得最优解 :Xmin = li m r→ 01 + r ,rT= (1 , 0 ) T由于此例可 解 析 求 解 , 故 可 如 上 进 行。 但 很 多 问 题 不 便 用 解 析 法 , 而 需 用 迭 代 法求解。例 6 试用内点法解min f ( X) = x1 + x2g1 ( X) = - x21 + x2 ≥0g2 ( X) = x1 ≥0解 障碍项采用自然对数函数 , 得障碍函数如下 :P( X , r) = x1 + x2 - rlog( - x21 + x2 ) - rlog x1各次迭代结果示于表 7 -1 及图 7 -6 中。表 7-1障碍因子rx1 ( r)x2 ( r)r11. 0000. 5001. 250r20. 5000. 3090. 595r30. 2500. 1830. 283r40. 1000. 0850. 107r50. 00010. 0000. 000图 7 -6·681·ªŸNC|q‰NCªŸ|q‰NCªŸ|q‰ªŸNC|q‰ªŸNC|q‰我们知道 , 内点法的迭代过程必须由某个内点开始。在处理实际问题时 , 如果不能找 出某个内点作为初始点 , 迭代就无法展开。 下面说 明初 始内点 的求 法。求 初始内 点本 身 也是一个迭代过程。先任找一点 X( 0 ) 为初始点 , 令S0 = { j | gj ( X( 0 ) ) ≤0 , T0 = { j | gj ( X( 0 ) ) > 0 ,1≤ j≤ l}1≤ j≤ l}如果 S0 为空集 , 则 X( 0 ) 为初始内点 ; 若 S0 非空 , 则 以 S0 中 的约束 函数 为假 拟目标 函数 , 并以 T0 中的约束函数为障碍 项 , 构成 一无 约 束极 值问 题 , 对 这一 问题 进行 极小 化 , 可 得 一个新点 X( 1 ) 。然后检验 X( 1 ) , 若仍不为内点 , 如上继续 进行 , 并减小 障碍因 子 r, 直到 求 出一个内点为止。求初始内点的迭代步骤如下 : (1 ) 任取一点 X( 0 ) ∈ En , r0 > 0 ( 例如 r0 = 1 ) , 令 k: = 0。 (2 ) 定出指标集 Sk 及 T kS k = { j | gj ( X( k) ) ≤ 0 , Tk = { j | gj ( X( k) ) > 0 ,1≤ j≤ l}1 ≤ j≤ l}(3 ) 检查集 合 S k 是否为 空集 , 若为空 集 , 则 X( k) 在 R0 内 , 初始 内点找到 , 迭 代停止。否则转向第 (4 ) 步。(4 ) 构造函数～P ( X , rk ) = - ∑j∈ Skg j ( X) + rk∑j∈ Tk1 gj ( X),rk > 0以 X( k ) 为初始点 , 在保持对集合～ Rk = { X | gi ( X) > 0 ,j∈ Tk }～可行的情况下 , 极小化P( X , rk ) , 即～min ～ P( X , rk ) ,X∈Rk～得 X( k + 1 ) , X( k + 1 ) ∈Rk , 转向第 (5 ) 步。(5 ) 令 0 < rk + 1 < rk ( 例如说 rk + 1 = rk/ 10) , k: = k + 1 , 转向第 (2 ) 步。注记关于非线 性 规划 的 系 统研 究 始 于 20 世 纪 40 年 代后 期 , 1951 年 Kuhn 和 T ucker 提 出 了 著 名 的K uhn - T ucker 条件。此后 , 无论在基本理论还是在实 用算法 的研究 方面都 发展很 快。目前 , 非线性 规划已成为数学规划中内容十分丰富的一个分支。限于篇幅 , 本篇 仅叙述 了非线 性规划 中最基 本的一 些概念和算法 , 力图便于读者掌握一些重要方法 , 并为进一步深入学习打好基础。在求解无约束最优化问题的方法中 , 变尺度法、共轭梯度法和 Powell 直接 法占有十分 重要的地位。如欲进一步研究 , 除本篇末列出的参考文 献外 , 还可 参阅 : 邓乃扬 等著 .无约 束最优 化计算 方法 . 北京 :科学出版社 , 1982 年。对约束极值问题 , 除本篇提到者外 , 梯度投影法、简约梯度法、约束变尺度法、乘子罚函 数法、序 列二次规划法和起作用约束集法 ( active set method ) 等都是 很重要 的方法。其 中简约 梯度法 和起作 用约 束集法对处理线性约束非线性规划十分有效。处理一般非线 性约束 非线性 规划的 有效方 法 , 有 待进一 步·781·研究。希望对非线性规划有更多地了解的读者 , 除可参看本篇末所列文献 , 尤其是 [8 ] , [12] , [ 13] 外 , 还可参考 :Fletcher R . Practical Methods of Optimization , Vol . 2 , John Wiley & Sons . 1981 .Edited by A . Bachem , M . G r tschel and B . Kor te , Mathematical P rogr amming : T he State of t heAr t , Bonn 1982 , Springe r - Verlag , 1983 .习题7. 1 在某一试验中变更条件 xi 四 次 , 测 得相 应的 结果 yi 示 于下 表 , 试 为这 一试 验 拟合一条直线 , 使 其 在 最 小 二 乘 意 义 上 最 好 地 反 映 这 项 试 验 的 结 果 ( 仅 要 求 写 出 数 学 模型 ) 。 xi2468yi13567. 2 有一线性方程组如下x1 - 2 x2 + 3 x3 = 23 x1 - 2 x2 + x3 = 7x1 + x2 - x3 = 1现欲用无约束极小化方法求解 , 试建立数学模型并说明计算原理。7. 3 试判定下述非线性规划是否为凸规划 : min f ( X) = x2 x2 1 - x2 ≥0 - x1 - x27. 3 试判定下述非线性规划是否为凸规划 : min f ( X) = x2 x2 1 - x2 ≥0 - x1 - x2(1 )2 + 2 = 0x1 , x2 ≥0min f ( X) = 2 x2 x2 1 + x2 5 x2 1 + x3 = 10 x1 , x2 , x3 ≥01 + x22 ≤ 42 + x23 - x1 x27. 4 试用斐波那契法求函数f ( x) = x2 - 6 x + 2在区间 [0 , 10] 上的极小点 , 要求缩短后的区间长度不大于原区间长度的 8 % 。7. 5 试用 0. 618 法重做习题 7. 4, 并将计算结果与用斐波那契法所得计算结果进行比较。 7. 6 试用最速下降法求解 2 + x23选初始点 X( 0 ) = ( 2 , - 2 , 1) T , 要求做三次迭代 , 并验证相邻两步的搜索方向正交。7. 7 试用最速下降法求函数f ( X) = - ( x1 - 2 ) 2 - 2 x2 的极大点。先以 X( 0 ) = ( 0 , 0) T 为初始点进行计 算 , 求出极 大点 ; 再 以 X( 0 ) = ( 0 , 1) T 为 初 ·881·2À{"(cid:5)À{"(cid:5)始点进行两次迭代。最后比较从上述两个不同初始点出发的寻优过程。7. 8 试用牛顿法重解习题 7. 6。 7. 9 试用牛顿法求解max f ( X) =1 1 + x2 x22 + 2取初始点 X( 0 ) = ( 4 , 0) T , 用最佳步长进行。然后采用固定 步长 λ= 1 , 观察 迭代情 况 , 并 加 以分析说明。7. 10 试用共轭梯度法求二次函数f ( X) =1 2XT A X的极小点 , 此处A =11127. 11 令 X( i) ( i = 1 , 2 , … , n) 为一组 A 共 轭向量 ( 假 定为列 向量 ) , A 为 n × n 对称 正定阵 , 试证nA- 1 = ∑i = 1X( i) ( X( i ) ) T ( X( i) ) T A X( i)7. 12 试用变尺度法求解min f ( X) = ( x1 - 2 ) 3 + ( x1 - 2 x2 ) 2取初始点 X( 0 ) = ( 0. 00 , 3. 00) T , 要求近似极小点处梯度的模不大于 0. 5。7. 13 试以 X( 0 ) = ( 0 , 0) T 为初始点 , 使用 (1 ) 最速下降法 ( 迭代 4 次 ) ; (2 ) 牛顿法 ; (3 ) 变尺度法。 求解无约束极值问题 1 + x22 + 2 x1 x2 + x1 - x27. 14 试用步长加速法 ( 模矢法 ) 求下述函数f ( X) = x21 + 2 x22 - 4 x1 - 2 x1 x2的极小点 , 初始点 X( 0 ) = (3 , 1 ) T , 步长Δ1 =0. 50,Δ2 =00. 5并绘图表示整个迭代过程。7. 15 分析非线性规划min f ( X) = ( x1 - 2) 2 + ( x2 - 3 ) 2x2 1 + ( x2 - 2) 2 ≥ 4 x2 ≤2在以下各点的可行下降方向 ( 使用式 ( 7 -6 ) 和式 ( 7 -7) ) :(1 ) X( 1 ) = ( 0 , 0) T ;(2 ) X( 2 ) = (2 , 2 ) T ;( 3) X( 3 ) = ( 3 , 2) T 。·981·并绘图表示各点可行下降方向的范围。7. 16 试写出下述二次规划的 K uhn- Tucker 条件 :max f ( X) = CT X + XT H XA X≤ b X≥0其中 : A 为 m× n 矩阵 , H 为 n× n 矩阵 , C 为 n 维列向量 , b 为 m 维列向量 , 变量 X 为 n 维 列向量。7. 17 试写出下述非线性规划问题的 K uhn- Tucker 条件并进行求解 :(1 )max f ( x ) = ( x - 3 ) 21 ≤ x≤ 5(2 )min f ( x) = ( x - 3 ) 21≤ x≤57. 18 试找出非线性规划问题max f ( X) = x1x2 - 2 + ( x1 - 1) 3 ≤0 ( x1 - 1) 3 - x2 + 2 ≤0x1 , x2 ≥0的极大点 , 然后写出其 Kuk n-Tucke r 条件 , 这 个极大 点满 足 Kuh n-Tucke r 条件 吗 ? 试 加 以说明。7. 19 试解二次规划min f ( X) = 2 x2 x1 + x2 ≤3 4 x1 + x2 ≤9 x1 , x2 ≥01 - 4 x1 x2 + 4 x22 - 6 x1 - 3 x27. 20 试用可行方向法求解min f ( X) = 2 x2 x1 + x2 ≤21 + 2 x22 - 2 x1 x2 - 4 x1 - 6 x2x1 + 5 x2 ≤5 x1 , x2 ≥07. 21 试用 SU M T 外点法求解min f ( X) = x21 + x22x2 = 1并求出当罚因子等于 1 和 10 时的近似解。7. 22 试用 SU M T 外点法求解m ax f ( X) = x1( x2 - 2 ) + ( x1 - 1 ) 3 ≤0 ( x1 - 1 ) 3 - ( x2 - 2 ) ≤0 x1 , x2 ≥0·091·7. 23 试用 SU M T 内点法求解min f ( x) = ( x + 1 ) 2x≥ 07. 24 试用 SU M T 内点法求解min f ( x ) = x 0 ≤ x≤1参 考 资 料[1] 南京大学数学系计算数学专业编 . 最优化方法 . 北京 : 科学出版社 , 1978[2] 王德人编 . 非线性方程组解法与最优化方法 . 北京 : 人民教育出版社 , 1979[3] 中国科学院数学研究所运筹室编 . 最优化方法 . 北京 : 科学出版社 , 1980[4] 马仲蕃、魏权龄、赖炎连编 . 数学规划讲义 . 北京 : 中国人民大学出版社 , 1981[5] 薛嘉庆编 . 最优化原理与方法 . 北京 : 冶金工业出版社 , 1983[6] 席少霖、赵凤治编著 . 最优化计算方法 . 上海 : 上海科学技术出版社 , 1983[7] 郭耀煌等编著 . 运筹学与工程系统分析 . 北京 : 中国建筑工业出版社 , 1986[8] M. 阿佛里耳著 . 李元熹等译 . 非线性规划———分析与方法 . 上海 : 上海科学技术出版社 , 1979[9] D. M. 希梅尔布劳著 , 张义 等译 . 实用非线性规划 . 北京 : 科学出版社 , 1981[10 ] D. G. 鲁恩伯杰著 , 夏尊铨等译 . 线性与非线性规划引论 . 北京 : 科学出版社 , 1980[11 ] David A Wismer , Chat tergy R . Int roduction To Nonlinea r Op timiza tion : A P roblem Solving Ap-proach , Nor th- H olland P ublishing Comp any , 1978[12 ] Mokh tar S Baza raa, Shet ty C M . Nonlin ea r Programming : T h eory and Algorit hms , John Wiley& Sons , 1979[13 ] Philip E Gill . Walter Murray a nd Marga ret H . W right , Pr actical Op timiza tion , Aca demic Pr es s,1981·191·五、动 态 规 划动态规则是运筹学的一 个分 支 , 它是 解 决多 阶段 决策 过程 最 优化 的 一种 数 学 方法。 大约产生于 20 世纪 50 年代。1951 年 美国数学 家贝尔曼 ( R .Bellman) 等人 , 根据 一类 多 阶段决策问题的特点 , 把多阶段决策问题变换为一系列互相联系的单阶段问题 , 然后逐个 加以解决。与此同时 , 他提出了解决这类问题 的“ 最优 性原 理”, 研 究了 许多实 际问 题 , 从 而创建了解决最优化问题的一 种新 的方 法———动态 规划。 他的 名著“ 动 态规 划”于 1957 年出版 , 该书是动态规划的第一本著作。动态规划的方法 , 在工程技术、企业管理、工农业 生产 及军 事等部 门中 都有广 泛的 应 用 , 并且获得了显著的效果。在企业管理方面 , 动 态规 划可 以用来 解决 最优路 径问 题、资 源分配问题、生产调度问题、库存问题、装载问题、排序问题、设备更新问题、生产过程最优控制问题等等 , 所以它是现代企业管理中的 一种 重要的 决策 方法。许 多问 题用动 态规 划 的方法去处理 , 常比线性规划或非线性规划更有成效。特别对于离散性的问题 , 由于解析 数学无法施展其术 , 而动态规划的方法就成为非常有用的工具。应指出 , 动态规划是求解 某类问题的一种方法 , 是考查问题的一种途径 , 而 不是 一种特 殊算 法 ( 如线 性规划 是一 种 算法 ) 。因而 , 它不像线性规划那样有一个标准的 数学 表达 式和明 确定 义的一 组规 则 , 而 必须对具体问题进行具体分析处理。因此 , 读者在学习时 , 除了要对基本概念和方法正确 理解外 , 应以丰富的想像力去建立模型 , 用创造性的技巧去求解。动态规划模型的分类 , 根据多阶段决策过程的时间参量是离散的还是连续的变量 , 过 程分为离散决策过程和连续决策过程。根据决 策过程 的演 变是确 定性 的还 是随机 性的 , 过程又可分为确定性决策过程和随机性决策 过程。组 合起 来就有 离散 确定性、离 散随 机性、连续确定性、连续随机性四种决策过程模型。本部分主要研究离散决策过程 , 介绍动态 规划 的基本 概念、理 论和 方法 , 并通 过几 个典型的问题来说明它的应用 , 这些都是整个动态规划的基本内容。第 8 章 动态规划的基本方法第 1 节 多阶段决策过程及实例在生产和科学实验中 , 有一类活动的过 程 , 由于它 的特 殊性 , 可将 过程 分为若 干个 互 相联系的阶段 , 在它的每 一个 阶 段都 需要 作出 决策 , 从而 使整 个过 程达 到 最好 的活 动 效 果。因此 , 各个阶段决策的选取不是任意确定 的 , 它依 赖于 当前面 临的 状态 , 又影 响以 后 的发展。当各个阶段决策确定后 , 就组成了一个决策序列 , 因而也就决定了整个过程的一 ·291·条活动路线。这种把一 个 问 题可 看 作 是一 个 前 后 关 联具 有 链 状 结 构的 多 阶 段 过 程 ( 如 图 8-1所示 ) 就称为多 阶 段决 策 过 程 , 也 称 序 贯 决策 过 程。 这种 问 题 就 称 为多 阶 段 决 策 过程。图 8-1在多阶段决策问题中 , 各个阶段采取的决 策 , 一般 来说 是与时 间有 关的 , 决策 依赖 于 当前的状 - - 态 , 又随 即引 起状 态的转 移 , 一个 决策序 列就 是在 变化的 状态 中产 生出 来 的 , 故有“ 动态”的含义。因此 , 把处理它的方 法称为 动态 规划方 法。但 是 , 一些与 时间 没 有关系的静态规划 ( 如线性规划、非线性规划等 ) 问 题 , 只要 人为地 引进“时 间”因素 , 也 可 把它视为多阶段决策问题 , 用动态规划方法去处理。多阶段决策问题很多 , 现举例如下。 例 1 最短路线问题 如图 8-2 , 给 定一个 线路 网络 , 两 点之间 连线 上的 数字表 示两 点间的 距离 ( 或费用 ) ,试求一条由 A 到 G 的铺管线路 , 使总距离为最短 ( 或总费用最小 ) 。图 8-2例 2 机器负荷分配问题 某种机器可以在高低两种不同的负荷下 进行生 产。在 高负荷 下进 行生产 时 , 产品 的年产量 g 和投入生产的机器数量 u1 的关系为g = g( u1 ) 这时 , 机 器的 年完好 率为 a, 即 如果 年初 完好机 器的 数量为 u, 到年 终时 完好的 机器 就为 au, 0 < a < 1 , 在低负荷下生产时 , 产品的年产量 h 和投入生产的机器数量 u2 的关系为h = h( u2 )相应的机器年完好率为 b, 0 < b < 1。假定开始生产时完好的机器数量为 s1 。要求制定一个五年计划 , 在每年开始时 , 决定 如何重新分配完好的机器在两种不同的负荷下 生产的 数量 , 使 在五年 内产 品的总 产量 达 到最高。·391·还有 , 如各种资源 ( 人力、物力 ) 分配问题、生产 - 存 储问 题、最 优装 载问 题、水 库优 化 调度问题、最优控制问题等等 , 都是具有多阶段 决策问 题的 特性 , 均可 用动 态规划 方法 去 求解。第 2 节 动态规划的基本概念和基本方程如图 8 -2 所示的线路网络 , 求 A 到 G 的最短路线问题是动态规划中一个较为直观 的 典型例子。现通过 讨 论 它 的 解 法 , 来 说 明 动 态 规 划 方 法 的 基 本 思 想 , 并 阐 述 它 的 基 本 概念。由图 8 -2 可知 , 从 A 点到 G 点可以分为 6 个阶段。从 A 到 B 为第一阶段 , 从 B 到 C 为第二阶段…从 F 到 G 为第六阶段。在第一阶段 , A 为起点 , 终点有 B1 、B2 两个 , 因而这 时走的路线有两个选择 , 一是走到 B1 ; 一是走到 B2 , 若选择走到 B2 的 决策 , 则 B2 就是 第 一阶段在我们决策之下的结果。它既是第一阶段路线的终点 , 又是第二阶段路线的始点。 在第二阶段 , 再从 B2 点出发 , 对应于 B2 点就有一个可供选择的 终点集合 { C2 , C3 , C4 } ; 若 选择由 B2 走至 C2 为第 二阶段的决策 , 则 C2 就是第二阶段 的终点 , 同时又是第三阶 段的 始点。同理递推下去 , 可看到 : 各个阶段的决策不同 , 铺管路线就不同。很明显 , 当某阶段 的始点给定时 , 它直接影响着后面各阶段的行进路线和整个路线的长短 , 而后面各阶段的 路线的发展不受这点以前各阶段路线的影响。故 此问 题的 要求是 : 在 各个 阶段选 取一 个 恰当的决策 , 使由这些决策组成的一个决策序列所决定的一条路线 , 其总路程最短。如何解决这个问题呢 ? 可以采取穷举 法。即 把由 A 到 G 所有可 能的 每一条 路线 的 距离都算出来 , 然后互 相比较找出最短者 , 相应 地得出了最短路 线。这样 , 由 A 到 G 的 6 个阶段中 , 一共有 2× 3×2× 2 × 2 × 1 = 48 条不 同 的路 线 , 比较 48 条 不同 的 路线 的距 离 值 , 才找出最短路线为A→ B1 → C2 → D1 → E2 → F2 → G 相应最短距离为 18。显然 , 这样作 计算 是相当 繁杂 的。如 果 当段 数很 多 , 各 段的 不同 选 择也很多时 , 这种解法的计算将变得极其繁 杂 , 甚至在 电子 计算机 上计 算都 是不现 实的。 因此 , 为了减少计算工作量 , 需要寻求更好的算法 , 这就是下面要介绍的动态规划的方法。 为了讨论方便 , 先介绍动态规划的基本概念和符号。2. 1 动态规划的基本概念1. 阶段把 所给 问题的 过程 , 恰 当地 分为若 干个 相互联 系的 阶段 , 以 便能按 一定 的次 序去 求 解。描述阶段的变量称为阶段变量 , 常用 k 表示。阶段的划分 , 一般是根据时间和空间的 自然特征来划分 , 但要便于把 问题的 过程 能转化 为多 阶段 决策 的过 程。如 例 1 可分 为 6 个阶段来求解 , k 分别等于 1 、2 、3 、4 、5 、6 。2. 状态状态表示每个阶段开始所处的自然状况或客观条件 , 它描述了研究问题过程的状况 ,·491·又称不可控因素。在例 1 中 , 状态就是某阶段的出发位置。它既是该阶段某支路的起点 , 又是前一阶段某支路的终点。通常一个阶段有若 干个 状态 , 第 一阶段 有一 个状态 就是 点 A , 第二阶段有两个状态 , 即点集合{ B1 , B2 } , 一般第 k 阶段的状态就是第 k 阶段所有始 点 的集合。描述过程状态的变量称为状态变量。它可用一 个数、一 组数 或一向 量 ( 多 维情形 ) 来 描述。常用 Sk 表示第 k 阶段的状态变量。如在例 1 中第三阶段有四个状态 , 则状态变 量 S k 可取四个值 , 即 C1 、C2 、C3 、C4 。点 集合 { C1 , C2 , C3 , C4 } 就称 为第 三阶 段的 可达 状态 集 合。记为 S3 = { C1 , C2 , C3 , C4 }。有时为 了方 便起 见 , 将 该阶 段的 状态 编 上号 码 1 , 2 … 这 时也可记 S3 = {1 , 2 , 3 , 4}。第 k 阶段的可达状态集合就记为 S k 。这里所说的状态应具有下面的性质 : 如果某阶段状态给定后 , 则在这阶段以后过程的 发展不受这阶段以前各段状态的影响。换句话说 , 过 程的 过去 历史只 能通 过当前 的状 态 去影响它未来的发展 , 当前的状态是以往历史的一个总结。这个性质称为无后效性 ( 即马 尔科夫性 ) 。如果状态仅仅描述过程的具体特征 , 则并 不是任 何实 际过 程都能 满足 无后效 性的 要 求。所以 , 在构造决策过程的动态规划模型时 , 不能仅由描述过程的具体特征这点着眼去 规定状态变量 , 而要充分注意是否满足无后 效性 的要求。 如果 状态的 某种 规定方 式可 能 导致不满足无后效性 , 应适当地改变状态的 规定方 法 , 达到 能使它 满足 无后 效性的 要求。 例如 , 研究物体 ( 把它看作一个质点 ) 受外力 作用 后其空 间运 动的 轨迹问 题。从描 述轨 迹 这点着眼 , 可以只选坐标位置 ( xk , yk , zk ) 作 为过 程的状 态 , 但这 样不能 满足 无 后效 性 , 因 为即使知道了外力的大小和方向 , 仍无法确定物体受力后的运动方向和轨迹 , 只有把位置 ( xk , yk , zk ) 和速度 ( x· k ) 都 作为过 程的 状态 变量 , 才能 确定 物体 运动 下 一步 的方 向 和轨迹 , 实现无后效性的要求。k , y·k , z·3. 决策决策表示当过程处于某一阶段的某个状态时 , 可以作出不同的决定 ( 或选择 ) , 从而确 定下一阶段的状态 , 这种决定称为决策。在最优控制中也称为控制。描述决策的变量 , 称 为决策变量。它可用一个数、一组数或一向 量来 描述。常 用 uk ( sk ) 表 示第 k 阶段 当状 态 处于 s k 时的决策变量。它是状态变量的函数。在实际问 题中 , 决策 变量的取 值往往限 制 在某一范围之内 , 此范围称为允许决策集合。常用 Dk ( sk ) 表示第 k 阶段从 状态 sk 出发 的 允许决策集合 , 显然有 uk ( sk ) ∈ Dk ( sk ) 。如在例 1 第二阶段中 , 若 从状态 B1 出发, 就可作出 三种不同的决策 , 其允许决 策集合 D2 ( B1 ) = { C1 , C2 , C3 } , 若选取的点为 C2 , 则 C2 是状态 B1 在决策 u2 ( B1 ) 作用下的一个新的 状态 , 记作 u2 ( B1 ) = C2 。4. 策略策略是一个按顺序排列的决策组成的集合。由过程的第 k 阶段开始到终止状态为止 的过程 , 称为问题的后部子过程 ( 或称为 k 子过 程 ) 。由每 段的 决策按 顺序 排列组 成的 决 策函数序列{ uk ( sk ) , … , un ( sn ) }称为 k 子过程策略 , 简称子策略 , 记为 pk, n ( sk ) 。即pk, n ( sk ) = { uk ( sk ) , uk + 1 ( sk + 1 ) , … , un ( sn )}·591·当 k = 1 时 , 此决策函数序列称为全过程的一个策略 , 简称策略, 记为 p1 , n ( s1 ) 。即 p1 , n ( S1 ) = { u1 ( s1 ) , u2 ( s2 ) , … , un ( sn ) }在实际问题中 , 可供 选择 的 策略 有 一 定的 范 围 , 此 范围 称 为 允 许策 略 集 合 , 用 P 表示。从允许策略集合中找出达到最优效果的策略称为最优策略。5. 状态转移方程状态转移方程是确定过程由一个状态到另一个状态的演变过程。若给定第 k 阶段状 态变量 s k 的值 , 如果该段的决策变量 uk 一经确定 , 第 k + 1 阶段的状态变量 sk + 1 的值也就 完全确定。即 sk + 1 的值随 sk 和 u k 的值变化而变化。这种确定的对应关系 , 记为sk + 1 = Tk ( sk , uk )上式描述了由 k 阶段到 k + 1 阶段的状 态转移 规律 , 称为状 态转移方 程。 Tk 称为 状态转移函数。如例 1 中 , 状态转移方程为 sk + 1 = uk ( sk ) 。6. 指标函数和最优值函数用来衡量所实现过程优劣的一种数量指 标 , 称为指 标函 数。它是 定义 在全过 程和 所有后部子过程上确定的数量函数。常用 V k, n 表示之。即V k, n = V k, n ( sk , uk , sk + 1 , … , sn + 1 ) , k = 1 , 2 , … , n对于要构成动态规划模型的指标函数 , 应具有可分离性 , 并满足递推关系。 即 V k, n 可以表示为 s k 、uk 、V k + 1 , n 的函数。记为V k, n ( sk , uk , sk + 1 , … , sn + 1 ) = ψk [ sk , uk , V k + 1 , n ( sk + 1 , … , sn + 1 ) ]在实际问题中很多指标函数都满足这个性质。常见的指标函数的形式如下。(1 ) 过程和它的任一子过程的指标是它所包含的各阶段的指标的和。即nV k, n ( sk , uk , … , sn + 1 ) = ∑v j ( sj , uj )j = k其中 v j ( sj , uj ) 表示第 j 阶段的阶段指标。这时上式可写成V k, n ( sk , uk , … , sn + 1 ) = vk ( sk , uk ) + V k + 1 , n ( sk + 1 , uk + 1 , … , sn + 1 )(2 ) 过程和它的任一子过程的指标是它所包含的各阶段的指标的乘积。即nV k, n ( sk , uk , … , sn + 1 ) = ∏v j ( sj , uj )j = k这时就可写成V k, n ( sk , uk , … , sn + 1 ) = vk ( sk , uk ) V k + 1 , n ( sk + 1 , uk + 1 , … , sn + 1 )指标函数的最优值 , 称为最优值 函数 , 记为 f k ( sk ) 。 它表 示从 第 k 阶 段的 状 态 sk 开始到第 n 阶段的终止状态的过程 , 采取最优策略所得到的指标函数值。即f k ( sk ) ={ uop t , … , u kn}V k, n ( sk , uk , … , sn + 1 )其中“ opt”是最优化 ( op timization) 的缩写 , 可根据题意而取 min 或 max。在不同的问题中 , 指标函数的含义是不 同的 , 它可 能是 距离、利 润、成本、产品 的产 量 或资源消耗等。例如 , 在最短路线问题中 , 指标函数 V k, n 就表示在第 k 阶段由点 s k 至终点 G 的距离。用 dk ( sk , uk ) = vk ( sk , uk ) 表 示在 第 k 阶 段由 点 s k 到 点 sk + 1 = uk ( sk ) 的 距离 ,·691·如 d5 ( E1 , F1 ) = 3 , 就表示在第 5 阶段中由点 E1 到 点 F1 的距 离 为 3 。 f k ( sk ) 表 示从 第 k 阶段点 s k 到终点 G 的最短距离 , 如 f4 ( D1 ) 就表 示从 第 4 阶 段 中的 点 D1 到 点 G 的最 短 距离。2. 2 动态规划的基本思想和基本方程现在 , 再结合解决最短路线问题来介绍 动态 规划方 法的 基本 思想。生 活中的 常识 告 诉我们 , 最短路线有一个重要特性 : 如果由起点 A 经过 P 点和 H 点而到达终点 G 是一条 最短路线 , 则由点 P 出发经过 H 点到达终点 G 的这条子路线 , 对于从点 P 出发到达终点 的所有可能选择的不同路线来说 , 必定也 是最短 路线。例 如 , 在最 短路 线问题 中 , 若找 到 了 A→ B1 → C2 → D1 → E2 → F2 → G 是由 A 到 G 的最短路线 , 则 D1 → E2 → F2 → G 应该是 由 D1 出发到 G 点的所有可能选择的不同路线中的 最短路 线。此特 性用反 证法 易证。因 为 如果不是这样 , 则从点 P 到 G 点有另 一条 距离更 短的 路线 存在 , 把它 和原 来最短 路线 由 A 点到达 P 点的那部分连接起来 , 就会得到 一条由 A 点 到 G 点的新 路线 , 它比原 来那 条 最短路线的距离还要短些。这与假设矛盾 , 是不可能的。图 8 -3根 据最 短 路 线 这 一特 性 , 寻 找 最 短路线的方法 , 就是从最 后一段 开始 , 用由 后 向 前逐步 递 推 的方 法 , 求 出 各 点到 G 点的 最 短路 线 , 最 后 求得 由 A 点到 G 点的 最 短 路 线。所以 , 动 态 规 划的方法是从终点逐 段向始点 方向 寻找最短路线的一种方法 , 如图 8 -3 表示。下面按照动态规划的方法, 将例 1 从最后一段开始计算, 由后向前逐步推移至 A 点。 当 k = 6 时 , 由 F1 到终点 G 只有一条路线 , 故 f6 ( F1 ) = 4。同理 , f6 ( F2 ) = 3。 当 k= 5 时, 出发点有 E1 、E2 、E3 三个。若从 E1 出发, 则有两个选择 :①至 F1 ; ②至 F2则f5 ( E1 ) = mi nd5 ( E1 , F1 ) + f6 ( F1 )d5 ( E1 , F2 ) + f6 ( F2 )= min3 + 45 + 3= 7其相应的决策为 us ( E1 ) = F1这说明 , 由 E1 至终点 G 的最短距离为 7 , 其最短路线是E1 → F1 → G同理 , 从 E2 和 E3 出发 , 则有f5 ( E2 ) = mi nd5 ( E2 , F1 ) + f6 ( F1 )d5 ( E2 , F2 ) + f6 ( F2 )= min5 + 42 + 3= 5其相应的决策为 us ( E2 ) = F2f5 ( E3 ) = mi nd5 ( E3 , F1 ) + f6 ( F1 )d5 ( E3 , F2 ) + f6 ( F2 )= min6 + 46 + 3= 9且 u5 ( E3 ) = F2类似地 , 可算得·791·当 k = 4 时 , 有f4 ( D1 ) = 7u4 ( D1 ) = E2f4 ( D2 ) = 6u4 ( D2 ) = E2f4 ( D3 ) = 8u4 ( D3 ) = E2当 k = 3 时 , 有f3 ( C1 ) = 13u3 ( C1 ) = D1f3 ( C2 ) = 10u3 ( C2 ) = D1f3 ( C3 ) = 9u3 ( C3 ) = D2f3 ( C4 ) = 12u3 ( C4 ) = D3当 k = 2 时 , 有f2 ( B1 ) = 13u2 ( B1 ) = C2f2 ( B2 ) = 16 当 k = 1 时 , 出发点只有一个 A 点 , 则u2 ( B2 ) = C3d1 ( A, B1 ) + f 2 ( B1 )f1 ( A) = min= min3 + 16 且 u1 ( A) = B1 。于是得到从起点 A 到终点 G 的最短距离为 18。d1 ( A, B2 ) + f 2 ( B2 )5 + 13= 18为了找出最短路 线 , 再 按 计 算 的顺 序 反 推 之 , 可 求 出 最 优 决 策 函 数 序 列 { uk } , 即 由 u1 ( A) = B1 , u2 ( B1 ) = C2 , u3 ( C2 ) = D1 , u4 ( D1 ) = E2 , u5 ( E2 ) = F2 , u6 ( F2 ) = G 组成一个最优策 略。因而 , 找出相应的最短路线为A→ B1 → C2 → D1 → E2 → F2 → G从上面的计算过程中可以看出 , 在求解的 各个阶 段 , 我们 利用了 k 阶 段与 k + 1 阶 段之间的递推关系 :f k ( sk ) = min ( s k∈ Dukk){ dk ( sk , uk ( sk ) ) + f k + 1 ( uk ( sk ) )} k = 6 , 5 , 4 , 3 , 2, 1f7 ( s7 ) = 0 ( 或写成 f 6 ( s6 ) = d6 ( s6 , G) )一般情况 , k 阶段与 k + 1 阶段的递推关系式可写为f k ( sk ) =ukopt ∈ D ( s kk){ vk ( sk , uk ( sk ) ) + f k + 1 ( uk ( sk ) ) }k = n, n - 1 , … , 1边界条件为f n + 1 ( sn + 1 ) = 0 这种递推关系式 (8 -1) 称为动态规划的基本方程。 现在把动态规划方法的基本思想归纳如下。(1 ) 动态规划方法的关键在 于正 确地写 出基 本的 递推关 系式 和恰当 的边 界条 件 ( 简 言之为基本方程 ) 。要做到这一点 , 必须先将问题 的过 程分 成几个 相互 联系的 阶段 , 恰 当 地选取状态变量和决策变量及定义最优值函数 , 从而 把一 个大 问题化 成一 族同类 型的 子 问题 , 然后逐个求解。即从边界条件开始 , 逐段递推寻优 , 在每一个子问题的求解中 , 均利 用了它前面的子问题的最优化结果 , 依次进 行 , 最后一 个子 问题所 得的 最优 解 , 就 是整 个 问题的最优解。·891·( 8 -1)(2 ) 在多阶段决策过程中 , 动态规划方法是既把当前一段和未来各 段分开 , 又把当 前 效益和未来效益结合起来考虑的一种最优化 方法。因 此 , 每段 决策的 选取 是从全 局来 考 虑的 , 与该段的最优选择答案一般是不同的。(3 ) 在求整个问题的最优策略时 , 由于初始状态是已知的 , 而每 段的决策 都是该段 状态的函数 , 故最优策略所经过的各段状态便可逐次变换得到 , 从而确定了最优路线。如例 1 最短路线问题 , 初始状态 A 已知 , 则按下面箭头所指的方向逐次变换有 u1 ( A) u2 ( B1 ) … u0′( F2 )↗ ↓ ↗ ↓ ↗↗ ↓AB1C2…G(已知 )从而可得最优策略为{ u1 ( A) , u2 ( B1 ) , … , u0′( F2 ) } , 相应的最短路线为A→ B1 → C1 → D1 → E2 → F2 → G上述最短路线问题的计算过程 , 也可借助图形直观简明的表示出来 , 如图 8 -4 所示。 在图 8 -4 中 , 每 节 点 处 上 方 的 方 格 内 的 数 , 表 示 该 点 到 终 点 G 的 最 短 距 离。 用 直线连接的点表示 该 点 到 终 点 G 的 最 短 路 线。未 用 直 线 连 接 的 点 就 说 明 它 不 是 该 点 到终点 G的最短路线 , 故这些支路均被舍去了。图中粗线表示由始点 A 到 终点 G 的最 短 路线。这种在图上直接作业的方法叫做标号法。如果规定从 A 点到 G 点为顺行方 向 , 则 由 G 点到 A 点为逆行方向 , 那么 , 图 8 -4 是由 G 点开始从后向 前标的。 这种以 A 为 始端 , G 为终端 , 从 G 到 A 的解法称为逆序解法。图 8 -4由于线路 网 络 的 两 端 都 是 固 定 的 , 且 线 路 上 的 数 字 是 表 示 两 点 间 的 距 离 , 则 从 A 点计算到 G 点和从 G 点计算到 A 点 的最 短路线 是相 同的。 因而 , 标 号也 可以 由 A 开 始 , 从前向后标。只是那时 是视 G 为起 点 , A 为 终 点 , 按 动态 规 划方 法 处理 的 , 如图 8 -5 所示。图 8 -5 中 , 每节点处上方方格内 的数表 示该 点到 A 点 的 最短 距离 , 用 直 线连 接的 点表示该点到起点 A 的最短路线 , 粗线表示 A 到 G 的最短路线。·991·图 8 -5这种以 G 为始端、A 为终端的从 A 到 G 的解法称为顺序解法。由此可见 , 顺序解法和 逆序 解法 只表 示 行进 方向 的不 同或 对 始端 终 端看 法 的 颠倒。但用动态规划方法求最优解时 , 都是在行进 方向规 定后 , 均 要逆着 这个 规定 的行进 方向 , 从最后一段向前逆推计算 , 逐段找出最优途径。从上面例 1 的计算过程 , 明显看到 , 动态规划的方法比穷举法有以下优点 : (1 ) 减少了计算量。计算例 1 若用 穷举 法 , 就要对 48 条路 线进行 比较 , 运算 在计 算 机上进行时 , 比较运算要进行 47 次 ; 求各条 路线的 距离 , 即 使用逐 段累 加方 法 , 也 要进 行 6 + 12 + 24 + 48 + 48 = 138 次加法运算。用动态规划方法来计算 , 比较运算 ( 从 k = 5 段开始向前算 ) 共进 行 3 + 3 + 4 + 4 + 1 = 15 次。每次比较运算相应有两次加法运算 , 再 去掉中 间重 复两次 ( 即 B1 → C1 , B2 → C4 各 多算了一次 ) , 实际只有 28 次加法运算。可见 , 动态规划方法比穷举法减少了计算量。而 且随着段数的增加 , 计算量将大大地减少。(2 ) 丰富了计算结 果。在逆 序 ( 或 顺序 ) 解 法中 , 我 们得 到的 不 仅仅 是由 A 点 ( 或 G 点 ) 出发到 G 点 ( 或 A 点 ) 的最短路线 及相 应的最 短距 离 , 而且 得到了 从所 有各中 间点 出 发到 G 点 ( 或 A 点 ) 的最短路线及相 应的距 离。这 就是说 , 求出的 不是 一个最 优策 略 , 而 是一族的最优策略。这对许多实际问题来讲是很有用的 , 有利于帮助分析所得结果。在明确了动态规划的基本概念和基本思想之后 , 我们看到 , 给一个实际问题建立动态规划模型时 , 必须做到下面五点 :(1 ) 将问题的过程划分成恰当的阶段 ; (2 ) 正确选择状态变量 sk , 使它既能描述过程的演变 , 又要满足无后效性 ; (3 ) 确定决策变量 uk 及每阶段的允许决策集合 D k ( sk ) ; (4 ) 正确写出状态转移方程 ; (5 ) 正确写出指标函数 V k, n 的关系 , 它应满足下面三个性质 : ① 是定义在全过程和所有后部子过程上的数量函数 ; ② 要具有可分离性 , 并满足递推关系。即V k, n ( sk , kk , … , sn + 1 ) = ψk [ sk , uk , V k + 1 , n ( sk + 1 , uk + 1 , … , sn + 1 ) ]③ 函数 ψk ( sk , uk , V k + 1 , n ) 对于变量 V k + 1 , n 要严格单调。 以上五点是构造动态规 划模 型的 基础 , 是正 确写 出动 态规 划 基本 方 程的 基 本 要素。·002·而一个问题的动态规划模型是否正确给出 , 它 集中地 反映 在恰 当的定 义最 优值函 数和 正 确地写出递推关系式及边界条件上。简言之 , 要正确写出动态规划的基本方程。根据动态规划方法有逆序解法和顺序解法之分 , 那么 , 它们的动态规划基本方程应如何来表述呢 ?设指标函数是取各阶段指标的和的形式 , 即nV k, n = ∑v j ( sj , uj )j = k其中 vj ( sj , uj ) 表 示 第 j 段 的 指 标。 它 显然 是 满 足 指 标 函 数 三 个 性 质 的。 所 以 上 式 可 写成V k, n = vk ( sk , uk ) + V k + 1 , n [ sk + 1 , … , sn + 1 ]当初始状态给定时 , 过程的策略就被 确定 , 则指 标函 数也就 确定 了。因此 , 指 标函 数是初始状态和策略的函数。可记为 V k, n [ sk , pk , n ( sk ) ] 。故上面递推关系又可写成V k , n [ sk , pk, n ] = vk ( sk , uk ) + V k + 1 , n [ sk + 1 , pk + 1 , n ]其子策略 pk , n ( sk ) 可看成是由决策 uk ( sk ) 和 pk + 1 , n ( sk + 1 ) 组合而成。即pk , n = { uk ( sk ) , pk + 1 , n ( sk + 1 ) }如果用 p *k , n ( sk ) 表示初始状态 为 sk 的 后部 子过程 所有 子策 略中的 最优 子 策略 , 则 最优值函数为f k ( sk ) = V k, n [ sk , p *k, n ( sk ) ] = op t k, npV k, n [ sk , pk , n ( sk ) ]而op t p k, nV k, n ( sk , pk, n ) =opt , p{ vk ( sk , uk ) + V k + 1 , n ( sk + 1 , pk + 1 , n )}} k + 1 , n { uk ( sk , uk ) + op t k + 1 , n{ uk = op t u kV k + 1 , n }p但f k + 1 ( sk + 1 ) = op t k+ 1 , npV k + 1 , n ( sk + 1 , pk + 1 , n )所以f k ( sk ) =ukop t ∈ D ( s kk)[ vk ( sk , uk ) + f k + 1 ( sk + 1 ) ] k = n, n - 1 , … , 1边界条件为 f n + 1 ( sn + 1 ) = 0。这就是动态规划逆序解法的 基 本方 程。式 中 sk + 1 = Tk ( sk , uk ) , 其 求解 过程 , 根据 边 界条件 , 从 k = n 开始 , 由后向前逆推 , 从而逐步 可求得 各段 的最优 决策 和相 应的最 优值 , 最后求出 f1 ( s1 ) 时 , 就得到整个问题的最优解。对于动态规划顺序解法 的基 本方 程应 如何 表 述呢 ? 假 定 阶段 序数 k 和 状 态变 量 s k 的定义不变 , 而改变决策变量 uk 的定义 , 如例 1 中 取 uk ( sk + 1 ) = sk , 则 这时 的状态 转移 不 是由 sk 、uk 去确定 s k + 1 , 而是反过来由 sk + 1 、uk 去确定 sk , 则状态转移方程一般形式为sk = T rk ( sk + 1 , uk )因而第 k 阶段的允许决策集合也应作相应的 改变 , 记 为 Dr sk + 1 和 uk 的函数表示。于是可得动态规划顺序解法的基本方程为k ( sk + 1 ) 。指 标函 数也应 换成 以边界条件为f k ( sk + 1 ) =uk f 0 ( s1 ) = 0op t ∈ D r ( s kk + 1){ vk ( sk + 1 , uk ) + f k - 1 ( sk ) } k = 1 , 2 , … , n·102·式中 sk = T r 得各段的最优决策和相应的最优值 , 最后求出 f n ( sn + 1 ) , 就得到整个问题的最优解。k ( sk + 1 , uk ) 。其求解过程 : 根据边界条件 , 从 k = 1 开始 , 由前向后顺推 , 逐步 求第 3 节 动态规划的最优性原理和最优性定理20 世纪 50 年代 , R .Bellm an 等人根据研究一类多 阶段决策 问题 , 提出 了最优 性原 理 ( 有的翻译成最优化原理 ) 作为动态规划的理论基础。用它去解决许多决策过程的优化问 题。长期以来 , 许多动态规划的著作都用“ 依据最优化原理 , 则有……”的提法去处理决策 过程的优化问题。人们对用这样的一个简单的原理作为动态规划方法的理论根据很难理解。的确如此 , 实际上 , 这提法是给用动态规划方法去处理决策过程的优化问题披上神秘 的色彩 , 使读者不能正确理解动态规划方法的本质。下面将介绍“动态规划的最优性原理”的原文含义。并指出它为什么不是动态规划的理论基础 , 进而揭示动态规划方法的本质。其理论基础是“ 最优性定理”。动态规划的最优性原理 :“ 作为整个过程的最 优策 略具 有这样 的性 质 : 即无论 过去 的 状态和决策如何 , 对前面的决策所形成的状态而言 , 余下的诸决策必须构成最优策略。”简 言之 , 一个最优策略的子策略总是最优的。但是 , 随着人们深入地研究动态规划 , 逐渐认 识到 : 对 于不 同类型 的问 题所建 立严 格 定义的动态规划模型 , 必须对相应的最优性原理给以必要的验证。就是说 , 最优性原理不 是对任何决策过程都普遍成立的 ; 而且“ 最优性原理”与动态规划基本方程 , 并不是无条件 等价的 , 两者之间也不存在确定的蕴含关系。 可见动 态规 划的 基本方 程在 动态规 划的 理 论和方法中起着非常重要作用。而反映动态规划 基本 方程 的是最 优性 定理 , 它是 策略 最 优性的充分必要条件 , 而最优性原理仅仅是策略最优性的必要条件 , 它是最优性定理的推 论。在求解最优策略时 , 更需要的是其充分条件。所以 , 动态规划的基本方程或者说最优 性定理才是动态规划的理论基础。动态规划的最优性定理 : 设阶段数为 n 的多阶段决策过程 , 其阶段编号为允许策略 p *0 , n - 1 = ( u*0, u*1k = 0 , 1 , … , n - 1 n - 1 ) 为最优策略的充要条件是对任意一个 k, … , u * 0 < k < n - 1 和 s0 ∈ S0 有V0 , n - 1 ( s0 , p *0 , n - 1 ) =p0 , k - 1op t ∈ p0 , k - 1( s 0){ V0 , k - 1 ( s0 , p0 , k - 1 ) +pk, n - 1opt ∈ pk, n - 1～ ( sk)V k, n - 1 ( s～k, pk, n - 1 )}式中 p0 , n - 1 = ( p0 , k - 1 , pk, n - 1 ) , s～ k = Tk - 1 ( sk - 1 , uk - 1 ) , 它 是 由给 定的 初 始状 态 s0 和子 策 略 p0 , k - 1 所确 定 的 k 段 状 态。当 V 是效 益 函数 时 , opt 取 m ax ; 当 V 是 损 失函 数 时 , op t 取 min。证明 必要性 : 设 p * V0 , n - 1 ( s0 , p *0 , n - 1 ) =0 , n - 1 是最优策略 , 则pop t ∈ p0 , n - 10 , n - 1V0 , n - 1 ( s0 , p0 , n - 1 )=pop t ∈ p0 , n - 10 , n - 1[ V 0 , k - 1 ( s0 , p0 , k - 1 ) + V k, n - 1 ( s～k , pk, n - 1 ) ]但对于从 k 至 n - 1 阶段的子过程而言 , 它的总指标取决于过程的起始点·202·( 8 -2)～ sk = Tk - 1 ( sk - 1 , uk - 1 ) 和子策略 p k, n - 1而这个起始点 s～k 它是由前一段子过程在子策略 p0 , k - 1 下而确定的。因此 , 在策 略集合 P0 , n - 1 上求最 优解 , 就等价 于先在 子策略集 合 pk, n - 1 ( s～k ) 上求最 优解 , 然后再求这些子最优解在子策略集合 p0 , k - 1 ( s0 ) 上的最优解。故上式可写为V 0 , n - 1 ( s0 , p *0 , n - 1 ) =p0, k - 1op t ∈ p0, k - 1( s 0){pk, n - 1opt ∈ pk, n - 1～ ( sk)[ V0 , k - 1 ( s0 , p0 , k - 1 ) +～ V k , n - 1 ( sk , pk, n - 1 ) ] }但括号内第一项与子策略 pk , n - 1 无关 , 故得V0 , n - 1 ( s0 , p *0 , n - 1 ) =popt ∈ p0, k - 10, k - 1{V0 , k - 1 ( s0 , p0 , k - 1 )+popt ∈ pk, n - 1k, n - 1～ V k, n - 1 ( sk , pk, n - 1 )}充分性 : 设 p0 , n - 1 = ( p0 , k - 1 , pk, n - 1 ) 为任一策略 , s～k 为由 ( s0 , p0 , k - 1 ) 所确定的 k 阶段 的起始状态。则有V k, n - 1 ( s～k , p k, n - 1 ) tpk, n - 1op t ∈ pk, n - 1～ ( sk)V k, n - 1 ( s～k , pk, n - 1 )在这里记 号“ t ”的 含 义是 : 当 op t 表示 max 时 就 表示“ ≤”, 当 op t 表 示 min 时 就 表 示“≥”。因此 , ( 8 -2 ) 式为V0 , n - 1 ( s0 , p0 , n - 1 ) = V0 , k - 1 ( s0 , p0 , k - 1 ) + Vk, n - 1 ( s～k , pk, n - 1 )t V0 , k - 1 ( s0 , p0 , k - 1 ) +pk, n - 1op t ∈ pk, n - 1～ ( sk)V k, n - 1 ( s～k , pk, n - 1 )tp0, k - 1op t ∈ p0 , k - 1( s 0){V0 , k - 1 ( s0 , p0 , k - 1 ) +pk, n - 1op t ∈ pk, n - 1～ ( sk)V k , n - 1 ( s～k , pk, n - 1 )}= V0 , n - 1 ( s0 , p *0 , n - 1 )故只要 p *0 , n - 1 使 ( 8 -2) 式成立 , 则对任一策略 p0 , n - 1 , 都有V0 , n - 1 ( s0 , p0 , n - 1 ) t V 0 , n - 1 ( s0 , p *0 , n - 1 )因为 , p *0 , n - 1 是最优策略。证毕。推论 若允许策略 p * k - 1 , u *0 , n - 1 是最优策略 , 则对任意的 k, 0 < k < n - 1 , 它的子 策略 p * k - 1 ) 为起点的 k 到 n - 1 子过程来说 , 必是最优策略。 ( 注意 : k 阶k = Tk - 1 ( s* k 是由 s0 和 p * 证明 用反证法。 若 p *对于以 s* 段状态 s *0 , k - 1 所确定的 )k , n - 1 不是最优策略 , 则有 , p *V k, n - 1 ( s*V k, n - 1 ( s*op tk , n - 1 ) <, p k, n - 1 )kk( s * k, n - 1 ∈ p)pkk, n - 1k , n - 1此处记号“ < ”是 : 当 op t 表示 m ax 时表示“ < ”, 当 op t 表示 min 时表示“ > ”。因而 0 , k - 1 ) + V k, n - 1 ( s* V0 , n - 1 ( s0 , p *0 , n - 1 ) = V 0 , k - 1 ( s0 , p *, p *k, n - 1 )k< V0 , k - 1 ( s0 , p *0 , k - 1 ) +pk, n - 1op t ∈ pk, n - 1( sk)V k , n - 1 ( s*k, p k, n - 1 )<p0, k - 1op t ∈ P0, k - 1( s 0){V0 , k - 1 ( s0 , p0 , k - 1 ) +pk, n - 1opt ∈ Pk, n - 1～ ( sk)～ Vk, n - 1 ( sk , pk, n - 1 )}·302·故与以上定理的必要性矛盾。证毕。此推论就是前面提到的动态规划的“最优性原理”。它仅仅是最优策略的必要性。从最优性定理可以看到 : 如果一个决策问题有最优策略 , 则该问题的最优值函数一定可用动 态规划的基本方程来表示 , 反之亦真。这是该 定理为 人们 用动 态规划 方法 去处理 决策 问 题提供了理论依据和指明方法 , 就是要充分分析决策问题的结构 , 使它满足动态规划的条 件 , 正确地写出动态规划的基本方程。第 4 节 动态规划和静态规划的关系动态规划、线性规划和非线性规划都是属于数学规划的范围 , 所研究的对象本质上都 是一个求极值的问题 , 都是利用迭代法去逐步求解的。不过 , 线性规划和非线性规划所研 究的问题 , 通常是与时间无关的 , 故又称它们为静态规划。线性规划迭代中的每一步是就 问题的整体加以改善的。而动态规划所研究的问 题是 与时 间有关 的 , 它是 研究具 有多 阶 段决策过程的一类问题 , 将问题的整体按时间 或空间 的特 征而 分成若 干个 前后衔 接的 时 空阶段 , 把多阶段决策问题表示为前后有关联的一系列单阶段决策问题 , 然后逐个加以解 决 , 从而求出了整个问题的最优决策序列。因 此 , 对于 某些 静态的 问题 , 也 可以人 为地 引 入时间因素 , 把它看作是按阶段进行的一个动态规划问题 , 这就使得动态规划成为求解某 些线性、非线性规划的有效方法。由于动态规划方法有逆序解法和顺序解法之 分 , 其关 键在 于正确 写出 动态规 划的 递 推关系式 , 故递推方式有逆推和顺推两种 形式。一 般地说 , 当初始 状态 给定时 , 用 逆推 比 较方便 ; 当终止状态给定时 , 用顺推比较方便。 考查如图 8 -6 所示的 n 阶段决策过程。图 8 -6其中取状态变量为 s1 , s2 , … , sn + 1 ; 决策变量为 x1 , x2 , … , xn 。在第 k 阶段 , 决策 xk 使状态 sk ( 输入 ) 转移为状态 sk + 1 ( 输出 ) , 设状态转移函数为sk + 1 = Tk ( sk , xk ) ,k = 1 , 2 , … , n假定过程的总效益 ( 指标函数 ) 与各阶段效益 ( 阶段指标函数 ) 的关系为V1 , n = v1 ( s1 , x1 ) * v2 ( s2 , x2 ) * … * vn ( sn , xn ) 其中记号“ * ”可都表示为“ + ”或 者都 表示 为“×”。 问题 为使 V1 , n 达 到 最优 化 , 即求 op t V1 , n , 为简单起见 , 不妨此处就求 m ax V 1 , n 。4. 1 逆推解法设已知初始状态为 s1 , 并假定最优值函数 f k ( sk ) 表示 第 k 阶段 的初始 状态为 sk , 从 k阶段到 n 阶段所得到的最大效益。 ·402·从第 n 阶段开始 , 则有f n ( sn ) = m ax ( s n∈ D nxn)vn ( sn , xn )其中 Dn ( sn ) 是由状态 sn 所确定的第 n 阶段的允许决策集合。解此一维极值问题 , 就得 到 最优解 xn = xn ( sn ) 和最优值 f n ( sn ) , 要注意的是 , 若 Dn ( sn ) 只有一 个决策 , 则 x n ∈ Dn ( sn ) 就应写成 xn = xn ( sn )在第 n - 1 阶段 , 有f n - 1 ( sn - 1 ) =xn - 1max ∈ D ( s nn - 1)[ vn - 1 ( sn - 1 , xn - 1 ) * f n ( sn ) ]其中 sn = Tn - 1 ( sn - 1 , xn - 1 ) ; 解此 一 维极 值 问 题 , 得 到最 优 解 xn - 1 = xn - 1 ( sn - 1 ) 和 最 优 值 f n - 1 ( sn - 1 ) 。在第 k 阶段 , 有f k ( sk ) = max ( s∈ Dxkkk)[ vk ( sk , xk ) * f k + 1 ( sk + 1 ) ]其中 sk + 1 = Tk ( sk , xk ) 。解得最优解 xk = xk ( sk ) 和最优值 f k ( sk ) 。如此类推 , 直到第一阶段 , 有f1 ( s1 ) = m ax ( s 1∈ Dx11)[ v1 ( s1 , x1 ) * f2 ( s2 ) ]其中 s2 = T1 ( s1 , x1 ) ; 解得最优解 x1 = x1 ( s1 ) 和最优值 f1 ( s1 ) 。由于初始状态 s1 已知, 故 x1 = x1 ( s1 ) 和 f1 ( s1 )是确定的 ,从而 s2 = T1 ( s1 , x1 ) 也就 可确定 ,于是 x2 = x2 ( s2 ) 和 f2 ( s2 ) 也就可确定。这样 , 按照上述递推过程相反的顺序推算下去 , 就 可逐步确定出每阶段的决策及效益。例 3 用逆推解法求解下面问题max z = x1 · x22 · x3x1 + x2 + x3 = c ( c > 0) xi ≥0 ,i = 1 , 2 , 3 解 按问题的变量个数划分阶段 , 把它 看作 为一个 三阶 段决 策问题。 设状态 变量 为 s1 、s2 、s3 、s4 , 并记 s1 = c; 取问题中的变量 x1 、x2 、x3 为决策变量 ; 各阶段指标函数按乘积 方式结合。令最优值函数 f k ( sk ) 表示为第 k 阶段 的初始 状态 为 sk , 从 k 阶段 到 3 阶 段所 得 到的最大值。设s3 = x3s3 + x2 = s2s2 + x1 = s1 = c则有x3 = s30 ≤ x1 ≤ s20 ≤ x1 ≤ s1 = c于是用逆推解法 , 从后向前依次有f3 ( s3 ) = max = s 2x2( x3 ) = s3 及最优解 x *3 = s3f2 ( s2 ) = max ≤ s 20 ≤ x 2[ x22 · f3 ( s3 ) ] = m ax ≤ s 20 ≤ x2[ x22 ( s2 - x2 ) ] = max ≤ s 20 ≤ x 2h2 ( x2 , x2 )由又d h2 d x2 d2 h2 d x22= 2 x2 s2 - 3 x22 = 0 得 x2 == 2 s2 - 6 x2 , 而d2 h2 d x22x2=2 32 3s 2s2 和 x2 = 0( 舍去 )= - 2 s2 < 0 , 故 x2 =2 3s2 为极大值点。所以 f2 ( s2 ) =4 272 及最优解 x * s32 =2 3s2·502·f1 ( s1 ) = max ≤ s 10 ≤ x1[ x1 · f2 ( s2 ) ] = max0 ≤ x 1≤ s 1x1 · 4 27( s1 - x1 ) 3= max ≤ s 0 ≤ x 11h1 ( s1 , x1 )像前面一样利用微分法易知x * 1 =1 4s1故f1 ( s1 ) =1 64s41由于已知 s1 = c, 因而按计算的顺序反推算 , 可得各阶段的最优决策和最优值。即x * 1 =1 4c,f1 ( c) =1 64c4由s2 = s1 - x *1 = c -1 4c=3 4c所以x * 2 =2 3s2 =1 2c,f2 ( s2 ) =1 16c3由s3 = s2 - x *2 =3 4c -1 2c =1 4c所以x * 3 =1 4c,f 3 ( s3 ) =1 4c因此得到最优解为x * 1 =1 4c, x *2 =1 2c, x *3 =1 4c最大值为max z = f1 ( c) =1 64c44. 2 顺推解法设已知终止状态 sn + 1 , 并假定最优值函数 f k ( s) 表示第 k 阶段末的 结束状 态为 s, 从 1阶段到 k 阶段所得到的最大收益。已知终止状态 sk + 1 用顺推解法与已 知初 始状 态用逆 推解 法在本 质上 没有 区别 , 它 相 当于把实际的起点视为终点 , 实际的终点 视为起 点 , 而按 逆推解 法进 行的。换 言之 , 只 要 把图 8 -6 的箭头倒转过来即可 , 把输出 sk + 1 看作 输入 , 把输入 sk 看作输 出 , 这样便 得到 顺 推解法。但应注意 , 这里是在上述状态变量 和决 策变量 的记 法不 变的情 况下 考虑的。 因 而这时的状态变换是上面状态变换的逆变换 , 记为 sk = T * k ( sk + 1 , xk ) ; 从运算而言 , 即是由 sk + 1 和 xk 而去确定 s k 的。从第一阶段开始 , 有f1 ( s1 ) = m ax ( s 1∈ Dx11)v1 ( s1 , x1 ) 其中 s1 = T *1 ( s2 , x1 )解得最优解 x1 = x1 ( s2 ) 和 最优 值 f1 ( s2 ) 。若 D1 ( s1 ) 只有 一个决 策, 则 x1 ∈ D1 ( s1 ) 就 写 成 x1 = x1 ( x2 ) 。·602·在第二阶段 , 有f2 ( s3 ) = m ax ( s 2∈ Dx32)[ v2 ( s2 , x1 ) * f1 ( s2 ) ]其中 s2 = T *2 ( s3 , x2 ) , 解得最优解 x2 = x2 ( s3 ) 和最优值 f2 ( x3 )如此类推 , 直到第 n 阶段 , 有f n ( sn + 1 ) = max ( s n∈ Dxnn)[ vn ( sn , xn ) * f n - 1 ( sn ) ]其中 sn = T *n ( sn + 1 , xn ) 。解得最优解 xn = xn ( sn + 1 ) 和最优值 f n ( sn + 1 ) 。由于终止状态 sn + 1 是已知的 , 故 xn = xn ( sn + 1 ) 和 f n ( sn + 1 ) 是确定的。再按计算过程的相反顺序推算上去 , 就可逐步确定出每阶段的决策及效益。应指出的是 , 若将状态变量的记法改为 s0 , s1 , … , sn , 决 策变量 记法 不变 , 则按 顺序 解 法 , 此时的最优值函数为 f k ( sk ) 。因而 , 这 个符号 与逆 推解 法的符 号一 样 , 但含义 是不 同 的 , 这里的 sk 是表示 k 阶段末的结束状态。 例 4 将例 3 用顺推解法解之。 解 设 s1 = c, 令最优值函数 f k ( sk + 1 ) 表示第 k 阶段末的结束状态为 s k + 1 , 从 1 阶段到k 阶段的最大值。则有设s2 = x1 , s2 + x2 = s3 , s3 + s3 = s4 = c x1 = s2 , 0≤ x2 ≤ s3 , 0≤ x3 ≤ s4于是用顺推解法 , 从前向后依次有f1 ( s2 ) = max = s 2x1( s1 ) = x2 及最优解 x *1 = s2 。f2 ( s3 ) = max ≤ s 30 ≤ x2[ x22 · f1 ( s2 ) ] = max ≤ s 30 ≤ x2[ x22 ( s3 - x2 ) ] =4 27x33及最优解 x *2 =2 3s3 。f3 ( s4 ) = max ≤ s 10 ≤ x2[ x3 · f2 ( s3 ) ] = max ≤ s 40 ≤ x3x3 · 4 27( s4 - x3 ) 3 =1 64S44及最优解 x *3 =1 4s3 。由于已知 s4 = c, 故易得到最优解为 x *1 =1 4c, x *2 =1 2c, x *3 =1 4c; 相应的最大值为m ax z =1 64c4现在再考虑若是已知初始状态 s1 = c, 将例 3 用顺推解法又如何进行呢 ? 因这时的状态转移函数为 sk = sk + 1 + xk , k = 1 , 2 , 3。为 了保证 决策 变量 非负 , 必须 有sk + 1 ≤ sk ≤ c 因此 , 设 则有x1 + s2 = S1 = c, x2 + s3 = s2 , x3 + S4 = s3 x1 = s1 - s2 = c - s2 , 0≤ x2 ≤ s2 - s3 ≤ c - s3 , 0≤ x3 ≤ s3 - s4 ≤ c - s4于是用顺推解法 , 从前向后依次有f1 ( s2 ) = m ax = c - s 2x1( x1 ) = c - s2及最优解 x *1 = c - s2f2 ( s3 ) = max ≤ c - s 30 ≤ x2[ x22 f1 ( s2 ) ] = m ax0 ≤ x≤ c - s 32[ x22 ( c - s3 - x2 ) ]·702·=4 27( c - s3 ) 3及最优解 x *f3 ( s4 ) = max ≤ c - s 40 ≤ x 3x3 f2 ( s3 ) = max ≤ c - s 40 ≤ x32 3 x3 · 4 272 =( c - s3 )( c - s4 - x3 ) 31 4 由于终止状态 s4 不知道 , 故须再对 s4 求一次极值 , 即1 64( c - s4 ) 3及最优解 x *=3 =( c - s4 )max ≤ c 0 ≤ s 4f 3 ( s4 ) = max ≤ c0 ≤ s 41 64( c - s4 ) 3显然 , 只有当 s4 = 0 时, f3 ( s4 ) 才能达到最大值。然后按计算顺 序反推算可求出 各阶段的最优决策及最优值。最后得到最优解为 x *1 =1 4c, x *2 =1 2c, x*3 =1 4c; 最大值为max z = f3 (0 ) =1 64c3注意 若记状态 变 量 为 s0 、s1 、s2 、s3 , 取 s0 = c; 决 策 变 量 记 法 不 变 ; 令 最 优 值 函 数 f k ( sk ) 表示第 k 阶段末的结束状态 为 s k , 从 1 阶段 到 k 阶 段的 最大 值 , 则按 顺 推解 法 , 从 前向后依次为f1 ( s1 ) = m ax = c - s 1 f2 ( s2 ) = max ≤ c - s 2 [ x3 f2 ( s2 ) ]( x1 )x1[ x22 f1 ( s1 ) ]0 ≤ x2f3 ( s3 ) = max 0 ≤ x ≤ c - s 3例 5 用动态规划方法解下面问题m ax F = 4 x22 + 2 x2 1 - x2 3 x1 + 2 x2 + x3 ≤9 xi ≥ 0 ,3 + 12i = 1 , 2 , 3解 按问题中变量的个数分为 三个 阶段。设 状态 变量为 s0 、s1 、s2 、s3 , 并记 s3 ≤9 ; 取 x1 、x2 、x3 为各阶段的决策变量 ; 各阶段指标函数按加法方式 结合。令 最优值函 数 f k ( sk ) 表示第 k 阶段的结束状态为 s k , 从 1 阶段至 k 阶段的最大值。 3 x1 = s1 , s1 + 2 x2 = s2 , s2 + x3 = s3 ≤9 设 x1 = s1/ 3 , 0≤ x2 ≤ s2/ 2 , 0≤ x3 ≤ s3则有于是用顺推方法 , 从前向后依次有f1 ( s1 ) = max / 3 1x= x1(4 x21 ) =4 9s21及最优解 x *1 = s1/ 3f2 ( s2 ) = max ≤ s 20 ≤ x2/ 2[ - x22 + f1 ( s1 ) ] = max ≤ s / 2 20 ≤ x2x22 +4 9( s2 - 2 x2 ) 2由= max ≤ s 0 ≤ x 2 2 d h2 d x2/ 2h2 ( s2 , x2 )=14 9x2 -16 9s2 = 0 解得 x2 =8 7s2因该点不在允许决策集合内 , 故无须判别。因而 h2 ( s2 , x2 ) 的最大值必在两个端点上选取。而h2 (0 ) =4 9s2 2 , h2s2 2= - s22/ 4·802·所以 h2 ( s2 , x2 ) 的最大值点在 x2 = 0 处,故得到 f2 ( s2 ) =4 92 及相应的最优解 x * s24 = 0。f 3 ( s3 ) = m ax ≤ s 30 ≤ x3[2 x23 + 12 + f2 ( s2 ) ]= m ax ≤ s 0 ≤ x 332 x23 + 12 +4 9( s3 - x3 ) 2 = max0 ≤ x3≤ s 3h3 ( s3 , x3 )由d h3 d x3=44 9x3 -8 9s3 = 0 解得 x3 =2 11s3又d2 h3 d x23=44 9> 0 , 故该点为极小值点。而h3 ( 0) =4 9s2 3 + 12 ,h3 ( s3 ) = 2 s23 + 12故 h3 ( s2 , x3 ) 的最大值点在 x3 = s3 处 , 所以得 f3 ( x3 ) = 2 s23 + 12 及相应的最优解 x *3 = s3 。由于 s3 不知道 , 故须再对 s3 求一次极值 , 即max ≤ 9 0 ≤ s 3f3 ( s3 ) = max ≤ 90 ≤ s 3[2 s23 + 12]显然 , 当 s3 = 9 时 f3 ( s3 ) 才能达到最大值。所以 f1 (9 ) = 2×92 + 12 = 174 为最大值。再按计算的顺序反推算可求得最优解为 x *1 = 0 , x * max F = f 1 (9 ) = 1742 = 0 , x3 = 9 ; 最大值为注意(1 ) 若先作代换 , 令 y1 = 3 x1 , y2 = 2 x2 , y3 = x3 , 将原问题变为max F =4 9y2 1 -1 42 + 2 y2 y23 + 12y1 + y2 + y3 ≤9 yi ≥0 ,i = 1 , 2 , 3再解此问题 , 然后换回 xi 也可以。(2 ) 在计算 h2 和 h3 的最大值中 , 若学习了凸函数的 性质 , 也可 利用凸函 数的性质 来确定最大值。4. 3 动态规划的计算框图在实际问题中 , 函数序列 f k ( sk ) 往往不 能表 示为 解析 形 式 ; 状态 变量 sk 和决 策变 量 x k 即使是离散的 , 其集合也很大。这样 , 求 f k ( sk ) 和最优 策略的 数值解计 算量就 很大 , 一 般要用计算机来解决。下面讨论逆序解法的迭 代 计算 程序。由 于 始端 可能 是自 由状 态 或 固定 状 态两 种 情况 , 终端也可能是自由状态或固定状态两 种情况 , 因 而组 合起来 就有 四种 情况。这 里 , 仅 讨论终端自由而且始端自由或固定的两种情况的计算框图。至于终端固定的情况框图类似 , 就不讨论了。为明确起见 , 假设 : 决策变量 xk 是连续实变数 , 允许 决策集合 Dk ( sk ) 是 实数集 合 ; 状态变量 sk 也是连续实变数 , 各段可达状态集合 Sk 的实数闭区间是 [ sk , sk ] , 对于始端固定的1 k , s状态变量 , 各段可达状态集合 s1 k ]。在计算前 , 先要把 sk 离散化。为 此, 要选好适当的增量 Δs。在第 k 段, 计算将在点列{ sk , sk + Δs, … , sk + mkΔs}上 进行 , 其 中k 的实数闭区间是 [ s1·902·mk 是满足sk + mkΔs≤ Sk ≤ Sk + ( mk + 1)Δs 的正整数。根据一般的逆序动态规划的基本方程 :f n + 1 ( sn + 1 ) = 0f k ( sk ) =xkop t ∈ D ( s kk){ vk ( sk , xk ) + f k + 1 ( sk + 1 )} ,k = n, … , 2 , 1其中 sk + 1 = Tk ( sk , sk ) , 且当 s1 固定时 , sk ∈ S1 逆序解法计算程序框图 ( 见图 8 -7 ) , 下面对框图作几点说明。k ; 当 s1 自由时 , sk ∈ Sk 。因而可得动态规划的(1 ) 图 8 -7 中 , 左边部分是指标函数序列{ f k ( sk )} 的递推计算 , 它 是逆序 的 , 即 k 由 n k }的递 推计 算 , 它是顺 序的 , 即 k 由 1 逐步 增逐步减少到 1 ; 右边部分是最优决策序列 { x * 大到 n。图 8 -7 动态规划逆序解法计算程序框图(2 ) 若实际问题要求的不只 是整 个过程 的最 优解 , 而且 要求 出从 各段出 发的 最优 策 k ( sk ) 后就可 输出 , 如图中的 虚略和最优值。则在程序中 , 对每一 k 段 , 计算完 f k ( sk ) 和 x * 线所示。如不需要输出 sk , 可把右边部分框图取消。(3 ) 框图中包含①固定始 端和② 自由 始端 两种情 况。它 们的区 别是 , 左 边部 分输 入数据不同 , 右边部分在自由始端②情况下 , 还需多求一次最优值计算。(4 ) 因 f k + 1 ( sk + 1 ) 只 在 计 算 k 段 时 有 用 , 到 k - 1 段 就 没 用 了。 故 在 计 算 k 段 时 , k ( sk ) 在f k ( sk ) 都要存入内存 , 在计算 k - 1 段时 , 可用 f k ( sk ) 把 f k + 1 ( sk + 1 ) 替换掉。函数 x *·012·左边部分计算出来后不要用 , 可送 入外存。 在右 边部分 求{ x * x k 由外存移入内存。k }需 用时 , 再 依 k 的 序列 将(5 ) 在计算 f k ( sk ) 时 , sk 在点列上取值 , 对于点 sk = sk + jΔs(0≤ j≤ mk )～点 sk + 1 = T k ( sk , xk ) ( xk ∈ Dk ( sk ) )不一定在 sk + 1 的点列中 , 这时 , 必须选择适当的内插公式 , 由 f k + 1 ( sk + 1 ) 在点列上的值求它 在点 s～k + 1 上的值。逆序解法计算程序框图 : ①固定始端 ; ②自由始端。 最后应指出的是 , 在这节里运用递推关系 逐步求 出极 值函 数 f 1 ( s) 、…、f n ( s) 及相 应 的决策函数 x1 ( s) 、…、xn ( s) , 这是一种通过 函数值 不断 的迭代 过程 , 而 逐步 达到最 优值 , 通常称为函数空间迭代法。这种迭代方法 , 不 仅对像 例 1 那样 阶段数 为确 定有限 值的 定 期多阶段决策过程有效 , 而且 , 对在实际问题中 , 出现的动态规划基本方程 , 不是一个递推 方程 , 而是为某函数的泛函方程 , 那种阶段数为有限但不固定的不定期多阶段决策过程或 阶段数为无限 ( 或很大 ) 的无期多阶段决策过程也是一种重要的求解方法。还有对解上述 两类过程比函数空间迭代法的收敛速度要快些的策略空间迭代法。函数空间迭代法和策略空间迭代法都是动态规划求解不定期或无期的多阶段决策过程的两种重要方法。由于篇幅有限 , 这里就不介绍了。注记通过这章的学习 , 大家看到 : 任何一个多阶段决策过程的最优化问题 , 都可以用非线性规 划 (特 殊的为线性规划 ) 模型来描述。从原则上说 , 一般也可以用 非线性 规划方 法来求 解。那么 , 用动态 规划方 法有什么优越性呢 ?( 1) 易于确定全局最优解。即使指标函 数形式 较简单 , 由于 约束条 件所确 定的约 束集合 往往十 分复杂 , 故应用目前的非线性规划方法求全局最优解是非常困难的。而动态规划方法是一种 逐步改善法 ,它把原问题化成一系列结构相似的最优化子问题 , 而每个子问题的变量个数比原问题少得 多 , 约束 集合也简单得多 , 故较易于确定全局最优解。特别是 , 对于一类 其指标、状态 转移和 允许决 策集合 不能用 分析形式表出的过程最优化问题( 如非线性整数规划、离散 模型 ) , 用 分析方 法无法 求出最 优解 , 而用动 态规划却很容易。基于这点 , 目前有相当多的最优化问题 , 动态规划是求出其全局最优解的唯一方法。( 2) 能得到一族解 , 有利于分析结果。非 线性规 划的方 法是对 问题的 整体求 解 , 是 单阶段 进行的 ,它只能得到全过程的解。而动态规划方法是将求解分成多阶段进行 , 求出的不仅是全过程 的解 , 而 且包括所有子过程的一族解。在某些情况下 , 这些解族正是实际问题所需要的 , 它有助于分 析结果是否 有用等 , 这时 , 动态规划方法比其他方法更显示出优越性 , 且大大节省了计算量。( 3) 能利用经验 , 提高求解的效率。动态规划方法反映了过 程逐段演变的 前后联系 , 较之非线 性规划与实际过程联系得更紧密 , 因而在计算中 , 能更有效 地利用 经验 , 提高 求解的 效率。如在策 略空间 迭代法中 , 初始策略的选取对于迭代的收敛速度有很大的影响 , 故利用经验能帮助选好初始策略。有 的问题 , 不一定要知道最优解的值 , 而关心的是最优解的结构或 过程中 某些参 数的依 赖关系 等 , 这 时利用 动态规划方法分析较方便。动态规划方法也存在不足之外 :( 1) 到目前为止 , 没有一个统一的标准模型可供应用。由于 实际问题不同 , 其动态 规划模型也 就有异 , 虽然理论上说可以把某些静态规划的问题转化为动态规划模型来求解 , 但这种转化 有时将变得 十分困难 , 需要丰富的想像力和灵活的技巧性。·112·( 2) 应用的局限性。由于构造动态规划模型时 , 状态变量必须 满足“无后效性”条件 , 这条件不 仅依赖于状态转移规律 , 还依赖于允许决策集合和指标函数的结构 , 是一个相当强的条件。不少实际问 题在取其自然特征作为状态变量往往不能满足这条件 , 这就 降低了 动态规 划的通 用性。虽然 , 从原 则上说 ,采取适当增多状态变量的办法 , 总能人为地把过程变为无后效的 , 但由于动态规划的常 规算法还存 在局限性 , 故这种作法目前不可取。( 3) 在数值求解时 , 存在“维数障碍”。由于在大多数问题中 , 函数{ f k ( sk ) }必须以状态 集合 sk 内格点上的数值来表示。故在电子计算机上计算时 , 每递推一段 , 都必须把前一段算出的最 优值函数在 相应的状态集合上的全部值存入内存中。设每一 状态变 量的集 合是实 数区间 , 如 果每区 间都分 成 m - 1 个格子 , 则在一 维情况 下 , 表示 f k 之值 的格点 数为 m, 而 在 n 维情况 下 , 格点数 为 mn 。可 见当维 数增 大 时 , 所需的内存量成指数倍增长。例如 , 若计算机的内存量为 216 = 32768 字节 , 由维数 n12345每维格点数 3276818132138可见 , 在这样内存限制下 , 超过三维 (包 括三 维 ) 的 问题 用通 常的 动态 规划方 法是 不可 取的。为 了克 服“维数障碍”, 目前已找出了不少方 法。如多 项式 逼近 法、逐次 逼近 法、状态 微增 法、拉格朗 日乘 数法 等等。它们对于不同范围内的问题已经证明在一定程度上可以克服这个障碍。但是目前 尚无一般的 解决办法。应指出的是 , 动态规划方法虽存在许多不足之处 , 但应用是广泛的。许多专家学者 结合实际已 成功解决了许多实际问题。我国情况也是如此 , 如张勇传院士等 , 在 1985 年前 , 将动态规划 方法应用于 水电站水库优化调度方面作出了成绩 , 曾获 1985 年国家科委公颁的一等奖 (见光明日报 1985 年 10 月8 日 ) 。随着计算机的日益普及 , 用动态规划基本思想去处理问题更加广泛。许多介绍算法的 书里 , 都 提到用动态规划方法 , 如何巧妙地解决了科 学技术 和实 际生 活中 问题 的例 子 , 称这 种算 法是高 效率 的算 法之一。习题8. 1 试分 析 本 章 第 1 节 之 例 2 问 题 中 ( 1 ) 阶 段 的 划 分 ; ( 2 ) 状 态 变 量 和 它 的 取 值范围 ; ( 3) 决策变量和它的 允 许 决 策 集 合 ; ( 4 ) 状 态 转 移 方 程 ; ( 5 ) 指 标 函 数 和 最 优 值 函数。8. 2 设某工厂自国外进口一部精密机器 , 由机器制造厂至出口港有三个港口可供选 择 , 而进口港又有三个可供选择 , 进口后可经由 两个城 市到 达目的 地 , 其间 的运输 成本 如 图 8 -8 中所标的数字 , 试求运费最低的路线 ?图 8 -88. 3 计算从 A 到 B、C 和 D 的最短路线。已知各段路线的长度如图 8 -9 所示。·212·ÆÝô¯(cid:11)ôô(cid:11)(cid:11)(cid:11)图 8 -98. 4 写出下列问题的动态规划的基本方程。nn(1 ) max z = ∑i ( xi )( 2) min z = ∑ci x2i = 1i = 1nn∑x i = b ( b > 0 )∑ai x i ≥ b ( ai > 0)i = 1i = 1x i ≥0 ,( i = 1 , 2 , … , n)x i ≥0 ,( i = 1 , 2 , … , n)8. 5 用递推方法求解下列问题 (1 ) max z = 4 x1 + 9 x2 + 2 x2 x1 + x2 + x3 = 10 i = 1 , 2 , 3(3) max z = x1 … xn( 2) m ax z = 4 x1 + 9 x2 + 2 x232 x1 + 4 x2 + 3 x3 ≤10x i ≥0 , (4) min z = 3 x1 - 5 x1 + 3 x2i = 1 , 2 , 32 - 3 x2 + 2 x23 - 7 x3n∑x i = c ( c > 0)i = 1x i ≥0 ,i = 1 , 2 , … , n2 x1 + 3 x2 + 2 x3 ≥16 x i ≥0 ,i = 1 , 2 , 3n(5 ) max z = 3 x31 - 4 x1 + 2 x22 - 5 x2 + 2 x3( 6) min z = ∑x p i ( p > 1 )i = 1n4 x1 + 2 x2 + 3 x3 ≤18 x i ≥0 ,i = 1 , 2 , 3∑xi = c ( c > 0 )i = 1x i ≥0 ,i = 1 , 2 , … , n8. 6 设某人有 400 万元金额 , 计划在四年内全部用于投资中去。已知在一年内若投资用去 x 万元就能获得 x 万元的效用。每年没有用掉的金额 , 连同利息 ( 年利息 10 % ) 可 再用于下一年的投资。而 每年 已 打算 用于 投资 的金 额 不计 利息。试 制 定金 额 的使 用 计划 , 而使四年内获得的总效用最大 ? (1 ) 用动态规划方法求解 ; (2 ) 用拉格朗日乘数法求解 ; (3 ) 比较两种解法 , 并说明动态规划方法有哪些优点。·312·第 9 章 动态规划应用举例第 1 节 资源分配问题所谓分配问题 , 就是将数量一定的一种 或若 干种资 源 ( 例如 原材 料、资金、机器 设备、劳力、食品等等 ) , 恰当地分配给若干个使用者 , 而使目标函数为最优。1. 1 一维资源分配问题设有某种原料 , 总数量为 a, 用 于生 产 n 种产 品。若 分配 数 量 xi 用 于生 产 第 i 种 产品 , 其收益为 gi ( x i ) 。问应如何分配 , 才能使生产 n 种产品的总收入最大 ?此问题可写成静态规划问题 :max z = g1 ( x1 ) + g2 ( x2 ) + … + gn ( xn )x1 + x2 + … + xn = a xi ≥0 ,i = 1 , 2 , … , n当 gi ( xi ) 都是线性函数时 , 它是一个线 性规划 问题 ; 当 gi ( xi ) 是非 线性 函数时 , 它 是 一个非线性规划问题。但当 n 比较大时 , 具体求解是比较麻烦的。然而 , 由于这类问题的 特殊结构 , 可以将它看成一个多阶段决策问题 , 并利用动态规划的递推关系来求解。在应用动态规划方法处理这类“静态规划”问题时 , 通 常以 把资源 分配 给一个 或几 个 使用者的过程作为一个阶段 , 把问题 中的 变量 xi 为决 策变 量 , 将累计 的量 或随递 推过 程 变化的量选为状态变量。设状态变量 sk 表示分配用于生产第 k 种产品至第 n 种产品的原料数量。 决策变量 uk 表示分配给生产第 k 种产品的原料数 , 即 uk = xk 状态转移方程 :sk + 1 = sk - uk = sk - xk允许决策集合 :Dk ( sk ) = { uk | 0≤ uk = xk ≤ sk }令最优值函数 f k ( sk ) 表示 以数量 为 sk 的 原料 分配 给第 k 种产 品 至第 n 种产 品所 得到的最大总收入。因而可写出动态规划的逆推关系式为 :f k ( sk ) = m ax ≤ s0 ≤ xkk{ gk ( xk ) + f k + 1 ( sk - xk ) } ,k = n - 1 , … , 1f n ( sn ) = max = s nxng n ( xn )利用这个递推关系式进行逐段计算 , 最后求得 f1 ( a) 即为所求问题的最大总收入。 例 1 某 工业 部门 根据 国 家计 划的 安排 , 拟将 某种 高效 率 的设 备五 台 , 分 配给 所 属 的甲、乙、丙三个工 厂 , 各 工 厂 若 获 得 这 种 设 备 之 后 , 可 以 为 国 家 提 供 的 盈 利 如 表 9 -1 所示。·412·表 9 -1盈利/万元工厂甲乙丙数台备设000013542710639111141211125131112问 : 这五台设备如何分配给各工厂 , 才能使国家得到的盈利最大。 解 将问题按工厂分为三个阶段 , 甲、乙、丙三个工厂分别编号为 1、2、3 设 sk 表示为分配给第 k 个工厂至第 n 个工厂的设备台数。 xk 表示为分配给第 k 个工厂的设备台数。 则 sk + 1 = sk - xk 为分配给第 k + 1 个工厂至第 n 个工厂的设备台数。 Pk ( xk ) 表示为 xk 台设备分配到第 k 个工厂所得的盈利值。 f k ( sk ) 表示为 sk 台设备分配给第 k 个工厂至第 n 个工厂时所得到的最大盈利值。 因而可写出逆推关系式为f k ( sk ) = max ≤ s0 ≤ xkk[ Pk ( xk ) + f k + 1 ( sk - xk ) ] ,k = 3 , 2 , 1f 4 ( s4 ) = 0下面从最后一个阶段开始向前逆推计算。第三阶段 : 设将 s3 台设备 ( s3 = 0 , 1 , 2 , 3 , 4 , 5 ) 全部分配给工厂丙时 , 则最大盈利值为f3 ( s3 ) = maxx3[ P3 ( x3 ) ]其中 x3 = s3 = 0 , 1 , 2 , 3 , 4 , 5因为此时只有一个工厂 , 有多少台设备就全部分配给工厂丙 , 故它的盈利值就是该段的最大盈利值。其数值计算如表 9 -2 所示。表 9 -2x3p3 ( x3 )s3012345f3 ( s3 )x* 3000014412662311113412124512125·512·©e(cid:7)(cid:11)©e(cid:7)(cid:11)Àe(cid:11)(cid:7)À"e(cid:7)Àe"(cid:30)À"e(cid:30))ØÀLdð|«"|‘«"ð‘«d"‘"«ï¨"«c¨×«"¨表中 x *3 表示使 f3 ( s3 ) 为最大值时的最优决策。第二阶段 : 设把 s2 台设备 ( s2 = 0 , 1 , 2 , 3 , 4 , 5) 分配给工厂乙和工厂丙时 , 则对 每个 s2 值 , 有一 种最优分配方案 , 使最大盈利值为其中f2 ( s2 ) = max[ P2 ( x2 ) + f3 ( s2 - x2 ) ]x2 x2 = 0 , 1 , 2 , 3 , 4 , 5因为给乙工厂 x2 台 , 其盈利为 p2 ( x2 ) , 余 下的 s2 - x2 台就给 丙工 厂 , 则它的 盈利 最 大值为 f3 ( s2 - x2 ) 。现要选择 x2 的值 , 使 p2 ( x2 ) + f3 ( s2 - x2 ) 取最大值。其数值计算如 表 9 -3所示。表 9 -3x2p2 ( x2 ) + f3 ( s2 - x2 )s2012345f2 ( s2 )x* 2000010 + 45 + 05120 + 65 + 410 + 010230 + 115 + 610 + 411 + 014240 + 125 + 1110 + 611 + 411 + 0161 , 250 + 125 + 1210 + 1111 + 611 + 411 + 0212第一阶段 : 设把 s1 台 ( 这里只 有 s1 = 5 的 情 况 ) 设备 分 配 给 甲、乙、丙 三个 工 厂 时 , 则 最 大 盈 利值为其中f1 ( 5) = m ax[ p1 ( x1 ) + f2 (5 - x1 ) ]x1 x1 = 0 , 1 , 2 , 3 , 4 , 5因为给甲工厂 x1 台 , 其盈利为 p1 ( x1 ) , 剩 下的 5 - x1 台 就分 给乙 和丙 两个 工 厂 , 则 它的盈利最大值为 f2 (5 - x1 ) 。现要选择 x1 值 , 使 p1 ( x1 ) + f2 (5 - x1 ) 取最大值 , 它就 是 所求的总盈利最大值 , 其数值计算如表 9 -4 所示。表 9 -4x1p1 ( x1 ) + f2 (5 - x1 )s1012345f1 (5 )x* 150 + 213 + 167 + 149 + 1012 + 513 + 0210 , 2然后按计算表格的顺序反推算 , 可知最优分配方案有两个 : (1 ) 由于 x *1 = 0 , 根 据 s2 = s1 - x *1 = 5 - 0 = 5 , 查 表 9 -3 知 x *2 = 2 , 由 s3 = s2 - x *5 - 2 = 3 , 故 x *3 = s3 = 3 。即得甲工厂分配 0 台 , 乙工厂分配 2 台 , 丙工厂分配3 台。(2 ) 由于 x *1 = 2 , 根 据 s2 = s1 - x *1 = 5 - 2 = 3 , 查 表 9 -3 知 x *2 = 2 , 由 s3 = s2 - x *·612·2 =2 =)ÀØLðd|«"|‘Á"5«‘ÁÀ«5"¨ØÀ«"45¨ÀØPL«4¨¨ØL×"4«¨¨(cid:28))ÀØLdð|ØÀPL4«¨¨(cid:28)3 - 2 = 1 , 故 x *3 = s3 = 1 。即得甲工厂分配 2 台 , 乙工厂分配 2 台 , 丙工厂分配1 台。以上两个分配方案所得到的总盈利均为 21 万元。 在这个问题中 , 如果原设备的台数不是 5 台 , 而是 4 台或 3 台 , 用其他方法解时 , 往往 要从头再算 , 但用动态规划解时 , 这些列出的 表仍旧 有用。 只需要 修改 最后的 表格 , 就 可 以得到 :当设备台数为 4 台时 , 最 优 分 配方 案 为 : x *1 = 1 , x *2 = 2 , x *3 = 1 ; 或 x *1 = 2 , x *2 = 2 ,x * 3 = 0 , 总盈利为 17 万元。当设备台数为 3 台时 , 最优分配方案为 : x * 这个例子是决策变量取离散值的一类分配问题。在实际中 , 如销售店分配问题 , 投资 分配问题 , 货物分配问题等等 , 均属于这类分配问题。这种只将资源合理分配不考虑回收 的问题 , 又称为资源平行分配问题。1 = 0 , x *2 = 2 , x *3 = 1 , 总盈利为 14 万元。在资源分配问题中 , 还有一种要考虑资 源回收 利用 的问题 , 这 里决 策变 量为连 续值 ,故称为资源连续分配问题。这类分配问题一般叙述如下 :设有数量为 s1 的某种资源 , 可投入 A 和 B 两种 生产。第一 年若以 数量 u1 投 入生 产 A , 剩下的量 s1 - u1 就投入生产 B , 则可得收 入为 g( u1 ) + h( s1 - u1 ) , 其中 g( u1 ) 和 h( u1 ) 为已知函数 , 且 g( 0) = h(0 ) = 0。这 种资 源在投 入 A、B 生 产后 , 年终 还可 回收再 投入 生 产。设年回收率分别为 0 < a < 1 和 0 < b < 1 , 则 在第 一 年生 产 后 , 回 收 的资 源 量合 计 为 s2 = au1 + b( s1 - u1 ) 。第二年再将资源数量 s2 中的 u2 和 s2 - u2 分 别再投入 A、B 两种 生 产 , 则第二年又可得到收入为 g( u2 ) + h( s2 - u2 ) 。如此继 续进 行 n 年 , 试问 : 应当 如何 决 定每年投入 A 生产的资源量 u1 , u2 , … , un , 才能使总的收入最大 ?此问题写成静态规划问题为max z = { g( u1 ) + h( s1 - u1 ) + g( u2 ) + h( s2 - u2 ) + … + g( un ) + h( sn - un ) }s2= au1 + b( s1 - u1 )s3= au2 + b( s2 - u2 )⁝sn + 1 = aun + b( sn - un ) 0≤ ui ≤ si ,i = 1 , 2 , … , n下面用动态规划方法来处理。设 sk 为状态变量 , 它表示在第 k 阶段 ( 第 k 年 ) 可投入 A、B 两种生产的资源量。 uk 为决策变量 , 它表示在第 k 阶段 ( 第 k 年 ) 用 于 A 生产 的资源 量 , 则 sk - uk 表示 用于 B 生产的资源量。状态转移方程为 sk + 1 = auk + b( sk - uk ) 最优值函数 f k ( sk ) 表示有资源量 sk , 从第 k 阶段 至第 n 阶 段采取 最优 分配方 案进 行生产后所得到的最大总收入。因此可写出动态规划的逆推关系式为f n ( sn ) = m ax ≤ s n0 ≤ un{ g( un ) + h( sn - un ) }f k ( sk ) = max ≤ s0 ≤ ukk{ g( uk ) + h( sk - uk ) + f k + 1 [ auk + b( sk - uk ) ]}( 9 -1)k = n - 1 , … , 2 , 1·712·最后求出 f1 ( s1 ) 即为所求问题的最大总收入。例 2 机器负荷分配问题。某种 机器 可在高 低两 种不 同 的负 荷下 进行 生产 , 设机 器 在高负 荷 下 生 产 的 产 量 函 数 为 g = 8 u1 , 其 中 u1 为 投 入 生 产 的 机 器 数 量 , 年 完 好 率 a = 0 .7 ; 在低负荷下生产的产量函数为 h = 5 y, 其 中 y 为投 入生产 的机 器数量 , 年 完好 率 为 b = 0 .9。假定开始生产时完好的机器数量 s1 = 1000 台 , 试 问每 年 如何 安排 机器 在高、低负 荷下的生产 , 使在五年内生产的产品总产量最高。先构造这个问题的动态规划模型 : 设阶段序数 k 表示年度。 状态变量 sk 为第 k 年度初拥 有的 完好机 器数 量 , 同时 也是 第 k - 1 年 度 末时 的完 好机器数量。决策变量 uk 为第 k 年度中分配高负荷下生产的机器数量 , 于是 sk - uk 为该年度中分配在低负荷下生产的机器数量。这里 sk 和 u k 均取连续变量 , 它们的非整 数值可以这样理 解 , 如 sk = 0 .6 , 就表示一 台 机器在 k 年度中正常工作时间只占 6/ 10 ; uk = 0 .3 , 就表示一台机器在该年度只有 3/ 10 的 时间能在高负荷下工作。状态转移方程为sk + 1 = auk + b( sk - uk ) = 0 .7 uk + 0 .9( sk - uk ) ,k = 1 , 2 , … , 5k 段允许决策集合为 D k ( sk ) = { uk | 0≤ uk ≤ sk } 设 vk ( sk , uk ) 为第 k 年度的产量 , 则vk = 8 uk + 5( sk - uk )故指标函数为5V 1 , 5 = ∑vk ( sk , uk )k = 1令最优值函数 f k ( sk ) 表示由资源量 sk 出发 , 从第 k 年开始 到第 5 年结束 时所生产 的产品的总产量最大值。因而有逆推关系式 :f6 ( s6 ) = 0f k ( sk ) = max ( s∈ D kukk){8 uk + 5 ( sk - uk ) + f k + 1 [0 .7 uk + 0 .9 ( sk - uk ) ]}k = 1 , 2 , 3 , 4 , 5从第 5 年度开始 , 向前逆推计算。当 k = 5 时 , 有f5 ( s5 ) = max ≤ s 50 ≤ u 5{8 u5 + 5 ( s5 - u5 ) + f 6 [ 0 .7 u5 + 0 .9 ( s5 - u5 ) ] }= max ≤ s 0 ≤ u 5 5{8 u5 + 5 ( s5 - u5 )}= max ≤ s 0 ≤ u 5 5{3 u5 + 5 s5 }因 f5 是 u5 的线性单调增函数 , 故得最大解 u *5 = s5 , 相应的有 f5 ( s5 ) = 8 s5 。当 k = 4 时 , 有f4 ( s4 ) = max ≤ s 40 ≤ u 4{8 u4 + 5 ( s4 - u4 ) + f 5 [ 0 .7 u4 + 0 .9 ( s4 - u4 ) ] }·812·= max ≤ s 0 ≤ u 4 4{8 u4 + 5 ( s4 - u4 ) + 8 [0 .7 u4 + 0 .9( s4 - u4 ) ]}= max ≤ s 0 ≤ u 4 4{13 .6 u4 + 12 .2 ( s4 - u4 )}= max ≤ s 0 ≤ u 4 4{1 .4 u4 + 12 .2 s4 }故得最大解 , u *4 = s4 , 相应的有 f4 ( s4 ) = 13 .6 s4 依此类推 , 可求得u * 3 = s3 , 相应的 f3 ( s3 ) = 17 .5 s3 u * 2 = 0 , 相应的 f2 ( s2 ) = 20 .8 s2 u * 1 = 0 , 相应的 f1 ( s1 ) = 23 .7 s1因 s1 = 1000 , 故 f1 ( s1 ) = 23700 ( 台 ) 。 计算结果表明 : 最优策略为 u *2 = 0 , u * 5 = s5 , 即前 两年应把 年 初全部完好机器投入低负荷生产 , 后三年应 把年 初全部 完好 机器 投入高 负荷 生产。这 样 所得的产量最高 , 其最高产量为 23700 台。1 = 0 , u *3 = s3 , u *4 = s4 , u *在得到整个问题的最优指标函数值和最优策略后 , 还需反过来确定每年年初的状态 ,即从始端向终端递推计算出每年年初完好机器数。已知 s1 = 1000 台 , 于是可得 1 + 0 .9( s1 - u * 2 + 0 .2( s2 - u * 3 + 0 .9( s3 - u * 4 + 0 .9( s4 - u * 5 + 0 .9( s5 - u *s2 = 0 .7 u * s3 = 0 .7 u * s4 = 0 .7 u * s5 = 0 .7 u * s6 = 0 .7 u *1 ) = 0 .9 s1 = 900 ( 台 )2 ) = 0 .9 s2 = 810 ( 台 ) 3 ) = 0 .7 s3 = 567 ( 台 ) 4 ) = 0 .7 s4 = 397 ( 台 )5 ) = 0 .7 s5 = 278 ( 台 )上面所讨论的最优策略过程 , 始端状态 s1 是 固定的 , 终 端状 态 s6 是 自由 的。由此 所 得出的最优策略称为始端固定终端自由的最优 策略 , 实现 的目 标函数 是五 年里的 产品 总 产量最高。如果在终端也附加上一定的约束条件 , 如规定在第五年度结束时 , 完好的机器数量为 500 台 ( 上面只有 278 台 ) , 问应如何安排生产 , 才能在满足这 一终端 要求的情 况下产量 最 高 ? 读者作为练习自己计算之。下面进一步来讨论始端固定、终端自由的一般情况。设有 n 个年度 , 在高、低负荷下生产的产量函数分别为 g = cu1 , h = du2 , 其中 c、d > 0 , c > d。而年回收率分别为 a 和 b , 0 < a < b < 1 。试求出最优 策略的一般关系 式。显然 , 这 时状态转移方程为sk + 1 = auk + b( sk - uk ) ,k = 1 , 2 , … , nk 段的指标函数为vk = cuk + d( sk - uk ) ,k = 1 , 2 , … , n令 f k ( sk ) 表示由状态 sk 出发 , 从第 k 年至第 n 年末时所生产的产品的总产量最大值。因而可写出逆推关系式为 :f n + 1 ( sn + 1 ) = 0f k ( sk ) = max ≤ s0 ≤ ukk{ cuk + d( sk - uk ) + f k + 1 [ auk + b( sk - uk ) ] }( 9 -2)k = 1 , 2 , … , n我们知道 , 在低负荷下生产的时间愈 长 , 机器完 好率 愈高 , 但 生产产 量少。而 在高 负·912·荷下生产产量会增加 , 但机器损坏大。这样 , 即使每台产量高 , 总起来看产量也不高。从前面的数字计算可以看出 , 前几年一般是全部用于低负荷生产 , 后几年则全部用于 高负荷生产 , 这样才 产量最 高。如果总 共为 n 年 , 从低 负荷转为 高负荷 生产的是 第 t 年 , 1≤ t≤ n。即是说 , 从 1 至 t - 1 年在低负荷下生产 , t 至 n 年 在高负 荷下生产。 现在要分 析 t 与系数 a、b、c、d 是什么关系。从回收率看 , ( b - a) 值愈大 , 表示在高 负荷下 生产 时 , 机车 损坏情 况比 在低负 荷时 严 重得多 , 因此 t 值应选大些。从产量看 , ( c - d) 值愈 大 , 表示 在高负 荷下 生产 较有利 , 故 t 应选小些。下面我们从 (9 -2) 式这一基本方程出发来求出 t 与 ( b - a) 、( c - d) 的关系。令 ζk = uk/ sk 。则在低 负 荷 生 产时 有 ζk = 0 , 高 负 荷 生 产 时 有 ζk = 1。 对 第 n 段 , 我们有f n ( sn ) = m ax ≤ s n0 ≤ un{ cun + d( sn - un ) }= m ax ≤ s 0 ≤ u nn{ ( c - d) un + dsn }= max ≤ 1 0 ≤ζ n{ ( c - d)ζn + d} sn由于 c > d, 所以 ζn 应选 1 才能使 f n ( sn ) 最大。也就 是说 , 最后一 年应 全部投 入高 负荷生产。故 f n ( sn ) = csn对 n - 1 段 , 根据 ( 9 -2) 式有f n - 1 ( sn - 1 ) = max ≤ s{ cun - 1 + d( sn - 1 - un - 1 ) + f n ( sn ) }0 ≤ un - 1 = max u n - 1 = max u n - 1 = max u n - 1 = max ζ n - 1n - 1{ cun - 1 + d( sn - 1 - un - 1 ) + csn }{ cun - 1 + d( sn - 1 - un - 1 ) + c[ aun - 1 + b( sn - 1 - un - 1 ) ] }{[ ( c - d) - c( b - a) ] un - 1 + ( d + cb) sn - 1 }{[ ( c - d) - c( b - a) ]ζn - 1 + ( d + cb)} sn - 1因此 , 欲要满足上式极值关系的条件是当( 9 -4) n - 1 = 1。即 n - 1 年仍应全部在高负荷下生产。否则 , 当 (9 -4 ) 式不满足时 , 应 取c - d > c( b - a)时 , 应取 ζ* ζ* n - 1 = 0 , 即 n - 1 年应全部投入低负荷生产。由前面知道 , 只要在第 k 年投入低负荷生产 , 那么递推计算结果必然是从第 1 年到第 k 年均为低负荷生产 , 即有 ζ* k = 0 后 , 前 几年就 没有 必 要再计算了。故只需 研究 哪 一 年 由 低 负 荷 转 入 高 负 荷 生 产 , 即 ζ从 那 一 年 开 始 变 为 1 就行。1 = ζ*2 = … = ζ*k = 0 。可见 , 算 出 ζ*根据这点 , 现只分析满足 ( 9 -4 ) 式的情况。由于 ζ*n - 1 = 1 , 故 ( 9 -3 ) 式变为f n - 1 ( sn - 1 ) = ( c + ca) sn - 1 = c(1 + a) sn - 1又由于 sn - 1 = aun - 2 + b( sn - 2 - un - 2 ) , 将它代入上式得f n - 1 ( sn - 1 ) = c( 1 + a) [ ( a - b) un - 2 + bsn - 2 ]对 n - 2 段 , 由 ( 9 -2) 式有f n - 2 ( sn - 2 ) = max ≤ s{ cun - 2 + d( sn - 2 - un - 2 ) + f n - 1 ( sn - 1 ) }0 ≤ un - 2 = max un - 2{ cun - 2 + d( sn - 2 - un - 2 ) + c( 1 + a) [ ( a - b) un - 2 + bsn - 2 ] }n - 2·022·( 9 -3)= max u n - 2 = max ζ n - 2{[ ( c - d) - c(1 + a) ( b - a) ] un - 2 + [ d + c(1 + a) b] sn - 2 }{[ ( c - d) - c(1 + a) ( b - a) ]ζn - 2 + d + cb( 1 + a) } sn - 2由此可知 , 只要满足极值条件式就应选 ζ*c - d > c(1 + a) ( b - a) n - 2 = 1 , 否则为 0 , 即应继续在高负荷下生产。依次类推 , 如果转入高负荷下生产的是第 t 年 , 则由f t ( st ) = maxut{ cut + d( st - ut ) + f t + 1 ( st + 1 ) }可以推出 , 应满足极值关系的条件必然是 :c - d > c(1 + a + a2 + … + an - c - d < c(1 + a + a2 + … + an -( t + 1 ) ) ( b - a) t ) ( b - a)( 9 -5)相应的有最优策略ζ*n =ζ* 1 = ζ* ζ*n - 1 = … = ζ* 2 = … = ζ*t = 1t - 1 = 0它就是例 2 在始端固定终端自由情况下最优策略的一般结果。从这个例子看到, 应用动态规划 ,可以在不求出数值解的情况下, 确定出最优策略的结构。 可见 , 只要知道了 a, b, c, d 四个值 , 就总可找到一个 t 值 , 满足 ( 9 -5 ) 式 , 且1≤ t≤ n - 1例如题中给定的 a = 0 .7 , b = 0 .8 , c = 8 , d = 5 , 代入 ( 9 -5) 式 , 应有c - d c ( b - a)=1 - d/ c b - a=1 - 5/ 8 0 .9 - 0 .7=3 1 .6= 1 .875 > (1 + a) = 1 + 0 .7可见 , n - t - 1 = 5 - t - 1 = 1 , 所以 t = 3 。即从第三年开始将全部 机器投 入高负荷 生产 , 五 年内总产量最高。从这个例子可看到 : 当 g( x ) 、h( x ) 是线性 函数时 , 问题 是易于 求解 的 , 当它们 为复 杂 函数时 , 求解就困难多了。但是 , 当 g( x ) 、h( x) 为凸函数且 h(0 ) = g(0 ) = 0 时 , 可以证 明 在每个阶段上的最 优决 策 总是 取 其 上限 或 下限。 因 此 , 对 于 解 的 结 构来 说 , 它与 g( x ) 、 h( x) 为线性的情况是类似的。上面的讨论表明 : 当 x 在 [0 , s1 ] 上离散地变化时 , 利用递推关系式逐步计 算或表格 法而求出数值解。当 x 在 [ 0 , s1 ] 上连续地变化时 , 若 g( x ) 和 h( x ) 是线性 函数或凸 函数时 , 根据递推关系式运用解析法不难求出 f k ( x) 和最优解 ; 若 g( x) 和 h( x) 不是线性函数或凸 函数时 , 一般来说 , 解析法不能奏效 , 那只好利用递推关系式 ( 9 -1 ) 求其数值解。首先要把 问题离散化 , 即把区间 [ 0 , s1 ] 进行分割 , 令 x = 0 ,Δ, 2Δ, … , mΔ= s1 。 其 Δ 的大小 , 应根 据 计算精度和计算机容量等来确定。然后规定所有的 f k ( x ) 和决策变 量只在这 些分割点 上 取值。这样 , 递推关系式 ( 9 -1 ) 便可写为f n ( iΔ) = max 0 ≤ j≤ i{ g( jΔ) + h( iΔ - jΔ) }f k ( iΔ) = max 0 ≤ j≤ i{ g( jΔ) + h( iΔ - jΔ) + f k + 1 [ a( jΔ) + b( iΔ - jΔ) ]}k = n - 1 , … , 2 , 1对 i = 0 , 1 , … , m 依次计算 , 可逐步求出 f n ( iΔ) , f n - 1 ( iΔ) , … , f1 ( iΔ) 及 相应的最 优决策 ,·122·最后求得 f1 ( mΔ) = f1 ( s1 ) 就是所求的最大 总收 入。这种 离散 化算法 可以 编成程 序在 计 算机中计算。1. 2 二维资源分配问题设有两种原料 , 数量各为 a 和 b 单位 , 需要分配用于生产 n 种产品。如果第一种原 料 以数量 xi 为 单 位 , 第 二 种 原 料 以 数 量 yi 为 单 位 , 用 于 生 产 第 i 种 产 品 , 其 收 入 为 gi ( xi , y i ) 。问应如何分配这两种原料于 n 种产品的生产使总收入最大 ?此问题可写成静态规划问题 :max [ g1 ( x1 , y1 ) + g2 ( x2 , y2 ) + … + gn ( xn , yn ) ] x1 + x2 + … + xn = a y1 + y2 + … + yn = bxi ≥0 ,yi ≥0 ,( i = 1 , 2 , … , n) 且为整数用动态规划方法来解 , 状态变量和决策变量要取二维的。设状态变量 ( x, y) : x———分配用于生产第 k 种产品至第 n 种产品的第一种原料的单位数量。 y———分配用于生产第 k 种产品至第 n 种产品的第二种原料的单位数量。 决策变量 ( xk , yk ) : xk ———分配给第 k 种产品用的第一种原料的单位数量。 yk ———分配给第 k 种产品用的第二种原料的单位数量。 状态转换关系 :～ x ～ y= x - xk= y - yk～ 和 y～ 分别表示用来生产第 k + 1 种产品至第 n 种产品 的第一 种和第二 种原料的 单式中 x 位数量。允许决策集合 :Dk ( x , y ) = uk0≤ xk ≤ x 0≤ yk ≤ yf k ( x, y) 表示以第一种原料数量为 x 单位 , 第二种原料数量 为 y 单 位 , 分 配用于生 产第 k 种产品至第 n 种产品时所得到的最大收入。故可写出逆推关系为f n ( x , y ) = gn ( x, y)f k ( x, y ) = m ax ≤ x ≤ y k0 ≤ x k 0 ≤ y[ gk ( xk , yk ) + f k + 1 ( x - xk , y - yk ) ]k = n - 1 , … , 1最后求得 f1 ( a, b) 即为所求问题的最大收入。 在实际问题中 , 由于 g( x, y) 的复杂性 , 一般计算较难 , 常利用这个递推关系进行数值计算 , 并采用下面的方法进行降维和简化处理 , 以求得它的解或近似解。1. 拉格朗日乘数法引入拉格朗日乘数 λ, 将二维分配问题化为·222·max { g1 ( x1 , y1 ) + g2 ( x2 , y2 ) + … + gn ( xn , yn ) - λ( y1 + y2 + … + yn ) } 满足条件x1 + x2 + … + xn = axi ≥ 0 , yi ≥0 ,i = 1 , 2 , … , n 且为整数其中 λ作为一个固定的参数。令hi ( x i ) = hi ( xi ,λ) = m ax≥ 0yi[ gi ( xi , y i ) - λy i ]为了使此式有意义 , 可设 limy→ ∞gi ( xi , y i ) y i= 0于是问题变为m ax [ h1 ( x1 ) + h2 ( x2 ) + … + hn ( xn ) ]满足x1 + x2 + … + x n = a,x i ≥0 且为整数这是一个一维分配问题 , 可用对一维的方法去求解。这里 , 由于 λ是参数 , 因 此 , 最 优 解 xi 是参数λ的函数 , 相应 的 yi 也是 λ的 函数。即 x i = x i (λ) , yi = y i (λ) 为其 解。如 果nn∑y i (λ) = b, 则可证明{ xi , yi }为原问题 的最优 解。如 果 ∑y i (λ) ≠ b, 我们将 调整 λ的i = 1i = 1n值 ( 利用插值法逐渐确定 λ) , 直到 ∑yi (λ) = b 满足为止。i = 1这样的降维方法在理论上有保证在计算上是 可行 的 , 故对 于高维 的问 题可以 用上 述拉格朗日乘数法的思想来降低维数。2. 逐次逼近法这是另一种降维方法 , 先保持一个变量不 变 , 对另 一个 变量实 现最 优化 , 然后 交替 地固定 , 以迭代的形式反复进行 , 直到获得某种要求的程度为止。n先设 x( 0 ) = { x ( 0 )1, x( 0 )2n } 为满 足 ∑, … , x( 0 )x( 0 )i= a 的一 个可 行解 , 固定 x 在 x ( 0 ) , 先i = 1对 y 求解 , 则二维分配问题变为一维问题 :max [ g1 ( x( 0 )1, y1 ) + g2 ( x ( 0 )2, y2 ) + … + gn ( x( 0 )n, yn ) ]y1 + y2 + … + yn = b, yi ≥0 且为整数可用对一维的方法来求解。设这解为 y( 0 ) = { y( 0 ) x 求解 , 即1, y( 0 )2, … , y( 0 )n } , 然后再 固定 y 为 y ( 0 ) , 对nmax ∑gi ( x i , y( 0 )i)i = 1n∑ n } , 再固定 x 为 x ( 1 ) , 对 y 求解 , 这样 依次 轮换下 去得 到 , … , x( 1 )x i ≥0 且为整数xi = a,i = 1, x( 1 )设其解为 x( 1 ) = { x( 1 ) 一系列的解{ x( k) } , { y( k ) }( k = 0 , 1 , … ) 因为21nnn∑gi ( x( 0 )i, yi ) ≤ ∑gi ( x( 0 )i, y( 0 )i) ≤ ∑gi ( x( 1 )i, y( 0 )i)i = 1i = 1i = 1·322·n故函数值序列 ∑gi ( x( k)i, y( k)i) 是单调上 升的 , 但 不一 定收 敛到 绝对 的最 优解 , 一般 只i = 1收敛到某一局部最优解。因此 , 在实际 计算 时 , 可选择 几个 初始 点 x ( 0 ) 进行 计 算 , 然后 从 所得到的几个局部最优解中选出一个最好的。3. 粗格子点法 (疏密法 )在采用离散化的方法计算时 , 先将矩形定 义域 : 0 ≤ x≤ a, 0≤ y≤ b 分成网 格 , 然后 在这些格子点上进行计算。如将 a、b 各分为 m1 和 m2 等份 , 则总共有 ( m1 + 1) · ( m2 + 1) 个格点 , 故对每个 k 值需要计 算的 f k ( x, y ) 共 有 ( m1 + 1) · ( m2 + 1 ) 个。 因此 , 这里 的计 算 量是相当大的。随着分点加多 , 格子点数也增多 , 那时的计算量将大得惊人。为了使计算 可行 , 往往根据问题要求的精确度 , 采用粗格子点法逐步缩小区域来减少计算量。粗格子点法是先用少数的格子点进行粗糙的计算 , 在求出相应的最优解后 , 再在最优 解附近的小范围内进一步细分 , 并求在细分格子点上的最优解 , 如此继续细分下去直到满 足要求为止。这方法也可能出现最优解“漏网”的情况 , 因此 , 应用此法时要结合对指标函 数的特性进行分析。逐次逼近法和粗格子点法 虽 有缺 点 , 但在 实 际问 题中 , 这 两种 方 法 的应 用 是比 较 广泛的。1. 3 固定资金分配问题设有 n 个生产行业 , 都需要 某两 种资 源。对 于第 k 个生 产 行业 , 如果 用 第 1 种 资 源xk 和第 2 种资源 yk 进行生产 , 可获得利润为 rk ( xk , yk ) 。若第 1 种资源的单 位价格为 a, 第 2 种资源的单位价格为 b, 现有资金 Z。 问应购 买第 1 种 资源 多少单 位 ( 设 为 X ) , 第 2 种资源多少单位 ( 设为 Y ) , 分配到 n 个生产行业 , 使总利润最大 ?此问题的数学模型可写为nmax ∑rk ( xk , yk )k = 1n∑xk = Xxk 为非负整数k = 1n∑yk = Yyk 为非负整数k = 1a X + b Y≤ Z解决这个问题 , 可以从固定资 金开 始 , 找出所 有满 足 a X + b Y≤ Z 的 X 和 Y ; 然后 将 资源量最优地分 配 给 n 个 生 产 行 业 , 找 出 获 利 最 大 的。 这 当 然 是 一 个 算 法 , 但 不 是 有 效的。如果我们把资源分配换算成资金分配 , 那样做要简单些。 (1 ) 把 资 源 分 配 利 润 表 换 算 成 资 金 分 配 利 润 表 , 即 将 rk ( xk , yk ) 换 算 成 Rk ( z ) ,z = 0 , 1 , … , Z。但必须注意 , 分配的资金应先使较贵的资源单位最大。设有资金 z( 0≤ z≤ Z) 分配到第 k 个生产行业 , 则由 Z = aX + bY 知 , 在给定 z 的情 况·422·下 , 若购 买 第 2 种 资 源 yk 单 位 , 则 留 下 的 资 金 只 能 购 买 第 1 种 资 源 xk 单 位 , xk =z - byk a, 于是得到资金利润函数 Rk ( z) 为Rk ( z) =ykmax = 0 , 1 , … , ( z/ b)rkz - byk a, yk式中 ( z/ b) 指以资金 z 购买第 2 种资源的最大单位数 ,z - byk a指以资金 z 购买了第 2 种资源 yk 单位以后能购买第 1 种资源的最大单位数。(2 ) 计算最优资金分配所 获得最 大利 润。规定 最优 值函 数 f k ( z) 表 示以 总的资 金 z分配到 k 至 n 个生产行业可能获得的最大利润。则有逆推关系式 :f k ( z) = m ax z= 0 , 1 , … , zk[ Rk ( zk ) + f k + 1 ( z - zk ) ]f n ( z) = Rn ( z)(3 ) 求出 f1 ( z) , 即为问题的解。这样 , 就 把一个原 含有两 个状态 变量 的问题 转化 为只含有一个状态变量的问题。第 2 节 生产与存储问题在生产和经营管理中 , 经常遇到要合理地安排生产 ( 或购买 ) 与库存的问题 , 达到既要 满足社会的需要 , 又要尽量降低成本费用。 因此 , 正确 制定 生产 ( 或 采购 ) 策 略 , 确 定不 同 时期的生产量 ( 或采购量 ) 和库存量 , 以使总的生产成本费用和库存费用之和最小 , 这就是 生产与存储问题的最优化目标。2. 1 生产计划问题设某公司对某种产品要制定一项 n 个阶段的生产 ( 或购买 ) 计划。已知它的初始库存 量为零 , 每阶段生产 ( 或购买 ) 该产品的数量有上限的限制 ; 每阶段社会对该产品的需求量 是已知的 , 公司保证供应 ; 在 n 阶段末的终结库存量为零。问该公司如何制定每个阶段的 生产 ( 或采购 ) 计划 , 从而使总成本最小。设 dk 为第 k 阶段对产品的需求量 , xk 为第 k 阶段该产品的生产量 ( 或采 购量 ) , vk 为第 k 阶段结束时的产品库存量。则有 vk = vk - 1 + xk - dkck ( xk ) 表示第 k 阶段生产产品 x k 时的成本费用 , 它包括生产准备成本 K 和产品成本axk ( 其中 a 是单位产品成本 ) 两项费用。即0当 xk = 0当 xk = 1 , 2 , … , mK + axk ∞ hk ( vk ) 表示在第 k 阶段结束时有库存量 v k 所需的存储费用。 故第 k 阶段的成本费用为 ck ( xk ) + hk ( xk ) 。 m 表示每阶段最多能生产该产品的上限数。ck ( xk ) =当 xk > m·522·因而 , 上述问题的数学模型为nmin g = ∑[ ck ( xk ) + hk ( vk ) ]k = 1v0 = 0 , vn = 0kvk = ∑( x j - dj ) ≥0k = 2 , … , n - 1j = 10≤ xk ≤ mk = 1 , 2 , … , nk = 1 , 2 , … , n 用动态规划方法来求解 , 把它看作一个 n 阶段决策问题。令 vk - 1 为状态变量 , 它表示第 k 阶段开始时的库存量。 xk 为决策变量 , 它表示第 k 阶段的生产量。 状态转移方程为xk 为整数vk = vk - 1 + xk - dkk = 1 , 2 , … , n最优值函数 f k ( vk ) 表示从第 1 阶段初始 库存 量为 0 到第 k 阶 段末库 存量 为 v k 时 的最小总费用。因此可写出顺序递推关系式为 :f k ( vk ) = min ≤σ k0 ≤ xk[ ck ( xk ) + hk ( vk ) + f k - 1 ( vk - 1 ) ]k = 1 , … , n其中 σk = min ( vk + dk , m) 。这是因 为一方 面每 阶段生 产的 上限 为 m; 另 一方 面由 于保 证 供应 , 故第 k - 1 阶段末的库存量 vk - 1 必须非负 , 即 vk + dk - xk ≥ 0 , 所以 xk ≤ vk + dk 。边界条件为 f0 ( v0 ) = 0 ( 或 f1 ( v1 ) = min = σ 1x 1[ c1 ( x1 ) + h1 ( v1 ) ] ) , 从边 界条 件 出发 , 利 用n上面的递推关系式 , 对每个 k, 计算出 f k ( vk ) 中 的 vk 在 0 至 min ∑dj , m - dk 之间 的j = k+ 1值 , 最后求得的 f n ( 0) 即为所求的最小总费用。注 : 若每阶段生产产品的数量无上限的限制 , 则只要改变 ck ( xk ) 和 σk 就行。即ck ( x k ) =0K + a xk当 xk = 0 当 xk = 1 , 2 , …σk = vk + dkn对每个 k, 需计算 f k ( vk ) 中的 vk 在 0 至 ∑dj 之间的值。j = k+ 1例 3 某工厂要对一种产品制 订今 后四个 时期 的生 产计 划 , 据估 计在 今 后四 个时 期内 , 市场对于该产品的需求量如表 9 -5 所示。表 9 -5时期 ( k)1234需求量 ( dk )2324假定该厂生产每批产品的固定成本为 3 千 元 , 若 不生 产就 为 0 ; 每 单位产 品成 本为 1 千元 ; 每个时期生产能力所允许的最大生产批量为不超过 6 个单位 ; 每个时期末未售出的 产品 , 每单位需付存储费 0 .5 千元。还假定在第一个时期 的初始库 存量为 0 , 第四个时 期 ·622·ØÀhðÀØhð之末的库存量也为 0。试问该厂 应如何 安排 各个时 期的 生产 与库 存 , 才能 在 满足 市场 需 要的条件下 , 使总成本最小。解 用动态规划方法来求解 , 其符号含义与上面相同。 按四个时期将问题分为四个阶段。由题意知 , 在第 k 时期内的生产成本为0当 xk = 0ck ( x k ) =3 + 1· xk 当 x k = 1 , 2 , … , 6 ∞当 xk > 6第 k 时期末库存量为 v k 时的存储费用为hk ( vk ) = 0 .5 vk故第 k 时期内的总成本为 ck ( xk ) + hk ( vk ) 而动态规划的顺序递推关系式为f k ( vk ) = mi n ≤ σ k k0 ≤ x[ ck ( xk ) + hk ( vk ) + f k - 1 ( vk + dk - xk ) ] ,k = 2 , 3 , 4其中 σk = min ( vk + dk , 6) 和边界条件 f1 ( v1 ) =x1min 1= min ( v+ d1, 5 )[ c1 ( x1 ) + h1 ( v1 ) ]当 k = 1 时 , 由f1 ( v1 ) =x 1mi n = mi n( v 1+ 2 , 5 )[ c1 ( x1 ) + h1 ( v1 ) ]4对 v1 在 0 至 mi n[ ∑ v1 = 0 时 ,j = 2dj , m - d1 ] = min [9 , 6 - 2] = 4 之间的值分别进行计算。f1 (0 ) = min = 2x 1[3 + x1 + 0 .5×0 ] = 5所以 x1 = 2v1 = 1 时 ,f1 (1 ) = min = 3x 1[3 + x1 + 0 .5×1 ] = 6 .5 所以 x1 = 3v1 = 2 时 ,f1 (2 ) = min = 4x 1[3 + x1 + 0 .5×2 ] = 8所以 x1 = 4同理得f1 (3 ) = 9 .5f1 ( 4) = 11所以 x1 = 5 所以 x1 = 6当 k = 2 时 , 由f 2 ( v2 ) = min ≤σ 20 ≤ x2[ c2 ( x2 ) + h2 ( v2 ) + f1 ( v2 + 3 - x2 ) ]4其中 σ2 = min( v2 + 3 , 6 ) 。对 v2 在 0 至 min ∑ 进行计算。从而有j = 3dj , 6 - 3 = mi n [ 6 , 3] = 3 之间的值分别f 2 (0 ) = min ≤ 30 ≤ x2[ c2 ( x2 ) + h2 (0 ) + f 1 ( 3 - x2 ) ]c2 ( 0) + h2 ( 0) + f1 (3 )0 + 9 .5= minc2 ( 1) + h2 ( 0) + f1 (2 )c2 ( 2) + h2 ( 0) + f1 (1 )= mi n4 + 85 + 6 .5= 9 .5 所以 x2 = 0c2 ( 3) + h2 ( 0) + f1 (0 )6 + 5f2 ( 1) = min ≤ 40 ≤ x 2[ c2 ( x2 ) + h2 ( 1) + f1 (4 - x2 ) ] = 11 .5所以 x2 = 0f2 ( 2) = min ≤ 50 ≤ x 2[ c2 ( x2 ) + h2 ( 2) + f1 (5 - x2 ) ] = 14所以 x2 = 5·722·f2 ( 3) = min ≤ 60 ≤ x 2[ c2 ( x2 ) + h2 ( 3) + f1 (6 - x2 ) ] = 15 .5所以 x2 = 6注意 : 在计算 f 2 ( 2) 和 f2 ( 3) 时 , 由于每个时期的最大生 产批量为 6 单位 , 故 f1 (5 ) 和f 1 (6 ) 是没有意义的 , 就取 f1 (5 ) = f1 ( 6) = ∞ , 其余类推。当 k = 3 时 , 由f 3 ( v3 ) = min ≤σ 30 ≤ x3[ c3 ( x3 ) + h3 ( v3 ) + f2 ( v3 + 2 - x3 ) ]其中 σ3 = min( v3 + 2 , 6 ) 。对 v3 在 0 至 min[ 4 , 6 - 2 ] = 4 之间的值分别进行计算 , 从而有f 3 (0 ) = 14所以 x3 = 0所以 x3 = 0 或 3 所以 x3 = 4 所以 x3 = 5 所以 x3 = 6f 3 (1 ) = 16f 3 (2 ) = 17 .5f 3 (3 ) = 19f 3 (4 ) = 20 .5 当 k = 4 时 , 因要求第 4 时期之末的库存量为 0 , 即 v4 = 0 , 故有f 4 (0 ) = min ≤ 40 ≤ x1[ c4 ( x4 ) + h4 (0 ) + f 3 ( 4 - x4 ) ]c4 ( 0) + f 3 (4 )0 + 20 .5c4 ( 1) + f 3 (3 )4 + 19= minc4 ( 2) + f 3 (2 )= min5 + 17 .5= 20 .5所以 x4 = 0c4 ( 3) + f 3 (1 )6 + 16c4 ( 4) + f 3 (0 )7 + 14再按计算的顺序反推算 , 可找出每个时期的最优生产决策为 :x1 = 5 , x2 = 0 , x3 = 6 , x4 = 0其相应的最小总成本为 20 .5 千元。如果把上面例题中的有关数据列成表 9 -6 , 然后分析这些数 据 , 可找出一 些规律性 的东西。表 9 -6阶段 i01234需求量 di—2324生产量 xi—5060库存量 vi03040由表中的数字可以看到 , 这样的库存问题有如下特征 :(1 ) 对每个 i, 有 vi - 1 · xi = 0 , ( i = 1 , 2 , 3 , 4 ) 其中 v0 = 0。 (2 ) 对于最优生产决策 来 说 , 它 被裂 解 为两 个 子 问题 , 一个 是 从第 1 阶 段到 第 2 阶 段 , 另一个是从第 3 阶段到第 4 阶段。每个子问题的最优生产决策特别简单 , 它们的最小 总成本之和就等于原问题的最小总成本。这种现象不是偶然的 , 而是反映着这类库存问题数学模型的特征。研究这类问题 , 注意到 (2 ) 的规律 , 就可将计算量大量地减少。如果对每个 i, 都有 vi - 1 x i = 0 , 则称该点的生产决策 ( 或称一 个策略 x = x1 , … , xn ) 具·822·ÁL×"bL×b"×L"bÁ×Lb"有再生产点性质 ( 又称重生性质 ) 。如果 vi = 0 , 则称阶段 i 为再生产点 ( 又称重生点 ) 。由假设 v0 = 0 和 vn = 0 , 故阶段 0 和 n 是再生 产点。可 以证明 : 若 库存 问题的 目标 函 数 g( x ) 在凸集合 S 上是凹函数 ( 或凸函 数 ) , 则 g( x ) 在 S 的顶点 上具有 再生产点 性质 的 最优策略。下面运用再生产点性质来求库存问题为凹函数的解。设 c( j, i) ( j≤ i) 为阶段 j 到阶段 i 的总 成本 , 给 定 j - 1 和 i 是 再生产 点 , 并且 阶段 j到阶段 i 期间的产品全部由阶段 j 供给。则i - 1c( j, i) = cj ∑d s + ∑cs (0 ) + ∑hs ∑dt( 9 -6)s = js = j + 1s = jt = s+ 1根据两个再生点之间的最优策略 , 可以得到一个更有效的动态规划递推关系式。设最优值函数 f i 表示在阶段 i 末 库存 量 v i = 0 时 , 从阶 段 1 到阶 段 i 的 最 小 成本。则对应的递推关系式为f t = mi n 1 ≤ j≤ i[ f j - 1 + c( j, i) ] i = 1 , 2 , … , n( 9 -7)边界条件为( 9 -8) 为了确定最优生产决策 , 逐个 计 算 f1 , f2 , … , f n 。 则 f n ( 0 ) 为 n 个 阶段 的 最小 总 成f0 = 0本。设 j( n) 为计算 f n 时 , 使 (9 -7) 式右边最小的 j 值 , 即f n = min 1 ≤ j≤ n[ f j - 1 + c( j, n) ] = f j ( n) - 1 + c( j( n) , n)则从阶段 j( n) 到阶段 n 的最优生产决策为 :nx j ( n) = ∑dss = j ( n )xs = 0当 s = j ( n) + 1 , j( n) + 2 , … , n 时故阶段 j( n) - 1 为再生产点。为了进一步确定 阶段 j ( n) - 1 到阶 段 1 的最 优生产 决策 , 记 m = j ( n) - 1 , 而 j ( m) 是在计算 f m 时 , 使 ( 9 -7) 式右边最小的 j 值 , 则从阶段 j ( m) 到 阶 段 j( n) 的最优生产决策为 :mx j ( m) = ∑dss = j ( m)当 s = j ( m) + 1 , j ( m) + 2 , … , m 时xs = 0 故阶段 j( m) - 1 为再生产点 , 其余依此类推。例 4 利用再生产点性质解例 3。解 因 ci ( xi ) =03 + xixi = 0 x i = 1 , 2 , … , 6。和 hi ( vi ) = 0 .5 vi∞ 都是凹函数 , 故可利用再生产点性质来计算。xi > 6(1 ) 按 ( 9 -6 ) 式计算 c( j, i) ,1≤ j≤ i,i = 1 , 2 , 3 , 4c(1 , 1 ) = c( 2) + h(0 ) = 5 c(1 , 2 ) = c( 5) + h(3 ) = 3 + 5 + 0 .5 ×3 = 9 .5 c(1 , 3 ) = c( 7) + h(5 ) + h( 2) = ∞ + 0 .5×5 + 0 .5×2 = ∞ c(1 , 4 ) = c( 11 ) + h( 9) + h(6 ) + h( 4) = ∞c( 2 , 2) = c(3 ) + h( 0) = 6 c( 2 , 3) = c(5 ) + h(2 ) = 9 c( 2 , 4) = c(9 ) + h( 6) + h(4 ) = ∞ c( 3 , 3) = c(2 ) + h(0 ) = 5·922·c( 3 , 4) = c(6 ) + h( 4) = 11 (2 ) 按 ( 9 -7 ) 式和 ( 9 -8) 式计算 f ic( 4 , 4) = c(4 ) = 7f 0 = 0f 1 = f 0 + c( 1 , 1) = 0 + 5 = 5所以 j( 1) = 1f 2 = min [ f0 + c( 1 , 2) , f1 + c( 2 , 2) ]= min [0 + 9 .5 , 5 + 6 ] = 9 .5所以 j( 2) = 1f 3 = min [ f0 + c( 1 , 3) , f1 + c( 2 , 3) , f2 + c(3 , 3 ) ]= min [0 + ∞ , 5 + 9 , 9 .5 + 5 ] = 14所以 j( 3) = 2f 4 = min [ f0 + c( 1 , 4) , f1 + c( 2 , 4) , f2 + c(3 , 4 ) , f3 + c(4 , 4 ) ]= min [0 + ∞ , 5 + ∞ , 9 .5 + 11 , 14 + 7 ]= 20 .5 (3 ) 找出最优生产决策所以 j( 4) = 3由 因j (4 ) = 3 ,故 x3 = d3 + d4 = 6 , x4 = 0m = j( 4) - 1 = 3 - 1 = 2 ,所以 j( m) = j( 2) = 1故x1 = d1 + d2 = 5 , x2 = 0所以最优生产决策为 : x1 = 5 , x2 = 0 , x3 = 6 , x4 = 0 相应的最小总成本为 20 .5 千元。还应指出的是 , 这种利用再生产点性质求解确定性需求不允许缺货的库存问题 , 可以 推广到确定性需求在某些阶段上允许延迟交货 的库存 问题 , 有 兴趣的 读者 可参看 参考 资 料 [8 ] 。例 5 某车间需要按月在月底 供应 一定数 量的 某种 部件 给总 装车 间 , 由 于生 产条 件 的变化 , 该车间在各月份中生产每单位这种部件所需耗费的工时不同 , 各月份的生产量于 当月的月底前 , 全部要存入仓库以备后用。已 知总装 车间 的各 个月份 的需 求量以 及在 加 工车间生产该部件每单位数量所需工时数如表 9 -7 所示。表 9 -7月份 k0123456需求量 dk0853274单位工时 ak111813172010设仓库容量限制为 H = 9 , 开始库 存量为 2 , 期终库 存量为 0 , 需要制 定一个半年的 逐 月生产计划 , 既使得满足 需要 和 库容 量的 限制 , 又 使 得生 产这 种部 件的 总 耗费 工时 数 为 最少。解 按月份划分阶段 , 用 k 表示月份序号。 设状态变量 sk 为第 k 段开 始 时 ( 本段 需 求量 送 出 之前 , 上段 产 品送 入 之后 ) 部 件 库存量。决策变量 uk 为第 k 段内的部件生产量。 状态转移方程 :sk + 1 = sk + uk - dkk = 0 , 1 , … , 6( 9 -9)·032·×d5(cid:127)y¨(cid:6)×d(cid:127)5y¨(cid:6)×5dy¨(cid:6)且d k ≤ sk ≤ H(9 -10)故允许决策集合为Dk ( sk ) = { uk : uk ≥0 , dk + 1 ≤ sk + uk - dk ≤ H}(9 -11) 最优值函数 f k ( sk ) 表示在第 k 段开始的库存量 为 s k 时 , 从第 k 段至第 6 段所生产 部件的最小累计工时数。因而可写出逆推关系式为f k ( sk ) = min ( s k∈ D kuk)[ ak u k + f k + 1 ( sk + uk - dk ) ] ,k = 0 , 1 , … , 6(9 -12)f7 ( s7 ) = 0当 k = 6 时 , 因要求期终库存量 为 0 , 即 s7 = 0。 因每 月的 生产 是供 应下 月 的需 要 , 故第 6 个月不用生产 , 即 u6 = 0 。因此 f6 ( s6 ) = 0 , 而由 ( 9 -9) 式有 s6 = d6 = 4当 k = 5 时 , 由 (9 -9) 式有 s6 = s5 + u5 - d5 , 故 u5 = 11 - s5所以f 5 ( s5 ) = mi n = 11 - s 5u5( a5 u5 ) = 10( 11 - s5 ) = 110 - 10 s5及最优解 u*5 = 11 - s5当 k = 4 时 , 有f4 ( s4 ) = min ( s 4 [ 20 u4 + 110 - 10( s4 + u4 - 2 ) ][ a4 u4 + f5 ( s4 + u4 - d4 ) ]∈ D u 4 4 = min u)4= min u4[ 10 u4 - 10 s4 + 130 ]其中 u4 的允许决策集合 D4 ( s4 ) 由 ( 9 -11 ) 式确定为 由 d5 ≤ s4 + u4 - d4 ≤ H , 故有 9 - s4 ≤ u4 ≤11 - s4 又 u4 ≥0 , 因而 m ax [0 , 9 - s4 ] ≤ u4 ≤ 11 - s4 而由 (9 -10 ) 式知 : s4 ≤9 , 所以 D4 ( s4 ) 为9 - s4 ≤ u4 ≤11 - s4故得f 4 ( s4 ) = 10 (9 - s4 ) - 10 s4 + 130 = 220 - 20 s4及最优解 u*4 = 9 - s4当 k = 3 时 ,f3 ( s3 ) = min ( s 3 [ 17 u3 + 220 - 20( s3 + u3 - 3 ) ][ a3 u3 + f4 ( s3 + u3 - d3 ) ]∈ D u 3 3 = min u)3= min u3[ - 3 u3 - 20 s3 + 280]由 (9 -11 ) 式得 D3 ( s3 ) 为 故得 f3 ( s3 ) = 244 - 17 s3max [0 , 5 - s3 ] ≤ u3 ≤12 - s3及最优解 u *3 = 12 - s3当 k = 2 时 ,f2 ( s2 ) = min ( s 2 [ - 4 u2 - 17 s2 + 329][ a2 u2 + f3 ( s2 + u2 - d2 ) ]∈ D u 2 2 = min u)2其中 D2 ( s2 ) 为 故得f 2 ( s2 ) = 273 - 13 s2max [ 0 , 8 - s2 ] ≤ u2 ≤14 - s2及最优解 u *2 = 14 - s2·132·当 k = 1 时 ,f1 ( s1 ) = min ( s 1 [ 5 u1 - 13 s1 + 377][ a1 u1 + f2 ( s1 + u1 - d1 ) ]∈ D u 1 1 = min u)1其中 D1 ( s1 ) 为 故得f 1 ( s1 ) = 442 - 18 s113 - s1 ≤ u1 ≤17 - s1及最优解 u *1 = 13 - s1当 k = 0 时 ,f0 ( s0 ) = min ( s 0[ a0 u0 + f1 ( s0 + u0 - d0 ) ]∈ D u 0 0 [ - 7 u0 + 442 - 18 s0 ] = min u)0其中 D0 ( s0 ) 为 故得因8 - s0 ≤ u0 ≤9 - s0f 0 ( s0 ) = 379 - 11 s0 所以s0 = 2 ,及最优解 u * f0 = 357 和 u *0 = 9 - s00 = 7再按计算顺序反推之 , 并结合 ( 9 -9 ) 式的运算 , 即得各阶段的最优决策为 :u * 0 = 7 ,u*u *u *u*u *1 = 4 ,2 = 9 , 所以从 0 月至 5 月的最优生产计划为 : 7 , 4 , 9 , 3 , 0 , 4 , 相应的最小总工时数为 357。3 = 3 ,4 = 0 ,5 = 42. 2 不确定性的采购问题在实际问题中 , 还遇到某些多阶段决策过 程 , 不是 像前 面所讨 论的 确定性 那样 , 状 态 转移是完全确定的 , 而是出现了随机性因素 , 状 态转移 不能 完全确 定 , 它是 按照某 种已 知 的概率分布取值的。具有这种性质的多阶段决策过程就称为随机性的决策过程。同处理确定性问题类似 , 用动态规划的方法也可处理这种随机性问题 , 有的又称此为随机性动态 规划。下面举一个简单的例子加以说明。例 6 采购问题。某厂生产上需 要在 近五周 内必 须采 购 一批 原料 , 而 估 计在 未来 五 周内价格有波动 , 其浮动价格和概率已测 得如表 9 -8 所 示。试 求在哪 一周 以什么 价格 购 入 , 使其采购价格的数学期望值最小 , 并求出期望值。表 9 -8单价概率5000.36000.37000.4解 这里价格是一个随机变量 , 是按某 种已 知的概 率分 布取 值的。用 动态规 划方 法处理 , 按采购期限 5 周分为 5 个阶段 , 将每周的价格看作该阶段的状态。设yk ———状态变量 , 表示第 k 周的实际价格。 xk ———决策变量 , 当 xk = 1 , 表示第 k 周决定采购 ; 当 xk = 0 , 表示第 k 周决定等待。 ykE ———第 k 周决定等待 , 而在以后采取最优决策时采购价格的期望值。·232·ÁiÁiÁif k ( yk ) ———第 k 周实际价格为 y k 时 , 从第 k 周至第 5 周采取最优决策所 得的最小 期望值。因而可写出逆序递推关系式为f k ( yk ) = min{ yk , ykE } ,f5 ( yk ) = y5 ,yk ∈ sk y5 ∈ s5(9 -13)(9 -14)其中sk = {500 , 600 , 700} ,k = 1 , 2 , 3 , 4 , 5(9 -15)由 ykE 和 f k ( yk ) 的定义可知 :yk E = E f k + 1 ( yk + 1 ) = 0 .3 f k + 1 (500 ) + 0 .3 f k + 1 ( 600) + 0 .4 f k + 1 (700 )(9 -16)并且得出最优决策为 :xk =1( 采购 ) 当 f k ( yk ) = yk0( 等待 ) 当 f k ( yk ) = ykE(9 -17)从最后一周开始 , 逐步向前递推计算 , 具体计算过程如下。 k = 5 时 , 因 f 5 ( y5 ) = y5 , y5 ∈ s5 , 故有f5 ( 500) = 500 , f 5 (600 ) = 600 , f5 ( 700) = 700即在第五周时 , 若 所 需 的 原 料 尚 未 买 入 , 则 无 论 市 场 价 格 如 何 , 都 必 须 采 购 , 不 能再等。k = 4 时 , 由 ( 9 -16 ) 式可知y4 E = 0 .3 f5 ( 500) + 0 .3 f5 ( 600) + 0 .4 f5 ( 700) = 0 .3×500 + 0 .3×600 + 0 .4×700 = 610于是 , 由 ( 9 -13) 式得f4 ( y4 ) = min ∈ s 4 500{ y4 , y4 E } = mi n ∈ s 4y 4y 4若 y4 = 500{ y4 , 610}=600610若 y4 = 600 若 y4 = 700由 (9 -17 ) 式可知 , 第四周的最优决策为x4 =1 ( 采购 ) 0 ( 等待 )若 y4 = 500 或 600 若 y4 = 700同理求得所以f3 ( y3 ) = min ∈ s 3 500{ y3 , y3 E } = mi n ∈ s 3{ y3 , 574}y 3y 3若 y3 = 500=若 y3 = 600 或 700 若 y3 = 500 若 y3 = 600 或 7005741x3 =0f2 ( y2 ) = min ∈ s 2 500{ y2 , y2 E } = min ∈ s 2{ y2 , 551 .8}yy22若 y2 = 500 若 y2 = 600 或 700=551 .8·332·所以x2 =10若 y2 = 500 若 y2 = 600 或 700所以f 1 ( y1 ) = min ∈ s 1 500 536 .26 若 y1 = 600 或 700 若 y1 = 500 若 y1 = 600 或 700{ y1 , y1 E } = min ∈ s 1{ y1 , 536 .26}yy11若 y1 = 500=1x1 =0由上可知 , 最优采购策略 为 : 在第 一、二、三周 时 , 若 价 格 为 500 就 采 购 , 否 则应 该 等 待 ; 在第四周时 , 价格为 500 或 600 应采购 , 否 则就 等待 ; 在 第五周 时 , 无论 什么价 格都 要 采购。依照上述最优策略进行采购时 , 价格 ( 单价 ) 的数学期望值为 500×0 .3 [1 + 0 .7 + 0 .72 + 0 .73 + 0 .73 × 0 .4] +600×0 .3 [0 .73 + 0 .4×0 .73 ] + 700× 0 .42 ×0 .73 = 500×0 .80106 + 600×0 .14406 + 700×0 .05488 = 525 .382≈525且0 .80106 + 0 .14406 + 0 .05488 = 1第 3 节 *背 包 问 题有一个人带一个背包上山 , 其可携带物品 重量的 限度 为 a 公斤。 设有 n 种物 品可 供 他选择装入背包中 , 这 n 种物品编号为 1 , 2 , … , n。已知第 i 种物 品每件重量为 w i 公斤 , 在上山过程中的作用 ( 价值 ) 是携 带数 量 x i 的 函数 c i ( xi ) 。 问此 人应 如何 选 择携 带物 品 ( 各几件 ) , 使所起作用 ( 总价值 ) 最大。这就是著名的背包问题 , 类似的问题有工厂里的下 料问题 , 运输中的货物装载问题 , 人造卫星内的物品装载问题等等。设 xi 为第 i 种物品的装入件数 , 则问题的数学模型为nmax f = ∑ci ( xi )i = 1n∑wi x i ≤ ai = 1xi ≥ 0 且为整数 ( i = 1 , 2 , … , n) 它是一个整数规划问题。如果 xi 只取 0 或 1 , 又称为 0— 1 背包问题。下面用动态规划的 方法来求解。设按可装入物品的 n 种类划分为 n 个阶段。 状态变量 w 表示用于装第 1 种物品至第 k 种物品的总重量。 决策变量 xk 表示装入第 k 种物品的件数。则状态转移方程为w～ = w - xk w k允许决策集合为Dk ( w) =xk | 0≤ xk ≤ w w k·432·最优值函数 f k ( w) 是当总重量不超过 w 公斤 , 背包中可 以装入 第 1 种到 第 k 种物 品的最大使用价值。k即f k ( w) =xmax x wk ∑ i = 1≤ wi ≥ 0 , 且 为 整 数 ( i = 1 , 2 , … , k)i∑i = 1ci ( xi )因而可写出动态规划的顺序递推关系为 :f 1 ( w) =x1max = 0 , 1 , … , [ w/ w1]c1 ( x1 )f k ( w) =xkmax = 0 , 1 , … , [ w/ wk]{ ck ( xk ) + f k - 1 ( w - wk x k )}2≤ k≤ n然后 , 逐步计算出 f1 ( w) , f2 ( w) , … , f n ( w) 及相应的决策函数 x1 ( w) , x2 ( w) , … , xn ( w) , 最后得出的 f n ( a) 就是所求的最大价值 , 其相应的最优策略由反推运算即可得出。例 7max f = 4 x1 + 5 x2 + 6 x33 x1 + 4 x2 + 5 x3 ≤10 x i ≥0 且为整数 ,i = 1 , 2 , 3解 用动态规划方法来解 , 此问题变为求 f3 ( 10 ) 。而f3 (10) =3 x 1 xmax + 5 x 2≤ 10+ 4 x 3 ≥ 0 , 整 数 , i = 1 , 2 , 3i{4 x1 + 5 x2 + 6 x3 }=3 x 1 xmax 2≤ 1 0 - 5 x + 4 x ≥ 0 , 整 数 , i = 1 , 2 , 33i{4 x1 + 5 x2 + ( 6 x3 ) }= max ≥ 0 1 0 - 5 x 3 ≥ 0 , 整 数{6 x3 +max + 5 x 3 ≥ 0 , x≤ 10 - 5 x3 x+ 4 x2 x13 ≥ 0 , 整 数x3 = max = 0 , 1 , 2 32 {6 x3 + f2 ( 10 - 5 x3 ) }1x[ 4 x1 + 5 x2 ]}= max{0 + f2 ( 10 ) , 6 + f2 ( 5) , 12 + f2 ( 0) }由此看到 , 要计算 f3 ( 10 ) , 必须先计算出 f2 ( 10 ) , f 2 (5 ) , f 2 (0 ) 。而f2 ( 10 ) =max ≤ 1 0 + 4 x 3 x 2 1 ≥ 0 , 整 数 ≥ 0 , x{4 x1 + 5 x2 }x 12 max ≤ 10 - 4 x{4 x1 + (5 x2 )}=3 x 1 ≥ 0 , x2 ≥ 0 , 整 数x 1 = max ≥ 0 10 - 4 x 2 ≥ 0 , 整 数2{5 x2 + max 3 x(4 x1 ) }≤ 10 - 4 x 2 ≥ 0 , 整 数1 xx 2 = m ax = 0 , 1 , 2 21{5 x2 + f 1 (10 - 4 x2 )}x= max{ f1 (10) , 5 + f1 (6 ) , 10 + f1 (2 )}f2 ( 5) =xm ax + 4 x 2 1 ≥ 0 , 整 数 ≥ 0 , x≤ 53 x12{4 x1 + 5 x2 } = max = 0 , 1x2{5 x2 + f1 ( 5 - 4 x2 )}= m ax{ f 1 ( 5) , 5 + f1 (1 )}f2 ( 0) =xm ax + 4 x 1 2 ≥ 0 , 整 数 ≥ 0 , x≤ 03 x12{4 x1 + 5 x2 } = max = 0x2{5 x2 + f1 (0 - 4 x2 ) } = f 1 ( 0)为了要计算出 f2 (10) , f2 ( 5) , f2 ( 0 ) , 必须先计 算出 f1 ( 10) , f1 ( 6 ) , f1 (5 ) , f1 ( 2 ) , f 1(1 ) , f 1 (0 ) , 一般地有·532·f1 ( w) = max ≤ w 3 x ≥ 0 , 整 数1x1( 4 x1 ) = 4× ( 不超过 w/ 3 的最大整数 ) = 4× [ w/ 3 ]相应的最优决策为 x1 = [ w/ 3 ] , 于是得到f 1 (10) = 4×3 = 12 f 1 (6 ) = 4 ×2 = 8 f 1 (5 ) = 4 ×1 = 4 f 1 (2 ) = 4 ×0 = 0 f 1 (1 ) = 4 ×0 = 0 f 1 (0 ) = 4 ×0 = 0( x1 = 3 )( x1 = 2 )( x1 = 1 )( x1 = 0 )( x1 = 0 )( x1 = 0 )从而f 2 (10) = max{ f1 ( 10 ) , 5 + f1 ( 6) , 10 + f2 ( 0) }= max{12 , 5 + 8 , 10 + 0} = 13( x1 = 2 , x2 = 1)f 2 ( 5 ) = max{ f1 (5 ) , 5 + f1 ( 1) }= max{4 , 5 + 0} = 5( x1 = 0 , x2 = 1)f 2 ( 0 ) = f1 (0 ) = 0( x1 = 0 , x2 = 0)故最后得到f 3 (10) = max{ f2 ( 10 ) , 6 + f2 ( 5) , 12 + f2 ( 0) }= max{13 , 6 + 5 , 12 + 0}所以 , 最优装入方案为 x *= 13 1 = 2 , x *2 = 1 , x *( x1 = 2 , x2 = 1 , x3 = 0)3 = 0 , 最大使用价值为 13。注意(1 ) 若使用计算机进行计算时 , 对 f1 ( w) 和 f2 ( w) ( w = 0 , 1 , … , 10) 的值都应算出 并存储起来以备用。(2 ) 在实际问题中 , 当 a 不大时 , 为了 计算 的简 便 , 可将单 位重 量 wi 排 成递减 序列 , 然后逐个分析 xi 能取值的可能性 , 并适当加以比较调整 , 再删掉某些可 能性 , 这样能节 省 计算量。(3 ) 当 n 很大时 , 就会产生存储 量过 大的 困难。如 果 ci ( xi ) 都是 线 性函 数 ci x i 的 情 形 , 可按单位重量的价值 ρi = ci/ wi ( i = 1 , 2 , … , n) 由小到大进行排列。设有 ρ1 ≤ρ2 ≤… ≤ ρn - 1 ≤ρn , 则对于给定的可供装入重量 w , 如果 w < wn , 背包 内当然无 法容纳 第 n 种物品 , 即最优解中 x * n = 0 ; 如果 w = kwn ( k 为正整数 ) , 背包内必然仅含有第 n 种物品 , 即最优 解 为 x * i = 0 ( i≠ n) ; 如果 w > wn , 且不是 wn 的整数倍 , 这时背包容纳了第 n 种物品 ,n = k, x *甚至可能不是最优解。但可以找到一个粗略的估算公式 : 当 w≥ρn ρn - ρn - 1wn 成立时 , 最 优解中 x *n 一定大于或等于 1 , 即一定要装入第 n 种物品。上面例子我们只考虑了背包重量的限制 , 它称为“ 一维背包问题。”如果还增加背包体 积的限制为 b, 并假设第 i 种物品 每件的 体积为 v i 立 方米 , 问应如 何装使 得总价值 最大。 这就是“二维背包问题”, 它的数学模型为·632·nmax f = ∑ci ( xi )i = 1n∑wi x i ≤ ai = 1n∑vi x i ≤ bi = 1xi ≥0 且为整数 ,i = 1 , 2 , … , n用动态规划方法来解 , 其思想方法与一维背包问题完全类似 , 只是这时的状态变量是两个 ( 重量和体积的限制 ) , 决策变量仍是 一个 ( 物品的 件数 ) 。设 最优 值函数 f k ( w , v) 表 示当总重量不超过 w 公斤 , 总体 积不 超过 v 立方 米时 , 背 包中装 入第 1 种 到 第 k 种物 品 的最大使用价值。故kf k ( w , v) =maxk ∑ i = 1 k ∑ i = 1≤ wwxii≤ vvxii∑i = 1ci ( xi )x≥ 0 , 整 数 i = 1 , 2 , … , k因而可写出顺序递推关系式为f k ( w , v) =0 ≤ xk≤ minmax w wkv vk{ ck ( xk ) + f k - 1 ( w - wk x k , v - vk x k ) }1≤ k≤ nf0 ( w, v) = 0最后算出 f n ( a, b) 即为所求的最大价值。第 4 节 *复合系统工作可靠性问题若某种机器的工作系统由 n 个部件串联组成 , 只要有一个部件失灵 , 整个系统就不能工作。为提高系统工作的可靠性 , 在每一个部件上均装有主要元件的备用件 , 并且设计了 备用元件自动投入装置。显然 , 备用元件越多 , 整个系统正常工作的可靠性越大。但备用 元件多了 , 整个系统的成本、重量、体积均 相应加 大 , 工作 精度也 降低。 因此 , 最优 化问 题 是在考虑上述限制条件下 , 应 如 何选 择各 部件 的备 用 元件 数 , 使整 个系 统 的工 作可 靠 性 最大。设部件 i( i = 1 , 2 , … , n) 上装有 ui 个备用件时 , 它正常工作的概率为 pi ( ui ) 。因此 , 整个系统正常工作的可靠性 , 可用它正常工作的概率衡量。即nP = ∏pi ( ui )i = 1设装一个部件 i 备用元件费 用为 c i , 重量 为 wi , 要求 总费 用不 超过 c, 总 重量 不超 过w, 则这个问题有两个约束条件 , 它的静态规划模型为 :nm ax P = ∏pi ( ui )i = 1·732·n∑ci ui ≤ ci = 1n∑wi u i ≤ wi = 1ui ≥0 且为整数 ,i = 1 , 2 , … , n这是一个非线性整数规划问题 , 因 ui 要求 为整 数 , 且目标 函数 是 非线 性的。 非线 性整数规划是个较为复杂的问题 , 但是用动态规划方法来解还是比较容易的。为了构造动态规划模型 , 根据有两个约束 条件 , 就 取二 维状态 变量 , 采 用两个 状态 变量符号 xk , yk 来表达 , 其中xk ———由第 k 个到第 n 个部件所容许使用的总费用。 yk ———由第 k 个到第 n 个部件所容许具有的总重量。 决策变量 uk 为部件 k 上装的备用元件数 , 这里决策变量是一维的。 这样 , 状态转移方程为 :xk + 1 = xk - uk ckyk + 1 = yk - uk w k( 1≤ k≤ n)允许决策集合为Dk ( xk , yk ) = { uk : 0≤ uk ≤ min( [ xk/ ck ] , [ yk/ wk ] ) }最优值函数 f k ( xk , yk ) 为 由状 态 xk 和 y k 出发 , 从部 件 k 到部 件 n 的 系统的 最大 可靠性。因此 , 整机可靠性的动态规划基本方程为 :f k ( xk , yk ) = max ( x k∈ D kuk, yk)[ pk ( uk ) f k + 1 ( xk - ck u k , yk - wk u k ) ]k = n, n - 1 , … , 1f n + 1 ( xn + 1 , yn + 1 ) = 1边界条件为 1 , 这 是因为 xn + 1 、yn + 1 均为零 , 装置 根本不工 作 , 故可靠性 当然为 1。最后 计 算得 f1 ( c, w) 即为所求问题的最大可靠性。这个问题的特点是指标函数为连乘积形式 , 而不是连加形式 , 但仍满足可分离性和递 推关系 ; 边界条件为 1 而不是零。它们是由研究对象的特性所决定的。另外 , 这里可靠性 pi ( ui ) 是 ui 的严格单调上升函数 , 而且 pi ( ui ) ≤1。在这个问题中 , 如果静态模型的 约束 条件增 加为 三个 , 例如 要求 总体 积不 许 超过 v, 则状态变量就要取为三维的 ( xk , yk , zk ) 。它说 明静 态规划 问题 的约束 条件 增 加时 , 对 应 的动态规划的状态变量维数也需要增加 , 而决策变量维数可以不变。例 8 某厂设计一种电子设备 , 由 三种 元 件 D1 、D2 、D3 组 成。已 知这 三 种元 件的 价 格和可靠性如表 9 -9 所示 , 要求在设计中 所使用 元件 的费用 不超 过 105 元。试问 应如 何 设计使设备的可靠性达到最大 ( 不考虑重量的限制 ) 。·832·表 9 -9元件单位/ 元可靠性D1300.9D2150.8D3200.5解 按元件种类划分为三个阶段 , 设状态变量 sk 表示能容许用在 Dk 元件至 D3 元件 的总费用 ; 决策变量 xk 表示在 Dk 元件上的并联个数 ; pk 表示一个 Dk 元件正常工作的概 率 , 则 ( 1 - pk ) x k 为 x k 个 D k 元件不正常工作的概率。令最优值函数 f k ( sk ) 表 示由状态 sk 开始从 D k 元件至 D3 元件组成的系统的最大可靠性。因而有f 3 ( s3 ) = max ≤ [ s 3 f 2 ( s2 ) = max ≤ [ s 2 f 1 ( s1 ) = max ≤ [ s 11 ≤ x31 ≤ x21 ≤ x1/ 20 ]/ 15 ]/ 30 ][ 1 - ( 0 .5) x{ [1 - (0 .2 ) x{ [1 - (0 .1 ) x3 ]2 ] f 3 ( s2 - 15 x2 )}1 ] f 2 ( s1 - 30 x1 )}由于 s1 = 105 , 故此问题为求出 f 1 ( 105) 即可。而f 1 (105 ) = m ax ≤ 31 ≤ x1{ [1 - (0 .1 ) x1 ] f2 (105 - 30 x1 )}= max {0 .9 f2 ( 75 ) , 0 .99 f2 (45) , 0 .999 f2 (15) }但f 2 ( 7 5 ) = max ≤ 41 ≤ x2{ [1 - (0 .2 ) x2 ] f 3 ( 75 - 15 x2 ) }= max {0 .8 f3 (60) , 0 .96 f3 (45) , 0 .992 f3 (30) , 0 .9984 f3 (15)}可是 f 3 ( 6 0 ) = max ≤ 31 ≤ x3[ 1 - ( 0 .5) x3 ] = max{0 .5 , 0 .75 , 0 .875} = 0 .875f 3 ( 4 5 ) = m ax {0 .5 , 0 .75} = 0 .75f 3 ( 3 0 ) = 0 .5f 3 ( 1 5 ) = 0所以 f 2 ( 7 5 ) = m ax {0 .8×0 .875 , 0 .96×0 .75 , 0 .992×0 .5 , 0 .9984×0}= m ax {0 .7 , 0 .72 , 0 .496} = 0 .72 同理 f 2 ( 4 5 ) = m ax {0 .8 f3 ( 30 ) , 0 .96 f3 (15) }= m ax {0 .4 , 0} = 0 .4故f 2 ( 1 5 ) = 0 f 1 (105 ) = max {0 .9×0 .72 , 0 .99 ×0 .4 , 0 .999×0} = max {0 .648 , 0 .396} = 0 .648。从而求得 x1 = 1 , x2 = 2 , x3 = 2 为最优方案 , 即 D1 元件用 1 个 , D2 元件用 2 个 , D3 元件用 2 个。其总费用为 100 元 , 可靠性为 0 .648。第 5 节 排 序 问 题设有 n 个工件需要在机床 A、B 上加 工 , 每 个工 件都 必须经 过先 A 而后 B 的 两道 加 工工序 ( 见图 9 -1 ) 。以 ai 、bi 分别 表示工件 i (1 ≤ i≤ n) 在 A、B 上的加 工时间。问应如 何·932·Ý×jÝ×jÝ×j在两机床上安排各工件加工的顺序 , 使在机床 A 上加工第一个工件 开始 到在 机床 B 上将 最后 一 个工件加工完为止 , 所用的加工总时间最少 ?加工工件在 机 床 A 上 有 加 工 顺 序 问 题 , 在 机床 B 上也有加工顺序问题。它 们在 A、B 两台 机床上加工工 件的 顺 序是 可 以 不同 的。 当机 床B 上的加工顺序与机床 A 不同时 , 意味着在机床 A 上加工完毕的某些工件 , 不能在机床 B 上立即 加工 , 而是要等到另一个或一 些工 件 加工 完毕 之后 才能 加 工。这 样 , 使机 床 B 的 等待 加 工时间加长 , 从而使总的加工时间加长了。可以证明 : 最优加工顺序在两台机床上可同时 产生。因此 , 最优排序方案 只能 在 机床 A、B 上加 工 顺序 相 同的 排 序 中去 寻 找。即 使 如 此 , 所有可能的方案仍有 n ! 个 , 这是 一个不 小的 数 , 用穷 举法 是不 现 实的。 下面 用动 态 规划方法来研究同顺序两台机床加工 n 个工件的排序问题。图 9 -1当加工顺序取定之后 , 工件在 A 上加工时没有等待时间 , 而在 B 上则常常等待。因此 , 寻求最优排序方案只有尽量减少在 B 上等待 加工的时间 , 才能 使总加工时间最 短。设第 i 个工件在机床 A 上加工完毕以后 , 在 B 上要经过若干时间才能加工完 , 故对同 一个工件来 说, 在 A、B 上总是出现加工完毕的时间差 , 我们以它来描述加工状态。现在 , 我们以在机床 A 上更 换工件 的时 刻作为 时段。 以 X 表示 在机 床 A 上 等待 加 工的按取定顺序排列的工件集合。以 x 表示 不属于 X 的在 A 上最 后加工完 的工件。 以 t 表示在 A 上加工完 x 的时刻算起到 B 上加工完 x 所需的时间。这样 , 在 A 上加工完 一 个工件之后 , 就有 ( X , t) 与之对应。选取 ( X , t) 作为描述机床 A、B 在加工过 程中 的状态 变量。这 样选 取状 态变量 , 则 当 X 包含有 s 个工件时 , 过程尚有 s 段 , 其时段数已隐含在状 态变量 之中 , 因而 , 指标最优 值 函数只依赖于状态而不明显依赖于时段数。令 f ( X , t) 为由状态 ( X, t) 出发 , 对未 加工 的工 件采取 最优 加工顺 序后 , 将 X 中所 有工件加工完所需时间。f ( X , t, i) 为由状态 ( X , t) 出发 , 在 A 上加工 工件 i, 然后再 对以后 的加 工工件 采取 最优顺序后 , 把 X 中工件全部加工完所需要的时间。f ( X , t, i, j) 为由状态 ( X , t) 出发 , 在 A 上相继加工工 件 i 与 j 后 , 对以后 加工的工 件采取最优顺序后 , 将 X 中的工件全部加工完所需要的时间。因而 , 不难得到f ( X , t, i) =ai + f ( X/ai + f ( X/i, t - ai + bi ) 当 t≥ ai 时 当 t≤ ai 时i, bi )式中状态 t 的转换关系参看示意图 9 -1 。 记zi ( t) = max ( t - ai , 0 ) + bi上式就可合并写成其中 X/i, zi ( t) ] i 表示在集合 X 中去掉工件 i 后剩下的工件集合。f ( X , t, i) = ai + f [ X/由定义 , 可得·042·f ( X , t, i, j) = ai + aj + f [ X/ { i, j} , zij ( t) ]其中 zi j ( t) 是在机床 A 上从 X 出发相继加工工件 i、j, 并从它将 j 加工 完的时刻 算起 , 至 j ( t) ) 是在 A 加工 i、 在 B 上相继加工工件 i、j 并将工件加工完所需时间。故 ( X/ { i, j} , zi j 后所形成 的 新 状 态。即 在 机 床 A 上 加 工 i、j 后 由 状态 ( X , t) 转 移 到 状 态 ( X/ { i, j} , zi j ( t) ) 。仿照 zi ( t) 的定义 , 以 X/ { i, j}代替 X/ { i} , zi ( t) 代替 t, aj 代替 ai , bj 代替 bi , 则可得zi j ( t) = max [ zi ( t) - aj , 0] + bj故zi j ( t) = max [ m ax( t - ai , 0) + bi - aj , 0] + bj= max [ m ax( t - ai - aj + bi , bi - aj ) , 0 ] + bj= max [ t - ai - aj + bi + bj , bi + bj - aj , bj ]将 i、j 对调 , 可得f ( X , t, j , i) = ai + aj + f [ X/ { i, j} , zi j ( t) ]zj i ( t) = max [ t - ai - aj + bi + bj , bi + bj - ai , bi ]由于 f ( X , t) 为 t 的单调上升函数 , 故当 zi j ( t) ≤ zj i ( t) 时 , 有f ( X , t, i, j) ≤ f ( X , t, j, i) 因此 , 不管 t 为何值 , 当 zi j ( t) ≤ zj i ( t) 时 , 工 件 i 放在 工件 j 之 前加工 可以 使总的 加工 时 间短些。而由 zi j ( t) 和 zj i ( t) 的表示式可知 , 这只需要下面不等式成立就行。即max ( bi + bj - aj , bj ) ≤ max ( bi + bj - ai , bi )将上不等式两边同减去 bi 与 bj , 得max ( - aj , - bi ) ≤ max ( - ai , - bj )即有min ( ai , bj ) ≤ min ( aj , bi )这个条件 就 是工 件 i 应 该排 在工 件 j 之 前 的条 件。即 对于 从头 到尾 的 最优 排序 而 言。它的所有前后相邻接的两个工件所组成的对 , 都必须满足上不等式。根据这个条件 , 得到最优排序的规则如下 :(1 ) 先作工件的加工时间的工时矩阵M =a1 a2b1 b2… an … bn(2 ) 在工时矩阵 M 中找出最小元素 ( 若最小的不止一个 , 可 任选其一 ) ; 若它 在上行 ,则将相应的工件排在最前位置 ; 若它在下行 , 则将相应的工件排在最后位置。(3 ) 将排定位置的工件所对应的列从 M 中划掉 , 然后对余下 的工件 重复按 ( 2) 进行。但那时的最前位置 ( 或最后位置 ) 是在已排定 位置的 工件 之后 ( 或 之前 ) 。如 此继续 下去 , 直至把所有工件都排完为止。这个同顺序两台机床加工 n 个工 件的 最优 排序规 则 , 是 Johnson 在 1954 年提 出的。 概括起来说 , 它的基本思路是 : 尽量减少在机床 B 上 等待加 工的 时间。因 此 , 把在 机床 B 上加工时间长的工件先加工 , 在 B 上加工时间短的工件后加工。例 9 设有 5 个工件需在机床 A、B 上加工 , 加工的顺序是先 A 后 B , 每个工件所需加 工时间 ( 单位 : 小时 ) 如表 9-10 所示。问 如何 安排加 工顺 序 , 使机床 连续 加工 完所 有工 件 的加工总时间最少 ? 并求出总加工时间。·142·表 9 -10加 工 时 间/ 码号件工小 时机床AB136272347453574解 工件的加工工时矩阵为M =3 7 4 5 76 2 7 3 4根据最优排序规则 , 故最优加工顺序为 :1→ 3→5→ 4→2总加工时间为 28 小时。第 6 节 设备更新问题在工业和交通运输企业中 , 经常碰到设 备陈 旧或部 分损 坏需 要更新 的问 题。从经 济 上来分析 , 一种设备应该用多少年后进行更 新为最 恰当 , 即 更新的 最佳 策略 应该如 何 , 从 而使在某一时间内的总收入达到最大 ( 或总费用达到最小 ) 。现以一台机器为例 , 随着使用年限的增加 , 机器的使用效率降低 , 收入减少 , 维修费用 增加。而且机器使用年限越长 , 它本身的价值就越小 , 因而更新时所需的净支出费用就愈 多。设 :Ij ( t) ———在第 j 年机器役龄为 t 年的一台机器运行所得的收入。 Oj ( t) ———在第 j 年机器役龄为 t 年的一台机器运行时所需的运行费用。 Cj ( t) ———在第 j 年机器役龄为 t 年的一台机器更新时所需更新净费用。 α———折扣因子 (0 ≤α≤ 1) , 表示一年以后的单位收入的价值视为现年的 α单位。 T———在第一年开始时 , 正在使用的机器的役龄。 n———计划的年限总数。 gj ( t)———在第 j 年开始使用一个役龄为 t 年的机器时, 从第 j 年至第 n 年内的最佳收入。 x j ( t) ———给出 gj ( t) 时 , 在第 j 年开始时的决策 ( 保留或更新 ) 。 为了写出递推关系式 , 先从两方面分析问题。若在第 j 年开始时购买了新机 器 , 则 从 第 j 年至第 n 年得 到的总收 入应等 于在第 j 年中由 新机器 获得的收 入 , 减去在第 j 年 中 的运行费用 , 减去在第 j 年开始 时役 龄为 t 年 的机 器的更 新 净费 用 , 加上 在第 j + 1 年 开 始使用役龄为 1 年的机器从第 j + 1 年至第 n 年的最佳收入 ; 若在第 j 年开始 时继续使 用 役龄为 t 年的机器 , 则从第 j 年至第 n 年的总收入应等于在第 j 年由役龄为 t 年的机器得 到的收入 , 减去在第 j 年中役龄 为 t 年的 机器 的运 行费用 , 加上 在第 j + 1 年 开始 使用 役 ·242·MÀ(cid:11)MÀ(cid:11)MÀ(cid:11)MÀ(cid:11)MÀ(cid:11)龄为 t + 1 年的机器从第 j + 1 年 至 第 n 年的 最 佳 收入。 然 后 , 比 较它 们 的大 小 , 选 取 大 的 , 并相应得出是更新还是保留的决策。将上面这段话写成数学形式 , 即得递推关系式为 :gj ( t) = m axR : Ij (0 ) - Oj (0 ) - Cj ( t) +αgj + 1 (1 )K : Ij ( t) - Oj ( t) +αgj + 1 ( t + 1 )( j = 1 , 2 , … , nt = 1 , 2 , … , j - 1 , j + T - 1)其中“ K”是 K eep 的缩写 , 表示保留使用 ;“R”是 Replacement 的缩写 , 表示更新机器。由于研究的是今后 n 年的计划 , 故还要求gn + 1 ( t) = 0对于 g1 ( · ) 来说 , 允许的 t 值只能是 T。因为当进入计划过程时 , 机器必然已使用了T 年。应指出的是 : 这里研究的设备更新问题 , 是以 机龄 作为 状态变 量 , 决策 是保留 和更 新 两种。但它可推广到多维情形 , 如还考虑对使用的机器进行大修作为一种决策 , 那时所需 的费用和收入 , 不仅取决于机龄和购置的 年限 , 也取 决于 上次大 修后 的时 间。因此 , 必 须 使用两个状态变量来描述系统的状态 , 其过程与此类似。例 10 假设 n = 5 ,α= 1 , T = 1 , 其有关数据如表 9 -11 所 示。试制 定 5 年 中的设备 更新策略 , 使在 5 年内的总收入达到最大。表 9 -11序年品产第一年第二年第三年 第四年 第五年期 前机项 目龄01234012301201012345收入2221201816272524222926243028321816161414运行费用6688105689556454889910更新费用2729323437293134363132333233343234363638解 先解释符号的意思。因第 j 年开始机龄为 t 年的机器 , 其制造年序应为 j - t 年 , 因此 , I5 (0 ) 为第五年新产品的收入 , 故 I5 ( 0 ) = 32 。 I3 ( 2 ) 为 第一 年的 产品其 机龄 为 2 年的收入 , 故 I3 ( 2) = 20 。同理 O5 (0 ) = 4 , O3 (2 ) = 8。而 C5 (1 ) 是第 5 年机龄为 1 年的机 器 ( 应为第四年的产 品 ) 的 更 新 费 用 , 故 C5 ( 1 ) = 33 。 同 理 C5 ( 2 ) = 33 , C3 ( 1 ) = 31 , 其 余类推。当 j = 5 时 , 由于设 T = 1 , 故从第 5 年开始计算时 , 机器使用了 1、2、3、4、5 年 , 则递 推关系式为g5 ( t) = m axR : I5 ( 0) - O5 ( 0) - C5 ( t) + 1 · g6 (1 ) K: I5 ( t) - O5 ( t) + 1 · g6 ( t + 1 )因此g5 (1 ) = maxR: 32 - 4 - 33 + 0 = - 5K : 28 - 5 + 0 = 23= 23 所以 x5 (1 ) = K·342·mŸ¾AØPLð3d3z6§¨’ª(cid:5)(cid:28)(cid:5)MÁ©¾Õ3“c35yJg{¨ï‘(cid:7)(cid:5)(cid:28)MÁÕ©¾533{c“Jyg¨‘ï(cid:7)(cid:28)(cid:5)M¾Á©Õ353cyJg{“‘ï¨(cid:7)(cid:28)(cid:5)g5 (2 ) = maxR: 32 - 4 - 33 + 0 = - 5K : 24 - 6 + 0 = 18= 18 所以 x5 (2 ) = K同理g5 (3 ) = 13 , x5 ( 3) = K; g5 (4 ) = 6 , x5 ( 4) = Kg5 (5 ) = 4 , x5 (5 ) = K当 j = 4 时 , 递推关系为g4 ( t) = m axR : I4 ( 0) - O4 ( 0) - C4 ( t) + g5 ( 1)K: I4 ( t) - O4 ( t) + g5 ( t + 1)故g4 (1 ) = maxR: 30 - 4 - 32 + 23 = 17K : 26 - 5 + 18 = 39= 39 所以 x4 (1 ) = K同理g4 (2 ) = 29 , x4 ( 2) = K; g4 (3 ) = 16 , x4 (3 ) = Kg4 (4 ) = 13 , x4 ( 4) = R当 j = 3 时 , 有g3 ( t) = m axR : I3 ( 0) - O3 ( 0) - C3 ( t) + g4 ( 1)K: I3 ( t) - O3 ( t) + g4 ( t + 1)故g3 (1 ) = maxR: 29 - 5 - 31 + 39 = 32K : 25 - 6 + 29 = 48= 48 所以 x3 (1 ) = K同理g3 (2 ) = 31 , x3 ( 2) = R; g3 (3 ) = 27 , x3 (3 ) = R当 j = 2 时 , 有g2 ( t) = m axR : I2 ( 0) - O2 ( 0) - C2 ( t) + g3 ( 1)K: I2 ( t) - O2 ( t) + g3 ( t + 1)故g2 (1 ) = maxR: 27 - 5 - 29 + 48 = 41K : 21 - 6 + 31 = 46= 46 所以 x2 (1 ) = Kg2 (2 ) = maxR: 27 - 5 - 34 + 48 = 36K : 16 - 8 + 27 = 35= 36x2 ( 2) = R当 j = 1 时 , 有g1 ( t) = m axR : I1 ( 0) - O1 ( 0) - C1 ( t) + g2 ( 1)K: I1 ( t) - O1 ( t) + g2 ( t + 1)故g1 (1 ) = maxR: 22 - 6 - 32 + 46 = 30K: 18 - 8 + 36 = 46= 46 所以 x1 (1 ) = K最后 , 根据上面计算过程反推 之 , 可求得 最优 策略 如表 9 -12 所示 , 相应 的最 佳收 益为 46 单位。表 9 -12年机龄最 佳 策 略11K22R31K42K53K·442·MÀMÀMÀMÀMÀ第 7 节 *货郎担问题货郎担问题在运筹学里是一个著名的命题 , 有一个串村走户卖货郎 , 他从某个村庄出 发 , 通过若干个村庄一次且仅一次 , 最后仍回到原出发的村庄 , 问应如何选择行走路线 , 能 使总的行程最短。类似的问题有旅行路线问题 , 应如何选择行走路线 , 使总路程最短或费 用最少。j 表示从 i 城到 j 城的距 离。一个推销员从城市 1 出 发 到其 他 每个 城 市 去一 次 且仅 仅 是一 次 , 然后 回 到城 市 1。 问他如何选择行走的路线 , 使总的路程最短。这个问题属于组合最优化问题 , 当 n 不太大 时 , 利用动态规划方法求解是很方便的。现在把问题一般化。设有 n 个城市 , 以 1 , 2 , … , n 表示之。 di由于规定推销员是从城市 1 开始的 , 设推销员走到 i 城 , 记 N i = {2 , 3 , … , i - 1 , i + 1 , … , n}表示由 1 城到 i 城的中间城市集合。 S 表示到达 i 城之前中途所经过的城市的集合 , 则有 S Ni 因此 , 可选取 ( i, S) 作为描述过程的状态变量 , 决策为由一个城市走到另一个 城市 , 并 定义最优值函数 f k ( i, S) 为从 1 城开 始经由 k 个 中间城市的 S 集到 i 城的最短路线的 距 离 , 则可写出动态规划的递推关系为f k ( i, S) = min j∈ s[ f k - 1 ( j, S \ { j} ) + dj i ]( k = 1 , 2 , … , n - 1 。 i = 2 , 3 , … , n。 S Ni )边界条件为f 0 ( i, Φ) = d1 iPk ( i, S) 为最优决策函数 , 它表示从 1 城开始经 k 个中间城市的 S 集到 i 城的最短路线上紧挨着 i 城前面的那个城市。表 9 -13距i1234j离10856260853790549780例 11 求解四个城市 旅行 推 销员 问题 , 其 距 离矩 阵 如表 9 -13 所示。 当 推销 员 从 1 城出发 , 经过每个城市一次且仅一次 , 最后回到 1 城 , 问按怎样的路线走 , 使总的行程距离 最短。解 由边界条件可知 :f0 ( 4 , Φ) = d14 = 6 当 k = 1 时 , 即从 1 城开始 , 中间经过一个城市到达 i 城的最短距离是 :f 0 (2 ,Φ) = d1 2 = 8 ,f0 ( 3 , Φ) = d13 = 5 ,f1 (2 , {3} ) = f0 ( 3 , Φ) + d32 = 5 + 9 = 14·542·ÀØhðØÀðh(cid:8)ØÀðh(cid:8)ØÀðh(cid:8)ÀØhð(cid:8)f1 (2 , {4} ) = f0 ( 4 , Φ) + d42 = 6 + 7 = 13f1 (3 , {2} ) = 8 + 8 = 16f1 ( 3 , {4}) = 6 + 8 = 14f1 (4 , {2} ) = 8 + 5 = 13f1 ( 4 , {3}) = 5 + 5 = 10当 k = 2 时 , 即从 1 城 开始 , 中间经 过二个城 市 ( 它们的 顺序随 便 ) 到达 i 城 的最短 距离是 :f 2 (2 , {3 , 4} ) = min [ f 1 ( 3 , {4}) + d32 ,f1 ( 4 , {3}) + d42 ]= min [14 + 9 , 10 + 7 ] = 17 所以 p2 (2 , {3 , 4} ) = 4f 2 (3 , {2 , 4} ) = min [13 + 8 , 13 + 8 ] = 21 所以 p2 (3 , {2 , 4} ) = 2 或 4 f 2 (4 , {2 , 3} ) = min [14 + 5 , 16 + 5 ] = 19 所以 p2 (4 , {2 , 3} ) = 2当 k = 3 时 , 即从 1 城开始 , 中间经过三个城市 ( 顺序随便 ) 回到 1 城的最短距离是 :f 3 (1 , {2 , 3 , 4} ) = min [ f 2 ( 2 , {3 , 4}) + d21 , f2 ( 3 , {2 , 4}) + d31 ,f 2 (4 , {2 , 3} ) + d41 ] = min [ 17 + 6 , 21 + 7 , 19 + 9] = 23所以p3 (1 , {2 , 3 , 4} ) = 2由此可知 , 推销员的最短旅行路线是 1→ 3→4→ 2→1 , 最短总距离为 23 。 实际中很多问题 都 可 以 归 结为 货 郎 担 这 类问 题。 如 物资 运 输 路 线 中 , 汽 车 应 走 怎 样的路线使路程最 短 ; 工 厂 里 在 钢 板 上 要 挖 些 小 圆 孔 , 自 动 焊 机 的 割 嘴 应 走 怎 样 的 路 线使路程最短 ; 城市 里 在 一 些 地 方 铺 设 管 道 时 , 管 子 应 走 怎 样 的 路 线 使 管 子 耗 费 最 少 等等。注记这一章列举了一些典型问题 , 介绍了如何用动 态规划 方法去 求解。但这些 问题大 多数都 是确定 型的 , 而对于连续型、随机型问题接触较少。应该指出 , 动态 规划方 法是解 决最优 控制的 一种重 要方法 之一 , 这在许多最优控制理论书中都有明确的叙述。在 随机性方面 , [美 ] R .A 霍华特 著 .动态规 划与马 尔柯夫过程 .赖炎连等译 .上海科学技术出版社 , 1963 , 以马氏 过程作 为模型 , 以动 态规划 的迭代 方法作 为手段 , 提供了实际计算的可能性。中国科学院应用 数学研 究所董 泽清编 著了《马尔 科夫决 策规划》1981年中国科学院应用数学研究所印 , 详细地叙述了这方面的基本理论和各种模型及应用。至于本章所列举的典型问题 , 有些问题并未 完全解 决。如背包 问题、货郎担 问题 , 在理论 和算法 上还有许多问题 , 有些书还介绍了它们的近似算法 , 如卢 开澄著 .组 合数学———算法 及分析 ( 下册 )。清 华大学出版社 , 1983。此书就介绍了一些近似算法。排序问题在三台以上机器的情形未得到 解决 , 中 国科学院应用数学研究所越民义、韩继业写的《排序问题中的一些数学 问题》(数 学的实践与 认识 , 1976 年第3 期和第 4 期 )在这方面有所介绍。习题9. 1 有一部货车每天沿着公路给四个零售店卸下 6 箱货物 , 如果各零售店出售该货 物所得利润如表 9 -14 所示 , 试求在各零售店 卸下几 箱货 物 , 能使 获得总 利润 最大 ? 其 值 是多少 ?·642·表 9 -14利零售店1234箱润数0000014234264553767647886579866710869. 2 设有某种肥料共 6 个单位重量 , 准备供给四块粮田用。其每块田施肥数量与增 产粮食数字关系如表 9 -15 所示。试求对每块田施多少单位重量的肥料 , 才使总的增产粮 食最多。 表 9 -15粮田施肥1234000001202518282424539473605761654756578745857090806907395859. 3 某公司打算向它的三个营业区增设六个销售店 , 每个营业区至少增设一个。从各区赚取的利润 ( 单位为万元 ) 与增设的销售店个数有关 , 其数据如下。销售店增加数A 区利润B 区利润C 区利润01002001501200210160228022017033302251804340230200试求各区应分配几个增设的销售店 , 才能使总利润最大 ? 其值是多少 ?·742·ÀØðhØÀhð(cid:8)ÀØðh(cid:8)ÀØhð(cid:8)ØÀhð(cid:8)ØÀhð(cid:8)ÀØðh(cid:8)ÀØhð(cid:8)ØÀðhÀØðh(cid:8)ØÀðh(cid:8)ØÀðh(cid:8)ÀØðh(cid:8)ØÀðh(cid:8)ÀØhð(cid:8)ÀØhð(cid:8)×e59×e59×e59×9e5×59e9. 4 某工厂有 100 台机器 , 拟分四个周 期使用 , 在 每一 周期 有两种 生产 任务。据 经 验 , 把机器 x1 台投入第一种生产任务 , 则在一个生产周期中将有 x1/ 3 台机器作废 ; 余下的 机器全部投入第二种生产任务, 则有 1/ 10 台机器作废。如果干第一种生产任务每台机器可 收益 10 , 干第二种生产任务每台机器可收益 7。问怎样分配机器, 使总收益最大 ?9. 5 用逐次逼近法求解下述问题1 y1 + 3 x2 y2 2 x1 + 3 x2 + 4 x3 ≤24 3 y1 + 2 y2 + 5 y3 ≤30 x i ≥0 , y j ≥0 且为整数。 ( i = 1 , 2 , 3 9. 6 设有三种资源 , 每单位的成本分别为 a、b、c。给定的利润函数为max z = x22 + 4 x23 y3j = 1 , 2 , 3)ri ( x i , yi , zi ) ,( i = 1 , 2 , … , n)现有资金为 W , 应购买各种资 源多 少单 位分 配给 n 个 行业 , 才 能 使总 利润 最大。 试给出动态规划的公式 , 并写出它的一维递推关系式。9. 7 若例 3 每个时期的生产数量无限制 , 其余条件不变 , 试解之。 9. 8 利用再生产点性质解上题。 9. 9 某厂生产一种产品 , 估计该 产品 在 未来 4 个 月 的销 售量 分别 为 400、500 、300、 200 件。该项产品的生产准备费用每批为 500 元 , 每件的生 产费用 为 1 元 , 存 储费用每 件 每月为 1 元。假定 1 月初的存货 为 100 件 , 4 月 底的 存货 为零。 试求 该厂 在 这 4 个月 内 的最优生产计划。9. 10 某电视机厂为生产电视机而需生产喇叭 , 生产以万只为单位。根据以往记录 , 一年的四个季度需要喇叭分别是 3 万、2 万、3 万、2 万只。设 每万只 存放在仓 库内一个 季 度的存储费为 0 .2 万元 , 每生产一批的装配 费为 2 万元 , 每 万只的 生产 成本 费为 1 万元。 问应该怎样安排四个季度的生产 , 才能使总的费用最小 ?9. 11 某公司需要对某产品决定未来半年内 每个 月的 最佳存 储量 , 以 使总费 用极 小 化。已知半年里 对 该 产 品 的 需 求 量 和 单 位 订 货 费 用、单 位 存 储 费 用 的 数 据 如 表 9 -16 所示。 表 9 -16月份 k123456需求量 dk505550454030单位订货费用 ck825775850850775825单位存储费用 pk40303520409. 12 某罐头制造公司需要在近五周内必须 采购 一批 原料 , 估计 在未 来五周 内价 格 有波动 , 其浮动价格和概率如表 9 -17 所示。试求 各周 以什 么价格 购入 , 使 采购价 格的 数 学期望值最小。·842·ØK©Pz(cid:28)Àgb3ï‘Àgb3‘ïÀ3b‘ï表 9 -17单价概率90.480.370.39. 13 求下列问题的最优解(1 ) max z = 10 x1 + 22 x2 + 17 x32 x1 + 4 x2 + 3 x3 ≤20 x i ≥0 且为整数 ( i = 1 , 2 , 3)(2 ) max z = x1 x2 x3 x42 x1 + 3 x2 + x3 + 2 x4 = 11 x i ≥0。整数 ( i = 1 , 2 , 3 , 4 )(3 ) max z = 4 x1 + 5 x2 + 8 x3x1 + x2 + x3 ≤10 x1 + 3 x2 + 6 x3 ≤13 x i ≥0 , 整数 ( i = 1 , 2 , 3)(4 ) max z = g1 ( x1 ) + g2 ( x2 ) + g3 ( x3 )x2 1 + x2 x i ≥0 且为整数 ( i = 1 , 2 , 3) 其中 xi 与 gi ( x i ) 的关系如表 9 -18 所示。2 + x23 ≤20表 9 -18xi0123456789g1 ( x1 )24711131518221815g2 ( x2 )5101520241812953g3 ( x3 )812172219161411979. 14 某工厂生产三种产品 , 各产品重量与利润关系如表 9 -19 所示。现将此三种产品运往市场出售 , 运输能力总重量不超过 6 吨。问如何安排运输使总利润最大 ?表 9 -19种 类123重 量234利 润801301809. 15 某工厂在一年进行了 A、B、C 三种新产 品试 制 , 由于资 金不 足 , 估计在 年内 这 三种新 产 品 研 制 不 成 功 的概 率 分 别 为 0 .40 、0 .60 、0 .80 , 因 而 都 研 制 不 成 功 的 概 率 为 0 .40 ×0 .60 ×0 .80 = 0 .192 , 为了促进三种新产品的研制 , 决定增拨 2 万元的研制费 , 并要 ·942·101114“i“i“iÀÖKd(cid:144)z5ª!ï(cid:5)×Ldb§í!‘ïª(cid:28)×Lbd§ïª‘í!(cid:28)×Ld§bí‘ï!ª(cid:28)©(cid:7)(cid:11)©(cid:7)(cid:11)©(cid:11)(cid:7)资金集中使用 , 以万元为单位进行分配。其增拨研制费 与新产品 不成功的 概率如 表 9 -20 所示。试问如何分配费用 , 使这三种新产品都研制不成功的概率为最小。表 9 -20新产品不 成 功 概 率研制费 SABC00.400.600.8010.200.400.5020.150.200.309. 16 某一印刷厂有六项加工任务 , 对印刷 车间和 装订 车间 所需时 间 ( 单 位为天 ) 如表 9 -21 所示 , 试求最优的加工顺序和总加工天数。表 9 -21任务J1J2J3J4J5J6车间印刷车间31052911装订车间81296529. 17 试制定五年中的一台机器更新策略 , 使总收入达到最大。设 α= 1 , T = 2 , 有 关数据如表 9 -22 所示。表 9 -22年序第一年第二年第三年机龄项目01234012301收入2019181614252322202724运行费用44668346733更新费用2527303235272932342930年序第四年第五年期 前机龄项目0102345收入28263016141412运行费用2326677更新费用30313230323434·052·222431612836ÆÂdeÆÂdeÆÂdeBµqä(cid:19)×Ld¨(cid:6)×Ld¨(cid:6)KÁØ9yb4ayï(cid:6)(cid:29)KØPx(cid:144)4(cid:144)ybï(cid:29)(cid:6)KØPbx(cid:144)y4(cid:144)ï(cid:29)(cid:6)KØP(cid:144)yx4(cid:144)bï(cid:6)(cid:29)KÀ×c¿ï(cid:10)(cid:30)Ö×z5bî!(cid:6)Ö×b5z!î(cid:6)Ö×z5b!î(cid:6)表 9 -23距i离123456j101020304050212018302521323905101543432408165452711100186562216201209. 18 求解六个城市旅行推销 员问 题。其 距离 矩阵 如 表 9 -23 所示。 设推 销员 从 1 城出发 , 经过每个城 市 一 次 且仅 一 次 , 最 后回 到 1 城。 问 按 怎样 的 路 线 走 , 使 总 的 行 程 最短。参 考 资 料[1] 马仲蕃 , 魏权龄 , 赖炎连数学规划讲义 . 北京 : 中国人民大学出版社 , 1981[2] 俞玉森主编 . 数学规划的原理和方法 . 武汉 : 华中工学院出版社 , 1985[3] 傅清祥 , 王晓东编著 . 算法与数据结构 . 北京 : 电子工业出版社 , 1998[4] Dreyfus S E , Law A M .T he ar t and th eory of Dynamic Programming . Academic Pr es s, 1977·152·ÀP6dî’Ù©×{6g(cid:5)©Ù×6{g(cid:5)©Ù×6{g(cid:5)©Ù×g{6(cid:5)©Ù×6{g(cid:5)Ù©×6g{(cid:5)六、图与网络分析第 10 章 图与网络优化图论是应用十分广 泛的 运筹 学分 支 , 它 已广 泛地 应用 在物 理 学、化学、控 制 论、信 息 论、科学管理、电子计算机等各个领域。在实际生活、生产和科学研究中 , 有很多问题可以 用图论的理论和方法来解决。例如 , 在组织生 产中 , 为 完成 某项生 产任 务 , 各工序 之间 怎 样衔接 , 才能使生产任务完成得既快又好。一个邮递员送信 , 要走完他负责投递的全部街 道 , 完成任务后回到邮局 , 应该按照怎样的路线走 , 所走的路程最短。再例如 , 各种通信网 络的合理架设 , 交通网络的合理分布等问题 , 应用图论的方法求解都很简便。欧拉在 1736 年发表图论方面的第一篇论文 , 解决了著名的哥尼斯堡七桥问题。哥尼 斯堡城中有一条河叫普雷格尔河 , 该河中有两个岛 , 河上有七座桥。如图 10-1( a ) 所示。图 10-1当时那里的居民热衷于这样的问题 : 一个散步者能否走过七座桥 , 且每座桥只走过一次 , 最后回到出发点。1736 年欧拉将此问题归结为如图 10-1 ( b ) 所示图形的一笔画问题。即能 否从某一 点 开始 , 不重复地一笔画出这个图形 , 最后回到 出发点。 欧拉 证明了 这是 不可能 的 , 因为 图 10-1( b) 中的每个点都只与奇数条线相关联 , 不可能将这个图不重复地一笔 画成。这是 古 典图论中的一个著名问题。随着科学技术的发展以及电子计算机的出现与广泛应用 , 20 世纪 50 年代 , 图论得 到 进一步发展。将庞大复杂的工程系统和管理问题 用图 描述 , 可 以解决 很多 工程设 计和 管 理决策的最优化问题。例如 , 完成工程任 务的时 间最 少、距离最 短、费用 最省 等。图论 受 到数学、工程技术及经营管理等各个方面越来越广泛的重视。第 1 节 图的基本概念在实际生活中 , 人们为了反映一些对象之间的关系 , 常常在纸上用点和线画出各种各样的示意图。 ·252·例 1 图 10-2 是我国北京、上海等十个城市间的铁路交 通图 , 反映了这十个城市间的铁路分布情况。这 里用点代表 城市 , 用点和点之 间的连 线代表 这两 个城 市之间 的铁 路线。 诸如此类的还有电话线分布图、煤气管道图、航空线图等。图 10-2例 2 有甲、乙、丙、丁、戊五个球队 , 它们之间比赛的 情 况 , 也可以用图 表示 出 来。已 知 甲队 和 其 他各 队 都比 赛 过 一次 , 乙队和甲、丙队比赛过 , 丙 队和甲、乙、丁 队比赛 过 , 丁 队和甲、丙、戊队比赛过 , 戊队和 甲、丁队比 赛过。为 了反 映 这个情况 , 可以用点 v1 , v2 , v3 , v4 , v5 分 别代表 这五个 队 , 某 两个队之间比赛过 , 就 在 这两 个 队所 相 应 的点 之 间联 一 条线 , 这条线不过其他的点 , 如图 10 -3 所示。图 10 -3图 10 -4例 3 某单位储存八种化学药品 , 其中某些药品是不能存放在 同一个库房里的。为了 反映这个情况, 可以用点 v1 , v2 , …, v8 分别代表这八种药品, 若药品 vi 和药品 vj 是不能存放 在同一个库房的 , 则在 vi 和 vj 之间联一条线。如图 10 -4 所示。从这个图中可以看到 , 至少 要有四个库房, 因为 v1 , v2 , v5 , v8 必须存放在不同的库房里。事实上, 四个库房就足够了。例 如, { v1 }, { v2 , v4 , v7 } , { v3 , v5 }, { v6 , v8 }各存放在一个库房里 (这一类寻求库房的最少个数问题, 属于图论中的所谓染色问题,一般情况下是尚未解决的) 。从以上几个例子可见 , 可以用由点及点与点的连线所构成的图 , 去反映实际生活中某 些对象之间的某个特定的关系。通常用点代表研 究的 对象 ( 如 城市、球 队、药品等 ) , 用 点 与点的连线表示这两个对象之间有特定的关系 ( 如两个城市间有铁路线、两个球队比赛过、 两种药品不能存放在同一个库房里等 ) 。因此 , 可以说图是反映对象之间关系的一种工具 , 在一般情况下 , 图中点的相对位置如 何, 点与点之间连线的长短曲直, 对于反映对象之间的关系 , 并不重要。如例 2 , 也可以用图 10 -5 所示的图去反映五个球队的比赛情况, 这与图 10 -3没有本质的区别。所以, 图论中的 图与几何图、工程图是不同的。图 10 -5·352·前面几个例子中涉及到的对象之间的“关系”具有“对称性”, 就是说, 如果甲与乙有这种关 系, 那么同时乙与甲也有这种关系。例如甲药品不能和乙药品放在一起 , 那么, 乙药品当然也 不能和甲药品放在一起。在实际生活中, 有许多关系不具有这种对称性。比如人们之间的认 识关系, 甲认识乙并不意味着乙也认识甲。比赛中的胜负关系也是这样, 甲胜乙和乙胜甲是不 同的。反映这种非对称的关系, 只用一条连线就不行了。如例 2 ,如 果人们关心的是五个球队比赛的胜负情况, 那么从图 10 -3 中就看 不出来了。为了反映这一类关系, 可以用一条带箭头的连线表示。 例如球队 v1 胜了 球队 v2 , 可以 从 v1 引一条 带箭头 的连线到 v2 。 图 10 -6反映了五个球队比赛的胜负情况 ,可见 v1 三胜一负, v4 打了 三场球, 全负等。类似胜负这种非对称性的关系, 在生产和生活中 是常见的, 如交通运输中的“单行线”, 部门之间的领导与被领导的 关系、一项工程中各工序之间的先后关系等。图 10 -6综上所述 , 一个图是由一些点及一些点之间的连线 ( 不带箭头或带箭头 ) 所组成的。 为了区别起见 , 把两点之间的不带箭头的连线称为边 , 带箭头的连线称为弧。 如果一个图 G 是由点及边所构成的 ,则称之为无向图 ( 也简称为图 ) , 记为 G = ( V, E) , 式中 V, E 分别是 G的点集合和边集合。一条连结点 vi , vj ∈V 的边记为[ vi , vj ]( 或[ vj , vi ] )。如果一个图 D 是由点及弧所构成的 , 则称 为有 向图 , 记为 D = ( V , A) , 式 中 V , A 分别表示 D 的点集合和弧集合。一条方向是从 vi 指向 v j 的弧记为 ( vi , v j ) 。图 10 -7 是一个无向图。V = { v1 , v2 , v3 , v4 } , E = { e1 , e2 , e3 , e4 , e5 , e6 , e7 }其中e1 = [ v1 , v2 ] , e2 = [ v1 , v2 ] , e3 = [ v2 , v3 ] , e4 = [ v3 , v4 ]e5 = [ v1 , v4 ] , e6 = [ v1 , v3 ] , e7 = [ v4 , v4 ]图 10 -8 是一个有向图 ,V = { v1 , v2 , v3 , v4 , v5 , v6 , v7 } , A = { a1 , a2 , a3 , a4 , … , a1 1 }其中a1 = ( v1 , v2 ) , a2 = ( v1 , v3 ) , a3 = ( v3 , v2 ) , a4 = ( v3 , v4 )a5 = ( v2 , v4 ) , a6 = ( v4 , v5 ) , a7 = ( v4 , v6 ) , a8 = ( v5 , v3 )a9 = ( v5 , v4 ) , a10 = ( v5 , v6 ) , a1 1 = ( v6 , v7 )图 10 -7图 10 -8·452·图 G 或 D 中的点数记为 p( G) 或 p( D) , 边 ( 弧 ) 数记为 q( G) ( q( D) ) 。在 不会引起 混淆的情况下 , 也分别简记为 p, q。下面介绍常用的一些名词和记号 , 先考虑无向图 G = ( V , E) 。 若边 e = [ u, v] ∈ E, 则称 u, v 是 e 的端点 , 也称 u, v 是相邻的。称 e 是点 u( 及点 v) 的 关连边。若图 G 中 , 某个边 e 的两个端点相同 , 则称 e 是环 ( 如图 10 -7 中的 e7 ) , 若两个点 之间有多于一条的边 , 称这些边为多重边 ( 如图 10 -7 中的 e1 , e2 ) 。一个 无环 , 无多重边 的 图称为简单图 , 一个无环 , 但允许有多重边的图称为多重图。以点 v 为端点的边的个数称为 v 的次, 记为 dG ( v) 或 d( v) 。如图 10 -7 中 , d( v1 ) = 4 ,d( v2 ) = 3 , d( v3 ) = 3 , d( v4 ) = 4 ( 环 e7 在计算 d( v4 ) 时算作两次 ) 。称次为 1 的点为悬挂点 , 悬挂点的关连边称为悬挂边 , 次为零的点称为孤立点。 定理 1 图 G = ( V , E) 中 , 所有点的次之和是边数的两倍 , 即∑ 这是显然的 , 因为在计算各点的次时 , 每条边被它的端点各用了一次。 次为奇数的点 , 称为奇点 , 否则称为偶点。 定理 2 任一个图中 , 奇点的个数为偶数。 证明 设 V1 和 V2 分别是 G 中奇点和偶点的集合 , 由定理 1 , 有d ( v) = 2 qv∈ V∑v∈ V1d( v) + ∑v∈ V2d( v) = ∑v∈ Vd( v) = 2q因 ∑v∈ Vd ( v) 是 偶数 , ∑v ∈ V2d( v) 也 是 偶 数 , 故 ∑v∈ V1d( v) 必 定 也 是 偶 数 , 从 而 V 1 的 点 数 是偶数。给定一个图 G = ( V , E) , 一个点、边的交错序列 ( vi2 , … , vi 和 vik ) , 如 1 ,2 , ei t + 1 ] ( t = 1 , 2 , … , k - 1 ) , 则 称 为 一 条 联 结 vi1 , ei1 , vik - 1 , ei k - 1 , vi 的 链 , 记 为 ( vi果满足 ei 2 , … , vi 链 ( vi 1 , vit = [ vi t , vi k ) , 有时称点 vi 2 , … , vi 1 , vi 2 , … , vik1为链的中间点。3 , … , vi2 , vi k ) 中 , 若 vi 1 , vivik - 11 ) 。 若 2 , … , 都是 不 同的 , 则称 之 为 初 等链 ; 若圈 ( vi 都是不同的 , 则称之为初 等圈 ; 若链 ( 圈 ) 中 含的 边均不 相同 ,2 , … , vik , 则称 之 为一 个 圈 , 记 为 ( vi1 , vik - 1 , vi 1 , vi1 = vi 2 , … , vik ) 中 , 点 vi 2 , … , vi链 ( vik1 ) 中 , vivi 则称之为简单圈。以后说到链 ( 圈 ) , 除非特别交代 , 均指初等链 ( 圈 ) 。k - 1 , vi1 , vik - 1例如图 10 -9 中 , ( v1 , v2 , v3 , v4 , v5 , v3 , v6 , v7 ) 是一条简单链 , 但 不 是 初等 链 , ( v1 , v2 , v3 , v6 , v7 ) 是一条初等链。这个图中 , 不存在联结 v1 和 v9 的 链。 ( v1 , v2 , v3 , v4 , v1 ) 是 一个 初 等圈 , ( v4 , v1 , v2 , v3 , v5 , v7 , v6 , v3 , v4 ) 是简单圈 , 但不是初等圈。图 10 -9图 G 中 , 若任 何 两个 点 之 间 , 至 少 有 一条 链 , 则称 G 是连通 图 , 否则 称为 不 连通 图。若 G 是 不 连通图 , 它的每 个连 通 的部 分 称 为 G 的 一个 连 通分图 ( 也简称分图 ) 。如图 10 -9 是一个不连通图 , 它有两个连通分图。·552·给了一个图 G = ( V , E) , 如果图 G′= ( V′, E′) , 使 V = V′及 E′ E, 则称 G′是 G 的 一个支撑子图。设 v∈ V ( G) , 用 G- v 表示从图 G 中去掉点 v 及 v 的关联边后得到的一个图。 例如若 G 如图 10 -10( a) 所示 , 则 G- v3 见图 10 -10 ( b ) 。图 10 -10( c) 是图 G 的一个 支撑子图。图 10 -10现在讨论有向图的情形。设给了一个有向图 , D = ( V , A) , 从 D 中去掉所有弧上的 箭头 , 就得到一个无向图 , 称之为 D 的基础图 , 记之为 G( D) 。给 D 中的一条弧 a = ( u, v) , 称 u 为 a 的始点 , v 为 a 的终点 , 称弧 a 是从 u 指向 v 的。 k ) 是 D 中的一个 点弧交错 序列 , 如 果这个 序列 在 设 ( vi 基础图 G( D) 中所对应的点边序列是一条 链 , 则称 这个 点弧交 错序 列是 D 的 一条链。 类 似定义圈和初等链 ( 圈 ) 。 1 , ai t , vi2 , … , vi1 , vi2 , aik - 1 , aik - 1 , vi1 , ai如果 ( vi2 , … , vik ) 是 D 中的 一条链 , 并且对 t = 1 , 2 , … , k - 1 , 的 一条 路。若 路的 第 一个 点和 最后 一点 相 同 , 则1 , vi t + 1 ) , 称之为从 vi2 , aik - 1 , vik - 1 , ai到 vi均有 ai 称之为回路。类似定义初等路 ( 回路 ) 。t = ( vi1k例如图 10 -8 中 , ( v3 , ( v3 , v2 ) , v2 , ( v2 , v4 ) , v4 , ( v4 , v5 ) , v5 , ( v5 , v3 ) , v3 ) 是 一个 回路 , ( v1 , ( v1 , v3 ) , v3 , ( v3 , v4 ) , v4 , ( v4 , v6 ) , v6 ) 是 从 v1 到 v6 的路 , ( v1 , ( v1 , v3 ) , v3 , ( v5 , v3 ) , v5 , ( v5 , v6 ) , v6 ) 是一条链 , 但不是路。对无向图 , 链与路 ( 圈与回路 ) 这两个概念是一致的。 类似于无向图 , 可定义简单有向图、多重有向图 , 图 10 -8 是一个简单有向图。以后除特别交代外 , 说到图 ( 有向图 ) 均指简单图 ( 简单有向图 ) 。第 2 节 树2. 1 树及其性质在各式各样的图中 , 有一类图是极其简单然而却是很有用的 , 这就是树。例 4 已知有五个城市 , 要在它们之间架设电话线 , 要求 任何两 个城市都 可以互相 通话 ( 允许通过其他城市 ) , 并且电话线的根数最少。 ·652·用五个点 v1 , v2 , v3 , v4 , v5 代 表 五 个 城市 , 如 果 在某 两 个城市之间架设电话线 , 则 在相 应的两 个点 之间 连一条 边 , 这样一个电话线网就可以用 一个 图来表 示。为 了使任 何两个城市都可以通话 , 这样 的图必 须是 连通 的。其次 , 若 图中 有圈的话 , 从 圈上 任 意去 掉 一条 边 , 余 下 的 图仍 是 连 通 的 , 这样可以省去 一 根电 话 线。因 而 , 满 足 要求 的 电 话 线网 所 对应的图必定是不含圈的 连通 图。图 10 -11 代 表了满 足要 求的一个电话线网。图 10 -11定义 1 一个无圈的连通图称为树。 例 5 某工厂的组织机构如下所示 :———行政办公——————生产计划科———技术科——————供销科———财务科———设计组———工艺组厂长———室———行政科生产———一车间——————铸造工段———锻压工段———办——————二车间公———三车间室———四车间如果用图表示 , 该工厂的组织机构图就是一个树 ( 如图 10 -12 所示 ) 。下面介绍树的一些重要性质。定理 3 设图 G = ( V , E) 是一 个树 , p( G) ≥2 , 则 G 中至 少有 两个悬挂点。图 10 -12证明 令 P = ( v1 , v2 , … , vk ) 是 G 中含边数最 多的一条 初等链 , 因 p( G) ≥2 , 并且 G 是 连通 的 , 故链 P 中至 少有 一条 边 , 从 而 v1 与 vk 是不 同的。现 在 来证 明 : v1 是 悬挂 点 , 即 d ( v1 ) = 1。 用反 证法 , 如果 d( v1 ) ≥ 2 , 则存 在边 [ v1 , vm ] , 使 m≠ 2。若点 vm 不 在 P 上 , 那 么 ( vm , v1 , v2 , … , vk ) 是 G 中 的 一 条 初 等 链 , 它 含 的 边 数 比 P 多 一 条 , 这与 P 是含边数最多的初等链矛盾。若点 vm 在 P 上 , 那 么 ( v1 , v2 , … , vm , v1 ) 是 G 中 的 一 个 圈 , 这 与 树 的 定 义 矛 盾。 于 是 必 有 d( v1 ) = 1 , 即 v1 是悬挂点。同理可证 vk 也是悬挂点 , 因而 G 至少有 两个悬挂点。定理 4 图 G = ( V , E) 是一 个树 的充 分必要 条件 是 G 不 含圈 ,且恰有 p - 1 条边。证明 必要性 设 G 是一个树 , 根据定义 , G 不含圈 , 故只要证明 G 恰 有 p - 1 条边。对点数 p 施行数学归纳法。 p = 1 , 2 时 , 结论显然成立。假设对点数 p≤ n 时 , 结论成立。设树 G 含 n + 1 个 点。由定理 3 , G 含悬 挂点 , 设 v1 是 G 的一个悬挂点 , 考虑图 G - v1 , 易见 p( G - v1 ) = n, q( G - v1 ) = q( G) - 1 。因 G - v1 ·752·是 n 个点的树 , 由归纳假设 , q( G - v1 ) = n - 1 , 于是q( G) = q( G - v1 ) + 1 = ( n - 1) + 1 = n = p( G) - 1充分性 只要证明 G 是连通的。用反证法 , 设 G 是不连通的 , G 含 s 个连通分图 G1 , G2 , … , Gs ( s≥2) 。因每个 Gi ( i = 1 , 2 , … , s) 是连通的 , 并且不含圈 , 故每个 Gi 是树。设 Gi 有 pi 个点 , 则由必要性 , Gi 有 p i - 1 条边 , 于是sssq( G) = ∑q( Gi ) = ∑( pi - 1 ) = ∑pis = p( G)s ≤ p( G) - 2i = 1i = 1i = 1这与 q( G) = p( G) - 1 的假设矛盾。定理 5 图 G = ( V , E) 是一个树的充分必要条件是 G 是连通图 , 并且q( G) = p( G) - 1证明 必要性 设 G 是树 , 根据定义 , G 是连通图 , 由定理 4 , q( G) = p( G) - 1 充分性 只要证明 G 不含圈 , 对点 数施 行 归纳。 p ( G) = 1 , 2 时 , 结论 显然 成立。 设 p( G) = n( n≥1 ) 时结论成立。现设 p( G) = n + 1 , 首 先证 明 G 必 有悬 挂点。若 不然 , 因 G 是连通的 , 且 p( G) ≥ 2 , 故对每个点 vi , 有 d( vi ) ≥2 。从而q( G) =p ( G)1 2 ∑i = 1d( vi ) ≥ p( G)这与 q( G) = p( G) - 1 矛盾 , 故 G 必有 悬挂点。设 v1 是 G 的一个 悬挂 点 , 考虑 G - v1 , 这 个图仍是连通的 , q( G - v1 ) = q( G) - 1 = p( G) - 2 = p( G - v1 ) - 1 , 由归 纳假设知 G - v1 不 含圈 , 于是 G 也不含圈。定理 6 图 G 是树的充分必要条件是任意两个顶点之间恰有一条链。 证明 必要性 因 G 是连通的 , 故任两个点之间至少有一条链。但如果某两个点之间有两条链的话, 那么图 G 中含有圈, 这与树的定义矛盾, 从而任两个点之间恰有一条链。充分性 设图 G 中任两个点之间恰有一条链 , 那么易见 G 是连通的。如果 G 中含有圈 , 那么这个圈上的两个顶点之间有两条链 , 这与假设矛盾 , 故 G 不含圈 , 于是 G 是树。由这个定理 , 很容易推出如下结论 : (1 ) 从一个树中去掉 任意一 条边 , 则 余下的 图是 不连 通的。由 此可知 , 在点集合 相同 的所 有 图中 , 树 是含 边 数 最少 的 连通 图。这 样 , 例 4 中所要求的电话线网就是以这五个城市为点的一个树。(2 ) 在树中不相邻的两个点间添上一条边 , 则恰好得到一个圈。 进一步地说 , 如果再从这个圈上任意去掉一条边 , 可以得到一个树。 如图 10 -11 中 , 添 加 [ v2 , v1 ] , 就得 到一 个 圈 ( v1 , v2 , v5 , v1 ) , 如图 10 -13果从这个圈中去掉一条边 [ v1 , v5 ] , 就得到如图 10 -13 所示的树。2. 2 图的支撑树定义 2 设图 T = ( V , E′) 是图 G = ( V , E) 的支撑子图 , 如果图 T = ( V , E′) 是一个树 ,则称 T 是 G 的一个支撑树。例如图 10 -14( b) 是图 10 -14 ( a ) 所示图的一个支撑树。 若 T = ( V , E′) 是 G = ( V , E) 的一个支撑 树 , 则显 然 , 树 T 中边 的个数 是 p ( G) - 1 , G中不属于树 T 的边数是 q( G) - p( G) + 1 ·852·图 10 -14定理 7 图 G 有支撑树的充分必要条件是图 G 是连通的。 证明 必要性是显然的。 充分性 设图 G 是连通图 , 如果 G 不含圈 , 那么 G 本身是一个树 , 从而 G 是它自身的 一个支撑树。现设 G 含圈 , 任取一个圈 , 从圈中任意地去掉一条边 , 得到图 G 的一个支 撑 子图 G1 。如果 G1 不含圈, 那么 G1 是 G 的一个支撑树( 因为易见 G1 是连通的 ) ; 如果 G1 仍 含圈 , 那么从 G1 中任取一个圈 , 从圈中再任意去掉一条边 , 得到图 G 的一个支撑子图 G2 , 如 此重复, 最终可以得到 G 的一个支撑子图 Gk , 它不含圈, 于是 Gk 是 G 的一个支撑树。定理 5 充分性的证明 , 提供了一个寻求连通图的支撑树的方法。这就是任取一个圈 , 从圈中去掉一边 , 对余下的图重复这个步骤 , 直到不含圈时为止 , 即得到一个支撑树 , 称这 种方法为“破圈法”。例 6 在图 10 -15 中 , 用破圈法求出图的一个支撑树。 解 取一个圈 ( v1 , v2 , v3 , v1 ) , 从这个圈中去掉边 e3 = [ v2 , v3 ] ; 在余下的图中 , 再取一 个圈 ( v1 , v2 , v4 , v3 , v1 ) , 去掉边 e4 = [ v2 , v4 ] ; 在余下 的图 中 , 从 圈 ( v3 , v4 , v5 , v3 ) 中 去掉 边 e6 = [ v5 , v3 ] ; 再从圈 ( v1 , v2 , v5 , v4 , v3 , v1 ) 中去 掉边 e8 = [ v2 , v5 ] 。 这时 , 剩 余的图 中不 含 圈 , 于是得到一个支撑树 , 如图 10 -15 中粗线所示。也可以用另一种方法来寻求连通图的支撑树。在图中任取一条边 e1 , 找一条 与 e1 不 构成圈的边 e2 , 再找一条与{ e1 , e2 } 不 构成 圈的 边 e3 , 一 般 , 设 已有 { e1 , e2 , … , ek } , 找一 条 与{ e1 , e2 , … , ek }中的任何一些边不构成圈的边 ek + 1 。重复这个过 程 , 直 到不能进 行为止。 这时 , 由所有取出的边所构成的图是一个支撑树 , 称这种方法为“避圈法”。图 10 -15图 10 -16例 7 在图 10 -16 中 , 用避圈法求出一个支撑树。解 首先任取边 e1 , 因 e2 与 e1 不构成圈 , 所以可以取 e2 , 因为 e5 与{ e1 , e2 }不构成圈 , 故可以取 e5 ( 因 e3 与{ e1 , e2 }构 成 一个 圈 ( v1 , v2 , v3 , v1 ) , 所 以 不能 取 e3 ) ; 因 e6 与 { e1 , e2 , e5 }不构成圈 , 故可取 e6 ; 因 e8 与{ e1 , e2 , e5 , e6 }不 构成 圈 , 故可 取 e8 ( 注 意 , 因 e7 与{ e1 , e2 , e5 , e6 }中的 e5 , e6 构成圈 ( v2 , v5 , v4 , v2 ) , 故不能 取 e7 ) 。这 时由 { e1 , e2 , e5 , e6 , e8 }所 构成 的 图就是一个支撑树 , 如图 10 -16 中粗线所示。·952·实际上 , 由定理 4 , 5 可知 , 在“破圈法”中去 掉的边 数必 是 q( G) - p( G) + 1 条 , 在“ 避圈法”中取出的边数必定是 p( G) - 1 条。2. 3 最小支撑树问题定义 3 给图 G = ( V , E) , 对 G 中的每一条边 [ vi , vj ] , 相应地有一个数 wi j , 则称这样的图 G 为赋权图 , wij 称为边 [ vi , vj ] 上的权。这里所说的“权”, 是指与边有关的数量指标。根据实际问题的需要 , 可以赋予它不同的含义 , 例如表示距离、时间、费用等。赋权图在图的理论及其应用方面有着重要的地位。赋权图不仅指出各个点之间的邻接关系 , 而且同时也表示出各点之间的数量关系。所以 , 赋权图被广泛地应用于解决工程 技术及科学生产管理等领域的最优化问题。最小支撑树问题就是赋权图上的最优化问题之一。设有一个连通图 G = ( V , E) , 每一边 e= [ vi , v j ] , 有一个非负权w( e) = wi j( wi j ≥0 )定义 4 如果 T = ( V , E′) 是 G 的一个支撑树 , 称 E′中所有边的权之和为支撑树 T 的权 , 记为 w( T) 。即w( T) = ∑[ v, v] ∈ Tw i j如果支撑树 T * 的权 w( T * ) 是 G 的所有支撑 树的权中 最小者 , 则 称 T * 是 G 的最 小支撑树 ( 简称最小树 ) 。即w( T * ) = minTw ( T )式中对 G 的所有支撑树 T 取最小。最小支撑树问题就是要求给定连通赋权图 G 的最小支撑树。 假设给定一些城市 , 已知每对城市间交 通线 的建造 费用。 要求建 造一 个联结 这些 城市的交通网 , 使总的建造费用最小 , 这个问题就是赋权图上的最小树问题。下面介绍求最小树的两个方法。1. 避圈法( kr uskal)开始选一条最小权的边 , 以后每一步中 , 总从 与已 选边 不构成 圈的 那些未 选边 中 , 选 一条权最小的。 ( 每一步中 , 如果有两条或两条以 上的 边都 是权最 小的 边 , 则从中 任选 一 条 ) 。算法的具体步骤如下 : 第 1 步 : 令 i = 1 , E0 = 第 2 步 : 选 一 条 边 ei ∈ E \ E i - 1 , 使 ei 是 使 ( V , Ei - 1 ∪ { e}) 不 含 圈 的 所 有 边 e( e∈ E\ Ei - 1 ) 中权最小的边。令 Ei = Ei - 1 ∪{ ei } , 如果这 样的边不 存在 , 则 T = ( V , Ei - 1 ) 是最小树。, ( 表示空集 ) 。第 3 步 : 把 i 换成 i + 1 , 转入第 2 步。 在证明这个方法的正确性之前 , 先介绍一个例子。 例 8 某工厂内联结六个车间的道路网 如图 10 -17 ( a ) 所示。 已知 每条道 路的 长 , 要·062·求沿道路架设联结六个车间的电话线网 , 使电话线的总长最小。图 10 -17解 这个问题就是求如图 10 -17( a ) 所示的赋权图上的最小树 , 用避圈法求解。, 从 E 中选最小权边 [ v2 , v3 ] , E1 = {[ v2 , v3 ] } ;i = 1 , E0 = i = 2 , 从 E \ E1 中 选最小 权边 [ v2 , v4 ] ( [ v2 , v4 ] 与 [ v2 , v3 ] 不构 成圈 ) , E2 = {[ v2 , v3 ] ,[ v2 , v4 ] } ;i = 3 , 从 E\ E2 中选 [ v4 , v5 ] ( ( V , E2 ∪{ [ v4 , v5 ]} ) 不含圈 ) , 令 E3 = { [ v2 , v3 ] , [ v2 , v4 ] ,[ v4 , v5 ] } ;i = 4 , 从 E\ E3 中 选 [ v5 , v6 ] ( 或 选 [ v4 , v6 ] ) ( ( V , E3 ∪ { [ v5 , v6 ] }) 不 含 圈 ) , 令 E4 ={[ v2 , v3 ] , [ v2 , v4 ] , [ v4 , v5 ] , [ v5 , v6 ] } ;i = 5 , 从 E\ E4 中选 [ v1 , v2 ] ( ( V , E4 ∪{ [ v1 , v2 ]} ) 不含圈 ) 。注意 , 因 [ v4 , v6 ] 与已选 边 [ v4 , v5 ] , [ v5 , v6 ] 构 成 圈 , 所 以 虽 然 [ v4 , v6 ] 的 权 小 于 [ v1 , v2 ] 的 权 , 但 这 时 不 能 选 [ v4 , v6 ] ) , 令 E5 = { [ v2 , v3 ] , [ v2 , v4 ] , [ v4 , v5 ] , [ v5 , v6 ] , [ v1 , v2 ]} ;i = 6 , 这时 , 任一条未选的边都与已选的边构成圈 , 所以算法终止。 ( V , E5 ) 就是要求的最小树 , 即电话线总长最 小的电话 线网方 案 ( 图 10 -17 ( b ) ) , 电 话线总长为 15 单位。现在来证明方法一的正确性。令 G = ( V , E) 是连通赋权图 , 根据 2. 2 中所述可知 : 方法一终止时 , T = ( V , Ei - 1 ) 是支撑树 , 并且这时 i = p( G) 。记E( T ) = { e1 , e2 , … , ep - 1 }p - 1式中 p = p( G) , T 的权为 w ( T ) = ∑w( ei ) 。i = 1用反证法来证明 T 是最小支 撑 树 , 设 T 不是 最小 支撑 树 , 在 G 的 所有 支撑 树 中 , 令 H 是与 T 的公共边数最大的最小支撑树。因 T 与 H 不是 同一个 支撑树 , 故 T 中至少 有 一条边不在 H 中。令 ei ( 1≤ i≤ p - 1 ) 是第 一个不 属于 H 的边 , 把 ei 放入 H 中 , 必得 到 一个且仅一个圈 , 记这个圈为 C。因为 T 是不含圈的 , 故 C 中 必有一 条边不属 于 T , 记 这 条边为 e。在 H 中去掉 e, 增加 ei , 就得到 G 的另一个支撑树 T0 , 可见w( T0 ) = w( H ) + w( ei ) - w( e) 因为 w( H ) ≤ w ( T0 ) ( 因 H 是 最小 支 撑 树 ) , 推 出 w ( e) ≤ w ( ei ) 。 但 根 据 算 法 , ei 是 使 ( V , { e1 , e2 , … , ei } ) 不含圈的权最小的边 , 而 ( V , { e1 , e2 , … , ei - 1 , e}) 也是不 含圈的 , 故必 有 w( e) = w( ei ) , 从而 w( T0 ) = w( H ) 。这就是说 T0 也是 G 的一个最小支撑 树 , 但 是 T0 与 T 的公共边数比 H 与 T 的公共边数多一条 , 这与 H 的选取矛盾。·162·2. 破圈法任取一个圈 , 从圈中去掉一条权最大的边 ( 如果有两条或两条以上的边都是权最大的 边 , 则任意去掉其中一 条 ) 。在余 下 的图 中 , 重复 这个 步 骤 , 直至 得到 一 个不 含 圈的 图 为 止 , 这时的图便是最小树。例 9 用破圈法求图 10 -17 ( a ) 所示赋权图的最小支撑树。 解 任取一个圈 , 比如 ( v1 , v2 , v3 , v1 ) , 边 [ v1 , v3 ] 是 这个 圈 中 权最 大 的边 , 于是 丢 去 [ v1 , v3 ] ; 再取圈 ( v3 , v5 , v2 , v3 ) , 去掉 [ v2 , v5 ] ; 取 圈 ( v3 , v5 , v4 , v2 , v3 ) , 去 掉 [ v3 , v2 ] ; 取 圈 ( v5 , v6 , v4 , v5 ) , 这个 圈中 , [ v5 , v6 ] 及 [ v4 , v6 ] 都 是权 最大 的边 , 去掉 其中 的一 条 , 比 如 说 [ v4 , v6 ] 。这时得到一个不含圈的图 ( 如图 10 -17 ( b) 所示 ) , 即为最小树。关于破圈法的正确性略去证明。第 3 节 最短路问题3. 1 引例例 10 已知如图 10 -18 所示的单行线交通网 , 每弧旁的 数字表 示通过这 条单行线 所需要的费用。现在某 人要从 v1 出 发 , 通过 这个 交 通网到 v8 去 , 求使总费用最小的旅行路线。可见 , 从 v1 到 v8 的旅 行路线 是很 多的 , 例 如 可以从 v1 出 发 , 依 次经 过 v2 , v5 , 然后 到 v8 ; 也 可 以从 v1 出 发 , 依 次 经 过 v3 , v4 , v6 , v7 , 然 后 到 v8 等。不同的路线 , 所需总 费用 是不同 的。比 如 , 按 前一个路线 , 总费用是 6 + 1 + 6 = 13 单 位 ; 而按 后 一个路线 , 总费 用是 3 + 2 + 10 + 2 + 4 = 21 单 位。 不难看到 , 用图的语 言来 描述 , 从 v1 到 v8 的旅 行 路线与有向图中从 v1 到 v8 的路是一一对应的。一条旅行路线的总费用就是相应的从 v1 到 v8 的路中所有弧旁 数字 之和。 当然 , 这 里说 到 的路 可以 不是 初等 路。例 如某 人 从 v1 到 v8 的旅行路线可以是从 v1 出发 , 依次 经 v3 , v4 , v6 , v5 , v4 , v6 , v7 , 最后到 达 v8 。这条 路 线相应的路是 ( v1 , v3 , v4 , v6 , v5 , v4 , v6 , v7 , v8 ) , 总费用是 47 单位。图 10 -18从这个例子可以引出一般 的 最短 路问 题 , 给 定一 个赋 权有 向 图 , 即 给了 一 个有 向 图 D = ( V , A) , 对每一个弧 a = ( vi , vj ) , 相应地有权 w( a) = wi j , 又给定 D 中的两个顶点 vs , vt 。设 P 是 D 中从 vs 到 v t 的一条路 , 定义路 P 的权是 P 中所有弧的权之和 , 记为 w( P) 。 最短路问题就是要在所有从 vs 到 v t 的路中 , 求一条权最小的路 , 即求一条从 vs 到 v t 的路 P0 , 使w( P0 ) = minPw ( P)式中对 D 中所有从 vs 到 v t 的路 P 取最 小 , 称 P0 是从 vs 到 v t 的最 短路。路 P0 的权 称 为从 vs 到 v t 的距离 , 记为 d( vs , vt ) 。显然 , d( vs , vt ) 与 d( vt , vs ) 不一定相等。·262·最短路问题是重要的最优化问题之一 , 它 不仅可 以直 接应 用于解 决生 产实际 的许 多 问题 , 如管道铺设、线路安排、厂区布局、设备更新等 , 而且经常被作为一个基本工具 , 用于 解决其他的优化问题。3. 2 最短路算法本节将介绍在一个赋权有向图中寻求最短路 的方 法 , 这些 方法实 际上 求出了 从给 定一个点 vs 到任一个点 v j 的最短路。如下事实是经常要利用的 , 如果 P 是 D 中从 vs 到 v j 的最短路 , vi 是 P 中的 一个点 , 那么 , 从 vs 沿 P 到 v i 的路是从 vs 到 v i 的最短路。事实上 , 如果这个结论不成立 , 设 Q 是 从 vs 到 v i 的最短路 , 令 P′是从 vs 沿 Q 到达 v i , 再从 vi 沿 P 到达 v j 的路 , 那么 , P′的权就 比 P 的权小 , 这与 P 是从 vs 到 v j 的最短路矛盾。首先介绍所有 wi j ≥0 的情形下 , 求最短路的方法。当所有的 wi j ≥0 时 , 目前公认 最好的方法是由 Dijkst ra 于 1959 年提出来的。Dijk st r a 方法的基本思想是从 vs 出发 , 逐步地向外探寻最短路。执行过程中 , 与每 个 点对应 , 记录下一个数 ( 称为这个点的标号 ) , 它或者表示从 vs 到该 点的最 短路的权 ( 称 为 P 标号 ) , 或者是从 vs 到该点的最短路的权的上界 ( 称为 T 标号 ) , 方法的每一步是去修改 T 标号 , 并且把某一个具 T 标号的点改变为具 P 标号的点 , 从而使 D 中具 P 标号的顶 点 数多一个 , 这样 , 至多经过 p - 1 步 , 就可以求出从 vs 到各点的最短路。在叙述 Dijk str a 方 法的具体 步骤之 前 , 以 例 10 为例 说明一下 这个方 法的基本 思想。 例 1 中 , s = 1。因为所有 wi j ≥0 , 故有 d( v1 , v1 ) = 0。 这时 , v1 是具 P 标 号的 点。现在 考 查从 v1 发出的三条弧 , ( v1 , v2 ) , ( v1 , v3 ) , 和 ( v1 , v4 ) 。如果某 人从 v1 出发 沿 ( v1 , v2 ) 到 达 v2 , 这时需要 d( v1 , v1 ) + w12 = 6 单位的费用 ; 如果他从 v1 出发 , 沿 ( v1 , v3 ) 到达 v3 , 则需要 d( v1 , v1 ) + w13 = 3 单位的费用 ; 类似地 , 若沿 ( v1 , v4 ) 到达 v4 , 需要 d( v1 , v1 ) + w14 = 1 单 位的费用。因min{ d( v1 , v1 ) + w12 , d( v1 , v1 ) + w1 3 , d( v1 , v1 ) + w1 4 } = d( v1 , v1 ) + w1 4 = 1可以断言 , 他从 v1 出发到 v4 所需要的最小 费用必 定是 1 单 位 , 即从 v1 到 v4 的最 短 路是 ( v1 , v4 ) , d( v1 , v4 ) = 1。这 是因为 从 v1 到 v4 的 任一条 路 P , 如 果不是 ( v1 , v4 ) , 则 必 是先从 v1 沿 ( v1 , v2 ) 到达 v2 , 或者沿 ( v1 , v3 ) 到达 v3 , 而后再从 v2 或 v3 到 v4 去 , 但如上所 说 , 这时候他已需要 6 单位或 3 单位的 费用 , 不管 他如 何再从 v2 或 从 v3 到达 v4 , 所需 要 的总费用都不会比 1 少 ( 因为所有的 wi j ≥ 0) 。因而推 知 d( v1 , v4 ) = 1 , 这样 就可 以使 v4 变成具 P 标号的点。现在考查从 v1 及 v4 指向其余点的弧 , 由上已知 , 从 v1 出发 , 分别沿 ( v1 , v2 ) 、( v1 , v3 ) 到达 v2 , v3 , 需要 6 单位或 3 单位的费用 , 而从 v4 出发沿 ( v4 , v6 ) 到达 v6 , 所需要的费用 是 d( v1 , v4 ) + w46 = 1 + 10 = 11 单位 , 因min{ d( v1 , v1 ) + w12 , d( v1 , v1 ) + w1 3 , d( v1 , v4 ) + w4 6 } = d( v1 , v1 ) + w1 3 = 3基于同样的理由可以断言 , 从 v1 到 v3 的最短路 是 ( v1 , v3 ) , d( v1 , v3 ) = 3。这 样又 可 以使点 v3 变成具 P 标号的点。如此重复这个过程 , 可以求出从 v1 到任一点的最短路。 在下述 Dijkst ra 方法具体步骤中 , 用 P , T 分 别表 示 某个 点的 P 标号、T 标 号 , Si 表·362·示第 i 步时 , 具 P 标号点的集合。为了在求出从 vs 到各 点的距 离的同时 , 也 求出从 vs 到 各点的最短路 , 给每个点 v 以一个λ值 , 算法终止时 , 如果 λ( v) = m, 表示在从 vs 到 v 的最 短路上 , v 的前一个点是 v m ; 如果 λ( v) = M , 则表 示 D 中不 含从 vs 到 v 的 路 ;λ( v) = 0 表 示 v = vs 。Dijk st r a 方法的具体步骤 : 给定赋权有向图 D = ( V , A) 。 开始 ( i = 0 ) 令 S0 = { vs } , P ( vs ) = 0 , λ( vs ) = 0 , 对 每 一 个 v≠ vs , 令 T ( v ) = + ∞ ,λ( v) = M , 令 k = s。① 如果 Si = V , 算法终止 , 这时 , 对每个 v∈ Si , d( vs , v) = P( v) ; 否则转入②。 ② 考查每个使 ( vk , vj ) ∈ A 且 v j | Si 的点 v j 。 如果 T ( vj ) > P( vk ) + w k j , 则把 T ( vj ) 修改为 P( vk ) + w k j , 把 λ( vj ) 修改为 k; 否则转入③。③ 令 T ( vji ) = min| Svj{ T ( vj ) }。i ) , 令 Si + 1 = Si ∪ i } , k = j i , 把 i 换成 i + 1 , 转入① ; 否则终止 , 这时对每一个 v∈ Si , d( vs , v) = P( v) , 而对如果 T ( vji ) < + ∞ , 则把 vj的 T 标号 变为 P 标 号 P ( v ji ) = T ( vji{ vj 每一个 v| Si , d( vs , v) = T ( v) 。现在用 Dijkst ra 方法求例 10 中从 v1 到各个顶点的最短路 , 这时 s = 1 。(1 ) i = 0 S0 = { v1 } , P( v1 ) = 0 ,λ( v1 ) = 0 , T ( vi ) = + ∞ ,λ( vi ) = M( i = 2 , 3 , … , 9) , 以及 k = 1。 转入② , 因 ( v1 , v2 ) ∈ A, v2 | S0 , P( v1 ) + w12 < T ( v2 ) , 故把 T( v2 ) 修 改为 P( v1 ) + w1 2= 6 ,λ( v2 ) 修改为 1 ;同理 , 把 T( v3 ) 修改为 P( v1 ) + w1 3 = 3 ,λ( v3 ) 修改 为 1 ; 把 T ( v4 ) 修 改为 P( v1 ) + w1 4= 1 ,λ( v4 ) 修改为 1。转入③ , 在所 有的 T 标号中 T ( v4 ) = 1 最 小 , 于是 令 P ( v4 ) = 1 , 令 S1 = S0 ∪ { v4 } ={ v1 , v4 } , k = 4。(2 ) i = 1 转入② , 把 T( v6 ) 修改为 P( v4 ) + w46 = 11 ,λ( v6 ) 修改为 4 。 转入③ , 在所有 T 标号 中 , T ( v3 ) = 3 最 小 , 于 是令 P( v3 ) = 3 , 令 S2 = { v1 , v4 , v3 } ,k = 3 。(3 ) i = 2 转入② , 因 ( v3 , v2 ) ∈ A, v2 | S2 , T ( v2 ) > P( v3 ) + w32 , 把 T ( v2 ) 修改为 P( v3 ) + w32 =5 ,λ( v2 ) 修改为 3。转入③, 在所有 T 标号中 , T( v2 ) = 5 最小 , 于是令 P( v2 ) = 5, S3 = { v1 , v4 , v3 , v2 } , k = 2。(4 ) i = 3 转入② , 把 T( v5 ) 修改为 P( v2 ) + w25 = 6 ,λ( v5 ) 修改为 2。 转入③ , 在所有 T 标号中 , T( v5 ) = 6 最小 , 于是令 P( v5 ) = 6 , S4 = { v1 , v4 , v3 , v2 , v5 } ,k = 5 。(5 ) i = 4 转入② , 把 T ( v6 ) , T ( v7 ) , T ( v8 ) 分 别 修 改 为 10 , 9 , 12 , 把 λ( v6 ) ,λ( v7 ) ,λ( v8 ) 修 改为 5。 ·462·转入③ , 在所有 T 标号中 , T( v7 ) = 9 最小 , 于是令P( v7 ) = 9 ,S5 = { v1 , v4 , v3 , v2 , v5 , v7 } ,k = 7(6 ) i = 5 转入② , ( v7 , v8 ) ∈ A, v8 | S5 , 但因 T ( v8 ) < P( v7 ) + w73 , 故 T ( v8 ) 不变。 转入③ , 在所有 T 标号中 , T( v6 ) = 10 最小 , 令P( v6 ) = 10 ,S6 = { v1 , v4 , v3 , v2 , v5 , v7 , v6 } ,k = 6。(7 ) i = 6 转入② , 从 v6 出发没有弧指向不属于 S6 的点 , 故直接转入③。 转入③ , 在所有 T 标号中 , T( v8 ) = 12 最小 , 令P( v8 ) = 12 ,S7 = { v1 , v4 , v3 , v2 , v5 , v7 , v6 , v8 } ,k = 8。(8 ) i = 7 转入③ , 这时仅有的 T 标号点为 v9 , T ( v9 ) = + ∞ , 算法终止。 算法终止时P( v1 ) = 0 ,P( v4 ) = 1 ,P( v3 ) = 3 ,P( v2 ) = 5 ,P( v5 ) = 6 ,T ( v9 ) = + ∞P( v7 ) = 9 , λ( v1 ) = 0 , λ( v7 ) = 5 ,P( v8 ) = 12 ,P( v6 ) = 10 , λ( v4 ) = 1 , λ( v6 ) = 5 ,λ( v3 ) = 1 , λ( v8 ) = 5 , 这表示对 i = 1 , 2 , … , 8 , d( v1 , vi ) = P( vi ) , 而从 v1 到 v9 不存在路 , 根据 λ值可以求出λ( v2 ) = 3 , λ( v9 ) = Mλ( v5 ) = 2 ,从 v1 到 vi 的最短路 ( i = 1 , 2 , … , 8) 。例如为了求从 v1 到 v8 的最短路 , 考查 λ( v8 ) , 因 λ( v8 ) = 5 , 故最短 路包含弧 ( v5 , v8 ) ; 再考查 λ( v5 ) , 因 λ( v5 ) = 2 , 故最短路包含弧 ( v2 , v5 ) ; 类推 ,λ( v2 ) = 3 ,λ( v3 ) = 1 , 于是最短 路包含弧 ( v3 , v2 ) , 及 ( v1 , v3 ) , 这样从 v1 到 v8 的最短路是 ( v1 , v3 , v2 , v5 , v8 ) 。上面介 绍了 求一 个赋 权 有向 图中 , 从一 个顶 点 vs 到 各个 顶点 的 最短 路。对 于赋 权 ( 无向 ) 图 G = ( V , E) , 因为 沿边 [ vi , vj ] 既可 以从 vi 到达 v j , 也 可以沿 vj 到 达 v i , 所以 边 [ vi , vj ] 可以看作是两条弧 ( vi , vj ) 及 ( vj , vi ) , 它们具 有相同 的权 w[ vi , vj ] 。 这样 , 在一 个 赋权图中 , 如果所有的 wi j ≥ 0 , 只 要 把 Dijkst ra 方 法 中的“② 考 查 每个 使 ( vk , v j ) ∈ A 且 v j | Si 的点 v j ”改为“ ②考查每 个使 [ vk , v j ] ∈ E 且 v j | Si 的点 v j ”, 同 样地 可 以 求出 从 vs 到各点的最短路 ( 对于无向图 , 即为最短链 ) 。例 11 用 Dijkst ra 方法求图 10 -19 所示的赋权图中 , 从 v1 到 v8 的最短路。解 这 里 只写 出 计算 的 最后 结 果 , 具 体 步 骤留给读者去完成。P( v1 ) = 0 ,P ( v4 ) = 1 ,P ( v3 ) = 3 ,P( v2 ) = 5 ,P( v5 ) = 6,P( v9 ) = 8 ,P( v7 ) = 9 ,P( v8 ) = 11。 λ( v4 ) = 1 ,P( v6 ) = 10 , λ( v1 ) = 0 ,λ( v2 ) λλ( v5 ) = 1 ,λ( v9 ) = 5 ,λ( v5 ) = 2 ,λ( v7 ) = 5 ,= 3 ,图 10 -19( v6 ) = 5 ,λ( v8 ) = 9 。这样从 v1 到 v8 的最短链为 ( v1 , v3 , v2 , v5 , v9 ,·562·v8 ) , 总权为 11。现在来证明 Dijkst ra 方法的正确性。只要证明对于每 一个点 v∈ Si , P( v) 是从 vs 到v 的最短路的权 , 即 d( vs , v) = P( v) 即可。对 i 施行归纳 , i = 0 时 , 结论显然正确。设对 i = n 时 , 结论 成立 , 即对 每一 个 v∈ Sn ,d( vs , v) = P( v) 。现在 考 查 i = n + 1 , 因 Sn + 1 = Sn ∪ { v jn } , 所 以 只 要 证 明 d( vs , v jn ) =P( vjn ) 。根据算法 , vjn是这时的具最小 T 标号的点 , 即Tn ( vjn ) = min| Svjn{ Tn ( vj ) }这里为了清晰起见 , 用 Tn ( v) 表示 当 i = n 执行步 骤③时点 v 的 T 标号。假设 H 是 D 中 任一条从 vs 到 v j | Sn , 那么 从 vs 出 发 , 沿 H 必存 在一条 弧 , 它 的始点属于 Sn , 而终点不属于 S n 。假设 ( vr , vl ) 是第一条这样的弧 ,的路 , 因为 vs ∈ Sn , 而 v jnnH = ( vs , … , vr , vl , … , vjn ) ,w( H ) = w( vs , … , vr ) + wrl + w( vl , … , vjn )由归纳假设 , P( vr ) 是从 vs 到 vr 的最短路的权 , 于是w( H ) ≥ P( vr ) + wrl + w( vl , … , vjn )根据方法中 T 标号的修改规则 , 因 vr ∈ Sn , vl | Sn , 故 P( vr ) + wrl ≥ Tn ( vl ) 。 而 Tn ( vl ) ≥ Tn ( vjn ) , 故w( H ) ≥ Tn ( vj( 因为所有的 wi j ≥0 , 故 w( vl , … , vjn ) + w( vl , … , vj n ) ≥0 ) 。n ) ≥ Tn ( vjn )这就证明了 Tn ( vjn ) 是从 vs 到 v jn的最短路的权 , 由方法 , P( vj n ) (cid:930) P( v jd( vs , vjn )n ) = Tn ( vjn ) , 这样就证明了Dijk st r a 算法只适 用 于 所 有 wi j ≥ 0 的 情 形 , 当 赋 权 有向图中存在负权时 , 则算法失效。例如在如 图 10 -20 所 示的赋权有向图中 , 如果用 Dijkst ra 方法 , 可得 出从 v1 到 v2 的最短路的权是 1 , 但这显然是不对的 , 因 为从 v1 到 v2 的最短路是 ( v1 , v3 , v2 ) , 权是 - 1 。现在介绍当赋权有向图 D 中 , 存 在具 负权的 弧时 , 求图 10 -20最短路的方法。为方便起见 , 不妨设从任一点 vi 到任一个点 v j 都有一 条弧 ( 如果在 D 中 , ( vi , vj ) |A , 则添加弧 ( vi , vj ) 。令 wi j = + ∞ ) 。显然 , 从 vs 到 v j 的最短路总是从 vs 出发 , 沿着一条路到 某个点 vi , 再沿 ( vi , vj ) 到 vj 的 ( 这里 vi 可以是 v s 本身 ) , 由本节开始时介绍的一个结论可知 , 从 vs 到 v i 的这条路必定 是从 vs 到 v i 的最短路 , 所以 d( vs , vj ) 必满足如下方程 :d( vs , vj ) = mi ni{ d( vs , vi ) + wi j }为了求得这个方程的解 d( vs , v1 ) , d( vs , v2 ) , … , d( vs , vp ) ( 这里 p = p( D) ) , 可用如 下递推公式 :开始时 , 令d( 1 ) ( vs , vj ) = ws j( j = 1 , 2 , … , p)对 t = 2 , … 3 ,d( t ) ( vs , vj ) = mini{ d( t - 1 ) ( vs , vi ) + wi j }·662·j = 1 , 2 , … , p若进行到某一步 , 例如第 k 步时 , 对所有 j = 1 , 2 , … , p , 有d( k) ( vs , v j ) = d( k - 1 ) ( vs , vj )则{ d( k) ( vs , vj )} j = 1 , 2 , … , p 即为 vs 到各点的最短路的权。例 12 求图 10 -21 所示赋权有向图中从 v1 到各点的最短路。 解 利用上述递推公式 , 求解结果如表 10 -1 所示 ( 表中未写数字的空格内是 + ∞ ) 。 可以看到 , 当 t = 4 时 , 对 所有 j = 1 , 2 , … , 8 , 有 d( t - 1 ) ( v1 , vj ) = d( t) ( v1 , vj ) , 于 是 表 中 最 后 一 列 0 , - 5 , - 2 , - 7 , - 3 , - 1 , - 5 , 6 就 分 别 是 从 v1 到 v1 , v2 , … , v8 的最短路的权。为了进一步求得从 vs 到 各点 的最短 路 , 可以 类似于 Dij kstr a 方法中 , 给每一个点以 λ值开始 ,λ( vs ) = 0 ,λ( vi ) = s ( i≠ s)图 10 -21在迭代过程中 , 如果 d( t ) ( vs , vj ) = min{ d( t - 1 ) ( vs , vi ) + wi j } = d( t - 1 ) ( vs , vi0 ) + wij0则把这时的 λ( vj ) 修改为 i0 。迭代终止时 , 根据各点的 λ值 , 可以得到 从 vs 到各点 的最短路。寻求最短路的另一个办法是在求出最短路 的权以 后 , 采用“ 反向追 踪”的 方法。比 如 已知 d( vs , vj ) , 则寻求一个 点 vk , 使 d( vs , vk ) + w k j = d ( vs , vj ) , 记 录 下 ( vk , vj ) , 再 考 查 d( vs , vk ) , 寻求一点 vi , 使 d( vs , vi ) + wi k = d( vs , vk ) , 如此等等 , 直至到达 vs 为止 , 于是 从 vs 到 v j 的最短路是 ( vs , … , vi , vk , vj ) 。表 10 -1wi jd( t ) ( v1 , vj )点v1v2v3v4v5v6v7v8t = 1t = 2t = 3t = 4v101230000v26021555v330512222v4023777v510133v61017111v710555v835066如例 3 , 由表 10 -1 已知 , d( v1 , v8 ) = 6 , 因 d( v1 , v6 ) + w6 8 = ( - 1) + 7 = d( v1 , v8 ) , 故记下 ( v6 , v8 ) 。·762·Ÿ+ (cid:25) (cid:25)»éÒE.¤Ë?0ü³Í(cid:18)(cid:19)^Ëü?0Í³)^@Ëü?³0(cid:18)(cid:19)^WË?0(cid:18)³^?0ü³)^@W?0³n)^W?0³(cid:18)^Wn0³)^因 d( v1 , v3 ) + w3 6 = d( v1 , v6 ) , 故记下 ( v3 , v6 ) 。 因 d( v1 , v7 ) + w7 3 = d( v1 , v3 ) , 从而从 v1 到 v8 的最短路是 ( v1 , v3 , v6 , v8 ) 。 定义 5 设 D 是赋权有向图 , C 是 D 中的 一个 回路 , 如果 C 的 权 w ( C) 小于零 , 则 称C 是 D 中的一个负回路。不难证明 : (1 ) 如果 D 是不含负回路的赋权 有向图 , 那 么 , 从 vs 到任 一个点 的最 短路必 可取 为初等路 , 从而最多包含 p - 2 个中间点 ;(2 ) 上述递推公式中的 d( t ) ( vs , vj ) 是在至 多包含 t - 1 个 中间点的 限制 条件下 , 从 vs到 v j 的最短路的权。由 (1 ) 、(2 ) 可知 : 当 D 中不含负回路时 , 上述算法最多经过 p - 1 次 迭代必定 收敛 , 即 对所有的 j = 1 , 2 , … , p , 均有 d( k) ( vs , v j ) = d( k - 1 ) ( vs , v j ) , 从而求出从 vs 到 各个顶点的 最 短路的权。如果经过 p - 1 次迭代 , 存在某个 j, 使 d( p ) ( vs , vj ) ≠ d( p - 1 ) ( vs , vj ) , 则说明 D 中含 有负回路。显然 , 这时从 vs 到 v j 的路的权是没有下界的。 为了加快收敛速度 , 可以利用如下的递推公式。d( 1 ) ( vs , v j ) = ws j( j = 1 , 2 , … , p)d( t) ( vs , vj ) = min mini < j{ d( t) ( vs , v j ) + wi, min i≥ j{ d( t - 1 ) ( vs , vi ) + wi j }}( j = 1 , 2 , … , p) , ( t = 2 , 3 , … )J. Y. Yen 提出一个改进的递推算法 :d( 1 ) ( vs , vj ) = ws jj = 1 , 2 , … , p对 t = 2 , 4 , 6 , … , 按 j = 1 , 2 , … , p 的顺序计算 :d( t) ( vs , v j ) = min d( t - 1 ) ( vs , vj ) , mini < j{ d( t ) ( vs , vi ) + wi j }对 t = 3 , 5 , 7 , … , 按 j = p, p - 1 , … , 1 的顺序计算 :d( t) ( vs , v j ) = min d( t - 1 ) ( vs , vj ) , mini > j{ d( t ) ( vs , vi ) + wi j }同样地 , 当对所有的 j = 1 , 2 , … , pd( k) ( vs , v j ) = d( k - 1 ) ( vs , vj )时 , 算法终止。3. 3 应用举例例 13 设备更新问题。某企业 使用 一台 设备 , 在 每年 年 初 , 企业 领导 部 门就 要决 定 是购置新的 , 还是继续使用旧的。若购置新设 备 , 就要 支付 一定的 购置 费用 ; 若继 续使 用 旧设备 , 则需支付一定的维修费用。现在的问 题是如 何制 定一 个几年 之内 的设备 更新 计 划 , 使得总的支付费用最少。我们用一个五年之内要更新某种设备的计划为例 , 若已知该 种设备在各年年初的价格为 :第 1 年第 2 年第 3 年第 4 年第 5 年1111121213·862·½C<5.还已知使用不同时间 ( 年 ) 的设备所需要的维修费用为 :使用年数0～11～22～33～44～5维修费用5681118可供选择的设备更新方案显然是很多的。例如 , 每年都购置一台新设备 , 则其购置费 用为 11 + 11 + 12 + 12 + 13 = 59 , 而每 年支付 的维 修费 用为 5 , 五 年合 计为 25 。于 是五 年 总的支付费用为 59 + 25 = 84。又如决定在第一、三、五年各购进一台 , 这 个方 案的 设备 购 置费 为 11 + 12 + 13 = 36 ,维修费为 5 + 6 + 5 + 6 + 5 = 27。五年总的支付费用为 63 。如何制定使得总的支付费用最少的设备更新计划呢 ? 可以把这个问题化为最短路问题 , 见图 10 -22 。图 10 -22用点 vi 代表“ 第 i 年年初 购进 一 台新 设备”这种 状态 ( 加 设一 点 v6 , 可 以理 解为 第 5 年年底 ) 。从 vi 到 v i + 1 , … , v6 各画一条弧。弧 ( vi , vj ) 表示在第 i 年年初购进 的设备一 直 使用到第 j 年年初 ( 即第 j - 1 年底 ) 。每条弧的权可按已知 资料 计 算出 来。 例如 , ( v1 , v4 ) 是 第 1 年 年 初 购进 一 台新 设 备 ( 支付购置费 11) , 一直使用到第 3 年年底 ( 支付 维修 费 5 + 6 + 8 = 19 ) , 故 ( v1 , v4 ) 上的 权 为 30。这样一来 , 制定一个最优的设 备更新 计划 问题 就等价 于寻 求从 v1 到 v6 的最 短路 的问题。按求解最短路的计算方法 , { v1 , v3 , v6 }及{ v1 , v4 , v6 }均为最短路 , 即有两个最 优方案。 一个方案是在第 1 年、第 3 年各购置一台新 设备 ; 另一 个方 案是在 第 1 年、第 4 年 各购 置 一台新设备。五年总的支付费用均为 53。第 4 节 网络最大流问题许多系统包含了流量问题。例如 , 公路系 统中 有车辆 流 , 控制 系统 中有信 息流 , 供 水系统中有水流 , 金融系统中有现金流等。图 10 -23 是联结某产品产地 v1 和销地 v6 的交通网, 每一弧( vi , vj ) 代表从 vi 到 vj 的运 输线 , 产品经这条弧由 vi 输送到 vj , 弧旁的数字表示这条运输线的最大通过能力。产品经·962·Ø,Ö†‚X=ç“¨过交通网从 v1 输送到 v6 。现在要求制定一个运输方案使从 v1 运到 v6 的产品数量最多。图 10 -24 给出了一个运输方案 , 每条弧旁的数字表示在这个方案中 , 每条运输线上的 运输数量。这个方案使 8 个单位的产品从 v1 运到 v6 , 在这个交通网上输送量是否还可以 增多 , 或者说这个运输网络中 , 从 v1 到 v6 的最大输送量是多少呢 ? 本节就是 要研究类 似 这样的问题。图 10 -23图 10 -244. 1 基本概念与基本定理1. 网络与流定义 6 给一个有向图 D = ( V , A) , 在 V 中指定了一点称为发点 ( 记 为 vs ) , 而另一点 称为收点 ( 记为 vt ) , 其余的点叫中间点。对于每一个弧( vi , vj ) ∈ A, 对应有一个 c( vi , vj ) ≥0 ( 或简写为 ci j ) , 称为弧的容量。通常我们就把这样的 D 叫作一个网络。记作D = ( V , A, C)所谓网络上的流 , 是指定义在弧集合 A 上的一个函数 f = { f ( vi , vj )} , 并称 f ( vi , vj )为弧 ( vi , vj ) 上的流量 ( 有时也简记作 f i j ) 。例如图 10 -23 就是一个网络 , 指定 v1 是发点 , v6 是收点 , 其他的点是中间点。弧旁的数字为 ci j 。图 10 -24 所示的运输方案 , 就可看作是这个网络上的一个流 , 每个弧上的运输量就是该弧上的流量 , 即 f12 = 5 ,f24 = 2 ,f1 3 = 3 ,f34 = 1 等。2. 可行流与最大流在运输网络的实际问题中可以看出 , 对于流有两个明显的要求 : 一是每个弧上的流量 不能超过该弧的最大通过能力 ( 即弧的容量 ) ; 二是中间点的流量为零。因为对于每个点 , 运出这点的产品总量与运进这点的产品总量之差 , 是这点的净输出量 , 简称为是这一点的 流量 ; 由于中间点只起转运作用 , 所以中间点的流量必为零。易见发点的净流出量和收点 的净流入量必相等 , 也是这个方案的总输送量。因此有 :定义 7 满足下述条件的流 f 称为可行流 : (1 ) 容量限制条件 : 对每一弧 ( vi , vj ) ∈ A 0≤ f ij ≤ ci j(2 ) 平衡条件 : 对于中间点 : 流出量等于流入量 , 即对每个 i( i≠ s, t) 有·072·( v∑) ∈ A, vjf i j- ∑) ∈ A, v( vjif j i = 0对于发点 vs , 记( v∑) ∈ A, vsjf s j∑ s∑ sf j s = v( f )对于收点 vt , 记( v∑) ∈ A, vjf t j∑ t∑ tf jt = - v( f )式中 v( f ) 称为这个可行流的流量 , 即发点的净输出量 ( 或收点的净输入量 ) 。 可行流总是存在的。比 如令 所有 弧的 流 量 f i j = 0 , 就 得到 一个 可行 流 ( 称 为 零流 ) 。其流量 v( f ) = 0 。最大流问题就是求一个流{ f i j }使其流量 v( f ) 达到最大 , 并且满足 :0≤ f i∑ f ij ≤ ci j∑ f j i =v( f )0( vt , vj ) ∈ A ( i = s) ( i ≠ s, t)①②v( f ) 最大流问题是一个特 殊的 线 性规 划 问题。 即 求一 组 { f i j } , 在 满足 条 件 ①和 ② 下 使 v( f ) 达到极大。将会看到利用图的特点 , 解决这个问 题的方 法较之线 性规 划的一 般方 法 要方便、直观得多。 ( i = t)3. 增广链若给一个可行流 f = { f i j } , 我们把网络 中使 f i j = ci j 的弧称 为饱 和弧 , 使 f i j < ci j 的弧称为非饱和弧。使 f i j = 0 的弧称为零流弧 , 使 f i j > 0 的弧称为非零流弧。在图 10 -24 中 , ( v5 , v4 ) 是饱和弧 , 其他的弧为非饱和弧。所有弧都是非零流弧。 若 μ是网络中联结发点 vs 和收点 v t 的一条链 , 我们定义链的方向是从 vs 到 v t , 则链 上的弧被分为两类 : 一 类是 弧的 方向 与链 的 方向 一致 , 叫 做 前向 弧。前 向弧 的 全体 记 为 μ+ 。另一类弧与链的方向相反 , 称为后向弧。后向弧的全体记为 μ- 。图 10 -23 中 , 在链μ= ( v1 , v2 , v3 , v4 , v5 , v6 ) 上μ+ = {( v1 , v2 ) , ( v2 , v3 ) , ( v3 , v4 ) , ( v5 , v6 ) } μ- = {( v5 , v4 )}定义 8 设 f 是 一 个可 行流 , μ是从 vs 到 v t 的 一 条链 , 若 μ满 足下 列条 件 , 称 之 为( 关于可行流 f 的 ) 增广链。在弧 ( vi , vj ) ∈μ+ 上 , 0≤ f i 在弧 ( vi , vj ) ∈μ- 上 , 0 < f i 图 10 -24 中 , 链 μ= ( v1 , v2 , v3 , v4 , v5 , v6 ) 是一条增广链。因为 μ+ 和 μ- 中的弧满足增j < ci j , 即 μ+ 中每一弧是非饱和弧。 j ≤ ci j , 即 μ- 中每一弧是非零流弧。广链的条件。比如 :( v1 , v2 ) ∈μ+ , ( v5 , v4 ) ∈μ-,f 12 = 5 < c12 = 10f 54 = 3 > 04. 截集与截量设 S , T V , S∩ T =, 我们把始点在 S 中 , 终点在 T 中的所 有弧 构成 的集合 , 记 为·172·( S, T ) 。定义 9 给 网 络 D = ( V , A, C) , 若 点 集 V 被 剖 分 为 两 个 非 空 集 合 V1 和 V1 , 使vs ∈ V1 , vt ∈ V1 , 则把弧集 ( V1 , V1 ) 称为是 ( 分离 vs 和 v t 的 ) 截集。显然 , 若把某一截集的弧从网络中丢去 , 则从 vs 到 v t 便不 存在路。 所以 , 直观 上说 ,截集是从 vs 到 v t 的必经之道。定义 10 给一截集 ( V1 , V1 ) , 把截 集 ( V1 , V 1 ) 中 所 有弧 的容 量之 和称 为 这个 截集 的容量 ( 简称为截量 ) , 记为 c( V1 , V1 ) , 即c( V1 , V 1 ) = ∑ci j( v, v) ∈ ( V1, V1)不难证明 , 任何一个可行流的流量 v( f ) 都不会超过任一截集的容量。即v( f ) ≤ c( V1 , V1 )显然 , 若对于一个可行流 f * , 网络中有一个 截集 ( V *1, V *1 ) , 使 v( f * ) = c( V *1则 f * 必是最大流 , 而 ( V *1, V *1 ) 必定是 D 的所有截集中 , 容量最小的一个 , 即最小截集。定理 8 可行流 f * 是最大流 , 当且仅当不存在关于 f * 的增广链。 证明 若 f * 是最大流 , 设 D 中存在关于 f * 的增广链 μ, 令 θ= mi n min( ci j - f *f *i j ) , minjiμ+μ-由增广链的定义 , 可知 θ> 0 , 令f *ij =f * i j + θ ( vi , v j ) ∈μ+ i j - θ ( vi , v j ) ∈μ- f * f * ( vi , v j ) | μi j不难验证{ f * 设矛盾。j } 是一个可行流 , 且 v( f * * ) = v( f * ) +θ> v ( f * ) 。这与 f * 是最大 流的 假现在设 D 中不存在关于 f * 的增广链, 证明 f * 是最大流。我们利用下面的方法来定义 V * 令 vs ∈ V * 若 vi ∈ V * 若 vi ∈ V *1, 且 f * i j < ci j , 则令 vj ∈ V * 则令 vj ∈ V * , 且 f j i > 0 , 因为不存在关于 f * 的增广链 , 故 vt | V *11111 。记 V *1 = V \ V *1, 于是得到一个截集 ( V *1, V *1 ) 。显然必有f *ij =ci j0( vi , v j ) ∈ ( V *( vi , v j ) ∈ ( V *11, V *1 ), V *1 )所以 v( f * ) = c( V *1, V *1 ) 。于是 f * 必是最大流。定理得证。由上述证明中可见 , 若 f * 是最大流 , 则网络中必存在一个截集 ( V *1, V *1 ) , 使v( f * ) = C( V *1, V *1 )于是有如下重要的结论 :最大流量最小截量定理 : 任一个网络 D 中 , 从 vs 到 v t 的最大 流的 流量等 于分 离 vs ,vt 的最小截集的容量。定理 8 为我们提供了寻求网络 中最 大流的 一个 方法。若 给了 一个可 行流 f , 只要 判 断 D 中有无关于 f 的增广链。如果有增广链 , 则可以按定理 8 前半部证明中的办法 , 改进 ·272·, V *1 ) ,1:f , 得到一个流量增大的新的可行流。如果没有增广链, 则得到最大流。而利用定理 8 后半 部证明中定义 V *1 来判断 D 中有无关于 f 的增广链。 1 。在 标号过程 中 , 有标号 的顶点 表示 是 V * 1 中的点。一旦 vt 有了标 号 , 就表明找 到一条增 广 链 ; 如果标号过程进行 不 下去 , 而 vt 尚未 标 号 , 则 说 明不 存 在增 广 链 , 于 是得 到 最 大流。 而且同时也得到一个最小截集。1 的办法, 可以根据 vt 是否属于 V * 实际计算时 , 用给顶点标号的方法来定义 V *1 中的点 , 没有标号的点表示不是 V *4. 2 寻求最大流的标号法从一个可行流出发 ( 若网络中没有给定 f , 则可以设 f 是零流 ) , 经过标号过程与调 整过程。1. 标号过程在这个过程中 , 网络中的点或者是标号点 ( 又分为已检查和未检查两种 ) , 或者是未标 号点。每个标号点的标号包含两部分 : 第一个标号表明它的标号是从哪一点得到的 , 以便 找出增广链 ; 第二个标号是为确定增广链的调整量 θ用的。标号过程开始 , 总先给 vs 标上 ( 0 , + ∞ ) , 这 时 vs 是标 号 而未 检查 的点 , 其余 都是 未标号点。一般地 , 取一个标号而未检查的点 vi , 对一切未标号点 vj :(1 ) 若在弧 ( vi , vj )上 , f i j < ci j , 则 给 vj 标号 ( vi , l( vj ) ) 。这里 l( vj ) = min [ l( vi ) , ci j -f i j ] 。这时点 vj 成为标号而未检查的点。(2 ) 若在弧 ( vj , vi ) 上 , f j i > 0 , 则 给 vj 标 号 ( - vi , l ( v j ) ) , 这 里 l( vj ) = min [ l( vi ) ,f j i ] 。这时点 v j 成为标号而未检查的点。于是 vi 成为标号而已检查过的点。重复上述 步骤 , 一旦 vt 被 标上 号 , 表明得 到一 条从 vs 到 v t 的增广链 μ, 转入调整过程。若所有标号都是已检查过的 , 而标号过程 进行 不下去 时 , 则算 法结 束 , 这时的 可行 流就是最大流。2. 调整过程首先按 vt 及其他点的第一个标号 , 利用“ 反向追踪”的办法 , 找出增广链 μ。例如设 vt 的第一个标号为 vk ( 或 - vk ) , 则弧 ( vk , vt ) ( 或相应地 ( vt , vk ) ) 是 μ上的弧。接下来检查 vk 的第一个标号 , 若为 vi ( 或 - vi ) , 则找 出 ( vi , vk ) ( 或 相应地 ( vk , vi ) ) 。再 检查 vi 的 第一 个 标号 , 依此下去 , 直到 vs 为止。这时被找出的弧就构成了增广链 μ。令调整量 θ是 l ( vt ) , 即 vt 的第二个标号。令f′i j =f if if ij +θ ( vi , vj ) ∈μ+ j - θ ( vi , vj ) ∈μ- ( vi , vj ) | μj去掉所有的标号 , 对新的可行流 f′= { f′i j } , 重新进入标号过程。例 14 用标号法求图 10 -25 所示网络的最大流。弧旁的数是 ( ci j , f i 解 (1 ) 标号过程 ① 首先给 vs 标上 (0 , + ∞ )j ) 。·372·图 10 -25② 检查 vs , 在弧 ( vs , v2 ) 上 ,fs2 = cs2 = 3 , 不 满 足 标 号 条 件。 弧 ( vs , v1 ) 上 , f s1 = 1 ,cs1 = 5 , f s1 < cs1 , 则 v1 的标号为 ( vs , l( v1 ) ) , 其中l( v1 ) = mi n[ l( vs ) , ( cs1 - f s1 ) ] = min [ + ∞ , 5 - 1 ] = 4③ 检查 v1 , 在弧 ( v1 , v3 ) 上 , f 13 = 2 , c13 = 2 , 不满足标号条件。 在弧 ( v2 , v1 ) 上 , f21 = 1 > 0 , 则给 v2 记下标号为 ( - v1 , l( v2 ) ) , 这里l( v2 ) = min [ l( v1 ) , f2 1 ] = min [4 , 1 ] = 1 ④ 检查 v2 , 在弧 ( v2 , v4 ) 上 , f 21 = 3 , c24 = 4 , f2 4 < c24 , 则给 v4 标号 ( v2 , l( v4 ) ) , 这里l( v4 ) = min [ l( v2 ) , ( c24 - 在弧 ( v3 , v2 ) 上 , f32 = 1 > 0 , 给 v3 标号 : ( - v2 , l( v3 ) ) , 这里f24 ) ] = mi n [1 , 1 ] = 1l( v3 ) = min [ l( v2 ) , f3 2 ] = min [1 , 1 ] = 1⑤ 在 v3 , v4 中任选一个进行检查。例如 在弧 ( v3 , vt ) 上 , f3 t = 1 , c3 t = 2 , f3 t < c3 t , 给 vt 标号为 ( v3 , l( vt ) ) , 这里l( vt ) = min [ l( v3 ) , ( c3 t - f3 t ) ] = min [ 1 , 1] = 1因 vt 有了标号 , 故转入调整过程。(2 ) 调整过程 按点的第一个标号找到一条增广链 , 如图 10 -26 中双箭头线表示。图 10 -26易见μ+ = { ( vs , v1 ) , ( v3 , vt ) }μ- = { ( v2 , v1 ) , ( v3 , v2 ) }按 θ= 1 在 μ上调整 f 。μ+ 上 :f s1 +θ= 1 + 1 = 2f3 t +θ= 1 + 1 = 2μ- 上 :f2 1 - θ= 1 - 1 = 0f3 2 - θ= 1 - 1 = 0其余的 f i j 不变。·472·调整后得如图 10 -27 所示的可行流 , 对这个可行流进入标号过程 , 寻找增广链。图 10 -27开始给 vs 标以 (0 , + ∞) , 于是检查 vs , 给 v1 标以( vs , 3) , 检查 v1 , 弧 ( v1 , v3 ) 上, f13 = c13 ,弧 ( v2 , v1 ) 上 , f21 = 0 , 均不符号条件 , 标号过程无法继续下去 , 算法结束。这时的可行流 ( 图 10 -27 ) 即为所求最大流。最大流量为v( f ) = f s1 + f s2 = f4 t + f3 t = 5与此同时可找到最小截集 ( V 1 , V 1 ) , 其中 V1 为标号点 集合 , V1 为 未标号 点集合。 弧集合 ( V 1 , V 1 ) 即为最小截集。上例中 , V 1 = { vs , v1 } , V1 = { v2 , v3 , v4 , vt } , 于是 ( V 1 , V1 ) = { ( vs , v2 ) , ( v1 , v3 ) }是 最小截集 , 它的容量也是 5。由上述可见 , 用标号法找增广链以求最大流的结果 , 同时得到一个最小截集。最小截 集容量的大小影响总的输送量的提高。因此 , 为提高总的输送量 , 必须首先考虑改善最小 截集中各弧的输送状况 , 提高它们的通过能力。另一方面 , 一旦最小截集中弧的通过能力 被降低 , 就会使总的输送量减少。第 5 节 最小费用最大流问题上一节讨论了寻求网络中的最大流问题。在实际生活中 , 涉及“ 流”的问题时 , 人们考 虑的还不只是流量 , 而且还有“ 费用”的因素 , 本节介绍的最小费用最大流问题就是这类问 题之一。给网络 D = ( V , A , C) , 每一弧 ( vi , vj ) ∈ A 上 , 除了已给容量 ci j 外 , 还给了一个单位流 量的费用 b( vi , vj ) ≥0 ( 简记为 bi j ) 。所谓最小费用最大流问题就是要求一个最大流 f , 使 流的总输送费用b( f ) = ∑( v, v) ∈ Abi j f i j取极小值。下面介绍解决这个问题的一种方法。从上节可知 , 寻求最大流的方法是从某个可行流出发 , 找到关于这个流的一条增广链 μ。沿着 μ调整 f , 对新的可行流试图寻 求关于 它的 增广 链 , 如此反 复直 至最大 流。现 在 要寻求最小费用的最大流 , 首先考查一下 , 当沿着一 条关于 可行流 f 的增 广链 μ, 以 θ= 1 调整 f , 得到新的可行流 f′时 ( 显然 v( f′) = v( f ) + 1) , b( f′) 比 b( f ) 增加多少 ? 不难看出·572·b( f′) - b( f ) = [ ∑μ+bi j ( f′i j -f ij ) - ∑μ-bi j ( f′i j - f i j ) ]= ∑μ+bi j - ∑μ-bi我们把 ∑ 可以证明 , 若 f 是流量为 v ( f ) 的所有可行 流中费用 最小者 , 而 μ是 关于 f 的 所有 增 广链中费用最小的增广链, 那么沿 μ去调整 f , 得到的可行流 f′, 就是流量为 v( f′)的所有可 行流中的最小费用流。这样 , 当 f′是最大流时, 它也就是所要求的最小费用最大流了。j - ∑bi j 称为这条增广链 μ的“费用”。biμ+μ-注意到, 由于 bi j ≥0 , 所以 f = 0 必是流量为 0 的最小费用流。这样 , 总可以从 f = 0 开 始。一般地 , 设已知 f 是流量 v( f ) 的最小费用流, 余下的问题就是如何去寻求关于 f 的最 小费用增广链。为此 , 可构造一个赋权有向图 W ( f ) , 它 的顶点是原网络 D 的 顶点, 而把 D 中的每一条弧( vi , vj ) 变成两个相反方向的弧 ( vi , vj ) 和 ( vj , vi )。定义 W( f ) 中弧的权 wi j 为 :若 f i 若 f i j = ci j 若 f i j > 0 若 f i j = 0bi + ∞j < ci jjwi j =bi j + ∞ ( 长度为 + ∞的弧可以从 W ( f ) 中略去 ) 于是在网络 D 中寻求关于 f 的最小费用增 广链就 等价于在 赋权有向 图 W ( f ) 中 , 寻 wj i =求从 vs 到 v t 的最短路。因此有如下算法 :开始取 f ( 0 ) = 0 , 一般情况下若在第 k - 1 步得 到最小 费用 流 f ( k - 1 ) , 则 构造赋 权有 向 图 W ( f ( k - 1 ) ) , 在 W ( f ( k - 1 ) ) 中 , 寻求 从 vs 到 v t 的最 短路。若 不存 在最短 路 ( 即最 短路 权 是 + ∞ ) , 则 f ( k - 1 ) 就是最小费用最大流 ; 若存在最短路 , 则在原网络 D 中得到相应的增 广 链μ, 在增广链 μ上对 f ( k - 1 ) 进行调整。调整量为 :θ= min[ minμ+( ci j - f ( k - 1 )i j) , min μ-( f ( k - 1 )ij) ]令f ( k) i j =f ( k - 1 ) f ( k - 1 ) f ( k - 1 )ijijij+θ ( vi , vj ) ∈μ+ - θ ( vi , vj ) ∈μ-( vi , vj ) | μ得到新的可行流 f ( k) , 再对 f ( k) 重复上述步骤。例 15 以图 10 -28 为例 , 求最小费用最大流。弧旁数字为 ( bi j , ci j ) 。图 10 -28(1 ) 取 f ( 0 ) = 0 为初始可行流。 (2 ) 构 造 赋 权 有 向 图 W ( f ( 0 ) ) , 并 求 出 从 vs 到 v t 的 最 短 路 ( vs , v2 , v1 , vt ) , 如·672·图 10 -29( a ) ( 双箭头即为最短路 ) 。(3 ) 在原网络 D 中 , 与这条最短路相应的增广链为 μ= ( vs , v2 , v1 , vt ) 。 (4 ) 在 μ上进行调整 ,θ= 5 , 得 f ( 1 ) ( 图 10 -29 ( b ) ) 。按照 上 述算 法依 次得 f ( 1 ) , f ( 2 ) , f ( 3 ) , f ( 4 ) , 流量依次为 5 , 7 , 10 , 11 ; 构造相应的赋 权有向 图为 W ( f ( 1 ) ) , W ( f ( 2 ) ) , W ( f ( 3 ) ) , W ( f ( 4 ) ) , 见图 10 -29。图 10 -29注意到 W ( f ( 4 ) ) 中已不存在从 vs 到 v t 的最短路 , 所以 f ( 4 ) 为最小费用最大流。第 6 节 中国邮递员问题在本章开始提到的邮递员问题 , 若把它抽 象为 图的语 言 , 就是 给定 一个连 通图 , 在 每边 ei 上赋予一个非负的权 w ( ei ) , 要求一个 圈 ( 未 必是 简单的 ) , 过 每边 至少一 次 , 并使 圈的总权最小。这个问题是我国学者管梅谷在 1962 年首先提出的 , 因此在国际上通称为中·772·国邮递员问题。6. 1 一笔画问题给定一个连通多重图 G, 若存 在一 条 链 , 过 每 边一 次 , 且 仅 一次 , 则称 这 条 链为 欧 拉 链。若存在一个简单圈 , 过每边一次 , 且仅一次 , 称这个圈为欧拉圈。一个图若有欧拉圈 , 则称为欧拉图。显然 , 一个图若能一笔画出 , 这个图必是欧拉图 ( 出发点与终止点重合 ) 或 含有欧拉链 ( 出发点与终止点不同 ) 。定理 9 连通多重图 G 有欧拉圈 , 当且仅当 G 中无奇点。 证明 必要性是显然的 , 只证明充分性。不妨设 G 至少有三个点, 对边数 q( G) 进行数 学归纳, 因 G 是连通图, 不含奇点 , 故 q( G) ≥ 3。首 先 q( G) = 3 时, G 显然是 欧拉图。考查 q( G) = n + 1的情况, 因 G 是不 含 奇点 的连 通 图, 并 且 p( G) ≥ 3 , 故 存 在三 个 点 u, v, w, 使 [ u, v] , [ w, v] ∈ E。从 G 中丢去边 [ u, v] , [ w, v] , 增加新边 [ u, w] , 得到新的多重图 G′。 G′有 q( G) - 1 条边, 并且仍不含奇点 , G′至多有两个分图。若 G′是连通的, 那么根据归纳假设, G′ 有欧拉圈 C′。把 C′中的[ w, u] 这一条边换成 [ w, v] , [ v, u] , 即得 G 中的欧拉圈。现设 G′有 两个分图 G1 , G2 。设 v 在 G1 中。根据归纳假设, G1 , G2 分别有欧拉圈 C1 , C2 , 则把 C2 中的 [ u, w] 这条边换成[ u, v] , C1 及 [ v, w] , 即得 G 的欧拉圈。推论 连通多重图 G 有欧拉链 , 当且仅当 G 恰有两个奇点。 证明 必要性是显然的。现设连通多重图 G 恰有两个奇点 u , v。在 G 中增加一个新 边 [ u, v] ( 如果在 G 中 , u, v 之间就有边 , 那么这个新边是原有边上的重复边 ) , 得连通多重 图 G′, 易见 G′中无奇点。由定理 3 , G′有 欧拉 圈 C′, 从 C′中丢去 增加 的那 个 新边 [ u, v] , 即得 G 中的一条联结 u , v 的欧拉链。上述定理和推论为我们提供了识别一个图能否是一笔画的简单办法。如前面提到的七桥问题 , 因为图 10 -1( b) 中有 4 个奇点。所以不能一笔画出。 也就是 说 , 七 桥问题的 回 答是否定的。如图 10 -30。它有两个奇点 v2 和 v5 , 因此可 以从点 v2 开始 , 用 一笔画到 点 v5 终止。图 10 -30现在的问题是 : 如果我们已经知道图 G 是可以 一笔画的 , 怎么 样把它 一笔画出 来呢 ? 也就是说 , 怎么找出它的欧拉圈 ( 这时 G 无奇点 ) 或欧拉链 ( 这时 G 恰有 两个奇点 ) 呢 ? 下 面简单地介绍由 Fleury 提供的方法。为此 , 首先介绍割边的概念。设 e 是连 通图 G 的一 个边 , 如果 从 G 中丢去 e, 图就 不连通了 , 则称 e 是图 G 的割边。例如 , 图 10 -10( b) 中 , [ v1 , v2 ] 是 割边 ; 树中的 每一个边 都是割边。·872·设 G = ( V , E) 是无奇点的连通图 , 以μk = ( vi2 , … , vi0 , ei1 , vi 记在第 k 步得到的简单链。记 Ek = { ei k = 0 时 , 令 μ0 = ( vi Gk 中选 v i 点 , 这时 vik - 1 , ei2 , vi 2 , … , ei1 , eik )k , vik } , Ek = E \ Ek , 以 及 Gk = ( V , Ek ) ( 开 始 ; G0 = G) 。进行第 ( k + 1) 步 : 在 是 Gk 的悬 挂1 , ei0 ) , 这里 vi是图 G 的 任意一点 , E0 = k+ 1 ] , 使 ei0不 是 Gk 的 割边 ( 除非 vi的一条关联边 e i k + 1 = [ vi 在 Gk 中的悬挂边选为 eik , vi k + 1 ) 。令 2 , vikkk + 1k2 , … , vi 重复这个过程 , 直到选不到所要求的边为止。可以证明 : 这时的简单链必定终止于 vi 0 , 并 且就是我们要求的图 G 的欧拉圈。μk + 1 = ( vi0 , ei1 , ei1 , vik - 1 , eik , vik + 1 , vik , eik + 1 )如果 G= ( V , E) 是恰有两个奇点的连通图。只需 要取 vi 0 是图 G 的一个 奇点就可 以了。最终得到的简单链就是图中联结两个奇点的欧拉链。6. 2 奇偶点图上作业法根据上面的讨论 , 如果在某邮递员所负责 的范 围内 , 街 道图中 没有 奇点 , 那么 他就 可 以从邮局出发 , 走过每条街道一次 , 且仅一次 , 最后回到邮局 , 这样他所走的路程也就是最 短的路程。对于有奇点的街道图 , 就必须在某些街道上重复走一次或多次。例如图 10 -30 的街道图中 , 若 v1 是邮局 , 邮递员可以按如下的路线投递信件 : v1 → v2 → v4 → v3 → v2 → v4 → v6 → v5 → v4 → v6 → v5 → v3 → v1 , 总权为 12。 也可按另一条路线走 : v1 → v2 → v3 → v2 → v4 → v5 → v6 → v4 → v3 → v5 → v3 → v1 , 总权为 11。 可见 , 按第一条路线走 , 在边 [ v2 , v4 ] , [ v4 , v6 ] , [ v6 , v5 ] 上各重复走了一次。而按第 二条路线走 , 在边 [ v3 , v2 ] , [ v3 , v5 ] 上各重复走了一次。如果在某条路线中 , 边 [ vi , vj ] 上 重复 走了几 次 , 我们 在图 中 vi , vj 之间 增 加几 条边 , 令每条边的权和原来的权相等 , 并把新增加的边 , 称为重复边。于是这条路线就是相应的 新图中的欧拉圈。例 如在 图 10 -30 中 , 上 面 提到 的 两 条 投递 路 线 分 别 是图 10 -31 ( a ) 和 ( b ) 中的欧拉圈。图 10 -31显然 , 两条邮递路线的总权的差必等于相应的重复边总权的差。因而 , 中国邮递员问 题可以叙述为在一个有奇点的图中 , 要求增 加一些 重复 边 , 使新图 不含 奇点 , 并且 重复 边 的总权为最小。我们把使新图不含奇点而增加的重复边 , 简称为可行 ( 重复边 ) 方案 , 使总权最小的可行方案称为最优方案。·972·现在的问题是第一个可行方案如何确定 , 在确定一个可行方案后 , 怎么判断这个方案是否为最优方案 ? 若不是最优方案 , 如何调整这个方案 ?1. 第一个可行方案的确定方法在第 1 节中 , 我们已经证明 , 在任何一个 图中 , 奇点 个数 必为 偶数。所 以如果 图中 有 奇点 , 就可以把它们配成对。又因为图是连通的 , 故每一对奇点之间必有一条链 , 我们把这 条链的所有边作为重复边加到图中去 , 可见新图中必无奇点, 这就给出了第一个可行方案。 例 16 图 10 -32 中的街道图 , 有四个奇点 , v2 , v4 , v6 , v8 , 将 其分成两 对 , 比如说 v2 与v4 为一对 , v6 与 v8 为一对。在图 10 -32 中 , 连接 v2 与 v4 的链 有好 几 条 , 任取 一 条 , 例 如 取链 ( v2 , v1 , v8 , v7 , v6 , v5 , v4 ) 。把边 [ v2 , v1 ] , [ v1 , v8 ] , [ v8 , v7 ] , [ v7 , v6 ] , [ v6 , v5 ] , [ v5 , v4 ] 作 为重 复 边加 到图 中 去 , 同样地 取 v6 与 v8 之 间 的一 条 链 ( v8 , v1 , v2 , v3 , v4 , v5 , v6 ) , 把 边 [ v8 , v1 ] , [ v1 , v2 ] , [ v2 , v3 ] , [ v3 , v4 ] , [ v4 , v5 ] , [ v5 , v6 ] 也作为重复边加到图中去 , 于是得图 10 -33。图 10 -32图 10 -33在图 10 -33 中 , 没有奇点 , 对应于这个可行方案 , 重复边总权为 :2 w12 + w23 + w3 4 + 2 w45 + 2 w56 + w67 + w78 + 2 w18 = 512. 调整可行方案 , 使重复边总权下降首先 , 从图 10 -33 中可以看出 , 在边 [ v1 , v2 ] 上有两条重复边 , 如 果把它们 都从图中 去 掉 , 图仍然无奇点。即剩 下的 重复 边 还是 一个 可行 方案 , 而总 长度 却 有 所下 降。同 样 道 理 , [ v1 , v8 ] , [ v4 , v5 ] , [ v5 , v6 ] 上的重复边也是如此。一般情况下 , 若边 [ vi , vj ] 上有两条或两条 以上的 重复边时 , 从中 去掉偶 数条 , 就能 得到一个总权较小的可行方案。因而有(1 ) 在最优方案中 , 图的每一边上最多有一条重复边。 依此 , 图 10 -33 可以调整为图 10 -34 , 重复边总权下降为 21。 其次 , 我们还可以看到 , 如果把图中某个圈上 的重 复边 去掉 , 而给 原来 没有重 复边 的 边加上重复边 , 图中仍没有奇点。因而如果在 某个圈 上重 复边 的总权 大于 这个圈 的总 权 的一半 , 像上面所说的那样作一次调整 , 将会得到一个总权下降的可行方案。(2 ) 在最优方案中 , 图中每个圈上的重复边的总权不大于该圈总权的一半。 如在图 10 -34 中 , 圈 ( v2 , v3 , v4 , v9 , v2 ) 的 总权为 24 , 但 圈上 重复 边总权 为 14 , 大于 该·082·圈总权的一半。因此可以作一次调整 , 以 [ v2 , v9 ] , [ v9 , v4 ] 上 的重 复边 代替 [ v2 , v3 ] , [ v3 , v4 ] 上的重复边 , 使重复边总权下降为 17 , 如图 10 -35。图 10 -34图 10 -353. 判断最优方案的标准从上面的分析中可知 , 一个最优方案一定 是满足 ( 1) 和 ( 2) 的可 行方 案 , 反之 , 可以 证 明一个可行方案若满足 (1 ) 和 ( 2) , 则这个 可行方 案一定 是最 优方 案。根据 这样的 判断 标 准 , 对给定的可行方案 , 检查它是否满足条件 (1 ) 和 ( 2) 。若满足 , 所得方案即为最优方案 ; 若不满足 , 则对方案进行调整 , 直至条件 (1 ) 和 ( 2) 均得到满足时为止。检查图 10 -35 中的圈 ( v1 , v2 , v9 , v6 , v7 , v8 , v1 ) , 它的重 复边 总权 为 13 , 而圈的 总权 为24 , 不满足条件 ( 2) , 经调整得图 10 -36 。重复边总权下降为 15。检查图 10 -36 , 条件 (1 ) 和 ( 2) 均 满足。于 是得 最 优方案 , 图 10 -36 中的任一个欧拉圈就是邮递员的 最 优邮递路线。图 10 -36以上所说的求最优邮递路线的方法 , 通常称为 奇 偶点图上作业法。值得注意的是 , 方法的主要困难 在 于检查条件 (2 ) , 它要求检查每一个圈。当图 中点、边 数较多时 , 圈的个数将会很多。如“日”字形图就有 三 个 圈 , 而“ 田”字 形的 图就有 13 个圈。 关于中 国邮 递 员问题 , 已有比较好的算法 , 我们不去介绍它了。注记希望进一步了解图的基本理论、图与 网络 的优 化问 题的 算法 和应用 的读 者 , 可参 考参 考资 料 [ 1 ]、[2] 、[5 ]、[6] 、[ 7] 、[9 ]、[ 12] 、[ 13] 、[ 21] 、[ 22 ]、[ 23 ] 。参考 资料 [ 4 ]、[ 8 ] 是两本 供数学 系和计 算机系 专业的研究生使用的教材 , 较全面地介绍图论及其应 用中的基 本概念 , 基本 理论 , 以及近 期的研 究方向 进展的问题。 [11] 是一本关于网 络流理 论和应 用的很 好入门 书。在 [1 ] 、[ 9 ]、[14 ] 中 , 作 者们介 绍了 Ed-monds-Karp、Dinitz、Ka rzanov 等人给出的求最大流的 改进 算法。关 于最 小费 用流 问题 , Tardos 等人 相继提出了更好的算法 , 可参考 [3 ] , 该书全面系统地介绍 了网络流 及与之 有关的 若干图 上的优 化问题 的理论、算法和应用。 [15] 是从实用的角度介绍网络流的概念、算法、计算程序及应用例子 , 涉及带增 益函数的广义网络流、凸与凹费用函数下的最小费用流等。可供实际工作者参考。中国邮递员问题的改进算法是 Edmonds 给出的。其算法涉及图的对集 ( ma tc hing) 问题。[ 19 ] 是一本关于对集理论的专著 , 详尽地介绍了对集及其推广的概念、重要成果、算法以及对集与网 络流、线 性规·182·划、拟阵等分支的联系。 [10] 是一本关于欧拉图与有关论题的专著。网络优化是一类组合优化问题。关于一般组合最优 化的基 本理论、算 法及算 法分析 , 可参 考 [ 16 ]、[17 ]、[ 20 ]。网络优化中 , 一个有名的问题 是所 谓旅 行推 销员 问题 ( T raveling Salesman P roblem ) ( 也 称为货郎担问题 ) : 一个推销员要到若干个城市推销产品 , 然后回到出发点。已知每两个城市 之间的距离 ,他应如何选择其旅行路线 , 使每个城市经过一次 且仅仅 一次 , 并且总 的行程 最短 ? 表面 上看 , 这个问 题与中国邮递员问题很相似 , 但实际上 , 这是一个非常困难的 问题 , 至今没 有一个 求最优 旅行路 线的有 效方法。由 Lawler 等人编著的 [18 ]全面地介绍了这个问题的历史、概况、理论发展和算法分析。习题10. 1 证明如下序列不可能是某个简单图的次的序列 : (1 ) 7 , 6 , 5 , 4 , 3 , 2 。 (2 ) 6 , 6 , 5 , 4 , 3 , 2 , 1 。 (3 ) 6 , 5 , 5 , 4 , 3 , 2 , 1 。 10. 2 已知九个人 v1 , v2 , … , v9 中 , v1 和两 人握过 手 , v2 , v3 各和 四个 人握 过 手 , v4 , v5 , v6 , v7 各和五个人握过手 , v8 , v9 各和六个人 握过手 , 证 明这 九个人 中一 定可以 找出 三 个人互相握过手。10. 3 用破圈法和避圈法找出图 10 -37 的一个支撑树。图 10 -3710. 4 用破圈法和避圈法求图 10 -38 中各图的最小树。图 10 -38·282·10. 5 已知世界六大城市 : ( Pe ) , ( N ) , ( Pa ) , ( L ) , ( T ) , ( M ) 。 试在 由 表 10-2 所示 交通网络的数据中确定最小树。表 10-2城市PeTPaMNLPe×1351776850T13×60706759Pa5160×57362M777057×2055N68673620×34L505925534×10. 6 有九个城市 v1 , v2 , … , v9 , 其公路网如图 10 -39 所示。弧旁数字是该段公路 的长度 , 有一批货物从 v1 运到 v9 , 问走哪条路最短 ?图 10 -39图 10 -4010. 7 用 Dijkst ra 方法求图 10 -40 中从 v1 到各点的最短路。10. 8 求图 10 -41 中从 v1 到各点的最短路。10. 9 在图 10 -42 中 (1 ) 用 Dij kstr a 方法求从 v1 到各点的最短路 ; (2 ) 指出对 v1 来说哪些顶点是不可到达的。图 10 -41图 10 -4210. 10 求图 10 -43 中从任意一点到另外任意一点的最短路。·382·Rk–¸(cid:5)R–¸(cid:5)(cid:30)R–k(cid:30)(cid:5)R–k¸(cid:30)k–¸(cid:30)(cid:5)Rk¸(cid:30)(cid:5)图 10 -43图 10 -4410. 11 在如图 10 -44 所示的网络中 , 每弧旁的数字是 ( ci j , f i j ) 。(1 ) 确定所有的截集 ; (2 ) 求最小截集的容量 ; (3 ) 证明指出的流是最大流。 10. 12 求如图 10 -45 所示的网络的最大流 ( 每弧旁的数字是 ( ci j , f i j ) ) 。 10. 13 求如图 10 -46 所示的网络的最大流。图 10 -45图 10 -4610. 14 两家工厂 x1 和 x2 生产一种商品 , 商品通过如图 10 -47 所示的网络运送到 市场 y1 , y2 , y3 , 试用标号法确定从工厂到市场所能运送最大总量。10. 15 求如图 10 -48 所示的网络的最小费用最大流 , 每弧旁的数字是 ( bi j , ci j ) 。图 10 -47图 10 -4810. 16 求解如图 10 -49 所示的中国邮递员问题。 10. 17 设 G = ( V , E) 是一个简单图 , 令 δ( G) = mi n v∈ V{ d( v) }( 称 δ( G) 为 G 的最小次 ) 。证明 :(1 ) 若 δ( G) ≥2 , 则 G 必有圈 ; (2 ) 若 δ( G) ≥2 , 则 G 必有包含至少δ( G) + 1 条边的圈。·482·10. 18 设 G 是一个连通图 , 不含奇点。证明 : G 中不含割边。10. 19 给一个连通赋权图 G, 类似于 求 G 的最小 支 撑树的 K ruskal 方 法 , 给 出 一 个 求 G 的 最 大 支 撑 树 的 方法。10. 20 下述论断正 确 与 否 : 可 行流 f 的 流 量 为零 ,即 v( f ) = 0 , 当且仅当 f 是零流。图 10 -4910. 21 设 D = ( V , A , C) 是一个网络。证明 : 如果 D中所有弧的容量 c i j 都是整数 , 那么必存在一个最大流 f = { f i j } , 使所有 f i j 都是整数。10. 22 已知有六台机床 x1 , x2 , … , x6 , 六个零件 y1 , y2 , … , y6 。机 床 x1 可加工零 件 y1 ; x2 可加工零件 y1 , y2 ; x3 可加工零件 y1 , y2 , y3 ; x4 可加工 零件 y2 ; x5 可加 工零 件 y2 , y3 , y4 ; x6 可加工零件 y2 , y5 , y6 。现在要求制定一个加工方案 , 使一 台机床只 加工一个 零 件 , 一个零件只在一台机床上加工 , 要求尽可能多地安排零件的加工。试把这个问题化为 求网络最大流的问题 , 求出能满足上述条件的加工方案。 参 考 资 料[1] 田丰 , 马仲蕃 . 图与网络流理论 . 北京 : 科学出版社 , 1987[2] 谢金星 , 邢文顺 . 网络优化 . 北京 : 清华大学出版社 , 2000[3] A huja R K , Magnan ti T L & Or lin J B . N et work F low s T heory A l gori thms and A p p lications .Pre ntice- H all , 1993[4] Bollobas B .Modern Grap h T heory .G rad Tex ts Ma th .184 , Springe r , 1998[5] Bondy J A & Murt y U S R . Graph Theor y w i th A p p lications .T he Macmilla n P res s , 1976吴望名 , 李念祖等译 . 图论及其应用 . 北京 : 科学出版社 , 1984[6] Ch ar tr and G & Oeller ma nn O R . A p p lie d and A l gorit hmic Graph T heor y .McGr aw- Hill , 1993[7] Deo N . Graph T heor y w ith A p p licat ions i n Eng i neering and Com pu ter Science .P ren tice- Hall,1974[8] Diestel R . Graph T heor y . G rad . T exts Math .173 , Springer- Ve rlag , 2000[9] Even S . Grap h A l gorith ms .Compute r Science Press , 1979[10 ] Fleischn er H .Eu lerian Grap hs and Related Top ics .Ann .Dis .Mat h .45 , Nort h Holla nd , Amster-dam , 1990[11 ] Ford L R & Ful kerson D R .F low s i n N et works .P rinceton Univer sity Press , 1962[12 ] Foulds L R . Gra ph T heory A p p lications .Springer- Velag , 1992[13 ] Gibbons A . Al gorithmic Gra ph T heory .Cambridge University Press , 1985[14 ] H u T C .Combi na tori al A l gori thms .Addison- Wesley Pub lish ing Com pany , 1982[15 ] Jensen P A & Barnes J W . N et work Flow Prog ram ming .John Wiely & Sons, 1980孙东川译 . 网络流规划 . 北京 : 科学出版社 , 1988[16 ] Korte B & Vygen J .Combinatoria l Op timiz ation .T heory an d A l gorit hms .Springer , 1991[17 ] Lawler E L . Combi na toria l O p timiz ation : N et works and Matroi ds .H olt Rineha rt a nd Winst on ,1976[18 ] Lawler E L , Lenstr a J K & Rinooy- Kan A H G . T he T ra vel ing S alesman Problem .Wiley-In ter-science .John Wiley & Sons , 1985[19 ] Lovasz L & Plummer M D .Ma tchi ng Theor y .Elsevier Scie nce Publishing Company Inc , 1986·582·[20 ] Papadimitr iou C H & Steig litz K . Combi na toria l O p timiz ation . A l gorith ms and Com p lex it y .P ren tice- Hall, 1982刘振宏 , 蔡茂诚译 . 组合最优化 : 算法和复杂性 . 北京 : 清华大学出版社 , 1988[21 ] S wamy M N S & T hulasir aman K .G ra phs N et works and A l gorith ms .Wiley-Inter science , JohnWiley & Sons , 1981[22 ] West D B .I ntroduction to Graph T heory .Pren tice- H all , 1993[23 ] Wilson R J & Beinek e W L .A p p lications o f Gra ph T heory . Aca demic P res s , 1979·682·第 11 章 网 络 计 划当前 , 世界上工业发达国家都非常重视 网络 计划技 术在 现代 管理中 的应 用。它已 被 许多国家公认为当前最为行之有效的管理方 法之一。 国外 多年实 践证 明 , 应用网 络计 划 技术组织与管理生产和项目一般能缩短工期 20 % 左右 , 降低成本 10 % 左右。美国是网络计划技术的 发源 地。美 国政 府 于 1962 年规 定 , 凡 与 政 府签 订 合同 的 企 业 , 都必须采用网络计划技术 , 以保证工程进度和质量。 1974 年 麻省理 工学院调 查指出 : “绝大部分美国公司采用网络计划编制施 工计划”。目 前 , 美国 基本上 实现 了用计 算机 绘 画、优化计算和资源平衡、项目进度控制 , 实 现了 计划工 作自 动化。以 后又 提出了 新的 网 络计划技术 , 如图示评审技术 ( GE RT ) , 风险评审技术 ( V ER T) 等。我国应用网络计划技术是从 20 世纪 60 年代初期开始。著名科学家钱学森将网络计 划方法引入我国 , 并在航天系统应用。著名数 学家华 罗庚 在综 合研究 各类 网络方 法的 基 础上 , 结合我国实际情况加以简化 , 于 1965 年发表了《统筹方法平话》, 为推广应用网络计 划方法奠定了基础。近几年 , 随着科技的发展和进步 , 网络计划技术的应用也日趋得到工 程管理人员的重视 , 且已取得可观的经济效 益。如上 海宝 钢炼 铁厂 1 号高 炉土建 工程 施 工中 , 应用网络法 , 缩短工期 21 % , 降低成本 9. 8 % 。广州白天鹅宾馆在建设中 , 运用网络 计划技术 , 工期比外商签订的合同提前四 个半 月 , 仅投 资利息 就节 约 1000 万 港元。为 在 我国推广普及网络计划技术 , 我国建设部公布了《工程网络计划技术规程》, 以便统一技术 术语、符号、代号和计算规范。特别近几年来 , 微机的 普及 和网 络计划 软件 的不断 更新 换 代。这些为在国内大范围推广网络计划技术创造了条件。第 1 节 网络计划图网络计划图的基本思想是, 首先应用网络计划图来表示工程项目中计划要完成的各项 工作 , 完成各项工作必然存在先后顺序及其相互依赖的逻辑关系 ; 这些关系用节点、箭线来 构成网络图。网络图是由左向右绘制, 表示工作进程 , 并标注工作名称、代号和工作持续时 间等必要信息。通过对网络计划图进行时间参数的计算 , 找出计划中的关键工作和关键线 路; 通过不断改进网络计划, 寻求最优方案 , 以求在计划执行过程中对计划进行有效的控制 与监督, 保证合理地使用人力、物力和财力 , 以最小的消耗取得最大的经济效果。1. 1 基本术语网络计划图是在网络图上标注时标和时间参 数的 进度 计划图 , 实 质上 是有时 序的 有 向赋权图。表述关键路线法 ( CP M ) 和计划评审技术 ( P ER T ) 的网络计划图没 有本质的 区 别 , 它们的结构和术语是一样的。仅前者的时间参数是确定型的 , 而后者的时间参数是不 确定型的。于是统一给出一套专用的术语和符号。(1 ) 节 点、箭 线 是 网 络 计 划 图 的 基 本 组 成 元 素。 箭 线 是 一 线 段 带 箭 头 的 实 射 线·782·( 用“ →”表示 ) , 节点是箭线两端的连接点 ( 用“○”或“□”表示 ) 。(2 ) 工作 ( 也称工序、活动、作业 ) , 将 整个项 目按 需要粗 细程 度分 解成若 干需 要耗 费时间或需要耗费其他资源的子项目或单元。它们是网络计划图的基本组成部分。(3 ) 描述工程项目网络计划 图有 两种表 达的 方式 : 双代 号网 络计 划图和 单代 号网 络计划图。双代号网络计划图在计算时间参数时 , 又可分为工作计算法和节点计算法。(4 ) 双代号网络计划图。在双代号网络计划图中 , 用箭线表示工作 , 箭尾 的节点表 示 工作的开始点 , 箭头的节点表 示工 作 的完 成点。 用 ( i- j ) 两个 代号 及箭 线表 示 一项 工作 , 在箭线上标记必需的信息 , 如图 11 -1 所示。图 11 -1箭线之间的连接顺序表示工作之间的先后开工的逻辑关系。(5 ) 单代号网络计划图。用 节点表 示工 作 , 箭线表 示工 作之间 的先 完成 与后 完成 的关系为逻辑关系。在节点中标记必需的信息 , 如图 11 -2 所示。图 11 -21. 2 双代号网络计划图这里主要介绍双代号网络计划图的绘制和按工作计算时间参数的方法。以下通过例题来说明网络计划图的绘制和时间参数的计算。例 1 开发一个新产品 , 需要完成的工作和先后关 系 , 各 项工作 需要的时 间汇总在 逻 辑关系表中 , 见表11 -1。要求编制 该项目 的 网络 计划 图和 计算 有 关参 数 , 根据 表 11 -1 中 数据 , 绘制网络图 , 见图 11 -3 。表 11 -1序号工作名称工作代号工作持续时间 (天 )紧后工作1产品设计和工艺设计A60B , C, D, E2外购配套件B45L3锻件准备C10F4工装制造 1D20G, H5铸件E40H6机械加工 1F18L7工装制造 2G30K8机械加工 2H15L9机械加工 3K25L10装配与调试L35/·882·«î«î«îš«î«î«šî«šî«šîš«îÂî图 11 -3为了正确表述工程项目中各个工作的相互 连接关 系和 正确绘 制网 络计 划图 , 应遵 循以下规则和术语 :1. 网络计划图的方向、时序和节点编号网络计划图是有向、有序的赋权图 , 按项目的工作流程自左向右地绘制。在时序上反 映完成各项工作的先后顺序。节点编号必须按箭尾节点的编号小于箭头节点的编号来标记。在网络图中只能有一个起始节点 , 表示工程项目的开始。一个终点节点 , 表示工程项 目的完成。从起始节点开始沿箭线方向顺序自左往右 , 通过一系列箭线和节点 , 最后到达 终点节点的通路 , 称为线路。2. 紧前工作和紧后工作紧前工作是指紧排在本工作之前的工作。 紧后工 作是 指紧排 在本 工作 之后的 工作。如图 11 -3 中 , 只有工作 A 完成后工作 B , C, D, E 才能 开始 , 工作 A 是 B , C, D, E 的紧 前 工作 ; 而工作 B, C, D, E 则是工作 A 的紧后工作。从 起始 节点 至本工 作之 前在同 一线 路 的所有工作 , 称为先行工作 ; 自本工作到终点节点在同一线路的所有工作 , 称为后继工作。 工作 G 的先行工作有工作 A , D; 工作 K , L 是工作 G 的后继工作。3. 虚工作在双代号网络计划图中 , 只 表示 相邻 工作 之 间的 逻辑 关系 , 不 占 用 时间 和 不消 耗 人 ⑤只表示 工力、资金等的虚设的工作。虚工作用虚箭线表示。如在图 11 -3 中④作 D 完成后 , 工作 H 才能开始。4. 相邻两节点之间只能有一条箭线连接 , 否则将造成逻辑上的混乱如图 11 -4 是错误的画法 , 为了使 两节点 之间 只有一 条箭 线 , 可增 加一 个 节点 ②′, 并增加一项虚工作②′…→②。图 11 -5 是正确的画法。·982·应当改成图 11 -4图 11 -55. 网络计划图中不能有缺口和回路在网络计划图中严禁出现 从 一个 节点 出发 , 顺箭 线方 向又 回 到原 出 发节 点 , 形 成 回 路。回路将表示这工作永远不能完成。网络计划 图中 出现 缺口 , 表示 这些 工作永 远达 不 到终点。项目无法完成。6. 平行工作可与本工作同时进行的工作。7. 起始节点与终点节点在网络计划图中只能有一个起始节点和一个终点节点。当工程开始或完成时存在几个平行工作时 , 可以用虚工作将它们与起始节点或终点节点连接起来。8. 线路网络图中从起点节点沿箭线方向顺序通过一 系列 箭线 与节点 , 最 后到 达终点 节点 的通路。本例中有五条线路。并可以计算出各线路的持续时间 , 见表 11 -2。表 11 -2线路线路的组成各工作的持续时间之和 ( 天 )1①→②→⑦→⑧60 + 45 + 35 = 1402①→②→③→⑦→⑧60 + 10 + 18 + 35 = 1233①→②→④→⑥→⑦→⑧60 + 20 + 30 + 25 + 35 = 1704①→②→④→⑤→⑦→⑧60 + 20 + 15 + 35 = 1305①→②→⑤→⑦→⑧60 + 40 + 15 + 35 = 150从网络图中可以计算出各线路的持续时间。其中有一条线路的持续时间最长线路是关键路线 , 或称为主要矛盾线。关键路线上 的各 工作为 关键 工作。因 为它 的持续 时间 就 决定了整个项目的工期。关键路线的特征以后再进一步阐述。9. 网络计划图的布局尽可能将关键路线布置在网络计划图的中心 位置 , 按 工作 的先后 顺序 将联系 紧密 的 工作布置在邻近的位置。为了便于在网络计划图 上标 注时 间等数 据 , 箭线 应是水 平线 或 具有一段水平线的折线。在网络计划图上附有时间坐标或日历进程。10. 网络计划图的类型(1 ) 总网络计划图 , 以整个项目为计划对象 , 编制网络计划图。供决策领导层使用。·092·/è(cid:8)¡è(cid:8)è(cid:8)(2 ) 分级网络计划图 , 这是按不 同管 理层 次的需 要 , 编制 的范围 大小 不同 , 详 细程 度不同的网络计划图 , 供不同管理部门使用。(3 ) 局部网络计划图 , 将整个项 目某 部分 为对象 , 编 制更 详细的 网络 计划 图 , 供专 业部门使用。当用计算机网络计划软件编制时 , 在计 算机 上可进 行网 络计 划图分 解与 合并。网 络 计划图详细程度 , 可以根据需要 , 将工作分解为 更细的 子工 作 , 也可以 将几 项工作 合并 为 综合的工作 , 以便显示不同粗细程度的网络计划。第 2 节 网络计划图的时间参数计算网络计划的时间参数计算有几种类型 : 双代号网络计划有工作计算法和节点计算法 ; 单代号网络计划有节点计算法。以下仅介绍工作计算法 , 其他的计算法可参考《工程网络 计划技术规程》( JGJ/ T121-99) 。网络图中工作的时间参数 , 它 们是 : 工作 持续 时间 ( D) , 工作 最早 开始 时间 ( E S) , 工 作最早完成时间 ( E F) ; 工 作 最 迟开 始 时间 ( L S) , 工 作 最迟 完 成 时 间 ( L F) ; 工 作 总 时 差 ( T F) 和工作自由时差 ( F F) 。2. 1 工作持续时间 D工作持续时间计算是一项基础工作 , 关 系到 网络计 划是 否能 得到正 确实 施。为了 有 效地使用网络计划技术 , 需要建立相应 的数据 库。这需 要专 项讨 论的问 题。这里 简述 计 算工作持续时间的两类数据和两种方法。1. 单时估计法 (定额法 )每项工作只估计或规定一个确定的持续 时间值 的方 法。一般 有工 作的工 作量 , 劳 动定额资料以及投入人力的多少等 , 计算各工作的持续时间 ;Q R · S· n Q———工作的工作量。以时间单位表示 , 如小时 , 或以体积、质量、长度等单位表示 ; R———可投入人力和设备的数量 ; S———每人或每台设备每工作班能完成的工作量 ; n———每天正常工作班数。 当具有类似工作的持续时间的历史统计资料时 , 可以根据这些资料 , 采用分析对比的工作持续时间 :D =方法确定所需工作的持续时间。2. 三时估计法在不具备有关工作的持续时间的历史资料时 , 在较难估计出工作持续时间时 , 可对工作进行估计三种时间值 , 然后计算其平均值。这三种时间值是 :乐观时间———在一切都顺利时 , 完成工作需要的最少时间 , 记作 a。·192·最可能时间———在正常条件下 , 完成工作所需要的时间。记作 m。 悲观时间———在不顺利条件下 , 完成工作需要最多的时间 , 记作 b。 显然上述三种时间发生都具有一定的概率 , 根据经验 , 这些时间的概率分布认为是正 态分布。一般情况下 , 通过专家估计法 , 给出三时估计的数据。可以认为工作进行时出现 最顺利和最不顺利的情况比较少 , 较多是出 现正 常的情 况。按 平均意 义可 用以下 公式 计算工作持续时间值 : D =a + 4 m + b 6; 方差 σ2 =b - a 62。2. 2 计算关系式这些时间参数的关系可以用图 11 -6 表 示工 作的关 系状 态。手工 计算 可在网 络图 上进行 , 计算步骤为 :(1 ) 计算各路线的持续时间 ( 见表 11 -2 ) 。 (2 ) 按网络图的箭线的方向 , 从起始工作开始 , 计算各工作的 E S , E F。 (3 ) 从网络图的终点节点开始 , 按逆箭线的方向 , 推算出各工作的 L S, L F。 (4 ) 确定关键路线 ( CP) 。 (5 ) 计算 T F, F F。 (6 ) 平衡资源。图 11 -6例 1 计算各工作的时间参数 , 并将计算结果记入 网络计划 图的相 应工作的 □中 , 见图 11 -7 。图 11 -7·292·1. 工作最早开始时间 E S 和工作最早完成时间 E F 的计算利用网络计划图 , 从网络计划图的起始点开始 , 沿箭线方向依次逐项计算。第一项工作的最早开始时间为 0 , 记作 ESi -j = 0。 ( 起始 点 i = 1 ) 。 第一 件 工 作 的 最早 完 成 时 间j 。第一件工作完成后 , 其紧 后工作 才能 开始。它 工作 最早完 成时 间E F1 - E F 就是其紧后工作最早开始时间 E S 。本工作的持续时间 D。表示为 :j = E S1 -j + D1 -E Fi -j = E Si -j + Di -j 。计算工作的 E S 时 , 当有多项紧前工作情况下 , 只能在这些紧前 工作中都 完成后才 能 开始。因此本工作的最早开始时间 是 : E S = max ( 紧 前工 作的 E F) 其 中 E F = ES + 工 作 持续时间 D, 表示为 :E Si -j = max h ( E Fh -i ) = max h ( E Sh - i + Dh -i ) ,例 1 的 E S, E F 计算值在表 11 -3 的③ , ④列中。表 11 -3工作 i - j 持续时间 Di - j最早开始时间 ESi - j最早完成时间 EFi - j①②③④ = ③ + ②A(1 - 2)60ES1 - 2 = 0EF1 - 2 = ES1 - 2 + D1 - 2 = 0 + 60 = 60B(2 - 7)45ES2 - 7 = EF1 - 2 = 60EF2 - 7 = ES2 - 7 + D2 - 7 = 60 + 45 = 105C(2 - 3)10ES2 - 3 = EF1 - 2 = 60EF2 - 3 = ES2 - 3 + D2 - 3 = 60 + 10 = 70D(2 - 4)20ES2 - 4 = EF1 - 2 = 60EF2 - 4 = ES2 - 4 + D2 - 4 = 60 + 20 = 80E(2 - 5)40ES2 - 5 = EF1 - 2 = 60EF2 - 5 = ES2 - 5 + D2 - 5 = 60 + 40 = 100E′(4 - 5)0(虚工作)ES4 - 5 = EF2 - 4 = 80EF4 - 5 = ES4 - 5 + D4 - 5 = 80 + 0 = 80F(3 - 7)18ES3 - 7 = EF2 - 3 = 70EF3 - 7 = ES3 - 7 + D3 - 7 = 70 + 18 = 88G(4 - 6)30ES4 - 6 = EF2 - 4 = 80EF4 - 6 = ES4 - 6 + D4 - 6 = 80 + 30 = 110H(5 - 7)15ES5 - 7 = max( EF2 - 5 , EF4 - 5 )EF5 - 7 = ES5 - 7 + D5 - 7 = 100 + 15 = 115= EF2 - 5 = 100K(6 - 7)25ES6 - 7 = EF4 - 6 = 110EF6 - 7 = ES6 - 7 + D6 - 7 = 110 + 25 = 135ES7 - 8 = max ( EF2 - 7 , EF3 - 7 , EF6 - 7 ,L(7 - 8)35EF5 - 7 )EF7 - 8 = ES7 - 8 + D7 - 8 = 135 + 35 = 170= EF6 - 7 = 135利用双代号的特 征 , 很 容易 在 表 中 确 定某 工 作 的 紧 前工 作 和 紧 后 工作。 凡 是 后 续 工作的箭尾代号与 某 工 作 的 箭 头 代 号 相 同 者 , 便 是 它 的 紧 后 工 作 ; 凡 是 先 行 工 作 的 箭 头代号与某工作的箭 尾 代 号相 同 者 , 便是 它 的 紧 前 工 作。在 表 11 -3 中 首 先 填 入 ①、② 两列数据 , 然后由上往下计算 ES 与 E F。若某工作 ( i - j ) 的先行工作中存在几个 ( h - i) , ·392·a¨³Àú³ÑÀ³ÑÀ³Àú³À¨ÀÑ³Àú³#³é#³#³j , 如计算 E S7 - 8 时 , 可 从中选择最大的 E Fh - j = max h [ E Fh - 从表 11 -3 的④ 列 已 有 的 E F6 - 7 , E F5 - 7 , E F3 - 7 中 找 到 最 大 的 E F6 - 7 = 135。 将 它 填 入 表 11 -3 的③列 , 对应的 L(7 - 8) 行即可。如此计算也很方便。i 进行计算 E S i -i ] , 即计算 E Fi -2. 工作最迟开始时间 L S 与工作最迟完成时间 L F应从网络图的终点节点开始 , 采用逆序法逐项计算。即按逆箭线方向 , 依次计算各工 作的最迟完成时间 L F 和最迟开始时间 L S , 直到第一项工作为止。网络图中 最后一项 工 作 ( i - n) ( j = n) 的最迟完成 时间应 由工 程的计 划工 期确 定。在未 给定 时 , 可令其 等于 其 最早完成时间 , 即 L Fi - n = E Fi - n 。 E Fi - n 由表 11 -3 中 的计 算 结果 是已 知的 了 , 并 且应 当 小于或等于计划工期规定的时间 T r 。L F = min( 紧后工作的 L S) , L S = L F - 工作持续时间 D其他工作的最迟开始时间 L Si -j = L Fi - L F = min( 紧后工作的 L S) , 或表示为 L Fi -j ; 当有多个紧后工作时 , 最 迟完成时 间j - Di - j = min k ( L Fj - k - D j - k ) 。可在表 11 -4 中进行。计算从下到上地进行 , 从 工作 ( 7 -8 ) 开始 , 令表 11 -4 的 ⑤列 最后一行 L F7 - 8 = E F7 - 8 = 170 。表 11 -4工作持 续时 间最 迟完 成 时间最迟 开 始时 间总时 差 TFi -自由 时差i -jDi - jL Fi - j = min( LS j - k )LS i - j = LFi -j - Di -= LSi -j - ES i - jFF i - j = ES i - k - EFi -①②⑤⑥ = ⑤ - ②⑦ = ⑥ - ③⑧A(1 - 2 )60LF 1 - 2 = LS2 - 4 = 60LS1 - 2 = LF1 - 2 - 60 = 60 - 6 0 = 00 - 0 = 0FF1 - 2 = ES2 - 3 - E F1 - 2 = 0B(2 - 7)45LF 2 - 7 = LS7 - 8 = 13 5LS2 - 7 = LF2 - 7 - 45 = 13 5 - 45 = 9090 - 60 = 3 0FF2 - 7 = ES7 - 8 - E F2 - 7 = 13 5 - 105 = 3 0C(2 - 3)10LF 2 - 3 = LS3 - 7 = 11 7LS2 - 3 = LF2 - 3 - 10 = 11 7 - 10 = 107107 - 6 0 = 4 7FF2 - 3 = ES3 - 7 - E F2 - 3 = 70 - 7 0 = 0D(2 - 4 )20LF 2 - 4 = LS4 - 6 = 80LS2 - 4 = LF2 - 4 - 20 = 80 - 2 0 = 6 060 - 6 0 = 0FF2 - 4 = ES4 - 6 - E F2 - 6 = 80 - 8 0 = 0E(2 - 5)40LF 2 - 5 = LS5 - 7 = 12 0LS2 - 5 = LF2 - 5 - 40 = 12 0 - 40 = 8080 - 60 = 2 0FF2 - 5 = ES5 - 7 - E F2 - 5 = 10 0 - 100 = 0F(3 - 7)18LF 3 - 7 = LS7 - 8 = 13 5LS3 - 7 = LF3 - 7 - 18 = 13 5 - 18 = 117117 - 7 0 = 4 7FF3 - 7 = ES7 - 8 - E F3 - 7 = 13 5 - 88 = 47G(4 - 6)30LF 4 - 6 = LS6 - 7 = 11 0LS4 - 6 = LF4 - 6 - 30 = 11 0 - 30 = 8080 - 8 0 = 0FF4 - 6 = ES6 - 7 - E F4 - 6 = 11 0 - 110 = 0H(5 - 7)15LF 5 - 7 = LS7 - 8 = 13 5LS5 - 7 = LF5 - 7 - 15 = 13 5 - 15 = 120120 - 10 0 = 20FF5 - 7 = ES7 - 8 - E F5 - 7 = 13 5 - 115 = 2 0K( 6 - 7)25LF 6 - 7 = LS7 - 8 = 13 5LS6 - 7 = LF6 - 7 - 25 = 13 5 - 25 = 110110 - 1 10 = 0FF6 - 7 = ES7 - 8 - E F6 - 7 = 13 5 - 135 = 0L(7 - 8)35LF 7 - 8 = E F7 - 8 = 1 70LS7 - 8 = LF7 - 8 - 35 = 17 0 - 35 = 135135 - 1 35 = 0FF7 - 8 = T - 17 0 = 170 - 17 0 = 0于是可计算出 E F7 - 8 = L F7 - 8 - D7 - 8 = 135。工作 L( 7 -8 ) 的紧前工 作的箭尾 代号 与 工作 L(7 -8 ) 的箭头代号是相同的 , 这里有 K(6 - 7 ) , H ( 5 - 7 ) , F( 3 - 7 ) , B(2 - 7 ) ; 它 们 只有唯一的紧后工作 L(7 - 8) , 所以 L F6 - 7 , L F5 - 7 , L F3 - 7 , L F2 - 7 都等 于 L F7 - 8 = 135。填 入表 11 -4⑤列的相应行即可。当具有多个紧后工作时 , 如要计算 LF1 - 2 时 , 先查 A(1 - 2) 的 紧后工作有几个 , 从代号可以看到是 B(2 - 7) , C(2 - 3) , D(2 - 4) , E( 2 - 5) , 对应的有 LS2 - 7 = 90, LS2 - 3 = 107 , L S2 - 4 = 60 , L S2 - 5 = 80。其中最小的是 60 , 即 L F1 - 2 = L S2 - 4 = 60。3. 工作时差工作时差是指工作有机动时间。常用有两种时差 , 即工作总时差和工作自由时差。·492·;>t?(cid:7)c^|tjt^›y(cid:6)Z]?t(cid:6)=^|tjDty›^DZt^|^›c‰tD›ty^t›6fy(1 ) 工作总时差 T Fi -T Fi -j 是指在不影响工期的前提下 , 工作所 具有 的机 动时间 , 按 工作 计算法 计算。 在表 11 -4 中⑦ = ⑥ - ③的数据。j 或 T F i -T Fi - 注意 : 工作总 时 差 往 往 为 若 干 项 工 作 共 同 拥 有 的 机 动 时 间 , 如 工 作 ( 2 - 3 ) 和 工 作 (3 - 7) , 其工作总时差为 47 , 当工作 (2 - 3) 用去一部分机 动时间后 , 工 作 ( 3 - 7 ) 的机 动 时间将相应地减少。j - E Si -j = E Fi -j - Di -j = L Si -j - E Si -j = L Fi -j - E Fi -j(2 ) 工作自由时差 F F 工作自由时差 是 指 : 在 不 影 响 其 紧 后 工 作 最 早 开 始 的 前 提 下 , 工 作 所 具 有 的 机 动时间。F Fi -j = ESj - k - E Si -j - Di -j ; 或 F Fi -j = E Sj - k - E Fi -计算结果见表 11 -4 ⑧和图 11 -7 。工作自由时差是某项工作单独拥有的机动时间 , 其大小不受其他工作机动时间的影响。关键路线的特征 : 在线路上从起点到终 点都 由关键 工作 组成。在 确定 型网络 计划 中 是指线路中工作总持续 时间 最长 的线 路。在 关键 线 路上 无机 动时 间 , 工 作总 时 差 为零。 在非确定型网络计划中是指估计工期完成可能性最小的线路。第 3 节 时标网络计划图时间坐标简称时标。时标在网络计划图的上 方或 下方 , 用 以表示 工程 进度时 间的 坐 标轴。根据需要规定时间单位为 : 小时、天、周、月或季。标注有时间坐标的网络计划图称 为时标网络计划图。在该图中箭线的长度就表示工作持续时间的长度。在图中可以用实粗箭线或实红色的箭线表示关键工作和关键线 路 , 并 且可 用不 同的线 型表 示出工 作的 总 时差和自由时差 , 例 1 的时标网络计划图如图 11 -8 所示。图 11 -8·592·第 4 节 网络计划的优化绘制网络计划图 , 计算时间参数和确定关键线路 , 仅得到一个初始计划方案。然后根 据上级要求和实际资源的配置 , 需要对初始 方案进 行调 整和 完善 , 即进 行网 络计划 优化。 目标是综合考虑进度 , 合理利用资源 , 降低费用等。4. 1 工期优化若网络计划图的计算工期大于上级要求的工期时 , 必须根据要求计划的进度 , 缩短工 程项目的完工工期。主要采取以下措施 , 增加对关键工作的投入 , 以便缩短关键工作的持 续时间 , 实现工期缩短。(1 ) 采取技术措施 , 提高工效 , 缩短关键工作的持续时间 , 使关键线路的时间缩短。 (2 ) 采取组织 措施 , 充 分 利 用非 关 键 工 作 的 总 时 差 , 合 理 调 配 人 力、物 力 和 资 金 等资源。4. 2 资源优化在编制初始网络 计 划 图 后 , 需 要 进 一 步考 虑 尽 量 利 用现 有 资 源 的 问题。 即 在 项 目 的工期不变的条件下 , 均 衡地 利用 资 源。实际 工 程项 目包 括工 作 繁多 , 需要 投 入资 源 种 类很多 , 均 衡 地利 用 资 源是 很 麻烦 的 事 , 要 用 计算 机 来完 成。为 了 简 化计 算 , 具 体 操 作 如下 :(1 ) 优先安排关键工作所需要的资源。 (2 ) 利用非关键工作的总时差 , 错开各工作的开始时间 , 避开在 同一时区 内集中使 用同一资源 , 以免出现高峰。(3 ) 在确实受到资源制约 , 或在 考虑 综合 经济效 益的 条件下 , 在 许可 时 , 也可 以适 当地推迟工程的工期。实现错开高峰的目的。下面通过例 1 的例子说明平衡人力资源的 方法。假 设在 例 1 中 , 现有 机械加 工工 人数 65 人 , 要完成工作 D、F、G、H、K。各工作需要工人人数列于表 11 -5。表 11 -5工作持续时间 ( 天)需要工人 (人数 )总时差 (天 )D20580F182247G30420H153920K25260·692·Å×{Å×{Å×{Å×{Å×{由于机械加工工人人数的限制。若上述工 作都按 最早 开始时 间安 排 , 在完成 各关 键 工作的 75 天工期中 , 每天需要机械加工工人人数如图 11 -9 所示。有 10 天需要 80 人 , 另 10 天需要 81 人。超过了现有机械 工人 人数的 约束 , 必须 进行 调整。 以虚 线 表示 的非 关 键路线 上 非 关 键 工 作 F、H 有 机 动 时 间 , 若 将 工 作 F 延 迟 10 天 开 工 , 就 可 以 解 决 第 70 ～80 天的超负荷问题 ; 将工 作 H 推迟 10 天 开工 , 可以解 决第 100 ～ 110 天的 超负荷 问 题。于是新的负荷图 ( 见图 11 -10 ) 能满 足机械 工人 的人 数 65 人约 束 条件。 以上 人力 资 源平衡是利用非关键工作的总时差 , 可以避开资源负荷的高峰。避开资源负荷高峰时 , 可以采用将非关键 工作分 段作 业或 采用技 术措 施减少 所需 要的资源 , 也可以根据计划规定适当延长项目的工期。图 11 -9图 11 -104. 3 时间—费用优化编制网络计划时 , 要研究如何使完成项目 的工 期尽可 能缩 短 , 费用 尽可能 少 ; 或在 保 证既定项目完成时间条件下 , 所需要的费用 最少 ; 或在 费用 限制的 条件 下 , 项目完 工的 时 间最短。这就是时间—费用优化要解决的问题。完成一项目的费用可以分为两大类 :1. 直接费用直接与项目的规模有关的费用 , 包括材料费用 , 直接生产工人工资等。为了缩短工作的持续时间和工期 , 就需要增加投入 , 即增加直接费用。2. 间接费用间接费用包括管理费等。一般按项目工期长度进行分摊 , 工期愈短 , 分摊的间接费用 就愈少。一般项目的总费用与直接费用、间接 费用、项 目工 期之间 存在 一定关 系 , 可以 用 图 11 -11 表示。·792·图 11 -11 工期与总费用的关系曲线图中 : T1 ———最短工期 , 项目总费用最高 ;T2 ———最佳工期 ; T3 ———正常的工期。当总费用最少工期短于要求工期时 , 这就是最佳工期。 进行时间 -费用优化时 , 首先要计算出不同工 期下 最低 直接费 用率 , 然 后考虑 相应 的间接费用。费用优化的步骤如下 :(1 ) 计算工作费用增加率 ( 简称费用率 ) 费用增加率是指缩短工作持续时间每一单位时间 ( 如一天 ) 所需要增加的费用。 按工作的正常持续时间计算各关键工作的费用率 , 通常可表示为 :ΔCi -j =CCi - D N i -j - C Ni - j - DCi -ΔCi -CCi -j ———工作 i - j 的费用率 ; j ———将工作 i - j 持 续时间 缩短 为最短 持续 时间 后 , 完成该 工作 所需要 的直 接费用 ;j ———在正常条件下完成工作 i - j 所需要的直接费用 ; j ———工作 i - j 正常持续时间 ; j ———工作 i - j 最短持续时间。C Ni -D Ni -DCi - (2 ) 在网络计划图找出费用率最低的一项关键工作或一组关键 工作作为 缩短持续 时间的对象。其缩短后的值不能小于最短持续时间 , 不能成为非关键工作。(3 ) 同时计算相应的增加的总费用 , 然后考虑由于工期的缩短间接 费用的变 化 , 在 这基础上计算项目的总费用。重复以上步骤 , 直到获得满意的方案为止。 以下通过举例说明。已知项目的每天间接费用为 400 元 , 利用表 11 -6 中的已知资料 , 按图 11 -6 安排进度, 项目正常工期为 170 天 , 对应的项目直接费用为 68900 元, 间接费用为 170×400 = 68000 元, 项目总费用为 136900 元。这是在正常条件下进行的方案 , 称为 170 天 方案。若要缩短这方案的工期, 首先从缩短关键路线上直接费用率最小的工作的持续时间 , 在 170 天方案中关键工作 K, G 的直接费用率是最低。从表中可见这两项工作的持续时间 都只能缩短 10 天。由此总工期可以缩短到 170 - 10 - 10 = 150 天。按 150 天 工期计算 , 这 时总直接费用增加到 68900 + (290×10 + 350×10) = 75300 元。由于缩短工期 , 可以减少间 ·892·接费用 400×20 = 8000 元, 工期为 150 天方案的总费用为 75300 + 60000 = 135300 元。与工 期 170 天方案相比 , 可以节省总费用 1600 元。 但在 150 天方案中已有两条关键路线 , 即①→②→④→⑥→⑦→⑧与①→②→⑤→⑦→⑧如果再缩短工期 , 工作的直接费用将 大幅度 增加。例 如在 150 天 方案 的基础 上再 缩 短工期 10 天 , 成为 140 天方案。这时应选择工 作 D, 缩 短 10 天 ; 工作 H 缩 短 5 天 ( 只 能 缩短 5 天 ) , 工作 E 缩短 5 天。这时直接费用成为 75300 + 400 × 10 + 400 × 5 + 500 × 5 = 83800 元。间接费用为 140× 400 = 56000 元 , 总费用为 139800 元。显然 140 天方案的 总 费用比 150 天方案和 170 天方案的总费用都高。综合考虑 150 天方案为最佳方案。计算 结果汇总在表 11 -7 中。表 11 -6序号工作代号正常持续时间( 天 )工作直接费用( 元 )最短工作时间 ( 天 )工作直接费用 ( 元)费用率 ( 元/ 天 )1A60100006010000/2B4545003063001203C102800543003004D20700010110004005E401000035125005006F1836001054402307G30900020125003508H1537501057504009K25625015915029010L35120003512000/表 11 -7工期方案170 天方案150 天方案140 天方案缩短关键工作K , GD, H , E缩短工作持续时间( 天 )10 , 1010 , 5 , 5直接费用 (元 )689007530083800间接费用 (元 )680006000056000总费用 (元 )136000135300139800第 5 节 网络计划软件5. 1 概况20 世纪 60 年代 , 网络计划 图用 手工编 制时 , 工 作量 很大 , 若 遇到 有些 工 作资 源配 置 有变化时 , 就需要及时修改网络计划图。这 是非常 麻烦 的事 , 推广 应用 都存 在很多 困难。·992·NF(cid:127) èNYF(cid:127) èNYF è(cid:127)YNF(cid:127) èYNF è(cid:127)YNF(cid:127) èYNF(cid:127) èNYF è(cid:127)YNF èNF (cid:127) (cid:127)òz(cid:28)òz(cid:28)òz(cid:28)1980 年以后 , 微机开始普及起来 , 到 1983 年 以后 有了 在 微机 上使 用的 网络 计 划的 软件。 这之后经历了几次变革 , 网络计划的软件随 计算 机的更 新换 代而 不断改 进。目前 网络 计 划技术应用软件的水平 , 大约处在第五代。大多数软件是 Windows 操作系统。可以处 理 表格及图形输入方式、图形横道 图 ( Gant t 图 ) 带逻 辑联 线、单 代号 网络 计划 图、完 成各 种 数值计算等。第六代是面向对象的图形智能 化的操 作 , 并在 不断 完善。如 我国梦 龙科 技 有限公司开发的智能项目动态控制软件 , 目前 是国内 工程 领域 中用户 最多 的项目 进度 控 制软件 , 它极易进行进度计划编制、进度计划 优化、进度 跟踪 反馈、进度 分析、控制 等各 方 面工作。它可同时优化、计划、管理和控制多个项目 , 可 以多方 案分 析比 较、目标计 划跟 踪、可 实时监控。它利用先进的资源平衡来优化资源 计划 , 采用 图形 化操 作、双代号 网络 图 , 并 同时自动生成 7 种不同模式图、双代号网络图、单代号、逻辑图、单双混合图、横道图、时标 网络图 , 完全根据不同的需要来反映工程各种数据。将整个项目作为一个系统加以处理 , 通过网络计划形式对整个系统统筹规划 , 并进行有效的监控管理 , 解决项目上最关心的两个问题 : 进度和费用。以网络计划为核心技术的梦龙智能项目管理动态控制系统 M r Pe rt , 也正 好体现了 这 一点。它很好地解决了项目管理者关心的两个问题 : 进度和费用 , 为有效地管理工程提供 了极大的方便。大量的工程项目实践表明 , 应 用网络 计划 技术 管 理后 可以 缩短 建设 周 期 20 % , 降 低工程成本 10 % , 而编制网络计划所需费用仅为总费用的 0. 1 % 。在三峡工程、50 周年大阅兵、“神舟”号研制 和发 射等 众多的 项目 中 , 梦龙的 Mr Per t系统得到很好的应用。有关网络计划的计算机 软件 的开 发和 研究 发 展很 快 , 现在 已 有不 少 商品 化 的 软件。 国外的 网 络 计 划 软 件 有 : Tim e Line , Project Scheduler , Microsoft P roject 等。 如 Mi- c rosof t P roject 有若干不断改进的版本 , 但基本部分是大同小异的。学习和掌握使用可分 阶段进行 : 初步了解和掌握使用、熟练掌握和 灵活使 用。它 有一套 术语 , 也 可以分 阶段 的 熟悉它们。要全部掌握这些软件的使用是需要花一定时间的。编制大型工程项目网络计划图 , 要掌握网络计划技术 , 必须要掌握有关网络计划软件的使用。否则网络计划图就失 去其实际控制进度的作用。以下作初步介绍 , 便于读者入门和引起兴趣。5. 2 编制网络计划图前的准备工作1. 项目的工作分解结构 ( wor k b reakdown str uctu re , WBS)将一个项目按由粗 到细 的原 则 , 分 解为 若干 层次 , 一般 是树 状结 构。分 解 的粗 细 程 度 , 取决于使用者的要 求。最好将项 目的工作分解层 次多一些 , 细一些。这是一项 基础工 作, 要求 项目的 WBS 应当是 稳定的 , 然 后确定 工作的逻 辑关系 , 列出工作 逻辑关 系表, 如 表 11-1那样, 但是要更详细。一 旦经过有关部门 审定后 , 不能随意 变动。当 将整个 项目的 WBS 输入计算机后 , 软件可按使用者的需要 , 随时显示不同层次的纲目和细目。将工作按逻辑关系表输入 计算 机后 , 软 件 能自 动地 给 WBS 的每 组成 部 分指 定识 别 编号。计算机根据工作的识别编号进行运算。并 按软 件具 有的功 能 , 自动 完成各 种图 表 ·003·的绘制和有关参数的计算。2. 数据收集和整理对应项目工作分解结构各层次工作的数据。包括与计算工作持续时间有关的数据 , 对应各工作的所需要资源及其经济指标 , 与计算项目经济指标有关的各工作的 费用数据 , 以便进行项目的时间—费用分析。3. 熟悉有关网络计划软件的术语不同软件的术语虽然有些不一样 , 但基本术语是相同的。掌握本章的基本术语后 , 就比较容易理解不同软件中的术语。另一类是进一步分析用的术语 , 需要专门学习。5. 3 软件的功能网络计划软件一般都具有 : 项目清单表、资源清单表、任务清单表、甘特图、网络图、项 目分解结构树形图、资源分布图、日历、各种 分析 报告或 报表。 图与表 之间 的数据 是动 态连接的 , 保证数据输入或修改的一致性。当在 任务清 单表 中输 入项目 的各 工作与 有关 数 据后 , 软件自动生成甘特图 , 网络图根据日历中 指定的 项目 开工日 期 , 按规 定的每 月或 周 的工作日和工作班数 , 计算出各工作的最早 开始日 期、最迟 开始日 期、最早 结束日 期和 最 迟结束日期 , 并计算出关键路线和时差。软件具有平衡资源和优化资源利用的功能 , 根据 需要可打印出不同详细程度的网络计划图和有关报表。1. 界面一般软件都采用视窗界面 , 能显示带有时 标的 甘特图 界面、网 络计 划图界 面、资源 平 衡界面、可指定日期的日历、资源配置表等 , 显示需要的计算结果 , 显示关键路线 ( CP M ) 。2. 操作软件启动后 , 软件具有操作提示或帮 助 , 便于使 用。可 以修改 初始 数据 , 新增 加工 作 或删改已有工作。各工作的细化或合并 , 在 界面 上很容 易实 现。进行 调整 软件给 出的 图 表 , 编制需要的计算关系式和设计输出报表的格式。通过人—机交换 , 进一步分析网络和 优化网络等。3. 输出结果打印出网络计划图、甘特图 ( 横道图 ) 、资源平衡图、日历进度计划、分析报表等。有的软件可允许使用者自行设计报表的格式和打印需要的内容。参 考 资 料[1] 中国建筑学会建筑统筹管理分会编著 .工程网络 计划技 术规程 教程 .北京 : 中国建 筑工业 出版社 ,2000[2] 卢向南 .项目计划与控制 .北京 : 机械工业出版社 , 2004·103·七、排 队 论排队是在日常生活中经常遇到的现象 , 如顾客到商店购买物品、病人到医院看病常常 要排队。此时要求服务的人数超过服务机构 ( 服 务台、服务 员等 ) 的 容量 , 也 就是说 , 到 达 的顾客不能立即得到服务 , 因而出现了排队现象。这种现象不仅在个人日常生活中出现 , 电话局的占线问题 , 车站、码头等交通枢纽的车船堵塞和疏导 , 故障机器的停机待修 , 水库 水量的存储调节等都是有形或无形的排队现象。以下将要求服务的对象统称为顾客。由于顾客到达和服务时间的随机性 , 可以说排队现象几乎是不可避免的。如果增添服务设备 , 就要增加投资或发生 空闲 浪费 ; 如 果服务 设备 太少 , 排队 现象 就 会严重 , 对顾客个人和对社会都会带来不利影响。因此 , 管理人员必须考虑如何在这两者 之间取得平衡 , 经常检查目前处理是否得当 , 研究今后改进对策 , 以期提高服务质量 , 降低 成本。排队论 ( queueing theory ) 也称随机服 务系 统理论 , 就 是为 解决上 述问 题 而发 展的 一门学科 , 它研究的内容有下列三部分。(1 ) 性态问题 , 即研究各种排队 系统 的概 率规律 性 , 主要 是研究 队长 分布、等 待时 间分布和忙期分布等 , 包括了瞬态和稳态两种情形。(2 ) 最优化问题 , 又分静态最优 和动 态最 优 , 前 者指 最优 设计 , 后者 指现 有排 队系 统的最优运营。(3 ) 排队系统的统计推断 , 即判断一个给定的排队系统符合于哪种 模型 , 以便根据 排队理论进行分析研究。这里将介绍排队论的一些基本知识 , 分析几个常见的排队模型 , 最后将介绍排队系统的最优化问题。第 12 章 排 队 论第 1 节 基 本 概 念1. 1 排队过程的一般表示图 12-1 就是排队过程 的一 般 模型。 各 个顾 客 由顾 客 源 ( 总体 ) 出 发 , 到 达 服务 机 构 ( 服务台、服务员 ) 前排队等候接受服务 , 服务完成后就离开。排队结构指队列的数目和排 列方式 , 排队规则和服务规则是说明顾客在 排队系 统中 按怎 样的规 则、次序 接受服 务的。 我们所说的排队系统就指图中虚线所包括的部分。·203·图 12-1在现实中的排队现象是多种多样的 , 对上面所说的“ 顾客”和“ 服务员”, 要作广泛的了 解。它可以是人 , 也可以是非生物 ; 队列可以是具体地排列 , 也可以是无形的 ( 例如向电话 交换台要求通话的呼唤 ) ; 顾客可以走向服务 机构 , 也可 以相 反 ( 如送 货上门 ) 。下 面举 一 些例子说明现实中形形色色的排队系统 ( 见表 12-1 ) 。表 12-1到达的顾客要求服务内容服务机构1. 不能运转的机器修理修理技工2. 修理技工领取修配零件发放修配零件的管理员3. 病人诊断或动手术医生 ( 或包括手术台 )4. 电话呼唤通话交换台5. 文件稿打字打字员6. 提货单提取存货仓库管理员7. 到达机场上空的飞机降落跑道8. 驶入港口的货船装 ( 卸) 货装( 卸 )货码头 (泊位 )9. 上游河水进入水库放水 , 调整水位水闸管理员10. 进入我方阵地的敌机我方高射炮进行射击我方高射炮1. 2 排队系统的组成和特征一般的排队系统都有三个基本组成部分 : ①输入过程 ; ②排队规则 ; ③服务机构。 现在分别说明各部分的特征。1. 输入过程输入即指顾客到达排队系统 , 可能有下列各种不同情况 , 当然这些情况并不是彼此排斥的。(1 ) 顾客的总体 ( 称为顾客 源 ) 的组 成可能 是有 限的 , 也可 能是 无限 的。上游 河水 流入水库可以认为总体是无限的 , 工厂内停机待修的机器显然是有限的总体。(2 ) 顾客到来的方式可能 是一个 一个 的 , 也可能 是成 批的。例 如到 餐厅 就餐 就有 单个到来的顾客和受邀请来参加宴会的成批顾客 , 我们将只研究单个到来的情形。·303·eZeZeZeZeZeZeZeZeZ“ˆ(3 ) 顾客相继到达的间隔 时间可 以是 确定 型的 , 也可 以是 随机型 的。如 在自 动装 配线 上 装 配 的 各 部 件 就必 须 按 确 定 的 时 间 间隔到达 装 配 点 , 定 期 运 行 的 班 车、班 轮、班 机的到达 也 都 是 确 定 型 的。 但 一 般 到 商 店购物的顾客、到医院诊病的病人、通过 路口的车辆等 , 它 们 的 到 达 都 是 随 机 型 的。 对 于 随机型 的 情 形 , 要 知 道 单 位 时 间 内 的 顾 客 到达数或相继到达的间隔时间的概率分布 ( 图 12-2 ) 。图 12-2(4 ) 顾客的到达可以是相互独立的 , 就是说 , 以前的到达情况对 以后顾客 的到来没 有 影响 , 否则就是有关联的。例如 , 工厂内的机器在 一个 短的时 间区 间内出 现停 机 ( 顾客 到 达 ) 的概率就受 已经 待 修或 被 修 理的 机 器 数 目 的影 响。 我 们主 要 讨 论 的 是相 互 独 立 的 情形。(5 ) 输入过程可以是平稳的 , 或称对时间是齐次的 , 是指描述相 继到达的 间隔时间 分 布和所含参数 ( 如期望值、方差等 ) 都是与时间无关的 , 否则称为非平稳的。非平稳情形的 数学处理是很困难的。2. 排队规则(1 ) 顾客到达时 , 如所有服务台 都正 被占 用 , 在 这种 情形 下顾客 可以 随即 离去 , 也 可 以排队等候。随即离去的称为即时制或称损失制 , 因为这将失掉许多顾客 ; 排队等候的称 为等待制。普通市内电话的呼唤属于前者 , 而登记市外长途电话的呼唤属于后者。对于等待制 , 为顾客进行服务的次序可以 采用 下列各 种规 则 : 先到 先服务 , 后 到先 服务 , 随机服务 , 有优先权的服务等。先到先服务 , 即按到达次序接受服务 , 这是最通常的情形。 后到先服务 , 如乘用电 梯的 顾 客常 是后 入先 出的。 仓 库中 存 放的 厚 钢板 也 是 如此。 在情报系统中 , 最后到达的信息往往是最有价值的 , 因而常采用后到先服务 ( 指被采用 ) 的 规则。随机服务 , 指服务员从等待的顾客中随 机地选 取其 一进行 服务 , 而 不管 到达的 先后 ,如电话交换台接通呼唤的电话就是如此。有优先权的服务 , 如医院对于病情严重的患者将给予优先治疗。 (2 ) 从占有的空间来看 , 队列 可以排 在具 体的处 所 ( 如 售票处、候 诊室 等 ) , 也 可以 是 抽象的 ( 如向电话交换台要求通话的呼唤 ) 。由 于空间 的限 制或其 他原 因 , 有的系 统要 规 定容量 ( 即允许进入排队系统的顾客数 ) 的最大限 ; 有的没有这种限制 ( 即认为容量可以是 无限的 ) 。(3 ) 从队列的数目看 , 可以是 单列 , 也可 以是 多列。在 多列 的情形 , 各 列 间的 顾客 有 的可以互相转移 , 有的不能 ( 如用绳子或栏杆隔 开 ) 。有的 排队 顾客因 等候 时间过 长而 中 途退出 , 有的不能退出 ( 如高速公路上的汽车流 ) , 必须坚持到被服务为止。我们将只讨论 各队列间不能互相转移 , 也不能中途退出的情形。·403·3. 服务机构从机构形式和工作情况来看有以下几种情况。(1 ) 服务机构可以没有服务员 , 也可以有一个或多个服务员 ( 服务台、通道、窗口等 ) 。例如 , 在敞架售书的书店 , 顾客选书时就没有服务员 , 但交款时可能有多个服务员。(2 ) 在有多个服务台的情 形中 , 它们 可以 是平行 排列 ( 并列 ) 的 , 可以 是前 后排 列 ( 串列 ) 的 , 也可以是混合的。图 12-3 说明了这些情形。图 12-3图 12-3 中 ( a ) 是单队—单服务台的情形 ; ( b ) 是多队—多服务台 ( 并 列 ) 的情形 ; ( c ) 是 单队—多服务台 ( 并列 ) 的情形 ; ( d) 是 多服 务台 ( 串 列 ) 的 情形 ; ( e ) 是多 服务 台 ( 混合 ) 的 情形。(3 ) 服务方式可以对单个顾客进行 , 也可以对成批顾客进行 , 公 共汽车对 在站台等 候的顾客就成批进行服务。我们将只研究单个单个的服务方式。(4 ) 和输入过程一样 , 服务时 间也分 确定 型的和 随机 型的。自 动冲 洗汽 车的 装置 对 每辆汽车冲洗 ( 服务 ) 的时间就是确定型的 , 但大 多数情 形的 服务 时间是 随机 型的。对 于 随机型的服务时间 , 需要知道它的概率分布。如果输入过程 , 即相继到达的间隔时间和服务时间二者都是确定型的 , 那么问题就太简单了。因此 , 在排队论中所讨论的是二者至少有一个是随机型的情形。(5 ) 和输入过程一样 , 服务时间 的分 布我 们总假 定是 平稳的 , 即 分布 的期 望值、方 差等参数都不受时间的影响。1. 3 排队模型的分类D .G .Kendall 在 1953 年提出排队模型分类方法 , 影响最大的特征有三个 , 即 (1 ) 相继顾客到达间隔时间的分布 ; (2 ) 服务时间的分布 ; (3 ) 服务台的个数。 按照这三个特征分类 , 并用一定符号表示 , 称为 Kendall 记号。 这只对并 列的服务 台( 如果服务台是多于一个的话 ) 的情形 , 他用的符号形式是 :·503·X/ Y/ Z其中 , X 处填写表示相继到达间隔时间的分布 ;Y 处填写表示服务时间的分布 ; Z 处填写并列的服务台的数目。表示相继到达间隔时间和服务时间的各种分布的符号是 : M———负指数分布 ( M 是 M arkov 的字头 , 因为负指数分布具有无记忆性 , 即 Markov性 ) ;D———确定型 ( deterministic ) ; Ek ——— k 阶爱尔朗 ( erlang ) 分布 ; G I——— 一般相互独立 ( gener al independen t ) 的时间间隔的分布 ; G——— 一般 ( gener al ) 服务时间的分布。 例如 , M/ M/ 1 表示相继到达 间 隔时 间为 负指 数分 布、服 务 时 间为 负 指数 分 布、单 服 务台的模型 ; D/ M/ c 表示确定的到达间隔、服务时间为负指数分布、c 个平行服务台 ( 但 顾 客是一队 ) 的模型。以后 , 在 1971 年一次关于排队论符号标准化会议上决定 , 将 Kendall 符号扩 充成为 :X/ Y/ Z/ A/ B/ C 形式 , 其中前三项意义不变 , 而后三项意义分别是 :A 处填写系统容量限制 N ; B 处填写顾客源数目 m ; C 处填写服务规则 , 如先到先服务 ( FC FS) , 后到后服务 ( LCFS ) 等。 并约定 , 如略去后三项 , 即指 X/ Y/ Z/ ∞/ ∞/ F CFS 的情形。在本书中 , 因只讨论先到先服务 F CFS 的情形 , 所以略去第六项。1. 4 排队问题的求解一个实际问题作为排队问题求解时 , 首先要研究它属于哪个模型 , 其中只有顾客到达 的间隔时间分布和服务时间的分布需要实测的 数据来 确定 , 其 他因素 都是 在问题 提出 时 给定的。解排队问题的目的 , 是研究排队系统运行 的效 率 , 估计 服务质 量 , 确定 系统参 数的 最 优值 , 以决定系统结构是否合理、研究设计改进措施等。所以必须确定用以判断系统运行 优劣的基本数量指标 , 解排队问题就是首先 求出 这些数 量指 标的 概率分 布或 特征数。 这 些指标通常是 :(1 ) 队长 , 指在系统中的顾客数 , 它的期望值记作 Ls ;排队长 ( 队列长 ) , 指在系统中排队等待服务的顾客数 , 它的期望值记作 Lq ;系统中在队列中等待正被服务顾客数=服务的顾客数+的顾客数一般情形 , Ls ( 或 Lq ) 越大 , 说明服务率越低 , 排队成龙 , 是顾客最厌烦的。 (2 ) 逗留时间 , 指一个顾客在系统中的停留时间 , 它的期望值记作 W s ;等待时间 , 指一个顾客在系统中排队等待的时间 , 它的期望值记作 W q , [ 逗留时间 ] = [ 等待时间 ] + [ 服务时间 ]在机器故障问题中 , 无论是等待修理或 正在 修理都 使工 厂受 到停工 的损 失。所以 逗·603·留时间 ( 停工时间 ) 是主要的。但一般购物、诊 病等问 题中 仅仅 等待时 间常 是顾客 们所 关 心的。此外 , 还有忙期 ( busy period) 指从顾客到 达空闲 服务 机构 起到服 务机 构再次 为空 闲 止这段时间长度 , 即服务机构连续繁忙的时间长度 , 它关系到服务员的工作强度。忙期和 一个忙期中平均完成服务顾客数都是衡量服务机构效率的指标。在即时制或排队有限制的情形 , 还有由于顾 客被 拒绝而 使企 业受 到损失 的损 失率 以及以后经常遇到的服务强度等 , 这些都是很重要的指标。计算这些指标的基础是表达系统状态的概 率。所 谓系 统的状 态即 指系 统中顾 客数 ,如果系统中有 n 个顾客就说系统的状态是 n , 它的可能值是 :(1 ) 队长没有限制时 , n = 0 , 1 , 2 , … (2 ) 队长有限制 , 最大数为 N 时 , n = 0 , 1 , 2 , … , N (3 ) 即时制 , 服务台个数是 c 时 , n = 0 , 1 , 2 , … , c 后者 , 状态 n 又表示正在工作 ( 繁忙 ) 的服务台数。 这些状态的概率一般是随时刻 t 而变化 , 所以在时刻 t、系统状态为 n 的概率用 P n ( t)表示。求状态概 率 Pn ( t ) 的 方 法 , 首 先 要 建 立 含 Pn ( t) 的关 系式 见 图 12 -4 , 因为 t 是 连 续 变量 , 而 n 只取非负整数 , 所以建立的 Pn ( t) 的关系式 一般是微分差分方程 ( 关于 t 的微分 方程 , 关 于 n 的差分方程 ) 。方 程的解 称为 瞬态 ( 或 称过 渡 状态 ) ( t r ansien t sta te ) 解。求 瞬态 解 是不 容 易 的 , 一般 地 , 即使 求 出也 很难 利用 , 因此 我们 常 用它的极限 ( 如果存在的话 )图 12 -4lim t→ ∞Pn ( t) = Pn称为稳态 ( steady state ) , 或称统计平衡状态 ( statistical equilibrium sta te) 的解。稳态的物理含义是 , 当系统运行了无限长的时间之后 , 初始 ( t = 0 ) 出发状 态的概率 分布 ( Pn ( 0) , n≥0) 的影响将消 失 , 而且 系统 的状 态概 率 分布 不再 随时 间变 化。当 然 , 在 实 际应用中大多数问题系统会很 快趋 于稳 态 , 而 无需 等到 t→ ∞ 以后。 但永 远 达不 到稳 态 的情形也确实存在的。求稳态概率 Pn 时 , 并不一定求 t→∞时 Pn ( t) 的极限 , 而只需令导数 P′n ( t) = 0 即可。我们以下着重研究稳态的情形。第 2 节 到达间隔的分布和服务时间的分布解决排队问题首先要根据原始资料作出顾客 到达 间隔 和服务 时间 的经验 分布 , 然 后按照统计学的方法 ( 例如 χ2 检验法 ) 以确定合于哪种理论分布 , 并估计它的参数值。本 节先举例说明经 验 分 布 , 然 后 介 绍 常 见 的 理 论 分 布———泊 松 分 布、负 指 数 分 布 和 爱 尔 朗 ( Erlang) 分布。·703·2. 1 经验分布现在举例说明原始资料的整理。例 1 大连港大港区 1979 年载 货 500 吨以 上船舶 到 达 ( 不 包括 定期 到达 的 船舶 ) 逐日记录见表 12 -2 。表 12 -2月日1234567891011121314一810410144703240二25527362322223三33524743343245四62154343755113五74122343532754六14265274331345七41133484443530八43443125535436九34417707230662十52116646236735十一54352344313334十二65521542223175月日1718192021222324252627282930一54211362344203二226521535522三12382332547241四54446514414364五21632525424444六52433363556214七13442355124346八20634644512845九44531461235024十62510793251735十一21036635512224十二67312134139331摘 自《港口 装卸》, 1980 第 5 期 , 第 5 页。·803·1524373571235131132313416262473433204CÈP=Sõ€§zd¡‹ïÎ(cid:22)(cid:28),ÞÈS={z9(cid:144)¡‹ïi(cid:22)(cid:5),=SÞÈdz9(cid:144)¡‹ïi(cid:22)(cid:5),SÞ=Èd(cid:144)z9¡ïi‹(cid:5)(cid:22),Þ=SÈdz9(cid:144)¡iï‹(cid:22)(cid:5),ÞS=È(cid:144)z9d¡ïi‹(cid:5)(cid:22),=SÈÞ(cid:144)9dz¡iï‹(cid:5)(cid:22),ÞSÈ=9d(cid:144)z¡‹ïi(cid:5)(cid:22),ÈÞ=S9dz(cid:144)ï¡‹i(cid:22)(cid:5),=ÈSÞd(cid:144)9z‹ï¡i(cid:5)(cid:22),ÞSÈ=9dz(cid:144)i¡ï‹(cid:22)(cid:5),ÞÈS=d9z(cid:144)ïi‹¡(cid:5)(cid:22),SÈ=Þ9zd(cid:144)¡i‹ï(cid:22)(cid:5)CTß¢õ{ã§ j(cid:6)(cid:28),Þ=ÈS(cid:144)zdï¡‹Ì(cid:22)(cid:5),ÞÈ=Szd‹¡ï(cid:5)(cid:22),ÞS=Èz(cid:144)dï¡Ì‹(cid:5)(cid:22),ÞÈS=dz(cid:144)‹ï¡(cid:5)(cid:22),ÈS=Þzd(cid:144)Ìï¡‹(cid:22)(cid:5),=ÞÈSd(cid:144)zï¡‹(cid:5)(cid:22),ÈÞ=Sz(cid:144)d¡ï‹Ì(cid:22)(cid:5),ÈÞS=z(cid:144)dïÌ¡‹(cid:5)(cid:22),ÞÈ=Sdz(cid:144)‹ï¡(cid:5)(cid:22),=SÈÞd(cid:144)z‹¡ïÌ(cid:5)(cid:22),ÈS=Þdz‹¡ï(cid:22)(cid:5),SÈÞ=(cid:144)zd‹¡ï (cid:5)Ì (cid:5)将表 12 -2 整理成船舶到达数的分布表 ( 表 12 -3) 。表 12 -3 船舶到达数分布表 ( 大连港大港区 1979 )船舶到达数 n频 数频 率 ( % )0120. 0331430. 1182640. 1753740. 2034710. 1955490. 1346260. 0717190. 052840. 011920. 00510 以上10. 003合计3651. 000平均到达率 =到达总数 总天数 =1271 365= 3 .48 ( 艘/ 天 )更原始的资料是记录各顾客到达的时刻和对各顾客的服务时间。以τi 表示第 i 号顾 客到 达 的 时 刻 , 以 si 表 示 对 它 的 服 务 时 间 , 这 样 可 算 出 相 继 到 达 的 间 隔 时 间 ti ( ti =τi + 1 - τi ) 和排队等待时间 wi , 它们的关系见图 12 -5 。图 12 -5从图 12 -5 中看出 间隔ti =τi + 1 - τi等待时间wi + 1 =wi + si - ti , 当 wi + si - ti > 0 当 wi + si - ti < 00 ,(12 -1)例 2 某服务机构是单服务台 , 先 到先 服务 , 对 41 个 顾客 记 录到 达时 刻 τ和 服务 时 间 s( 单位为分钟 ) 如表 12 -4 , 在 表中 以第 1 号 顾客 到 达时 刻 为 0。全 部 服 务时 间 为 127 分钟。·903·RGL(cid:31)RGL(cid:31)RGL(cid:31)RGL(cid:31)RGL(cid:31)RGL(cid:31)RGL(cid:31)RGL(cid:31)RGL(cid:31)RGL(cid:31)RGLRGL表 12 -4(1 ) i( 2)τi(3) si(4 ) ti(5 ) wi(1) i(2 )τi( 3) si(4) ti1052022833322743238662361562488544119122592135122710269536619435271012472234628105218263105291061393612030109251038270311141211455203211681124742333117441349135341212614522933512712156111036129611662230371303317651503813352187032039135241972481401394320803104114212181222各 栏意 义 :(1 ) 顾客编 号 i ; (2 ) 到 达时 刻τi ; (3 ) 服 务时 间 si ; 以上 三栏是 原始 记录 ; ( 4 ) 到 达间隔 ti ; ( 5 ) 排 队等待 时间 wi , 这两栏是通 过 ( 12 -1 ) 式 计算得 到的 。现将上面的原始记录整理成表 12 -5 和表 12 -6。表 12 -5 到达间隔分布表表 12 -6 服务时间分布表到达间隔/ 分钟次数服务时间/ 分钟次数161102102103837464553546262728171918110 以上19 以上1合 计40合 计41·013·(5 ) wi226752010007732771089©æSõbƒð](cid:22)©æSbƒðõ](cid:22)©æSbõƒð](cid:22)æ©Sbƒðõ](cid:22)©æSbõðƒ](cid:22)©æSƒbõð](cid:22)©æSbƒðõ](cid:22)©æSƒbõð](cid:22)©æSƒõðb](cid:22)©æSƒbõð](cid:22)æ©Sƒðõb](cid:22)æ©Sƒõbð](cid:22)æ©Sƒõbð](cid:22)©æSbõƒð](cid:22)æ©Sðbõƒ](cid:22)æ©Sbðƒõ](cid:22)©æSõðbƒ](cid:22)©æSƒðõb](cid:22)©æSðõƒb](cid:22)©æSðbƒ](cid:22)©ðƒ](cid:22)Ø%RîØîR%ØîR%Øî%RØîR%ØîR%Øî%RØî%RØîRîRî平均间隔时间 = 142/ 40 = 3. 55 ( 分钟/ 人 ) 平均到达率 = 41/ 142 = 0. 28 ( 人/ 分钟 ) 平均服务时间 = 127/ 41 = 3. 12 ( 分钟/ 人 ) 平均服务率 = 41/ 127 = 0. 32 ( 人/ 分钟 )下面介绍经常用的几个理论分布。2. 2 泊松流设 N ( t) 表示在时间区间 [0 , t) 内到达的顾客数 ( t > 0 ) 令 Pn ( t1 , t2 ) 表示在时间区间 [ t1 , t2 ) ( t2 > t1 ) 内有 ( n≥ 0 ) 个顾客 到达 ( 这当然 是随 机事件 ) 的概率 , 即Pn ( t1 , t2 ) = P{ N( t2 ) - N( t1 ) = n} ( t2 > t1 , n≥0)当 Pn ( t1 , t2 ) 合于下列三个条件时 , 我们说顾客的到达形成泊松流。这三个条件是 :(1 ) 在不相重叠的时间区间内顾客到达数是相互独立的 , 我们称这性质为无后效性。 ( 2) 对充分小的 Δt, 在时间区间 [ t, t + Δt) 内有 1 个顾客到达的概率与 t 无关 , 而约与区间长 Δt 成正比 , 即P1 ( t, t + Δt) = λΔt + o(Δt) (12 -2) 其中 o(Δt) , 当 Δt→0 时 , 是关于 Δt 的高阶无穷小。λ> 0 是常数 , 它表示单位时间有一 个 顾客到达的概率 , 称为概率强度。(3 ) 对于充分小的 Δt, 在时间区间 [ t, t + Δt) 内有 2 个或 2 个以 上顾客到 达的概率 极小 , 以至于可以忽略 , 即∞∑Pn ( t, t + Δt) = o(Δt)(12 -3)n = 2在上述条件下 , 我们研究顾客到达数 n 的概率分布。 由条件 (2 ) , 我们总可以取时间由 0 算起 , 并简记 Pn (0 , t) = Pn ( t) 由条件 (2 ) 和 ( 3) , 容易推得在 [ t, t + Δt) 区间内没有顾客到达的概率P0 ( t, t + Δt) = 1 - λΔt + o(Δt)(12 -4) 在求 Pn ( t) 时 , 用通常建立未知函数的微分方程的方法 , 先求未知函数 Pn ( t) 由时 刻 t到 t + Δt 的改变量 , 从而建立 t 时刻的概率分布与 t + Δt 时刻概率分布的关系方程。对于区间 [0 , t + Δt) , 可 分 成 两 个 互 不 重 叠 的 区 间 [ 0 , t) 和 [ t, t + Δt ) 。 现 在 到 达 总数是 n, 分别 出 现 在 这 两 区 间 上 , 不 外 下 列 三 种 情 况。 各 种 情 况 出 现 个 数 和 概 率 见 表 12 -7 。在 [0 , t + Δt ) 内 到 达 n 个 顾 客 应 是 表 中 三 种 互 不 相 容 的 情 况 之 一 , 所 以 概 率Pn ( t + Δt) 应是表中三个概率之和 ( 各 o(Δt) 合为一项 )Pn ( t + Δt) = Pn ( t) ( 1 - λΔt) + Pn - 1 ( t)λΔt + o(Δt) Pn ( t + Δt) - Pn ( t) o(Δt) Δt Δt= - λPn ( t) + λPn - 1 ( t) +·113·表 12 -7区间[0 ,t)[ t,t + Δt)[0 ,t + Δt)情况个数概 率个数概 率个数概率( A )nPn ( t)01 - λΔt + o(Δt)nPn ( t) ( 1 - λΔt + o(Δt) )( B)n - 1Pn - 1 ( t)1λΔtnPn - 1 ( t)λΔtn - 2Pn - 2 ( t)2n( C)n - 3⁝Pn - 3 ( t)⁝3⁝o(Δt)n⁝o(Δt)0P0 ( t)nn令 Δt→0 , 得下列方程 , 并注意到初始条件 , 则有d Pn ( t) d t= - λPn ( t) +λPn - 1 ( t) ,n≥1(12 -5)Pn ( o) = 0 ;当 n = 0 时 , 没有 ( B) , ( C) 两种情况 , 所以得d P0 ( t) d t= - λP0 ( t)(12 -6)P0 ( o) = 1解 (12 -5 ) 和 ( 12 -6 ) , 就得Pn ( t) =(λt) n n !e - λt ,①(12 -7)t > 0n = 0 , 1 , 2 , …Pn ( t) 表示长为 t 的时间区 间内 到达 n 个 顾客的 概率 , 由 ( 12 -7 ) 式 , 像在 概率 论中 所 学过的 , 我们说随机变量{ N ( t) = N ( s+ t) - N( s)} 服从 泊松 分布。它 的数 学期望 和方 差 分别是① 证明 时先解 ( 12 -6) 得 P0 ( t) = e-λt ,然后在 方程 (12 -5) 两 边乘 积分因 子 eλt , 并迁 项eλt d P n ( t)d t+ λP n ( t) eλt = λeλt P n - 1 ( t)d d t[ Pn ( t) eλt ] = λP n - 1 ( t) eλt积分得Pn ( t) eλt = λ∫tuP n - 1 ( t1 ) eλt1 d t1依次代 入 n = 1 , 2 , …n = 1 ,P1 ( t) eλt = λ∫t0e- λt1 eλt1 d t1 = λt ,P1 ( t) = λte -λtn = 2 ,P2 ( t) eλt = λ∫t0λt1 e-λt1 eλt1 d t1 =1 2λ2 t2所以P2 ( t) =λ2 t2 2 !e-λt递推 , 即可 得 ( 12 -7 ) 。证 毕。·213·ðE[ N( t) ] =λt; Var [ N ( t) ] = λt(12 -8) 期望值和方差相等 , 是泊松分布的一个重要特征 , 我们可以利用它对一个经验分布是否合于泊松分布进行初步的识别。2. 3 负指数分布随机变量 T 的概率密度若是f T ( t) =λe- λt , t≥0 t < 0 0 ,(12 -9)则称 T 服从负指数分布。它的分布函数是FT ( t) =1 - e- λt ,0 ,t≥0t < 0( 12 -10)数学期望 E[ T ] =1 λ; 方差 Var [ T] =1 λ2 ; 标准差 σ[ T ] =1 λ负指数分布有下列性质 : (1 ) 由条件概率公式容易证明( 12 -11) P{ T > t + s| T > s} = P{ T > t} 这性质称为无记忆性或马尔柯夫性。若 T 表示排队系统 中顾客 到达的间 隔时间 , 那么 这 个性质说明一个顾客到来所需的时间与 过去 一个 顾客到 来所 需时间 s 无关 , 所以 说这 情 形下的顾客到达是纯随机的。( 2) 当输入过程是泊松流时 , 那么顾客相继到达的间隔时间 T 必须服从负指数分布。这是因为对于泊松流 , 在 [ 0 , t) 区间内至少有 1 个顾客到达的概率是1 - P0 ( t) = 1 - e- λt , t > 0而这概率又可表示为P{ T≤ t} = F T ( t)结合 (12 -10) , 这性质得到证明。因此 , 相继到达的间隔时间是独立且为同 负指数分 布 ( 密 度函数 为 λe - λt , t≥0 ) , 与 输入过程为泊松流 ( 参数为 λ) 是等价的。所以在 Kendall 记号中就都用 M 表示。对于泊松流 ,λ表示单位时间平均到达的顾客数 , 所 以 1/ λ就 表示相 继顾客到 达平 均间隔时间 , 而这正和 E[ T ] 的意义相符。服务时间 v 的分布 对一顾客的服务时间也就是在忙期相继离开系统的两顾客的间隔时间 , 有时也服从负指数分布。这时设它的分布函数和密度分别是Fv ( t) = 1 - e - μt ,f v ( t) = μe - μ t( 12 -12)其中 μ表示单位时间能被服务 完成 的顾 客数 , 称为 平均 服务率 , 而 1μ = E( v ) 表示 一个 顾客的平均服务时间 , 这里平均就是期望值。2. 4 爱尔朗分布设 v1 , v2 , … , vk 是 k 个相互独立的随机变量 , 服从相同参数 kμ的负指数分布 , 那么T = v1 + v2 + … + vk·313·的概率密度是bk ( t) =μk(μkt) k - 1 ( k - 1) !e - μ kt , t > 0( 证明略 ) 我们说 T 服从 k 阶爱尔朗分布。E[ T ] =1 μ; Va r[ T ] =1 kμ2这是因为E[ vi ] =1 kμ, i = 1 , 2 , … , k1 所以kE[ T] = ∑i = 1E( vi ) =1 μ例如串列的 k 个服务台 , 每台服务时间相互独立 , 服从相同的负 指数分 布 ( 参数 kμ) ,那么一顾客走完这 k 个服务台总共所需要服务时间就服从上述的 k 阶爱尔朗分布。注意 爱尔朗分 布族 提供 更为 广 泛的 模型 类 , 比 指数分布有更大的适 应性。 事实 上 , 当 k = 1 时 , 爱 尔 朗分布化为负指数分布 , 这可 看成是 完全 随机的 ; 当 k 增大时 , 爱尔朗分布的图形逐 渐变为 对称 的 ; 当 k≥30 时爱尔朗分布近似于正态分布 ; k→∞时 , 由 ( 12 -14) 看 出 Va r[ T ] → 0 , 因此这 时爱尔朗 分布化为 确定型 分布 ( 参看图 12 -6) , 所以一般 k 阶 爱尔朗 分布可 看成 完全 随机与完全确定的中 间型 , 能 对 现实 世界 提供 更为 广 泛的适应性。图 12 -6第 3 节 单服务台负指数分布排队系统的分析在本节中讨论单服务台的排队系统 , 它的输入过程服从泊松分布过程 , 服务时间服从负指数分布。按以下三种情形讨论。(1 ) 标准的 M/ M/ 1 模型 , 即 ( M/ M/ 1/ ∞/ ∞ ) ; (2 ) 系统的容量有限制 , 即 ( M/ M/ 1/ N/ ∞ ) ; (3 ) 顾客源为有限 , 即 ( M/ M/ 1/ ∞/ m) 。3. 1 标准的 M/ M/ 1 模型( M/ M/ 1/ ∞/ ∞ )标准的 M/ M/ 1 模型是指适合下列条件的排队系统 : (1 ) 输入过程———顾客源是无 限的 , 顾客 单个 到来 , 相互 独立 , 一 定时 间 的到 达数 服从泊松分布 , 到达过程已是平稳的。(2 ) 排队规则———单队 , 且对队长没有限制 , 先到先服务。 (3 ) 服务机构———单 服务 台 , 各 顾 客的 服 务时 间 是相 互 独 立的 , 服从 相 同的 负 指 数·413·( 12 -13)( 12 -14)分布。此外 , 还假定到达间隔时间和服务时间是相互独立的。 在分析标准的 M/ M/ 1 模型时 , 首先要求出系统在任意时刻 t 的状态为 n ( 系统中有 n个顾客 ) 的概率 Pn ( t) , 它决定了系统运行的特征。因已知到达规律服从参数为 λ的泊松过程 , 服务时间服从参数为 μ的负指数分布 , 所以在 [ t, t + Δt) 时间区间内分为 :(1 ) 有 1 个 顾 客 到 达 的 概 率 为 λΔt + o (Δt ) ; 没 有 顾 客 到 达 的 概 率 就 是 1 -λΔt + o(Δt) 。(2 ) 当有顾客在接受服务时 , 1 个顾客被服务完了 ( 离去 ) 的概率是 μΔt + o(Δt) , 没 有离去的概率就是 1 - μΔt + o(Δt) 。(3 ) 多于一个顾客的到达或离去的概率是 o(Δt) , 是可以忽略的。 在时刻 t + Δt, 系统中有 n 个顾客 ( n > 0) 存在 下列四种 情况 ( 到达或 离去是 2 个以 上的没列入 ) :在区间[ t,t + Δt)情况在时刻 t 顾客数在时刻 t + Δt 顾客数到 达离 去( A)n××n( B)n + 1×n( C)n - 1×n( D)nn表示发生 (1 个 ) ; ×表示没有发生。 它们的概率分别是 ( 略去 o(Δt) ) : 情况 ( A) 情况 ( B) 情况 ( C) 情况 ( D) Pn ( t) (1 - λΔt) ( 1 - μΔt) Pn + 1 ( t) (1 - λΔt) ·μΔt Pn - 1 ( t) ·λΔt( 1 - μΔt) Pn ( t) ·λΔt·μΔt由于这四种情况是互不相容的 , 所以 Pn ( t + Δt) 应是这四项之 和 , 即 ( 将关于 Δt 的高阶 无 穷小合成一项 ) :Pn ( t + Δt) = Pn ( t) ( 1 - λΔt - μΔt) + Pn + 1 ( t)μΔt + Pn - 1 ( t)λΔt + o(Δt)Pn ( t + Δt) - Pn ( t) Δt=λPn - 1 ( t) + μPn + 1 ( t) - (λ+ μ) Pn ( t) +o(Δt) Δt令 Δt→0 , 得关于 Pn ( t) 的微分差分方程d Pn ( t) d t=λPn - 1 ( t) + μPn + 1 ( t) - (λ+ μ) Pn ( t) n = 1 , 2 , …( 12 -15)当 n = 0 , 则只有上表中 ( A) , ( B) 两种情况 , 即P0 ( t + Δt) = P0 ( t) ( 1 - λΔt) + P1 ( t) (1 - λΔt)μΔt同理求得·513·66d P0 ( t) d t= - λP0 ( t) + μP1 ( t)这样系统状态 ( n) 随时间变化的过程是称为生灭过程的一个特殊情形。 解方程 (12 -15) (12 -16 ) 是很麻烦的 , 求得的解 ( 瞬态 解 ) 中 因为含 有修 正的贝 塞耳 函 数 , 也不便于应用 , 我们只研究稳态的情况 , 这时 Pn ( t) 与 t 无关 , 可 写成 Pn , 它的 导数 为 0。由 ( 12 -15 ) 式和 ( 12 -16) 式可得λP0 + μP1 = 0 λPn - 1 + μPn + 1 - (λ+ μ) Pn = 0 n≥ 1这是关于 Pn 的差分方程。它表明了各状态间的转移关系 , 用图 12 -7 表示。图 12 -7由图 12 -7 可见 , 状态 0 转移 到状态 1 的转移 率为 λP0 , 状态 1 转移到 状态 0 的转 移率 为 μP1 。对状态 0 必须满足以下平衡方程λP0 = μP1同样对任何 n≥ 1 的状态 , 可得到 ( 12 -18) 的平衡方程。求解 (12 -17) 得P1 = (λ/ μ) P0将它代入 (12 -18) , 令 n = 1 ,μP2 = (λ+ μ) (λ/ μ) P0 - λP0 ; 所以 P2 = (λ/ μ) 2 P0同理依次推得Pn = (λ/ μ) n P0今设 ρ=λ μ< 1 ( 否则队列将排至无限远 ) , 又由概率的性质知∞∑Pn = 1n = 0将 Pn 的关系代入 ,∞P0 ∑n = 0ρn = P0 · 11 - ρ= 1得P0 = 1 - ρ Pn = (1 - ρ)ρn , n≥1ρ< 1这是系统状态为 n 的概率。上式的 ρ有其 实际 意 义。根据 表 达式 的不 同 , 可 以有 不同 的解 释。当 ρ= λ/ μ表 达 时 , 它是平均到达率与平均服务率之比 ; 即在相同时区内顾客到达的平均数与被服务的平 均数之比。若表示为 ρ= ( 1/ μ)/ ( 1/ λ) , 它 是 为 一个 顾 客的 服 务时 间 与 到 达间 隔 时 间 之 比 ; 称 ρ为服务强度 ( t raffic in ten sity) , 或称 ρ为话 务强 度。这 是因为 早期 排队论 是爱 尔 朗等人在 研究电 话理 论时用 的术 语 , 一直 沿用至 今。由 ( 12 -19 ) 式 ,ρ= 1 - P0 , 它 刻画 了·613·( 12 -16)( 12 -17)( 12 -18)( 12 -19)服务机构的繁忙程度 ; 所以又称服务机构的利用率。读者可考虑由于 ρ的大小不 同值 , 将 会产生顾客与服务员之间、服务员与管理员之间怎样不同的反应或矛盾。以 (12 -19) 式为基础 , 可以算出系统的运行指标。 (1 ) 在系统中的平均顾客数 ( 队长期望值 )∞∞Ls = ∑nP n = ∑n( 1 - ρ)ρnn = 0n = 1= (ρ+ 2ρ2 + 3ρ3 + … )(ρ2 + 2ρ3 + 3ρ4 + … )= ρ+ ρ2 + ρ3 + … =ρ , 1 - ρ0 < ρ < 1或Ls =λ μ - λ(2 ) 在队列中等待的平均顾客数 ( 队列长期望值 )∞∞∞Lq = ∑( n - 1) Pn = ∑nP n - ∑Pnn = 1n = 1n = 1= Ls - ρ =ρ2 1 - ρ=ρλ μ - λ关于顾客在系统中逗留的时间 W ( 随机变量 ) , 在 M/ M/ 1 情形下 , 它服从参数 为μ- λ的负指数分布 ① , 即 分布函数概率密度F( w) = 1 - e - ( μ- λ) w f ( w) = (μ- λ) e -(μ- λ) ww≥ 0( 12 -20)于是得(3 ) 在系统中顾客逗留时间的期望值W s = E[ W ] =1 μ- λ(4 ) 在队列中顾客等待时间的期望值W q = W s -1 μ=ρ μ - λ现将以上各式归纳如下 :① 设一 顾客到 达时 , 系 统已有 n 个顾 客 , 按先 到先服 务 的 规 则 , 这 个 顾 客的 逗 留 时 间 W n 就 是原 有 各 顾 客的 服务时间 T i 和 这个顾 客服务 时间 T n+ 1 之和W n = T′1 + T2 + … + T n + Tn + 1其中第 一个 顾客正 被服务 , T′1 是 到服务 完了 的部分 服务 时间。 令 f ( w | n + 1) 表示 W n 的概率 密度 , 这 是在系 统已 有 n 个 顾客条 件下 的条件 概率 密度 , 所以 W 的概 率密度∞f( w) = ∑P n f ( w | n + 1)n = 0现若 T i ( i = 2 , … , n + 1) 都服 从参数 为 μ的负指 数分 布 , 根 据负 指 数分 布 的无 记 忆性 。 T′1 也 服 从 同分 布 的 负 指数 分 布。由 ( 12 -13 ) 式得 W n 服 从爱 尔朗分 布f ( w | n + 1 ) =μ(μw) n e - μw n !所以∞f( w ) = ∑n = 0(1 - ρ)ρn ·μ(μ w ) n n !∞e- μw = (1 - ρ)μe -μ w ∑n = 0(ρμ w) n n != (μ- λ) e - (μ- λ) w证 毕。·713·(1 ) Ls =(3 ) W s =λ μ - λ(2 ) Lq =1μ- λ (4 ) W q =ρλ μ - λ ρ μ - λ( 12 -21)它们相互的关系如下 :(1 ) Ls = λWs( 2) Lq =λWq(3 ) W s = W q +1 μ( 4) Ls = Lq +λ μ( 12 -22)上式称为 Little 公式。例 3 某医院手术室根据病人来 诊和 完成手 术 时间 的记 录 , 任 意抽 查 100 个 工作 小 时 , 每小时来就诊的病人数 n 的出现次数如表 12 -8 所示。又任意抽查了 100 个完成手术 的病历 , 所用时间 v( 小时 ) 出现的次数如表 12 -9 所示。表 12 -8表 12 -9到达的病人数 n出现次数 f n为病人完成手术时间 v(小时 )出现次数 f v0100. 0～0. 2381280. 2～0. 42520. 4～0. 6173160. 6～0. 894100. 8～1. 06561. 0～1. 256 以上11. 2 以上0合 计100合 计100(1 ) 算出每小时病人平均到达率 = ∑ n f n 100 ∑ v f v 100每次手术平均时间 == 2. 1( 人 / 小时 )= 0. 4( 小时 / 人 )每小时完成手术人数 ( 平均服务率 ) =1 0. 4= 2. 5( 人/ 小时 )(2 ) 取 λ= 2. 1 ,μ= 2. 5 , 可以通过统计检验的方法 ( 例如 χ2 检验法 ) , 认为 病人到达 数服从参数为 2. 1 的泊松分布 , 手术时间服从参数为 2. 5 的负指数分布。(3 ) ρ=λ μ =2. 1 2. 5= 0. 84它说明服务机构 ( 手术室 ) 有 84 % 的时间是繁忙 ( 被利用 ) , 有 16 % 的时间是空闲的。 (4 ) 依次代入 ( 12 -21 ) 式 , 算出各指标 :在病房中病人数 ( 期望值 )Ls =2. 1 2. 5 - 2. 1= 5. 25 ( 人 )·813·,PE6e’,PE6e’,PE6e,PE6e’,PE6e’,PE6e’[P6’6’排队等待病人数 ( 期望值 )Lq = 0. 84×5. 25 = 4. 41( 人 )病人在病房中逗留时间 ( 期望值 ) W s =1 2. 5 - 2. 1= 2. 5( 小时 )病人排队等待时间 ( 期望值 )Wq =0. 84 2. 5 - 2. 1= 2. 1( 小时 )不同的服务规则 ( 先到先服务 , 后到先服务 , 随机服务 ) 它们的不同点主要反映在等待 时间的分布函数的不同 , 而一些期望值是相同的。我们上面讨论的各种指标 , 因为都是期 望值 , 所以这些指标的计算公式对三种服务规则都适用 ( 但对有优先权的规则不适用 ) 。3. 2 系统的容量有限制的情况 ( M/ M/ 1/ N/ ∞ )如果系统的最大容量为 N , 对于单服 务 台的 情形 , 排 队 等待 的顾 客最 多为 N - 1 , 在 某时刻一顾客到 达 时 , 如 系 统 中 已 有 N 个 顾 客 , 那 么 这 个 顾 客 就 被 拒 绝 进 入 系 统 ( 见 图 12 -8 ) 。图 12 -8当 N = 1 时为即时制的情形 ; 当 N→∞ , 为容量无限制的情形。 若只考虑稳态的情形 , 可作各状态间概率强度的转换关系图见图 12 -9。图 12 -9根据图 12 -9 , 列出状态概率的稳态方程 :μP1 =λP0 μPn + 1 +λPn - 1 = (λ+ μ) Pn , μPN =λPN - 1n≤ N - 1( 12 -23)解这差分方程与解式 (12 -17) , 式 ( 12 -18) 是很类似的 , 所不同的是 ,P0 + P1 + … + P N = 1仍令 ρ=λ/ μ, 因而得P0 =Pn =1 - ρ 1 - ρN + 1 1 - ρ 1 - ρN + 1ρnρ≠1n≤ N( 12 -24)这里略去 ρ= 1 情形的讨论 ( 参阅习题第 9 题 ) 。·913·在对容量没有限制的情形 , 我们曾设 ρ< 1 , 这不仅是实际 问题的需要 , 也是无穷级 数 收敛所必需的。在容量为有限数 N 的情形 下 , 这个 条件就 没有 必要了。 ( 为什 么 ?) 不 过 当 ρ> 1 时 , 表示损失率的 PN ( 或表示被拒绝排队的顾客平均数 λP N ) 将是很大的。根据 (12 -24) 式我们可以导出系统的各种指标 ( 计算过程略 ) : (1 ) 队长 ( 期望值 )NLs = ∑n = 0nP n =ρ 1 - ρ( N + 1)ρN + 1 1 - ρN + 1ρ≠ 1(2 ) 队列长 ( 期望值 )NLq = ∑( n - 1 ) Pn = Ls - (1 - P0 )n = 1当研究顾客在系统平均逗留时间 W s 和在 队列 中平均 等待 时间 W q 时 , 虽 然 ( 12 -22) 式仍可利 用 , 但要 注意平 均到 达率 λ是在系 统中 有空时 的平 均到 达率 , 当系 统已 满 ( n = N ) 时 , 则到达率为 0 , 因此需要求出有效到达率 λe =λ(1 - PN ) 。可以验证 :1 - P0 = λe/ μ(3 ) 顾客逗留时间 ( 期望值 )W s =Ls μ(1 - P0 )=Lq λ(1 - P N )+1 μ(4 ) 顾客等待时间 ( 期望值 )W q = W s - 1/ μ现在把 M/ M/ 1/ N/ ∞型的指标归纳如下 ( 当 ρ≠ 1 时 ) :Ls =ρ 1 - ρ( N + 1 )ρN + 1 1 - ρN + 1①Lq = Ls - (1 - P0 )②Ls μ( 1 - P0 ) W q = W s - 1/ μW s =③④例 4 单人理发馆有 6 个椅子 接待人 们排 队等 待理 发。当 6 个椅 子都 坐满 时 , 后 来到的顾客不进店就离开。顾客平均到达率为 3 人/ 小时 , 理发需时平均 15 分钟。则N = 7 为系统中最大的顾客数 ,λ= 3 人/ 小时 ,μ= 4 人/ 小时。 (1 ) 求某顾客一到达就能理发的概率 这种情形相当于理发馆内没有顾客 , 所求概率P0 =1 - 3/ 4 1 - ( 3/ 4) 8 = 0. 2778(2 ) 求需要等待的顾客数的期望值Ls =3/ 4 1 - 3/ 48 (3/ 4 ) 8 1 - ( 3/ 4) 8 = 2. 11Lq = Ls - (1 - P0 ) = 2. 11 - ( 1 - 0. 2778) = 1. 39(3 ) 求有效到达率λe = μ( 1 - P0 ) = 4( 1 - 0. 2778) = 2. 89 ( 人/ 小时 )(4 ) 求一顾客在理发馆内逗留的期望时间·023·( 12 -25)W s = Ls/ λe = 2. 11/ 2. 89 = 0. 73 ( 小时 ) = 43. 8 ( 分钟 )(5 ) 在可能到来的顾客中不等待就离开的概率 ( Pn ≥ 7 ) 这就是求系统中有 7 个顾客的概率 :P7 =λ μ71 - λ/ μ 1 - (λ/ μ) 8 =3 471 -1 -3 4 3 48 ≈3. 7 %这也是理发馆的损失率。现以本例比较队长为有限和无限 , 两种结果如下 :λ= 3 人/ 小时μ= 4 人/ 小时LsLqW sW qP0P7有限队长 N = 72. 111. 390. 730. 480. 2783. 7%无限队长32. 251. 00. 750. 2503. 3 顾客源为有限的情形 ( M/ M/ 1/ ∞/ m)现以最常见的机器因故障停机待修的问题来说明。设共有 m 台机器 ( 顾 客总体 ) , 机 器因故障停机表示“到达”, 待修的机器形成 队列 , 修理 工人 是服务 员 , 本节 只讨论 单服 务 员的情形。类似的例子还有 m 个打字员共用一台打字机 , m 个会计 分析员同 用一个计 算 机终端等等。顾客总体虽只有 m 个 , 但每个顾客到来并经 过服务 后 , 仍 回到原来 总体 , 所 以仍然可以到来。在机器故障问题中 , 同一台 机器出 了故障 ( 到来 ) 并 经修 好 ( 服务 完了 ) 仍可再出故障 ( 见图 12 -10 ) 。模型的符号中第 4 项 , 写了∞ , 这表示 对系统的 容量没有 限 制 , 但实际上它永远不会超过 m, 所以和写成 ( M/ M/ 1/ m/ m) 的意义相同。图 12 -10关于平均到达率 , 在无限源的情形是按全体顾客来考虑的 ; 在有限源的情形必须按每 个顾客来考虑。为简单起见 , 设各个顾客的到达 率都是相 同的 λ( 在这里 λ的含 义是每 台 机器单位 运 转 时 间 内 发 生 故 障 的 概 率 或 平 均 次 数 ) , 这 时 在 系 统 外 的 顾 客 平 均 数 为 m - Ls , 对系统的有效到达率 λe 应是λe =λ( m - Ls )( 12 -26) 对于 ( M/ M/ 1/ ∞/ m) 模型的分析可用前述的方 法。在 稳态的 情况 下 , 考虑状 态间 的 转移率。当由状态 0 转 移到 状 态 1 , 每 台 设备 由 正常 状 态转 移 为 故障 状 态 , 其 转移 率 为 λP0 , 现有 m 台设备由无故障状态转移为有一台设备 ( 不论哪一台 ) 发生 故障 , 其转移率 为·123·°ªMBMB®LALA4)9.MBLALAB4).mλP0 。至于由状态 1 转 移 到状 态 0 , 其 状 态 转移 率 为 μP1 。所 以 在 状 态 0 时 有 平 衡 方 程 mλP0 = μP1 。其 关 系 可 用 图 12 -11 表 示 , 由 图 12 -11 可 得 到 各 状 态 间 的 转 移 差 分 方程。图 12 -11μP1 = mλP0 μPn + 1 + ( m - n + 1 )λPn - 1 = [ ( m - n)λ+ μ] Pn ,1≤ n≤ m - 1μPm = λPm - 1解这差分方程 , 用递推方法 , 并注意到m∑Pi = 1 ( 因而不要求 λ/ μ < 1)i = 0得P0 =m∑i = 01 m !( m -i) !λ μPn =m ! ( m - n) !λ μnP 0( 1 ≤ n ≤ m)求得系统的各项指标为Ls = m -μ λ(1 - P0 )①Lq = m -(λ+ μ) ( 1 - P0 ) λ= Ls - ( 1 - P0 )②m μ( 1 - P0 ) W q = W s - 1/ μW s =1 λ③④在机器故障问题中 Ls 就是平均故障台数 , 而 m - L s 表示正常运转的平均台数。 μ λm - Ls =( 1 - P0 )例 5 某车间有 5 台机器 , 每台机器的连续运转时 间服从负 指数分 布 , 平 均连续运 转时间 15 分钟 , 有一个修理工 , 每次修理时间服从负指数分布 , 平均每次 12 分钟。求 :(1 ) 修理工空闲的概率 ; (2 ) 五台机器都出故障的概率 ; (3 ) 出故障的平均台数 ; (4 ) 等待修理的平均台数 ; (5 ) 平均停工时间 ; (6 ) 平均等待修理时间 ; (7 ) 评价这些结果。 解 m = 5 ,λ= 1/ 15 ,μ= 1/ 12 ,λ/ μ= 0. 8·223·( 12 -27)( 12 -28)(1 ) P0 =5 ! 5 !(0. 8)0 +5 ! 4 !(0. 8)1 +5 ! 3 !(0. 8)2 +5 ! 2 !(0. 8)3 +5 ! 1 !(0. 8)4 +5 ! 0 !(0. 8)5- 1= 1/ 136. 8 = 0. 0073(2 ) P5 =5 ! 0 !( 0. 8) 5 P0 = 0. 287(3 ) Ls = 5 -1 0. 8( 1 - 0. 0073) = 3. 76 ( 台 )(4 ) Lq = 3. 76 - 0. 993 = 2. 77( 台 )(5 ) W6 =1 125( 1 - 0. 007 )15 = 46 ( 分钟 )(6 ) W q = 46 - 12 = 34 ( 分钟 ) (7 ) 机器停工时间过长 , 修理工几乎没有空闲时间 , 应当提高服 务率减少 修理时间 或增加修理工人。第 4 节 多服务台负指数分布排队系统的分析现在讨论单队、并列的多服务台 ( 服务台数 c) 的情形 , 我们分以下三种情形讨论。 (1 ) 标准的 M/ M/ c 模型 ( M/ M/ c/ ∞/ ∞ ) ; (2 ) 系统容量有限制 ( M/ M/ c/ N/ ∞ ) ; (3 ) 有限顾客源 ( M/ M/ c/ ∞/ m) 。4. 1 标准的 M/ M/ c 模型 ( M/ M/ c/ ∞/ ∞ )关于标准的 M/ M/ c 模型各种特征 的规 定与 标准的 M/ M/ 1 模 型的 规定相 同。另 外 规定各服务台工作是相互独立 ( 不搞协作 ) 且平 均服务 率相 同 μ1 = μ2 = … = μc = μ。于 是 整个服务机构的平均 服务 率为 cμ( 当 n≥ c) ;λ cμ < 1 时 才不会排成无 限 的 队列 , 称它 为 这个 系 统 的 服务强 度 或 称 服 务 机 构 的 平 均 利 用 率 ( 见 图 12 -12) 。λ cμ, 只有 当为 nμ( 当 n < c) 。令 ρ=图 12 -12在分析这排 队 系统 时 , 仍 从状 态 间 的 转 移关系开始 , 可见图 12 -13 。如状态 1 转移到状态 0 , 即系统中有一名顾客被服务完了 ( 离 去 ) 的转移率为 μP1 。状态 2 转移到状态 1 时 , 这就是在两个服务台上被服务 的顾客中 有 一个被服务 完成而 离去。因为 不限哪一 个 , 那么这 时状态的 转移率便 是 2μP2 。 同理 , 再 考虑状态 n 转移到 n - 1 的情况。当 n≤ c 时 , 状态转移率为 nμPn ; 当 n > c 时 , 因为只 有 c 个服务台 , 最多有 c 个 顾 客 在 被 服 务 , n - c 个 顾 客 在 等 候 , 因 此 这 时 状 态 转 移 率 应 为 cμPn 。·323·图 12 -13由图 12 -13 可得μP1 = λP0 ( n + 1)μPn + 1 + λPn - 1 = (λ+ nμ) Pn cμPn + 1 +λPn - 1 = (λ+ cμ) Pn( 1≤ n≤ c)( n > c)∞这里∑Pi = 1 , 且 ρ≤ 1i = 0用递推法解上述差分方程 , 可求得状态概率。c - 1P0 = ∑k = 01 k !λ μk+1 c !11 - ρλ μc11 n !λ μnP 0( n≤ c)Pn =1 c ! cn - cλ μnP0( n > c)系统的运行指标求得如下 :平均队长Ls = Lq +λ μ∞Lq = ∑n = c+ 1( n - c) Pn =( cρ) cρ c !(1 - ρ) 2 P0∞因为 ∑n = c+ 1∞( n - c) Pn = ∑n′= 1∞n′P n′+ c = ∑n′= 1n′ c !cn′( cρ) n′+ c P0 = 右边平均等待时间和逗留时间仍由 Little 公式求得 ,Lq λ , W s = 例 6 某售票处有三个窗 口 , 顾 客的 到达 服从 泊 松过 程 , 平 均 到达 率 每分 钟 λ= 0. 9 ( 人 ) , 服务 ( 售票 ) 时间服从负指数分布 , 平均服 务率每 分钟 μ= 0. 4 人。现 设顾客 到达 后 排成一队 , 依次 向空 闲 的 窗 口 购票 如 图 12 -14 ( a ) , 这 就 是一 个 M/ M/ c 型 的 系 统 , 其 中Ls λW q =c = 3 ,λ μ = 2. 25 ,ρ= (1 ) 整个售票处空闲概率λ cμ=2. 25 3( < 1) 符合要求的条件 , 代入公式得 :P0 =(2. 25) 0 0 !+(2. 25) 1 1 !+1( 2. 25 ) 2 2 !+( 2. 25 ) 3 3 !1 1 - 2. 25/ 3= 0. 0748·423·( 12 -29)( 12 -30)图 12 -14(2 ) 平均队长Lq =( 2. 25 ) 3 ·3/ 4 3 ! ( 1/ 4) 2 ×0. 0748 = 1. 70 Ls = Lq +λ/ μ= 3. 95(3 ) 平均等待时间和逗留时间W q = 1. 70/ 0. 9 = 1. 89( 分钟 ) W s = 1. 89 + 1/ 0. 4 = 4. 39 ( 分钟 )顾客到达后必须等待 ( 即系统中顾客数已有 3 人即各服务台都没有空闲 ) 的概率P( n≥3) =( 2. 25 ) 3 3 ! 1/ 4×0. 0748 = 0. 574. 2 M/ M/ c 型系统和 c 个 M/ M/ 1 型系统的比较现就上面的例子说明 , 如果原题除排队方式外其他条件不变 , 但顾客到达后在每个窗 口前各排一队 , 且进入队列后坚持不换 , 这就形成 3 个队列 , 见 图 12 -14 ( b ) 而 每个队列 平 均到达率为λ1 = λ2 = λ3 = 0. 9/ 3 = 0. 3( 每分钟 )这样 , 原来的系统就变成 3 个 M/ M/ 1 型的子系统。现按 M/ M/ 1 型解决这个问题 , 并与上面比较如表 12 -10 所示。表 12 -10指 标模 型(1 ) M/ M/ 3 型(2) M/ M/ 1 型服务台空闲的概率 P00. 07480. 25 (每个子系统)顾客必须等待的概率P( n≥3) = 0. 570. 75平均队列长 Lq1. 702. 25 (每个子系统)平均队长 Ls3. 959. 00 (整个系统 )平均逗留时间 W s4. 39 (分钟 )10 (分钟 )平均等待时间 W q1. 89 (分钟 )7. 5( 分钟)·523·ØÍîã›Œ(cid:129)îãØÍîãØÍîãØÍØÍîã从表中各指标的对比可以看出 (1 ) ( 单队 ) 比 (2 ) ( 三队 ) 有显著 优越 性 , 在安排 排队 方式时应该注意。由于计算 P0 和各项指标公式 ( 12 -29) 式、(12 -30 ) 式很复杂 , 现 已有专 门的数 值表 可供使用。在 (12 -29) 式、( 12 -30) 式各式中 P0 和 Lq 都是由 c 和ρ完全确定的 , 于是 W q ·μ 也由 c 和ρ完全确定。可构造一个 W q·μ数值表 , 便于使用。表 12-11 多服务台 Wq ·μ的数值表服 务 台 数λ/ cμc = 1c= 2c= 3c = 4c= 50. 10. 11110. 01010. 0014. 0002 0. 0000 * 00. 20. 25000. 04170. 0103. 0030 0. 0010 00. 30. 42860. 09890. 0333. 0132 0. 0058 00. 40. 66670. 19050. 0784. 0378 0. 0199 00. 51. 00000. 33330. 1579. 0870 0. 0521 00. 61. 50000. 56250. 2956. 1794 0. 1181 00. 72. 33330. 96080. 5470. 3572 0. 2519 00. 84. 00001. 77781. 0787. 7455 0. 5541 00. 99. 00004. 26322. 7235. 9694 1. 5250 10. 9519. 00009. 25646. 0467. 4571 4. 5112 3小于 0. 00005在例 6 中 , 已知 c = 3 ,ρ=λ cμ= 0. 75。查表 12 -11 , 无此数。故用线性插值法求得W q ·μ= 0. 8129因 μ= 0. 4 , 所以 W q = 2. 03 分W s = 2. 03 +1 0. 4= 4. 53 ( 分 )Lq = 2. 03/ 0. 9 = 2. 2( 人 ) Ls = 2. 2 + 2. 25 = 4. 45( 人 )这结果和前面计算的有差异 , 这是由插值引起的。4. 3 系统的容量有限制的情形 ( M/ M/ c/ N/ ∞ )设系统的容量最大限制为 N ( ≥ c) , 当系统中 顾客数 n 已达 到 N ( 即 队列中顾 客数 已达 N - c) 时 , 再来的顾客即被拒绝 , 其他条件与标准的 M/ M/ c 型相同。 ·623·ÔÒ~‚(Ê¿»°¢(cid:21)ti(cid:30)(cid:19)Ê¿»°¢(cid:21)ti(cid:30)(cid:19)Ê¿¢»°ti(cid:21)(cid:30)(cid:19)Ê¿¢»°(cid:21)ti(cid:19)(cid:30)Ê¿¢»°(cid:21)ti(cid:19)(cid:30)Ê¿»°¢(cid:21)ti(cid:30)(cid:19)Ê¿»°¢ti(cid:21)(cid:19)(cid:30)Ê¿»°¢(cid:21)ti(cid:19)(cid:30)Ê¿»°¢(cid:21)ti(cid:30)(cid:19)Ê¿»°¢ti(cid:21)(cid:19)(cid:30)这时系统的状态概率和运行指标如下 :P0 =c∑k = 0Pn =1 cc c !( cρ) k k ! ( cρ) n n ! cc c !+P0ρn P 0ρ(ρc - ρN ) 1 - ρρ≠ 1(0 ≤ n ≤ c)( c ≤ n ≤ N)(12 -31 )其中 ρ=λ cμ, 但现在已不必对 ρ加以限制 , ( 关于 ρ= 1 的情形可参照习题第 9 题进行讨论 )Lq =P0ρ( cρ) c c ! ( 1 - ρ) 2 1 - ρN - c - ( N - c)ρN - c (1 - ρ)Ls = Lq + cρ(1 - PN )W q =Lq λ( 1 - P N )( 12 -32)W s = Wq +1 μ由于公式的复杂 , 现在已有一些专门图表可供使用。 特别当 N = c( 即时制 ) 的情形 , 例如在街头的停车场就不允许排队等待空位 , 这时P0 =c∑k = 01 ( cρ) k k !( 12 -33)Pn =( cρ) n n !P0 , 0≤ n≤ c其中 , 当 n = c 即关于 P c 的公式 , 被称为 爱尔 朗呼唤 损失 公式 , 是 A. K. Erlang 早 在 1917 年发现的 , 并广泛应用于电话系统的设计中。这时的运行指标如下 :Lq = 0 , W q = 0 , W s =1 μcLs = ∑n = 1nP n =c - 1cρ∑n = 0 c∑n = 0( cρ) n - 1 n ! ( cρ) n n != cρ(1 - Pc )(12 -34 )它又是使用的服务台数 ( 期望值 ) 。例 7 在某风景区准备建造旅馆 , 顾客到 达为 泊松流 , 每 天平 均到 (λ) 6 人 , 顾 客平 均 逗留时间 (1/ μ) 为 2 天 , 试就该 旅馆 在具 有 ( c) 1 , 2 , 3 , … , 8 个 房间 的条 件下 , 分别 计算 每 天客房平均占用数 Ls 及满员概率 P c 。这是即时 式 , 因 为 在 客 房 满 员 条 件 下 , 旅 客 显 然 不 能 排 队 等 待。 计 算 过 程 通 过表 12 -12进行 (λ= 6 , 1/ μ= 2 , cρ=λ/ μ= 12 ) 。·723·表 12 -12(1 )n(2 )( cρ) n = 12n(3 )n !(4 )( cρ) n/ n !c∑n = 0(5 )( cρ) n n !( 6)Pc (答 )( 7)c - 1c∑n = 0/ ∑n = 0011111—123456781122234. 2×10 1 . 44×102 . 73×103 . 07×104 . 49×105 . 99×106 . 58×107 . 30×1085412624120720. 04×103 . 03×10424711272288864 . 07×103 . 15×103 . 11×103 . 07×104137121385373. 24×103 . 31×103 . 46×103 . 45×104 . 52×10500000000. 92. 85. 77. 70. 63. 56. 49. 4200000000. 08. 15. 23. 30. 37. 44. 51. 58第 (4 ) 栏 : (2 )/ (3 ) 第 (5 ) 栏 : 第 (4 ) 栏各数累加 第 (6 ) 栏 : (4 )/ (5 ) 得满足概率 Pc , 注意第 ( 5) (6 ) 两栏的 c 就 是同行 的 n , Pc 的具体 意义是 :当 c = 1 旅馆只有一个房间 , 满员 ( 旅客被拒绝 ) 概率 0. 92 当 c = 5 旅馆备有 5 个房间 , 满员 ( 旅客被拒绝 ) 概率 0. 63 当 c = 8 旅馆备有 8 个房间 , 满员 ( 旅客被拒绝 ) 概率 0. 42第 (7 ) 栏 : 为求 Ls 作准备 , 用第 ( 5) 栏同行去除上一行结果。第 (8 ) 栏 : (7 ) ×12 得 Ls , 为每天客房平均占用数 , 它的具体意义是 :当 n = 1 旅馆只有一个房间 , 每天客房平均占用数 Ls = 0. 93( 间 )n = 5 旅馆备有五个房间 , Ls = 4. 48 ( 间 )n = 8 旅馆备有八个房间 , Ls = 6. 92 ( 间 ) 就是说每天平均都有一间以上的房间是空闲的。4. 4 顾客源为有限的情形 ( M/ M/ c/ ∞/ m)设顾客总体 ( 顾客源 ) 为有限数 m, 且 m > c, 和单服务台情形一样 , 顾客到达 率 λ是 按 每个顾客来考虑的 , 在机器管理问 题中 , 就 是共 有 m 台 机器 , 有 c 个修 理工 人 , 顾 客到 达 就是机器出了故障 , 而每个顾客的到达率 λ是 指每台 机器 每单 位运转 时间 出故障 的期 望 次数。系统中顾客数 n 就是出故障的机器台数 , 当 n≤ c 时 , 所有的故障机器都在 被修理 , 有 ( c - n) 个修理工人在空闲 ; 当 c < n≤ m 时 , 有 ( n - c) 台 机器在停 机等 待修 理 , 而 修理 工 人都在繁忙状态。假定这 c 个工人修理技术 相同 , 修 理 ( 服务 ) 时间 都服从 参数 为 μ的 负 指数分布 , 并假定故障的修复时间和正在生产的机器是否发生故障是相互独立的。(1 ) P0 =1 m !c∑k = 01 k !( m - k) !cρ mk1+mcc c !∑k = c+ 11 ( m - k) !ρ mk·823·(8 )Ls ( 答 )—. 92 0. 83 1. 74 2. 62 3. 48 4. 33 5. 14 6. 93 6ëN%ŠÉ(cid:157)]çÜNE:ÒÇÉ<“ˆ´E:çÜNÉ<“ˆ¨(cid:157)´E:NçÜSËÉ“ˆ¨(cid:157)èÝE:çÜNSà¨(cid:157)“ˆçÜNèÝE:÷¨(cid:157)“ˆpeçÜNE:÷“ˆèÝpe¨(cid:157)çÜNE:èÝpe¨(cid:157)“ˆ(cid:20)(cid:9)NE:çÜèÝpe¨(cid:157)“ˆ(cid:9)(cid:20)其中ρ =mλ cμm ! ( m - n) ! n !λ μnP 0(0≤ n≤ c)Pn =m ! ( m - n) ! c ! cn - cλ μnP0( c + 1 ≤ n≤ m)( 12 -35)(2 ) 平均顾客数 ( 即平均故障台数 )mLs = ∑nP nn = 1mLq = ∑( n - c) Pnn = c+ 1有效的到达率 λe 应等于每个顾 客的 到达率 λ乘以在 系统 外 ( 即 正常 生 产的 ) 机器 的期望数 :λe =λ( m - Ls )在机器故障问题中 , 它是每单位时间 m 台机器平均出现故障的次数。(3 ) 可以证明Ls = Lq +λe μ= Lq +λ μ( m - Ls )Ms = Ls/ λe W q = Lq/ λe( 12 -36)由于 P0 , Pn 计算公式过于复杂 , 有专用图书列成表格可供使用。 例 8 设有两个修理工人 , 负责 5 台机器的正常运 行 , 每 台机器 平均损坏 率为每运 转小时 1 次 , 两工人能以相同的平均修复率 4 ( 次/ 小时 ) 修好机器。求 :① 等待修理的机器平均数 ; ② 需要修理的机器平均数 ; ③ 有效损坏率 ; ④ 等待修理时间 ; ⑤ 停工时间。解 m = 5 ,λ= 1 ( 次/ 小时 ) ,μ= 4( 台/ 小时 ) , c = 2 , cρ/ m =λ/ μ= 1/ 4P0 =1 5 !1 5 !1 40+1 4 !1 41+1 2 ! 3 !1 42+22 2 !1 2 !1 83+1 84+1 851= 0. 3149P1 = 0. 394 , P2 = 0. 197 , P3 = 0. 074 , P4 = 0. 018 , P5 = 0. 002 ① Lq = P3 + 2 P4 + 3 P5 = 0. 118m② Ls = ∑n Pn = Lq + c - 2 P0 - P1 = 1. 094n = 1③ λe = 1× ( 5 - 1. 094 ) = 3. 906 ④ Wq = 0. 118/ 3. 906 = 0. 03 ( 小时 ) ⑤ W s = 1. 094/ 3. 906 = 0. 28( 小时 )·923·第 5 节 一般服务时间 M / G/1 模型前面我们研究了泊松输入和负指数的服务时间的模型。下面将讨论服务时间是任意分布的情形 , 当然 , 对任何情形下面关系都是正确的。E[ 系统中顾客数 ] = E[ 队列中顾客数 ] + E[ 服务机构中顾客数 ] E[ 在系统中逗留时间 ] = E[ 排队等候时间 ] + E[ 服务时间 ]其中 E[ · ] 表示求期望值 , 用符号表示 :Ls = Lq + LseW s = W q + E[ T] T 表示服务时间 (随机变量) , 当 T 服从负指数分布时, E[ T] = 1/ μ, 是讨论过的。又 (12 -22) 式 中的关系式 :Ls =λWs , Lq =λWq 也是常被利用的。所以上面的 7 个数中只要知 道 3 个 就可 求出其 余 , 不过 在有限 源和 队 长有限制情况下 ,λ要换成有效到达率λe 。5. 1 Pollaczek-Khintchine( P-K) 公式对于 M/ G/ 1 模 型 , 服 务 时 间 T 的 分 布 是 一 般 的 , ( 但 要 求 期 望 值 E [ T ] 和 方 差 V ar[ T ] 都存在 ) , 其他条件和标准的 M/ M/ 1 型相同。为了达到稳态 ,ρ< 1 这 一条件还 是 必要的 , 其中 ρ= λE[ T] 。在上述条件下 , 则有Ls =ρ+ρ2 + λ2 Var [ T ] 2( 1 - ρ)这就是 Pollaczek- K hintchine ( P- K ) 公式。只要知道 λ, E[ T] 和 Va r[ T] , 不管 T 是什么 具 体分布 , 就可求出 Ls , 然后通过 ( 12 -37) 式和 (12 -22 ) 式可求出 Lq , Wq 和 W s 。由这公式还可注意到 , 因为有方差项的存 在 , 在研究 各期 望值 ( 各 运行 指标都 是期 望 值 ) 时 , 完全不考虑概率性质会得出错误 结果 , 仅当 V ar [ T ] = 0 时 , 随 机性 的波动 才不 影 响 Ls , 所以要想改进各指标 , 除考虑期望值外 , 还可以从改变方差来考虑。现在举例说明公式的应用。例 9 有一售票口 , 已知顾客按平均为 2 分 30 秒的时 间间隔 的负指数 分布到达。 顾客在售票口前服务时间平均为 2 分钟。① 若服务时间也服从负指数分布 , 求顾客为购票所需的平均逗留时间和等待时间 ; ② 若经过调查 , 顾客在售票口 前至少 要占 用 1 分钟 , 且认 为服 务时间 服 从负 指数 分布是不恰当的 , 而应服从以下概率密度分布 , 再求顾客的逗留时间和等待时间。e- y + 1f ( y) =y < 1 解 ① λ= 1/ 2. 5 = 0. 4 ,μ= 1/ 2 = 0. 5 ,ρ=λ/ μ= 0. 80y≥1W s =1 μ- λ= 10 ( 分钟 )·033·( 12 -37)( 12 -38)ρμ - λ= 8( 分钟 ) ② 令 Y 为服务时间 , 那么 Y = 1 + X , X 服从均值为 1 的负指数分布。于是W q =E[ Y ] = 2 , Va r[ Y ] = V ar[ 1 + x] = Va r[ X] = 1 ρ=λE[ Y ] = 0. 8代入 P—K 公式 , 得Ls = 0. 8 +0. 8 2 + 0. 42 ×1 2 × (1 - 0. 8)= 2. 8Lq = Ls - ρ= 2W s = Ls/ λ= 7 ( 分钟 ) W q = Lq/ λ= 5 ( 分钟 )5. 2 定长服务时间 M/ D/ 1 模型服务时间是确定的常数 , 例如在一条装 配线 上完成 一件 工作 的时间 就应 是常数。 自动的汽车冲洗台 , 冲洗一辆汽车的时间也是常数 , 这时 T = 1/ μ, Va r[ T ] = 0Ls = ρ+ρ2 2 ( - ρ)( 12 -39)例 10 某实验室有一台自动检验机器性能的仪器 , 要求 检验机 器的顾客 按泊松分 布到达 , 每小时平均 4 个顾客 , 检验每台机器所需时间为 6 分钟。求 :① 在检验室内机器台数 Ls ( 期望值 , 下同 ) ;② 等候检验的机器台数 Lq ; ③ 每台机器在室内消耗 ( 逗留 ) 时间 W s ;④ 每台机器平均等待检验的时间 W q 。解 λ= 4 ,E( T ) =1 10( 小时 ) ,ρ=4 10,Va r[ T ] = 0① Ls = 0. 4 +( 0. 4) 2 2 (1 - 0. 4)= 0. 533( 台 )② Lq = 0. 533 - 0. 4 = 0. 133 ( 台 )③ W s =0. 533 4= 0. 133 ( 小时 ) = 8( 分钟 )④ Wq =0. 133 4= 0. 033 ( 小时 ) = 2( 分钟 )注意 可以证明 , 在一般服务 时间 分布的 Lq 和 W q 中以 定长 服务 时间 的 为最 小 , 这 符合我们通俗的理解———服务时间越有规律 , 等候 的时 间就 越短。读 者还 可在热 力学 或 信息论中熵的概念中找出类似的性质。5. 3 爱尔朗服务时间 M/ Ek/ 1 模型由图 12 -15 可知道 , 如果顾客必须经过 k 个服 务站 , 在每 个服 务站的 服务 时间 Ti 相·133·互独立 , 并 服 从 相 同 的 负 指 数 分 布 ( 参 数 为kkμ) , 那么 T = ∑Ti 服从 k 阶爱尔朗分布。E[ Ti ] =i = 1 1 kμVar[ T i ] =1 k2 μ2E[ T ] =1 μ Var[ T ] =1 kμ2图 12 -15对于 M/ Ek/ 1 模型 ( 除服务时间外 , 其他条件与标准的 M/ M/ 1 型相同 )Ls = ρ+λ2 kμ2 2( 1 - ρ)ρ2 += ρ+( k + 1 )ρ2 2 k( 1 - ρ)Lq =( k + 1 )ρ2 2 k(1 - ρ)W s = Ls/ λ,W q = Lq/ λ例 11 某单人裁缝店做西服 , 每套需经过 4 个不同的工序 , 4 个工序完成后才开始做 另一套。每一工序的时间服从负指数分布 , 期望值为 2 小时。顾客到来服从泊松分布 , 平 均订货率为 5. 5 套/ 周 ( 设一周 6 天 , 每天 8 小时 ) 。问一顾客为等到做好一套西服期望时 间有多长 ?解 顾客到达 λ= 5. 5 套/ 周 , 设 : μ———平均服务率 ( 单位时间做完的套数 ) ; 1/ μ———平均每套所需的时间 ; 1/ 4μ———平均每工序所需的时间。 由题设 1/ 4μ= 2 ( 小时 ) ,μ= 1/ 8 ( 套/ 小时 ) = 6 ( 套/ 周 ) ,ρ= 5. 5/ 6 , 设 : T i ———做完第 i 个工序所需的时间 ; T———做完一套西服所需的时间。E[ Ti ] = 2 , V ar[ T i ] =1 4× 62E[ T ] = 8 ( 小时 ) ,Var[ T ] =1 4× 62 ,ρ=5. 5 6Ls =5. 5 6+5. 5 62+ ( 5. 5) 2 × 14 ×622 1 -5. 5 6= 7. 2188顾客为等到做好一套西服的期望时间 :W s = Ls/ λ= 7. 2188/ 5. 5 = 1. 3 ( 周 )第 6 节 经济分析———系统的最优化6. 1 排队系统的最优化问题排队系统的最优化问题分为两类 : 系统 设计 的最优 化和 系统 控制最 优化。前 者称 为·233·( 12 -40)静态问题 , 从排队论一诞生起就成为人们研 究的内 容 , 目的 在于使 设备 达到 最大效 益 , 或 者说 , 在一定的质量指 标下 要求 机构 最 为经 济。后者 称 为动 态问 题 , 是 指一 个 给定 的 系 统 , 如何运营可使某个目标函数得到最优 , 这是 近 10 多 年来 排队 论的研 究重 点之一。 由 于学习这后一问题还需更多的数学知识 , 所以本节只讨论静态最优的问题。在一般情形下 , 提高服务水平 ( 数量 , 质 量 ) 自然 会 降低顾客的 等待 费 用 ( 损失 ) , 但 却 常 常增 加 了服 务 机 构的成本 , 我们 最优 化 的 目标 之 一是 使 二者 费 用 之 和 为最小 , 决定达 到 这 个目 标 的最 优 的 服 务 水平。 另 一 个常用的目 标函 数 是使 纯 收入 或 使 利润 ( 服 务收 入 与 服务成本之差 ) 为最大 ( 见图 12 -16 ) 。各种费用在 稳态 情 形 下 , 都 是 按 单 位时 间 来 考 虑 的。一般情形 , 服 务 费用 ( 成 本 ) 是可 以 确切 计 算 或 估 计的。至于顾 客的 等 待费 用 就有 许 多 不 同 情况 , 像 机 械故障问题中等待费用 ( 由于机器待修而使 生产遭 受的损 失 ) 是可 以确 切估 计的 , 但像 病 人就诊的等待费用 ( 由于拖延治疗使病情恶 化所受 的损失 ) , 或 由于队 列过 长而失 掉潜 在 顾客所造成的营业损失 , 就只能根据统计的经验资料来估计。图 12 -16服务水平也可以由不同形式来表示 , 主要的是平均服务率 μ( 代 表服务机 构的服务 能 力和经验等 ) , 其次是服务设备 , 如服务台的个 数 c, 以 及由队 列所占空 间大小所 决定的 队 列最大限制数 N 等 , 服务水平也可以通过服务强度 ρ来表示。我们常用的求解方法 , 对于离散变量常用边际分析法 , 对于连续变量常用经典的微分法 , 对于复杂问题读者们当然可以用非线性规划或动态规划的方法。6. 2 M/ M/ 1 模型中最优服务率 μ1. 标准的 M/ M/ 1 模型取目标函数 z 为单位时间服务成本与顾客在系统逗留费用之和的期望值z = csμ+ cw L s ( 12 -41) 其中 cs 为当 μ= 1 时 服务 机 构 单 位 时间 的 费 用 ; cw 为 每 个 顾客 在 系 统 停 留单 位 时 间 的 费用。将 (12 -21) 式中 Ls 之值代入 , 得z = csμ+ cw ·λ μ - λ为了求极小值 , 先求 d z dμ, 然后令它为 0 ,d z dμ= cs - cw λ· 1(μ- λ) 2cs - cw λ·1(μ- λ) 2 = 0解出最优的μ* = λ+cw csλ( 12 -42)·333·根号前取 + 号 , 是因为保证 ρ< 1 ,μ> λ的缘故。2. 系统中顾客最大限制数为 N 的情形在这情形下 , 系统中如已有 N 个顾客 , 则后来的顾客即被拒绝 , 于是 : P N ———被拒绝的概率 ( 借用电话系统的术语 , 称为呼损率 ) ; 1 - PN ———能接受服务的概率 ; λ(1 - P N ) ———单位时间实际进入服务机构顾客的 平均数。 在稳定状 态下 , 它也等 于单位时间内实际服务完成的平均顾客数。设每服务 1 人能收入 G 元 , 于是单位时间收入的期望值是 λ(1 - PN ) G 元。 纯利润z = λ( 1 - P N ) G - csμ= λG· 1 - ρN1 - ρN + 1 - csμ μN - λN= λμG·μN + 1 - λN + 1 - csμ求 d z dμ, 并令 d z dμ= 0 得ρN + 1 · N - ( N + 1)ρ+ρN + 1(1 - ρN + 1 ) 2=cs G最优的解 μ* 应合于上式。上式中 cs 、G、λ、N 都是给定的 , 但要由上式中解出 μ* 是很 困难的。通常是通过数值计算来求 μ* 的 , 或将上式左方 ( 对一定的 N ) 作为 ρ的函数作出 图形 ( 见图 12 -17 ) , 对于给定的 G/ cs , 根据图形可求出 μ* / λ。3. 顾客源为有限的情形仍按机械故障问题来考虑。设共有 机器 m 台 , 各 台 连续 运转 时间 服从 负 指数 分布。 有 1 个修理工人 , 修理时间服从负指数分布。 当服务 率 μ= 1 时的修 理费 用 cs , 单 位时 间 每台机器运转可得收入 G 元。平均运转台数为 m - Ls , 所以单位时间纯利润为z = ( m - Ls ) G - csμ=mG ρEm - 1E mm ρ m ρcsμm式中的 Em ( x) = ∑k = 0xk k !e- x 称为泊松部分和ρ=mλμ , 而d d xE m ( x ) = Em - 1 ( x ) - Em ( x)为了求最优服务率 μ*Em - 1m ρE m, 求 d zdμ , 并令 d zdμ = 0 , 得 m ρm ρm ρ+EmE m - 2E2mm ρm ρE2m - 1m ρ=cs λ G当给定 m、G、cs 、λ, 要由上式解出 μ* 是很困难的 , 通常是利用泊 松分布表 通过数值 计·433·算来求得 , 或将上式左方 ( 对一定的 m) 作为 ρ的函 数作出图 形 ( 见图 12 -18) , 对于给定 的 cs λ G根据图形可求出 μ* / λ。图 12 -17图 12 -186. 3 M/ M/ c 模型中最优的服务台数 c仅讨论标准的 M/ M/ c 模型 , 且在稳 态 情形 下 , 这时 单 位时 间全 部费 用 ( 服务 成本 与等待费用之和 ) 的期望值z = c′s · c + cw · L ( 12 -43) 其中 c 是服务台数 ; c′s 是每服务台单 位时 间的 成本 ; cw 为 每个 顾客在 系统 停留单 位时 间 的费用 ; L 是系统中顾客平均数 L s 或队列中等待的 顾客平 均数 L q ( 它们 都随 c 值 的不 同 而不同 ) 。因 为 c′s 和 cw 都是 给定的 , 唯 一可 能变 动的是 服务 台数 c, 所以 z 是 c 的函 数 z ( c) , 现在是求最优解 c* 使 z( c* ) 为最小。因为 c 只取整数值 , z( c) 不是连续变量的函数 , 所以不能用经 典的微分 法。我们采 用边际分析法 ( Ma rgi nal A nalysis) , 根据 z( c* ) 是最小的特点 , 我们有z( c* ) ≤ z( c* - 1 ) z( c* ) ≤ z( c* + 1 )将 (12 -43) 式中 z 代入 , 得c′s c * + cw L ( c* ) ≤ c′s ( c* - 1 ) c′s c * + cw L ( c* ) ≤ c′s ( c* + 1) + cw L ( c* + 1 )1) + cw L ( c*上式化简后 , 得L( c* ) - L( c* + 1 ) ≤ c′s/ cw ≤ L( c*1 ) - L( c* )( 12 -44) 依次求 c= 1 , 2 , 3 , …时 L 的值 , 并作两 相邻 的 L 值之 差 , 因 c′s/ cw 是已 知数 , 根据 这个 数 落在哪个不等式的区间里就可定出 c* 。例 12 某检验中心为各工 厂服务 , 要 求作 检验的 工厂 ( 顾客 ) 的到 来服 从 泊松 流 , 平 均到达率 λ为每天 48 次 , 每次来检验由于停工等原因损失为 6 元。服务 ( 作检验 ) 时间 服 从负指数分布 , 平均服务率 μ为每 天 25 次 , 每 设置 1 个 检 验员 服务 成本 ( 工 资及 设备 损 耗 ) 为每天 4 元。其他条件适合标准的 M/ M/ c 模型 , 问 应设几个 检验员 ( 及 设备 ) 才能 使 总费用的期望值为最小 ?解 c′s = 4 元/ 检验员cw = 6 元/ 次 μ= 25λ= 48λ/ μ= 1. 92设检验员数为 c, 令 c 依次为 1 , 2 , 3 , 4 , 5 , 根据表 12 -11 , 求出 Ls 。计算过程如下 :·533·c12345λ/ cμ1. 92. 96 0. 64 0. 48 00. 38查表 W q ·μ—10. 25500. 39610. 07720. 0170Ls =λ μ ( Wq ·μ+ 1)—21. 6102. 6802. 0681. 952将 Ls 值代入 (12. 44 ) 式得表 12 -13 。表 12 -13检验员数 c来检验顾客数 Ls ( c)L( c) - L( c+ 1) ～L( c) - L( c - 1 )总费用 (每天 ) z( c)1∞∞221. 61018. 930～∞154. 943. 680 20. 612～18. 93027. 87 ( * )4. 068 20. 116～0. 61228. 385. 952 131. 71c′s cw 小 , 直接代入 ( 10 -43 ) 式也可验证总费用为最小。= 0. 666 , 落在区间 (0. 612 ～18. 930 ) 内 , 所以 c* = 3。即以设 3 个检验员使总费用为 最z( c* ) = z( 3) = 27. 87( 元 )第 7 节 *分析排队系统的随机模拟法当排队系统的到达间隔时间和服务时间的概率分布很复杂时 , 或不能用公式给出时 ,那么就不能用解析法求解。这就需用随机模拟法求解 , 现举例说明。例 13 设某仓库前有 一卸 货 场 , 货车 一般 是 夜间 到达 , 白天 卸 货。每 天 只能 卸 货 2 车 , 若一天内到达数超过 2 车 , 那么就推迟到次日卸货。根据表 12 -14 所示的经验货车到 达数的概率分布 ( 相对频率 ) 平均为 1. 5 车/ 天 , 求每天推迟卸货的平均车数。表 12 -14到达车数012345≥6概率0. 230. 300. 300. 1. 05 00. 020. 00解 这是单服务台的排队系统 , 可验证到达车数不服从泊松分布 , 服务时间也不服从负指数分布 ( 这是定长服务时间 ) , 不能用以前的方法求解。随机模拟法首先要求事件能按历史的概率分布规律出现。对例 13 的数据进行分析 , 取 100 张卡片 , 按表 12 -14 的概率 , 取 23 张卡片 填入 0 ; 取 30 张 填 1 ; 取 30 张填 2 ; 取 10 张填 3 ; 取 5 张填 4 ; 取 2 张 填 5 等。然后 将这 些卡片 放在 盒内 搅均匀 , 再 随 机地 一一 取 出 , 依次记录卡片上的数码 , 得到这一系列数据就是每天到达车数的模拟。实际应用时可 ·633·×(cid:127)3z(cid:30)ÙÎ:/5*’‡îãdYÀµ(cid:19)(cid:12)(cid:1)(cid:30)×Ì5*{p#(cid:24)“MB“ïä(cid:127)t6+}rã“(cid:1)(cid:12)”‰6+“h]Ì6+“h]‰™½©ÙÉ¹”‰D9I>TI„y{pti用随机数表 , 表 12 -15 就是随机数表的一部分。也可以用 MS Excel 表中的 RAND ( ) 函数产生随机数 x, 在 0 < x < 1 之间 , 若需要 整 数两位的随机数 , 可以用 RO UND ( RA ND( ) * 1000) 产生 随机 数。再用 复制、粘贴 两个 操 作 , 完成需要的随机数的个数 , 比用随机数表方便。表 12 -15 随 机 数 表979512119049571386810292759124583922130280671499168996636760662472573215496300049676202872127723794655648261739426183731500274701685953285672953083381343021242558160191700750131824511669671653110636100455369730998010524086543561598964971602242352115910886817393936995074276948326847444186835024510208607141259093072429596588480668927097026644741160145708541290931095803250404408122046361947781690596486542488941458498079128812251970400640314200502460906960078629988168612490923268366302378940817774820177827820723538568941694337412136395780544076040501458455116803823222809247776221 53 91 4831 64 66 7277 54 21 7475 21 47 4043 04 95 9713 23 69 9283 85 58 0543 44 91 0170 81 47 6116 36 59 18本例在求解时先按到达车数的概率 , 分别给它们分配随机数 , 见表 12 -16 ①。① 严格 地说 , 这里 利用 了概率 论中 的一个 定理。 若 X 的分布 函数 是 F ( x ) , R 是 [ 0 , 1 ] 区间上 均匀 分布的 随机变量 , 那么 X = F - 1 ( R) , 其中 F - 1 ( · ) 表示 反函 数。利 用这定 理可 由分布 函数 求到 X 的抽 样值。·733·ÀÄæSyš t(cid:12)(cid:7)ÀÄæSyš t(cid:7)(cid:12)æÄÀSšy t(cid:12)(cid:7)ÀÄæSšy t(cid:7)(cid:12)æÀÄSyš t(cid:7)(cid:12)æÀÄSšy t(cid:7)(cid:12)æÀÄSyš t(cid:12)(cid:7)ÀæÄSšy t(cid:7)(cid:12)ÀæÄSyš t(cid:12)(cid:7)ÀÄæSyš t(cid:7)(cid:12)ÀæÄSyš t(cid:12)(cid:7)ÄÀæSyš t(cid:12)(cid:7)æÀÄSšy t(cid:12)(cid:7)æÄÀSšy t(cid:7)(cid:12)ÄæÀSyš t(cid:7)(cid:12)æÄÀSyš t(cid:12)(cid:7)ÀæÄSyš t(cid:7)(cid:12)ÀæÄSšy t(cid:12)(cid:7)ÀÄæSyš t(cid:7)(cid:12)ÀÄæSyš t(cid:7)(cid:12)ÀæÄSšy t(cid:7)(cid:12)ÀÄæSyš t(cid:12)(cid:7)ÀæÄSyš t(cid:7)(cid:12)ÄæÀSšy t(cid:7)(cid:12)ÀæÄSšy t(cid:12)(cid:7)ÄÀæSšy t(cid:12)(cid:7)ÄÀæSšy t(cid:7)(cid:12)ÄæÀSšy t(cid:7)(cid:12)æÀÄSyš t(cid:12)(cid:7)æÀÄSšy t(cid:12)(cid:7)ÀÄæSyš t(cid:7)(cid:12)æÀÄSyš t(cid:7)ÀæÄSšy (cid:12) (cid:12)表 12 -16到达车数概率累积概率对应的随机数00. 230. 2300～2210. 300. 5323～5220. 300. 8353～8230. 100. 9383～9240. 050. 9893～9750. 021. 0098～991. 00以下开始 模拟 ( 见表 12 -17 ) 。前 3 天作 为模 拟的 预 备期 , 记 为 x。 然后 依 次从 第 1 天、第 2 天……第 50 天。如第 1 天得到随机数 66 , 从表 12 -16 中可见 , 第 1 天达到车数为 2 , 将它记入表 12 -17。第 2 天 , 得到随机数 96 , 它在 表 12 -16 中 , 对应 达到 4 车 ……如 此 一直到第 50 天。表 12 -17 的第 (2 ) 、(3 ) 列数字 都填入 后 , 计 算出 第 ( 4 ) 、( 5 ) 、( 6 ) 列 数字 , 从第一个 x 日开始。当天到车数 ( 3) + 前一天推迟车数 (6 ) = 当天需要卸货车数 ( 4) ;卸货车数 (5 ) =需要卸货车数 (4 ) , 当天需要卸货车数≤2 当天需要卸货车数 > 22分析结果时 , 不考虑头三天写 x 的预备阶段的数 据。这是 为了使 模拟 在一个 稳态 过 程中任意点开始 , 否则若认为开始时没有 积压 就失去 随机 性了。表 12 -17 中表明 了模 拟 50 天运行情况 , 这相当于一个随机样本。由此可见多数情况 下很少 发生推迟 卸车而造 成 积压。只是在第 36 天比 较 严重 , 平均 达 车 数为 1. 58 , 比 期 望 值略 高。 又 知平 均 每 天 有 0. 9 车推迟卸货 , 当然模拟时间 越长 结果 越准确。 这方 法适 用于 对不 同方 案 可能 产生 的 结果进行比较 , 用电子计算机进行模拟是更为方便。模拟方法只能得到数字结果 , 不能得 出解析式。表 12 -17 排队过程的模拟表(1 )日期( 2) 随机数(3 )到达数( 4) 需要卸货车数(5) 卸货车数 ( 6) 推迟卸货车数x974422x020220x802220166222029644223552422450132152912206582220751111080400009863321·833·MBLA“(cid:10)MBLA“(cid:10)MBLA“(cid:10)MBLA“(cid:10)MBLA“(cid:10)MBLA“(cid:10)MBCTL(cid:3)(cid:30)CTL(cid:30)(cid:3)CTL(cid:30)(cid:3)CLTº(cid:30)(cid:3)CLTº(cid:3)(cid:30)CTLº(cid:3)(cid:30)CLTº(cid:30)(cid:3)CLTº(cid:30)(cid:3)CLTº(cid:3)(cid:30)CLTº(cid:30)(cid:3)CTLº(cid:3)(cid:30)CLTº(cid:3)(cid:30)(1 )日期101112131415161718192021222324252627282930313233343536373839404142434445 46 47 48 49 50 总 计 平 均( 2) 随机数243947606544932086124229360141546821539148365570383698509592672476640253 16 16 55 54 23(3 )到达数111221403011101220231122115143212202 0 0 2 2 1 79 . 581( 4) 需要卸货车数211221423111101220232122115467766644 2 0 2 2 1续表(5) 卸货车数 ( 6) 推迟卸货车数20101020201022202110101010001020200020212010202010102322242525242424222 2 0 2 2 12 0 0 0 0 0 45 . 900·933·CÑTL(cid:3)(cid:30)ÑCTL(cid:30)(cid:3)ÑCTL(cid:3)(cid:30)CÑTL(cid:30)(cid:3)ÑCLT(cid:30)(cid:3)CÑLT(cid:30)(cid:3)CÑLT(cid:30)(cid:3)CÑTL(cid:3)(cid:30)CÑTL(cid:30)(cid:3)CÑLT(cid:30)(cid:3)ÑCTL(cid:3)(cid:30)CÑTL(cid:30)(cid:3)ÑCTL(cid:3)(cid:30)ÑCLT(cid:3)(cid:30)ÑCLT(cid:3)(cid:30)CÑLT(cid:3)(cid:30)ÑCTL(cid:30)(cid:3)ÑCLT(cid:3)(cid:30)CÑLT(cid:30)(cid:3)CÑTL(cid:3)(cid:30)CÑLT(cid:30)(cid:3)CÑTL(cid:3)(cid:30)ÑCLT(cid:3)(cid:30)CÑLT(cid:30)(cid:3)CÑLT(cid:3)(cid:30)CÑLT(cid:30)(cid:3)CÑTL(cid:30)(cid:3)CÑLT(cid:3)(cid:30)ÑCLT(cid:3)(cid:30)ÑCTL(cid:3)(cid:30)CÑTL(cid:3)(cid:30)ÑCLT(cid:30)(cid:3)CÑLT(cid:30)(cid:3)CÑTL(cid:3)(cid:30)CÑTL(cid:3)(cid:30)CÑLT(cid:30)(cid:3)ÑCTL(cid:30)(cid:3)CÑLT(cid:3)(cid:30)ÑCLT(cid:30)(cid:3)ÑCTL(cid:3)(cid:30)CÑTL(cid:30)(cid:3)k(cid:26)¾³(cid:4)(cid:15)习题12. 1 某工地为了研究发放工具应设置几个 窗口 , 对 于请 领和发 放工 具分别 作了 调查记录 :(1 ) 以 10 分钟为一段, 记录了 100 段时间内每段到来请领工具的工人数, 见表 12 -18 ; (2 ) 记录了 1000 次发放工具 ( 服务 ) 所用时间 ( 秒 ) 见表 12 -19 , 试求 : ① 平均到达率和平均服务率。② 利用统计学的方法证明 : 若假设到来的数是服从参数 λ= 1. 6 的 泊松分布 , 服务 时间服从参数 μ= 0. 9 的负指数分布 , 这是可以接受的。(3 ) 这时只设一个服务员是不行的 , 为什么 ? 试分别就服务员数 c = 2 , 3 , 4 各情况 计算等待时间 W q , 注意用表 12 -11。(4 ) 设请领工具的工人等待 的费 用损失 为每 小时 6 元 , 发放 工具 的服务 员空 闲费 用损失为每小时 3 元 , 每天按八小时计算 , 问设几个服务员使总费用损失为最小 ?12. 2 某修理店只有一个修理工人 , 来修理的顾客到达次数服从泊松分布 , 平均每小时 4 人 , 修理时间服从负指数分布 , 平均需 6 分钟。求 :表 12 -18表 12 -19每 10 分钟内领工具人数次 数发放时间( 秒 )次 数511520060301757145140816010491757810290691141055112612047139135381415111215030161316516171018012189195101972107204225921324092232553232411270125 合计1100285合计11000·043·†³ï(cid:31)†³ï(cid:31)ï(cid:31)†³ï(cid:31)†³(cid:31)ï†œ6ïœ†6ïœ(cid:157)6ïœ(cid:157)6ïœ(cid:157)6(cid:6)(cid:157)œ6(cid:6)œ(cid:157)6(cid:6)œ(cid:157)6(cid:6)œ(cid:157)6ï…(cid:157)6ï…(cid:157)6ï6ï…(cid:157)6ï…(cid:157)6ï(cid:157)…6ï…(cid:157)6ïÊ(cid:29)(1 ) 修理店空闲时间概率 ;(2 ) 店内有 3 个顾客的概率 ; (3 ) 店内至少有 1 个顾客的概率 ; (4 ) 在店内顾客平均数 ; (5 ) 在店内平均逗留时间 ; (6 ) 等待服务的顾客平均数 ; (7 ) 平均等待修理 ( 服务 ) 时间 ; (8 ) 必须在店内消耗 15 分钟以上的概率。 12. 3 在某单人理发店顾客到达为泊松流 , 平均 到达 间隔 为 20 分 钟 , 理发时 间服 从负指数分布 , 平均时间为 15 分钟。求 : (1 ) 顾客来理发不必等待的概率 ; (2 ) 理发店内顾客平均数 ; (3 ) 顾客在理发店内平均逗留时间 ; (4 ) 若顾客在店内平均逗 留时间 超过 1. 25 小时 , 则店 主将 考虑增 加设 备 及理 发员 ,问平均到达率提高多少时店主才作这样考虑呢 ?12. 4 在例 3 中 (1 ) 试求系统中 ( 包括手术室和候诊室 ) 有 0 , 1 , 2 , 3 , 4 , 5 个病人的概率。 (2 ) 设 λ不变而 μ是可控制的 , 证明 : 若医院管理人员认为使病 人在医院 平均耗费 时间超过 2 小时是不允许的 , 那么必须平均服务率 μ达到 2. 6( 人/ 小时 ) 以上。12. 5 称顾客为等待所费时间与服务时间之比为顾客损失率 , 用 R 表示。 λ ; μ - λ (2 ) 在例 3 中仍设 λ不变 ,μ是可控制的 , 试定 μ使顾客损失率小于 4。 12. 6 设 ns 表示系统中顾客数 , nq 表示队列中等候的顾客数 , 在单服务台系统中有ns = nq + 1( ns , nq > 0)试说明它们的期望值Ls ≠ Lq + 1 Ls = Lq + ρ根据这关系式给 ρ以直观解释。12. 7 某工厂为职工设立了昼夜 24 小 时都能 看病 的医疗 室 ( 按 单服务 台处 理 ) 。 病 人到达的平均间隔时间为 15 分钟 , 平均看病 时间为 12 分钟 , 且服 从负 指数 分布 , 因工 人 看病每小时给工厂造成损失为 30 元。 (1 ) 试求工厂每天损失的期望值。 (2 ) 问平均服务率提高多少 , 方可使上述损失减少一半 ? 12. 8 对于 M/ M/ 1/ ∞/ ∞模型 , 在先到先服务情况下 , 试证 : 顾客排队等待时间分布 q , wq > 0并根据这式求等待时间的期望值 W q 。12. 9 在 M/ M/ 1/ N/ ∞模型中 , 如 ρ= 1(λ= μ) , 试证 : (12 -24) 式应为·143·P0 = P1 = … =1 N + 1于是Ls = N/ 212. 10 对于 M/ M/ 1/ N/ ∞模型 , 试证 :λ(1 - Pn ) = μ(1 - P0 )并对上式给予直观的解释。12. 11 在第 2 题中如店内已有 3 个顾客 , 那 么后 来的 顾客即 不再 排队 , 其他 条件 不变。试求 :(1 ) 店内空闲的概率 ; (2 ) 各运行指标 Ls , Lq , W s , Wq 。 12. 12 在第 2 题中 , 若顾客平均到达率增加 到每 小时 12 人 , 仍为 泊松流 , 服 务时 间不变 , 这时增加了一个工人。(1 ) 根据 λ/ μ的值说明增加工人的原因。 (2 ) 增加工人后求店内空闲概率 ; 店内有 2 个或更多顾客 ( 即工人繁忙 ) 的概率。 (3 ) 求 Ls , Lq , W s , Wq 。 12. 13 有 M/ M/ 1/ 5/ ∞模型 , 平 均服 务率 μ= 10 , 就两种 到达 率 :λ= 6 ,λ= 15 , 已 计算出相应的概率 Pn 如表 12 -20 所示。试就这两种情况计算 :表 12 -20系统中顾客数 n(λ= 6 ) Pn(λ= 15 ) Pn00. 42. 05 010. 25. 07 020. 15. 11 030. 09. 16 040. 05. 24 050. 04. 37 0(1 ) 有效到达率和服务台的服务强度 ; (2 ) 系统中平均顾客数 ; (3 ) 系统的满员率 ; (4 ) 服务台应从哪些方面改进工作 ? 理由是什么 ? 12. 14 对于 M/ M/ 1/ m/ m 模型 , 试证 :Ls = m -μ(1 - P0 ) λ并给予直观解释。12. 15 对于 M/ M/ c/ ∞/ ∞模型 ,μ是每个服务台的平均服务率 , 试证 : (1 ) Ls - Lq =λ/ μ; c(2 ) λ= μ c - ∑( c - n) Pn 。n = 0·243·Æ»M{pÆ»M{pMÆ»{pÆ»M{pMÆ»{pÆ»M{p并给予直观解释。注意 在单服务台情况 , ( 1) 式是很容易解释的。但是 c 个服务台时 , 其结果 仍相同 ,且与 c 无关 , 这是引人注意的。12. 16 车间内有 m 台机器 , 有 c 个修理工 ( m > c) 。 每台 机器发 生故 障率为 λ, 符 合M/ M/ c/ m/ m 模型 , 试证 :W s1 λ + W s=Ls m并说明上式左右两端的概率意义。12. 17 在例 9 中如售票处使用自动售票机 , 顾客在窗 口前的服 务时间 将减少 20 % 。这时认为服务时间分布的概率密度是f ( z) =1. 25 e - 1. 25 z + 1 0z≥0. 8z < 0. 8( 这里的服务时间 z 与例 9 中 ( 2) 的 y 关 系很相 似 z = 0. 8 y) 再 求顾客 的逗 留时间 和等 待 时间。12. 18 在第 2 题 , 如服务时间服从正态分布 , 数学期望值仍是 6 分钟 , 方差 σ2 = 1/ 8 ,求店内顾客数的期望值。12. 19 一个办事员核对登记的申请书时 , 必 须依次 检查 8 张 表格 , 核 对每份 申请 书需 1 分钟。顾客到达率为每小时 6 人 , 服务时间和到达间隔均为负指数分布 , 求 :(1 ) 办事员空闲的概率 ; (2 ) Ls , Lq , W s 和 W q 。 12. 20 对于单服务台情形 , 试证 : (1 ) 定长服务时间 L( 1 ) (2 ) 定长服务时间 W ( 1 )q 是负指数服务时间 L ( 2 ) q 是负指数服务时间 W ( 2 )q 的一半 ;q 的一半。·343·八、存 储 论第 13 章 存 储 论第 1 节 存储论的基本概念1. 1 存储问题的提出人们在生产和日常生活活动中往往将所需的物资、用品和食物暂时地储存起来 , 以备 将来使用或消费。这种储存物品的现象是为了解决供应 ( 生产 ) 与需求 ( 消费 ) 之间的不协 调的一种措施 , 这种不协调性一般表现为供应 量与需 求量 和供 应时期 与需 求时期 的不 一 致性上 , 出现供不应求或供过于求。人们在供应与需求这两环节之间加入储存这一环节 , 就能起到缓解供应与需求之间的不协调 , 以此为研究对象 , 利用运筹学的方法去解决最合 理、最经济地储存问题。(1 ) 例如 , 水电站在雨季到来之前 , 水库应蓄水多少 ? 这个问 题就存在 一个矛盾。 就 发电的需要来说 , 当然蓄水以多为好。就安全 来说 , 如 果雨 季降雨 量大 , 则 必须考 虑先 放 掉一些水 , 使水库存水量减少。否则洪水到来时 , 水库水位猛涨 , 溢洪道排泄不及时 , 可能 会使水坝坍塌 , 除水电站被破坏外 , 还会给下 游造成 巨大 的损失。 假设 只考虑 安全 , 可 提 前把水库存水放空。但当雨季降雨量小时 , 就会造成水库存水量不足 , 使发电量减少。因 此 , 合理地调节水库的存水量对国民经济 有重 大意义。 比如 1981 年第 一季度 , 由 于我 国 各地水电站调度合理 , 比计划多发电 14 亿度 , 相当于节约用煤 80 万吨。(2 ) 工厂生产需用原料 , 如没有储存一定数量的原料 , 会发生 停工待料 现象。原料 储 存过多除积压资金外 , 还要支付一笔存储保管费用。如蛋品加工厂需用鲜蛋作原料 , 鲜蛋 存量过少 , 会产生停工待料而使工厂开工不 足而造 成损 失 ; 如储存 鲜蛋 过多 , 在支 付存 储 保管费用中还要支出一笔冷冻保鲜费用。遇到 一些意 外的 因素使 鲜蛋 变质 则损失 更大。在这种情况下 , 最好存储多少鲜蛋 ?在机器制造厂中 , 加工一个零件常常需 要经 过许多 工序。 一道工 序完 工后即 成为 下 道工序的生产备件 , 在这种由前道工序转入 下道 工序的 环节 中就 会产生 存储 问题。每 台 机器由许多部件装配而成 , 每个部件又由许多零件组成 , 每个零件又需要许多工序才能制 成。因此发生在每个环节中的存储问题 , 总 起来 看就不 是可 以忽 略不计 的问 题了。如 果 各个环节生产备件的存储量安排得合理 , 既可避免因停工待料造成经济上的损失 , 又可以 少占用流动资金 , 加速周转 , 增加利润。(3 ) 在商店里若存储商品 数量不 足 , 会发 生缺货 现象 , 失 去销售 机会 而减 少利 润 ; 如·443·果存量过多 , 一时售不出去 , 会造成商品积压 , 占用流动资金过多而且周转不开 , 这样也会 给商家造成经济损失。当然 , 顾客购买何种商 品以 及购买 多少 , 都 带有 随机性 , 在 这种 情 况下商店的管理人员就应研究商品的存储量。诸如此类 , 与存储量有关的问题 , 需要人们作 出抉 择 , 在长 期实践 中人 们摸索 到一 些 规律 , 也积累了一些经验。专门研究这类有 关存储 问题 的科学 , 构 成运 筹学 的一个 分支 , 叫作存储论 ( inven t ory) , 也称库存论。本章所介绍的存储问题 , 模型并不复杂 , 原理 也容 易掌 握 , 应用这 些原 理可以 从一 个方面改善企业的经营管理 , 以达到节约资金 , 获得更多利润的目的。1. 2 存储论的基本概念工厂为了生产 , 必须储存一些原料 , 把这些储存物简称存储。生产时从存储中取出一 定数量的原料消耗掉 , 使存储减少。生产不断 进行 , 存 储不 断减少 , 到 一定 时刻必 须对 存 储给以补充 , 否则存储用完了 , 生产无法进行。商店必须储存一些商品 ( 即存储 ) , 营业时卖掉一部分商品使存储减少 , 到一定的时候又必须进货 , 否则库存售空无法继续营业。一般地说 , 存储量因需求而减少 , 因补充而增加。1. 需求对存储来说 , 由于需求 , 从 存储 中取 出一 定的 数 量 , 使存 储 量 减少 , 这就 是 存储 的 输出。有的需求是间断式的 , 有的需求是连续均匀的。图 13-1 和图 13-2 分别表示 t 时间内的输出量皆为 S- W , 但两者的输出方式不同。图13 -1 表示输出是间断的 , 图 13 -2 表示输出是连续的。图 13-1图 13-2有的需求是确定性的 , 如钢厂每月按合同卖给电机厂矽钢片 10 吨。有的需求是随机 性的 , 如书店每日卖出去的书可能是 1000 本 , 也 可能 是 800 本。但是 经过 大量的 统计 以 后 , 可能会发现每日售书数量的统计规律 , 称之为有一定的随机分布的需求。2. 补充 (订货或生产 )存储由于需求而不断减少 , 必须加以补充 , 否则最终将无法满足需求。补充就是存储 的输入。补充的办法可能是向其他工厂购买 , 从订货 到货 物进入“ 存储”往 往需要 一段 时·543·间 , 我们把这段时间称为备货时间。从另一个 角度 看 , 为了 在某一 时刻 能补充 存储 , 必 须 提前订货 , 那么这段时间也可称之为提前时间 ( lead time ) 。备货时间可能很长 , 也可能很短 , 可能是随机性的 , 也可以是确定性的。 存储论要解决的问题是 : 多少时间补充一次 , 每次补充的数量应该是多少。决定多少时间补充一次以及每次补充数量的策略称为存储策略。存储策略的优劣如何衡量呢 ? 最直接的衡量 标准 , 是 计算 该策略 所耗 用的平 均费 用多少。为此有必要对费用进行详细的分析。3. 费用主要包括下列一些费用 : (1 ) 存储费 , 包括货物占用资金 应付 的利 息以及 使用 仓库、保管 货物、货 物损 坏变 质等支出的费用。(2 ) 订货费 , 包括两项费用 , 一项是订购费用 ( 固定费用 ) 如手 续费、电信往来、派人 员 外出采购等费用。订购费 与订 货 次数 有关 而与 订货 数 量无 关。另一 项 是货 物 的成 本 费用 , 它与订货数量有关 ( 可变费 用 ) , 如 货物 本身的 价格 , 运 费等。如 货物 单价 为 K 元 , 订 购费用为 C3 元 , 订货数量为 Q, 则订货费用为 : C3 + KQ。(3 ) 生产费 , 补充存储时 , 如果不需向外厂订货 , 由本厂自行生产 , 这时仍 需要支出 两 项费用。一项是装配费用 ( 或称准备、结束费用 , 是 固定 费用 ) , 如更 换模、夹 具需要 工时 , 或添置某些专用设备等属于这项费用 , 也用 C3 表示。另一项是与生产产品的数量有关的 费用如材料费、加工费等 ( 可变费用 ) 。(4 ) 缺货费 , 当存储供不应求时所引起的损失。如失去销售机会的 损失、停工待料 的损失以及不能履行合同而缴纳罚款等。在不允许缺货的情况下 , 在费用上处理的方式是缺货费为无穷大。4. 存储策略如前所述决定何时补充 , 补 充多 少数 量的 办 法称 之为 存储 策 略 , 常 见的 策 略有 三 种类型。(1 ) t0 -循环策略 , 每隔 t0 时间补充存储量 Q。 (2 ) ( s, S) 策略 , 每当存储量 x > s 时不 补充。当 x≤ s 时补 充存储。补 充量 Q = S - x( 即将存储量补充到 S) 。( 3) ( t, s, S) 混合策略 , 每经过 t 时间检查存储量 x , 当 x > s 时不补充。当 x≤ s 时 , 补充存储量使之达到 S。确定存储策略时 , 首先是把实际问题抽象为数学模型。在形成模型过程中 , 对一些复 杂的条件尽量加以简化 , 只要模型能反映问 题的 本质就 可以 了。然后 对模 型用数 学的 方 法加以研究 , 得出数量的结论。这结论是否正确 , 还要拿到实践中加以检验。如结论与实 际不符 , 则要对模型重新加以研究和修改。存 储问题 经长 期研 究已得 出一 些行之 有效 的 模型。从存储模型来看大体上可分为两类 : 一类叫作确定性模型 , 即模型中的数据皆为确 定的数值 ; 另一类叫作随机性模型 , 即模型中含有随机变量 , 而不是确定的数值。由于具体条件有差别 , 制定 存储 策略 时又 不 能忽 视这 些差 别 , 因 而 模型 也 有多 种 类·643·型。本章将按确定性存储模型及随机性存储模型两大类 , 分别介绍一些常用的存储模型 , 并从中得出相应的存储策略。一个好的存储策略 , 既可以使总费用小 , 又可 避免因 缺货 影响生 产 ( 或 对顾客 失去 信用 ) , 下面利用一些具体的模型阐述如何求出较好的存储策略。第 2 节 确定性存储模型2. 1 模型一: 不允许缺货 , 备货时间很短在研究、建立模型时 , 需要作一些假设 , 目的 是使 模型简 单、易于 理解、便 于计算。 为此作如下假设 :(1 ) 缺货费用无穷大 ; (2 ) 当存储降至零时 , 可以立即 得到 补充 ( 即 备货 时间或 拖后 时间很 短 , 可以 近似 地看作零 ) ;(3 ) 需求是连续的、均匀的 , 设需求速度 R( 单位时间的需求量 ) 为常数 , 则 t 时间的需求量为 R t;(4 ) 每次订货量不变 , 订购费不变 ( 每次备货量不变 , 装配费不变 ) ; (5 ) 单位存储费不变。存储量变化情况用图 13-3 表示。 由于可以 立 即 得到 补 充 , 所 以 不 会 出 现 缺 货 , 在研究 这 种模 型 时 不 再 考虑 缺 货 费 用。 这 些假设条件 只 是 近 似的 正 确 , 在 这些 假 设 条 件 下如何 确 定 存 储 策 略 呢 ? 正 如 1. 2 中 所 提 示 的 , 要用 总 平 均 费 用 来 衡 量 存 储 策 略 的 优 劣。 为了找出最 低 费 用 的策 略 , 首 先 想到 在 需 求 确 定的情况下 , 每次订货量 多 , 则订 货次数 可以 减 少 , 从而减少了订购费。但是每次订货量多 , 会增加存储费用。为研究费用的变化情况需 要导出费用函数。图 13-3假定每隔 t 时间补充一 次存 储 , 那么 订货 量 必须 满 足 t 时 间的 需 求 R t , 记 订货 量 为Q, Q = R t, 订购费为 C3 , 货物单价为 K , 则订货费为 C3 + K R t; t 时间的平均订货费为 C3/ + K R , t 时间内的平均存储量为t∫t10RT d T =1 2Rt( 此结果由图 13-3 中利用几何知识易得出 , 平均存储量为三角形高的二分 之一 ) 单位时 间 内单位物品的存储费用为 C1 , t 时间内所需平均存储费用为 1 2R tC1 。t 时间内总的平均费用为 C( t)C( t) =C3 t+ K R +1 2C1 R t( 13-1)·743·tt 取何值时 C( t) 最小 ? 只需对 ( 13 -1 ) 式利用微积分求最小值的方法可求出。令 :d C( t) d t= -C3 t2 +1 2C1 R = 0得 :t0 =2 C3 C1 R因 d2 C( t) d t2> 0 , 即每隔 t0 时间订货一次可使 C( t) 最小。订货批量Q0 = R t0 =2 C3 R C1(13-3 ) 式即存储论中 著名 的经济 订购 批量 ( economic ordering quantity ) 公 式。简 称 为 E .O .Q 公式 , 也称平方根公式 , 或经济批量 ( economic lot size ) 公 式。由于 Q0 、t0 皆 与 K 无关 , 所以此后在费用 函 数中 略去 K R 这项 费 用。如 无特 殊需 要不 再考 虑 此项 费用 , (13 -1 ) 式改写为C( t) =C3 t+1 2Ct R t将 t0 代入 ( 13 -4) 式得出最佳费用C0 = C( t0 ) = C3C1 R 2 C3+1 2C1 R2 C3 C1 R=2 C1 C3 RC0 = min C( t)从费用曲线 ( 见图 13 -4) 也可以求出 t0 , Q0 , C0 。 存储费用曲线 1 2C1 R t订购费用曲线C3 tC3 t C( t) 曲线的最低点 ( min C( t) ) 的横坐标 t0 与存1 2总费用曲线 C( t) =( 13 -1′)+C1 R t储费用曲线、订购费用曲线交点横坐标相同。即C3 t0=1 2C1 R t0图 13 -4解出 t0t0 =2 C3 C1 RQ0 = R t0 =2 C3 R C11 2 (13 -2′) 式 , (13 -3′) 式 , ( 13 -4′) 式与 ( 13 -2) 式 , ( 13 -3 ) 式 , (13 -5) 式一致。 公式 ( 13 -2 ) 是由于选 t 作为存储策略变量推导出来的。如果选订货批量 Q 作存储策C3 t0C0 =+C1 Rt0 =2 C1 C3 R略变量也可以推导出上述公式。例 1 某厂按合同每年需提供 D 个产品 , 不许缺货。假设每一周期 工厂需装 配费 C3·843·(13 -2)( 13-3)(13 -4)(13 -5)(13 -2′)(13 -3′)(13 -4′)元 , 存储费每年每单位产品为 C1 元 , 问全年应分几批供货才能使装配费 , 存储费两者之和 最少。解 设全年 分 n 批 供 货 , 每 批 生 产 量 Q = D/ n, 周 期 为 1 n年 ( 即 每 隔 1/ n 年 供 货一次 ) 。每个周期内平均存储量为 1 2Q每个周期内的平均存储费用为 C11 2Q1 n( 年 ) =C1 Q 2 n全年所需存储费用C1 Q 2 nn =C1 Q 2全年所需装配费用 C3 n = C3D Q全年总费用 ( 以年为单位的平均费用 ) :C( Q) = C1Q 2+ C3D Q为求出 C( Q) 的最小值 , 把 Q 看作连续的变量。d C( Q) d Q=C1 2C3D Q2 = 0C1 2= C3D Q2Q0 =2 C3 D C1即 min C( Q) = C( Q0 ) Q0 为经济订购批量。最佳批次 n0 =D Q0=C1 D 2 C3( 取近似的整数 )最佳周期 t0 =2 C3 C1 D答 全年应分 n0 次供货可使费用最少。 把例 1 中的 t0 、Q0 值与 ( 13 -2) 式 , ( 13 -3 ) 式比较 , 可知它们是一样的。此处 D 就相当 于 R; (13 -1) 式和 (13 -1′) 式都是研究此类存储问题的数学模型。尽 管它们在 形式上有 差 别 , 但都反映了这类存储问题各量之间的本质联系。从例 1 中还看到这些公式在实 际应 用时还 会有 一点 问题 , 因 为 t0 ( 或 Q0 , n0 ) 不一 定 是整数。假设 t0 = 16. 235 ( 天 ) 。很明显 , 小数 点后面 的数 字对 实际订 货间 隔的时 间是 没 有意义的 , 这时可以取近似的整数。取 t0 D 16 或 t0 D 17 都可以。 为了 精确起 见 , 可以 比 较 C( 16 ) 、C(17) 的大小 , 再决定 t0 = 16 或 t0 = 17。从图 13 -4 也 可以看 到 C( t) 在 t0 附 近 变化平稳 , t 有变化时 C( t) 变化不大。利用 数学分析 方法可 以证明当 t 在 t0 点 有增量 Δt时 , 总费用的增量 ΔC( t0 ) DC3 t30(Δt) 2 。即当 Δt→ 0 时 ,ΔC 是 Δt 的 高阶 无穷 小量。 ( 证 明的方法可参考微积分台劳公式部分 )例 2 某轧钢厂每月按计划需产角 钢 3000 吨 , 每吨 每 月需 存储 费 5 .3 元 , 每 次生 产需调整机器设备等 , 共需装配费 2500 元。该厂每月生产角钢一次 , 生产批量为 3000 吨。·943·每月需总费用全年需费用5 .3× 1 2 10450×12 = 125400( 元/ 年 )× 3000 + 2500 = 10450( 元/ 月 )按 E. O. Q 公式计算每次生产批量Q0 =2× C3 ( 装配费 ) × D( 需求速度 ) ÷ C1 ( 存储费 )2× 2500× 3000÷ 5 .3D 1682 ( 吨 )= 利用 Q0 计算出全年应生产 n0 次 ,n0 =3000 ×12 Q0D 21. 4( 次 )两次生产相隔的时间 t0 = 365/ 21. 4D 17 ( 天 ) 17 天的单位存储费 5 .3 30×17D 3 .00 ( 元/ 吨 ) , 共需费用 5 .3 30× 17 × 1682 + 2500 D 5025( 元 ) 。按全年 生 产 21. 5 次 ( 两 年 生 产 43 次 ) 计 算 , 全 年 共 需 费 用 5025 × 21. 5 = 108037( 元/ 年 ) 。两者相比较 , 该厂在利用 E. O. Q 公式求出经济批量进行生产即可每年节约资金 125400 - 108037 = 17363 ( 元 )2. 2 模型二: 不允许缺货 , 生产需一定时间本模型的假设条件 , 除生产需要一定时间的条件外 , 其余皆与模型一的相同。 设生产批量为 Q, 所需生产时间为 T, 则生产速度为 P = Q/ T。 已知需求速度为 R, ( R < P) 。生产的产品一部分满足需求 , 剩余部 分才作为 存储 , 这时存储变化如图 13 -5 所示。图 13 -5在 [0 , T] 区间内 , 存储以 ( P - R) 速度增加 , 在 [ T, t] 区间内存储以速 度 R 减少。 T 与 t 皆为待定数。从图 13 -5 易知 ( P - R) T = R( t - T) , 即 P T = R t( 等式表示以速度 P 生 产 T 时间的产品等于 t 时间内的需求 ) , 并求出 T = R t/ P。t 时间内的平均存储量为 1 2( P - R) Tt 时间内所需存储费为 1 2C1 ( P - R) T·053·t 时间内所需装配费为 C3 单位时间总费用 ( 平均费用 ) 为 C( t)C( t) =1 t1 2C1 ( P - R) T t + C3=1 t1 2C1 ( P - R)R t2 P+ C3设 min C( t) = C( t0 ) , 利用微积分方法可求得t0 =2 C3 P C1 R( P - R)(13 -6)图 13 -5 中 t 表示周期 , 所求出的 t0 为最佳周期。相应的生产批量Q0 = E. O. Q =2 C3 R P C1 ( P - R)( 13-7)min C( t) = C( t0 ) =2 C1 C3 R( P - R) P(13 -8)利用 t0 可求出最佳生产时间T0 =R t0 P=2 C3 R C1 P( P - R)将前面求 t0 , Q0 的公式与 ( 13 -6) 式 , ( 13 -7 ) 式相比较 , 即知它们只差P P - R一个因子。P P - R 进入存储的最高数量当 P 相当大时 ,趋近于 1 , 则两组公式就相同了。S0 = Q0 - R T0 =2 C3 R P C1 ( P - R)R2 C3 R C1 P( P - R)=2 C3 R( P - R) C1 P(13 -9)例 3 某厂每月需甲产品 100 件 , 每月 生 产率 为 500 件 , 每 批装 配费 为 5 元 , 每月 每件产品存储费为 0. 4 元 , 求 E. O. Q 及最低费用。解 已知 C3 = 5 , C1 = 0. 4 , P = 500 , R = 100 , 将各值代入公式 ( 13 -7) 及 (13 -8) 得E. O. Q =2 C3 R P C1 ( P - R)=3125 (cid:930) 56( 件 )C0 =2 C1 C3 R( P - R) P(cid:930) 178. 9 ( 元 )答 每次生产批量为 56 件 , 每次生产所需装配费及存储费最低为 178. 9 元。 例 4 某商店经售甲商品成本单价 500 元 , 年存储 费用为 成本的 20 % , 年 需求量 365 件 , 需求速度为常数。甲商品的定购费为 20 元 , 提前期为 10 天 , 求 E. O. Q 及最低费用。 解 此例题从表面上看 , 似乎应按模型 二处 理。因为 拖后 时间似 乎与 生产需 一定 时 间意义差不多。其实不然 , 现将 本题 存储变 化情 况用 图表示 之 ( 见图 13-6 ) , 并 与模 型一、 模型二的图相比较 , 可看到与模型一完全相同。本题只需在存储降至零时提前 10 天订货 即可保证需求。本例题的数据与例 2 相同 , 所以解也相同 , E. O. Q = 12( 单位 ) , 最低费用 = 1208 元。 由于提前期为 10 天 , 10 天内的需求为 10 单位甲商品 , 因此只 要当存 储降至 10 就 要·153·订货。一般设 t1 为 提 前 期 , R 为 需 求 速 度 , 当 存 储 降至 L = Rt1 的时候即订货。 L 称为“ 订购点”( 或称 订货点 ) 。从本 例 题 来 看 , 多 少 时 间 订 一 次 货 , 虽 可 以 用 E. O. Q 除以 R( t0 = Q0/ R) 得出 t0 , 但求 解的过 程中 并没有 求出 t0 , 只 求出 订货 点 L, 这 时存 储 策略 是 : 不考虑 t0 , 只要存储降至 L 即订货 , 订货 量为 Q0 , 称 这种存储策 略 为 定点 定 货。 相对 地 称 每 隔 t0 时 间 订货一次为定时 订货 , 每 次 订货 量不 变则 称 为 定量 订货。图 13-62. 3 模型三: 允许缺货, 备货时间很短模型一、模型二是在不允许缺货的情况下推导出来的。本模型是允许缺货 , 并把缺货 损失定量化来加以研究。由于允许缺货 , 所以企业可以在存储降至零后 , 还可以再等一段 时间然后订货。这就意味着 企 业可 以少 付几 次订 货 的固 定费 用 , 少 支付 一些 存 储 费用。 一般地说当顾客遇到缺货时不受损失 , 或损失很小 , 而企业除支付少量的缺货费外也无其 他损失 , 这时发生缺货现象可能对企业是有利的。本模型的假设条件除允许缺货外 , 其余条件皆与模型一相同。 设 单位时间 单位物品 存储费 用为 C1 , 每次订购 费为 C3 , 缺货费 为 C2 ( 单位缺货 损失 ) , R 为需求速度。求最佳存储策略 , 使平均总费用最小 ( 见图 13 -7) 。图 13 -7假设最初存储 量为 S , 可以 满足 t1 时间的 需求 , t1 时间的 平均 存储 量为 1 2S, 在 ( t -t1 ) 时间的存储为零 , 平均缺货量为 1 2R( t - t1 ) 。由于 S 仅能满足 t1 时 间的需 求 S = R t1 ,有 t1 = S/ R在 t 时间内所需存储费C11 2S t1 =1 2C1S2 R在 t 时间内的缺货费C21 2R( t - t1 ) 2 =1 2C2( R t - S) 2 R订购费为 C3·253·平均总费用C( t, S) =1 tC1S2 2 R+ C2( Rt - S) 2 2 R+ C3式中有两个变量 , 利用多元函数求极值的方法求 C( t, S) 的最小值。C S R≠0 , t≠0 , C1 S - C2 ( R t - S) = 01 t( Rt - S) RS RC1=C2= 0S =C2 R t C1 + C2C t= -1 t2 C1S2 2 R+ C2( R t - S) 2 2 R R≠0 ,+ C3 +t≠01 t[ C2 ( R t - S) ] = 0( R t - S) 2 2 将 (13 -10) 式中 S 值代入上式 , 消去 SS2 2C1C2C3 R + tR[ C2 ( R t - S) ] = 0得t0 =2 C3 ( C1 + C2 ) C1 R C2将 (13 -10) 式代入 (13 -11 ) 式解出 SS0 =2 C2 C3 R C1 ( C1 + C2 )将 (13 -10) 式 , ( 13 -11) 式代入 C( t, S)得mi n C( t, S) = C0 ( t0 , S0 ) =2 C1 C2 C3 R C1 + C2当 C2 很大时 ( 不允许缺货 ) ,C2 →∞ ,C2 C1 + C2→ 1则t0 (cid:930)2 C3 C1 R,S0 (cid:930)2 RC3 C1,C0 (cid:930)2 C1 C3 R与 (13 -2 ) 式 , (13 -3) 式 , ( 13 -5 ) 式相同。模型三中由于 允 许 缺 货 最 佳 周 期 t0 为 不 允 许 缺 货 周 期 t 的C2 + C1 C2C2 + C1 C2> 1 , 所以两次订货间隔时间延长了。在不允许缺货情况下 , 为满足 t0 时间内的需求 , 订货量 Q0 = R t0即Q0 =2 RC3 C1C1 + C2 C2在允许缺货情况下 , 存储量只需达到 S0 即可 ,S0 =2 RC3 C2 C1 ( C1 + C2 )显然 Q0 > S0 , 它们的差值Q0 - S0 =2 RC3 C1( C1 + C2 ) C22 RC3 C1C2C1 + C2( 13 -10)( 13 -11)( 13 -12)( 13 -13)倍 , 又 由 于( 13 -14)·353·=2 RC3 C1C1 + C2 C2-C2 C1 + C2=2 RC3 C1C1C2 ( C1 + C2 )=2 R C3 C1 C2 ( C1 + C2 )表示在 t0 时间内的最大缺货量。在允许缺货条件下 , 经过研究而得出的存储策略是隔 t0 时间订货一次 , 订货量为 Q0 , 用 Q0 中的一部分补足所缺货物 , 剩余部分 S0 进 入存储。很 明显 , 在相 同的 时间段 落里 , 允许缺货的订货次数比不允许缺货时订货次数减少了。例 5 已知需求速度 R = 100 件 , C1 = 0. 40 元 , C2 = 0. 15 元 , C3 = 5 元 , 求 S0 及 C0 。 解 利用 (13 -12) 式 , ( 13 -13) 式即可计算S0 =2 RC3 C2 C1 ( C1 + C2 )=2 ×100×0. 15×5 0. 4× ( 0. 4 + 0. 15)(cid:930) 26 ( 件 )C0 =2 C1 C3 R C2 C1 + C2=2× 0. 4×5× 100×0. 15 0. 4 + 0. 15(cid:930) 104. 04( 元 )答 : S0 (cid:930) 26 ( 件 ) , C0 (cid:930) 104. 04 ( 元 ) 研究模型一、二、三存储策略之间的差别 , 可以看 到不 允许 缺货生 产需 要时间 很短 条件下得出的存储策略t0 =2 C3 C1 R( 见 13 -2 式 )Q0 =2 C3 R C1( 见 13 -3 式 )最大存储量S0 = Q0在不允许缺货、生产需一定时间条件下 , 得出存储策略t0 =2 C3 C1 RP P - R( 见 13 -6 式 )Q0 =2 C3 R C1P P - R( 见 13 -7 式 )最大存储量S0 =2 C3 R C1P - R P( 见 13 -9 式 )在允许缺货、生产需时间很短条件下 , 得出存储策略t0 =2 C3 C1 RC1 + C2 C2( 见 13 -11 式 )Q0 =2 C3 R C1C1 + C2 C2( 见 13 -14 式 )最大存储量S0 =2 C3 R C1C2 C1 + C2( 见 13 -12 式 )模型二、三只是以模型一的存储策略乘上相应的因子 , 这样可以便于记忆 , 再有模型一中1 2Q0 t0 =1 2S0 t0 =C3 C1模型二中1 2S0 t0 =2 C3 R C1P - R P2 C3 C1 RP P - R=C3 C1·453·模型三中 1 2S0 t0 =2 C3 R C1·C2 C1 + C2·2 C3 C1 R·C1 + C2 C2=C3 C1都是同一个数值 , 这样就得出它们之间的差 别与内 在联 系。对于 允许 缺货 ( 缺 货需 补足 ) 生产需要一 定 时 间 条 件 下 的 存 储 策 略 , 我 们 相 信 它 一 定 是 以 模 型 一 的 存 储 策 略 乘 上C1 + C2 C2及P P - R两个因子 , 它也应有 1 2S0 t0 =C3 C1, 可自行验证。下面做具体介绍。2. 4 模型四: 允许缺货 (需补足缺货 ) 、生产需一定时间假设条件除允许缺货生产 需 一定 时间 外 , 其 余条 件皆 与模 型 一相 同 , 其 存 储变 化 如图 13 -8 所示。图 13 -8取 [0 , t] 为一个周期 , 设 t1 时刻开始生产。 [0 , t2 ] 时间内存储为零 , B 表示最大缺货量。 [ t1 , t2 ] 时间内除满足需求外 , 补足 [0 , t1 ] 时间内的缺货。 [ t2 , t3 ] 时间内满足需求后的产品进入存储 , 存储量以 ( P - R) 速度增加。 S 表示存储量 , t3 时刻存储量达到最大 , t3 时刻停止生产。 [ t3 , t] 时间存储量以需求速度 R 减少。 由图 13 -8 易知 : 最大缺货量 B = R t1 , 或 B = ( P - R) ( t2 - t1 )即 R t1 = ( P - R) ( t2 - t1 ) , 得t1 =( P - R) Pt2( 13 -15)最大存储量 S = ( P - R) ( t3 - t2 ) , 或 S = R( t - t3 )即 ( P - R) ( t3 - t2 ) = R( t - t3 ) , 得 t3 =R Pt + 1 -R Pt2或t3 - t2 =R P( t - t2 )( 13 -16)在 [0 , t] 时间内所需费用 :存储费 :1 2C1 ( P - R) ( t3 - t2 ) ( t - t2 )将 (13 -16) 式代入消去 t3 , 得1 2C1 ( P - R)R P( t - t2 ) 2·553·缺货费 :1 2C2 R t1 t2将 (13 -15) 式代入消去 t1 , 得 1 2C2 R( P - R) Pt22装配费 : C3 在 [0 , t] 时间内总平均费用为 :C( t, t2 ) =1 t1 2C1( P - R) R P( t - t2 ) 2 +1 2C2( P - R) R Pt2 2 + C3=1 2( P - R) R PC1 t - 2 C1 t2 + ( C1 + C2 )t2 2 t+C3 tC( t, t2 ) t=1 2( P - R) R PC1 + ( C1 + C2 ) t221 t2C3 t2C( t, t2 ) t2=1 2( P - R) R P2 C1 + 2 ( C1 + C2 ) t2 · 1 t令C( t, t2 ) t= 0 ,C( t, t2 ) t2= 0 解出 t1 , t2由 (13 -18) 式得t2 =C1 C1 + C2t由 (13 -17) 式得1 2( P - R) R PC1 + ( C1 + C2 ) t221 t2C3 t2 = 0将 (13 -19) 式代入上式消去 t2 得1 2( P - R) R PC1 - ( C1 + C2 )C2 ( C1 + C2 ) 21C31 t2 = 01 2( P - R) R P1 + C1 C2 - C2 C2 C1 + C21C3 t2 = 0t2 =2 P( C1 + C2 ) C3 C1 C2 ( P - R) Rt =2 C3 C1 RC1 + C2 C2P P - R; 可记作 t0由 (13 -19) 有t2 =C1 C1 + C2t0 =C1 C1 + C22 C3 C1 RC1 + C2 C2P P - R依数学分析的知识可以断定 C( t, t2 ) 在 t = t0 , t2 =C1 C1 + C2t0 时有最小值。相应地得到t0 =2 C3 C1 RC1 + C2 C2P P - RQ0 = R· t0 =2 C3 R C1C1 + C2 C2P P - RS0 ( 最大存储量 ) = R( t0 - t3 ) = R t0 -= R t0 -R Pt0 -P - R PR P · C1P - R Pt0 -t0C1 + C2t2·653·( 13 -17)( 13 -18)( 13 -19)( 13 -20)( 13 -21)= R·P - R P·C2 C1 + C2· t0=2 C3 R C1C2 C1 + C2P - R P( 13 -22)B0 ( 最大缺货量 ) = R· t1 =R( P - R) Pt2=2 C1 C3 R ( C1 + C2 ) C2P - R P( 13 -23)min C( t0 , t2 ) = C0 =2 C1 C3 R·C2 C1 + C2P - R P( 13 -24)2. 5 价格有折扣的存储问题以上模型所讨论的货物单价是常量 , 得 出的 存储策 略都 与货 物单价 无关。现 在介 绍 货物单价随订购 ( 或 生产 ) 数量 而变 化时 的 存储 策略。 我们 常看 到一 种商 品 有所 谓零 售 价、批发价和出厂价 , 购买同一种商品的数量 不同 , 商品 单价 也不 同。一般 情况下 购买 数 量越多 , 商品单价越低。在少数情况下 , 某种商品 限额 供应 , 超 过限额 部分 的商品 单价 要 提高。除去货物单价随订购数量而变化外 , 其余条件皆与模型一的假设相同时 , 应如何制定相应的存储策略 ?记货物单价为 K( Q) , 设 K( Q) 按三个数量等级变化 ( 见图 13 -9) 。图 13 -9K( Q) =0≤ Q < Q1K1 K2 Q1 ≤ Q < Q2 K3 Q2 ≤ Q当订购量为 Q 时 , 一个周期内所需费用为 :1 2C1 QQ R+ C3 + K( Q) QQ∈ [ 0 , Q1 ) 有1 2C1 QQ R+ C3 + K1 QQ∈ [ Q1 , Q2 ) 有1 2C1 QQ R+ C3 + K2 QQ≥ Q2有1 2C1 QQ R+ C3 + K3 Q·753·平均每单位货物所需费用 C( Q) ( 见图 13 -10 )图 13 -10CⅠ ( Q) =1 2C1Q R+C3 Q+ K1Q∈ (0 , Q1 )CⅡ ( Q) =1 2C1Q R+C3 Q+ K2Q∈ [ Q1 , Q2 )CⅢ ( Q) =1 2C1Q R+C3 Q+ K3Q≥ Q2如果不考虑 CⅠ ( Q) 、CⅡ ( Q) 、CⅢ ( Q) 的定 义域 , 它 们之 间只差 一个 常数 , 因此 它们 的 导函数相同。为求极小 , 令导数为零 , 解得 Q0 , Q0 落在哪 一个区间 , 事先难以预计。 假设 Q1 < Q0 < Q2 , 这 也 不 能 肯 定 CⅡ ( Q0 ) 最 小。 图 13 -10 的 直 观 感 觉 启 发 我 们 考 虑 : 是 否 CⅢ ( Q2 ) 的费用更小 ? 设最佳订购批量为 Q* , 在给出价格有折扣情况下 , 求解步骤如下 :(1 ) 对 CⅠ ( Q) ( 不考虑定义域 ) 求得极值点为 Q0 (2 ) 若 Q0 < Q1 , 计算 :CⅠ ( Q0 ) =1 2C1Q0 R+C3 Q0+ K1CⅡ ( Q1 ) =1 2C1Q1 R+C3 Q1+ K2Q2 R 由 min{ CⅠ ( Q0 ) , CⅡ ( Q1 ) , CⅢ ( Q2 )} 得 到 单位 货 物最 小 费用 的 订 购批 量 Q* 。 例 如C3 Q21 2CⅢ ( Q2 ) =C1++ K3min{ CⅠ ( Q0 ) , CⅡ ( Q1 ) , CⅢ ( Q2 )} = CⅡ ( Q1 ) , 则取 Q* = Q1 (3 ) 若 Q1 ≤ Q0 < Q2 , 计算 CⅡ ( Q0 ) 、CⅢ ( Q2 ) 。 由 min{ CⅡ ( Q0 ) , CⅢ ( Q2 ) }决定 Q* (4 ) 若 Q2 ≤ Q0 , 则取 Q* = Q0 。 以上步骤易于推广到单价折扣分 m 个等级的情况。 比如说订购量为 Q, 其单价 K( Q) :K1K20≤ Q < Q1 Q1 ≤ Q < Q2⁝K( Q) =KjQ j - 1 ≤ Q < Qj⁝K mQm - 1 ≤ Q·853·对应的平均单位货物所需费用为 :Cj ( Q) =1 2C1Q R+C3 Q+ Kjj = 1 , 2 , … , m对 C1 ( Q ) 求 得 极 值 点 为 Q0 , 若 Qj - 1 ≤ Q0 < Qj , 求 min { Cj ( Q0 ) , Cj + 1 ( Qi ) , … ,Cm ( Qm - 1 )} , 设从此式得到的最小值为 Cl ( Ql - 1 ) , 则取 Q* = Ql - 1例 6 某厂每年需某种元件 5000 个 , 每次订 购费 C3 = 500 元 , 保 管费 每件 每年 C1 =10 元 , 不允许缺货。元件单价 K 随采购数量不同而有变化。K( Q) =20 元 Q < 1500 19 元 1500≤ Q解 利用 E. O. Q 公式计算Q0 =2 C3 R C1=2×500× 5000 10(cid:930) 707( 个 )分别计算每次订购 707 个和 1500 个元件所需平均单位元件所需费用 : ×10 × 707 50001 2500 707+ 20(cid:930) 21. 414 ( 元/ 个 )+C( 707) =C(1500) =1 2×10 ×1500 5000+500 1500+ 19(cid:930) 20. 833( 元/ 个 )因为 C( 1500 ) < C( 707) 知最佳订购量 Q = 1500 答 该厂每次应订购 1500 个元件。 在本章节中 , 由于订购批量不同 , 订货周期长 短不 一样 , 所 以才利 用平 均单位 货物 所需费用比较优劣。当然也可以利用不同批量 , 计算其全年所需费用来比较优劣。也有的折扣条件为K( Q) =K1K2当 Q < Q1 时当 Q > Q1 时 , 超过 Q1 部分 ( Q - Q1 ) 才按 K2 计算货物单价。如果 K2 < K1 , 显 然是鼓 励大量购 买货物。 在特殊情 况下会出 现 K2 > K1 , 这 时是利用 价 格的变化限制购货数量。本章节提供的方法稍加变化后可解决这类问题。第 3 节 随机性存储模型随机性存储模型的重要特点是需求为随机的 , 其概率或分布为已知。在这种情况下 , 前面所介绍过的模型已经不能适用了。例如商 店对 某种商 品进 货 500 件 , 这 500 件商 品 可能在一个月内售完 , 也有可能在两个月之 后还 有剩余。 商店 如果想 既不 因缺货 而失 去 销售机会 , 又不因滞销而过多积压资金 , 这时必须采用新的存储策略。可供选择的策略主 要有三种 :(1 ) 定期订货 , 但订货数量需 要根据 上一 个周期 末剩 下货 物的数 量决 定订 货量。 剩 下的数量少 , 可以多 订货。剩 下的 数 量多 , 可 以少 订 或不 订货。这 种 策 略可 称 为定 期 订 货法。(2 ) 定点订货 , 存储降到某一确定的数量时即订货 , 不再考虑 间隔的时 间。这一数 量值称为订货点 , 每次订货的数量不变 , 这种策略可称之为定点订货法。·953·(3 ) 把定期订货与定点订货综合起来的方法 , 隔一定时间检查一次 存储 , 如果存储 数 量高于一个数值 s, 则不订货。小于 s 时则订货补充存储 , 订货量要使存 储量达到 S , 这 种 策略可以简称为 ( s, S) 存储策略。此外与确定性模型不同的特点还有 : 不允许缺货的条件只能从概率的意义方面理解 , 如不缺货的概 率 为 0. 9 等。 存 储 策 略 的 优 劣 通 常 以 赢 利 的 期 望 值 的 大 小 作 为 衡 量 的 标准。为了讲清楚随机性存储问题的解法 , 先通过一个例题介绍求解的思路。 例 7 某商店拟在新年期间出 售一 批日 历画 片 , 每售 出 一千 张可 赢利 700 元。如 果 在新年期间不能售出 , 必须削价处理 , 作为画片出售。由于削价 , 一定可以售完 , 此时每千 张赔损 400 元。根据以往的经验 , 市场需求的概率见表 13-1。表 13-1需求量 r( 千张 )012345概率 P( r) ∑r = 0P ( r) = 10. 050. 100. 25. 35 00. 15每年只能订货一次 , 问应订购日历画片几千张才能使获利的期望值最大 ? 解 如果该店订货 4 千张 , 我们计算获利的可能数值。 当市场需求为 0 千张时获利为 : ( - 400) ×4 = - 1600( 元 ) 当市场需求为 1 千张时获利为 : ( - 400) ×3 + 700 = - 500( 元 ) 当市场需求为 2 千张时获利为 : ( - 400) ×2 + 700 ×2 = 600 ( 元 ) 当市场需求为 3 千张时获利为 : ( - 400) ×1 + 700 ×3 = 1700( 元 ) 当市场需求为 4 千张时获利为 : ( - 400) ×0 + 700 ×4 = 2800( 元 ) 当市场需求为 5 千张时获利为 : ( - 400) ×0 + 700 ×4 = 2800( 元 ) 订购量为 4 千张时获利的期望值 :E[ C(4 ) ] = ( - 1600) × 0. 05 + ( - 500 ) ×0. 10 + 600× 0. 25 + 1700× 0. 35 +2800× 0. 15 + 2800× 0. 10 = 1315 ( 元 )按上述算法列出表 13-2。表 13-2获利需求量012345订货量00000001400700700700700700280030014001400140014003120010010002100210021004160050060017002800280052000900200130024003500获利期望值最大者标有 ( * ) 记号 , 为 1440 元。 经比较 后可 知该店 订购 3000 张日 历画片可使获利期望值最大。·063·5. 10 0获利的期望值06451180 1440 *13151025Öc4’(cid:5)MBÀµ‘†h]ïä(cid:19)(cid:30)Àbï‘(cid:30)(cid:28)MÀJeóï‘(cid:30)MÀJóeï‘(cid:30)MÀJóe‘ï(cid:30)MÀeJï‘(cid:30)MÀóeJï‘(cid:30)MÀeóJï‘(cid:30)本例还可以从相反的角度考虑求 解。当 订货 量为 Q 时 , 可 能发 生滞 销赔 损 ( 供过 于 求的情况 ) , 也可能发生因缺货而失去销售机会的损失 ( 求过于供的情况 ) 。把这两种损失 合起来考虑 , 取损失期望值最小者所对应的 Q 值。当该店订购量为 2 千张时 , 计算其损失的可能值 :当市场需求量为 0 千张时滞销损失为 : ( - 400) ×2 = - 800 ( 元 ) 当市场需求量为 1 千张时滞销损失为 : ( - 400) ×1 = - 400 ( 元 ) 当市场需求量为 2 千张时滞销损失为 : 0 ( 元 ) ( 以上三项皆为供货大于需求时滞销损失。) 当市场需求量为 3 千张时缺货损失为 : ( - 700) ×1 = - 700 ( 元 ) 当市场需求量为 4 千张时缺货损失为 : ( - 700) ×2 = - 1400( 元 ) 当市场需求量为 5 千张时缺货损失为 : ( - 700) ×3 = - 2100( 元 ) ( 以上三项皆为供货小于需求时 , 失去销售机会而少获利的损失 )当订货量为 2 千张时 , 缺货和滞销两种损失之和的期望值 :E[ C(2 ) ] = ( - 800 ) ×0. 05 + ( - 400) × 0. 10 + 0×0. 25 + ( - 700) × 0. 35 +( - 1400) × 0. 15 + ( - 2100) × 0. 10 = - 745( 元 )按此算法列出表 13-3。表 13-3订货量 ( 千张 )012345损失的期望值19251280745485 *610900比较表中期望值以 - 485 最大 , 因我们采用负数表 示损失 , 即 485 为损 失最小值。 该 店订购 3000 张日历画片可使损失的期望值最小。这结论与前边得出的结论一样 , 都是订 购日历画片 3000 张。这说明对同一问题可以从两个不同的角度去考虑 , 一是考虑获利最 多 , 一是考虑损失最小。这两种考虑确实有差别 , 但在具体问题上实质上是一个问题的不 同表示形式。因此我们今后处理这类问题时 , 根据情况选其中之一即可。3. 1 模型五: 需求是随机离散的报童问题 : 报童每日售报数量是一个随 机变 量。报童 每售 出一 份报纸 赚 k 元。如 报 纸未能售出 , 每份赔 h 元。每日售出报纸份数 r 的概率 P ( r) 根据 以往 的经 验是已 知的 , 问报童每日最好准备多少份报纸 ?这个问题是报童每日报纸的订 货量 Q 为何 值时 , 赚钱 的期 望值 最大 ? 反言 之 , 如 何 适当地选择 Q 值 , 使因不能售出 报纸 的损失 及因 缺货 失去 销 售机 会的 损失 , 两者 期望 值 之和最小。现在用计算损失期望值最小的办法求解。 ∞解 设售出报纸数量为 r, 其概率 P( r) 为已知 , ∑ 设报童订购报纸数量为 Q。 ① 供过于求时 ( r≤ Q) , 这时报纸因不能售出而承担的损失 , 其期望值为 :P( r) = 1r = 0Q∑h( Q - r) P( r)( 初学者可参看例 7 )r = 0·163·Ö4c’(cid:5)×3‘(cid:6)(cid:10)② 供不应求时 ( r > Q) , 这时因缺货而少赚钱的损失 , 其期望值为 :∞∑k( r - Q) P( r)r= Q+ 1综合① , ②两种情况 , 当订货量为 Q 时 , 损失的期望值为 :Q∞C( Q) = h∑( Q - r) P( r) + k ∑( r - Q) P( r)r = 0r = Q+ 1要从式中决定 Q 的值 , 使 C( Q) 最小。由于报童订购报纸的 份数只能取整数 , r 是离散变量 , 所以不能 用求导数的方法 求极值。为此设报童每日订购报纸份数最佳量为 Q, 其损失期望值应有 :① C( Q) ≤ C( Q + 1 ) ② C( Q) ≤ C( Q - 1 ) 从①出发进行推导有 :Q∞h∑( Q - r) P( r) + k ∑( r - Q) P( r) ≤r = 0r = Q+ 1Q+ 1∞h∑( Q + 1 - r) P( r) + k ∑( r - Q - 1) P( r)r = 0r = Q+ 2经化简后得Q( k + h)∑P( r)k ≥ 0r = 0即Q∑r = 0P( r) ≥ kk + h从②出发进行推导有 :Q∞h∑( Q - r) P( r) + k ∑( r - Q) P( r) ≤r = 0r = Q+ 1Q - 1∞h∑( Q - 1 - r) P( r) + k∑( r - Q + 1) P( r)r = 0r = Q经化简后得Q - 1( k + h)∑P( r)k ≤ 0r = 0即Q - 1∑r = 0P( r) ≤ kk + h报童应准备的报纸最佳数量 Q 应按下列不等式确定 :Q - 1∑r = 0P( r) <k k + hQ≤ ∑r = 0P( r)从赢利最大来考虑报童应准备的报纸 数量。设 报童 订购报 纸数 量为 Q, 获利 的期 望值为 C( Q) , 其余符号和前面推导时表示的意义相同。当需求 r≤ Q 时 , 报童只能售出 r 份报纸 , 每份赚 k( 元 ) , 共赚 k· r( 元 ) 。未售出的报纸 , 每份赔 h( 元 ) , 滞销损失为 h( Q - r) ( 元 ) 。此时赢利的期望值为 :·263·(13-25)Q∑[ kr - h( Q - r) ] P( r)r = 0∞当需求 r > Q 时 , 报童因为只有 Q 份报纸可供销售 , 赢利的期望值为 ∑k· QP ( r) ,r = Q+ 1无滞销损失。由以上分析知赢利的期望值 :QQ∞C( Q) = ∑k· r· P( r) - ∑h( Q - r) P( r) + ∑k· QP( r)r = 0r = 0r = Q+ 1为使订购 Q 赢利的期望值最大 , 应满足下列关系式 :① C( Q + 1) ≤ C( Q) ② C( Q - 1) ≤ C( Q) 从①式推导 ,Q+ 1Q+ 1∞k∑rP ( r) - h∑( Q + 1 - r) P( r) + k ∑( Q + 1) P( r) ≤r = 0r = 0r= Q+ 2QQ∞k∑r = 0rP( r)h∑ r = 0( Q - r) P( r) + k∑r = Q+ 1Q· P( r)经化简后得Q∞kP ( Q + 1) - h∑P( r) + k∑P( r) ≤ 0r = 0r = Q+ 2进一步化简得QQk 1 - ∑r = 0P( r)h∑ r = 0P( r) ≤ 0Q∑r = 0P( r) ≥ kk + h同理从②推导出Q - 1∑r = 0P( r) ≤ kk + h用以下不等式确定 Q 的值 , 这一公式与 (13-25) 式完全相同。Q - 1∑r = 0P( r) <k k + hQ≤ ∑r = 0P( r)尽管报童问题中损失最小的期望值与赢利最大的期望 值是不 同的 , 但确定 Q 值的 条 件是相同的。无论从哪一个方面来考虑 , 报 童的 最佳订 购份 数是 一个确 定的 数值。在 下 面的模型六中将进一步说明这个问题。现利用公式 (13 -25) 解例 7 的问题。已知 : k = 7 , h = 4 ,k k + h(cid:930) 0. 637P(0 ) = 0. 05 , P(1 ) = 0. 10 , P(2 ) = 0. 25 , P( 3) = 0. 3523∑P( r) = 0. 40 < 0. 637 < ∑P( r) = 0. 75r = 0r= 0知该店应订购日历画片 3 千张。例 8 某店拟出售甲商品 , 每单位甲商品成本 50 元 , 售价 70 元。如不能 售出必须 减·363·价为 40 元 , 减价后一定可以售出。已知售货量 r 的概率服从泊松分布P( r) =e- λλr r !(λ为平均售出数 )根据以往经验 , 平均售出数为 6 单位 (λ= 6) 。问该店订购量应为若干单位 ? 解 该店的缺货损失 , 每单位商品为 70 - 50 = 20。滞 销损 失 , 每单位 商品 50 - 40 =10 , 利用 ( 15. 13) 式 , 其中 k = 20 , h = 10k h + k=20 20 + 10(cid:930) 0. 667P( r) =e- 6 6 r r !,Q∑r = 0P( r) 记作 F( Q) , 可查统计表。5F( 6) = ∑r= 0e- 6 6r r !7= 0. 6063 , F( 7) = ∑r = 0e- 6 6 r r != 0. 7440因 F( 6) <k k + h< F( 7) , 故订货量应为 7 单位 , 此时损失的期望值最小。答 该店订货量应为 7 单位甲商品。 例 9 上题中如缺货损失为 10 元 , 滞 销损 失为 20 元。 在这 种情 况下 该 店订 货量 应为若干 ?解 利用 (15 -13) 式 , 其中 k = 10 , h = 20k k + h 查统计表 , 找与 0. 3333 相近的数。=10 30(cid:930) 0. 333345e- 6 6r r ! F( 4) < 0. 3333 < F( 5) , 故订货量应为甲商品 5 个单位。F( 4) = ∑= 0. 2851 , F( 5) = ∑r= 0r = 0e- 6 6 r r != 0. 4457答 该店订货量为 5 个单位甲商品。 模型五只解决一次订货问题 , 对报童问题实际上每日订货策略问题也应认为解决了。 但模型中有一个严格的约定 , 即两次订货之间没有联系 , 都看作独立的一次订货。这种存 储策略也可称之为定期定量订货。3. 2 模型六: 需求是连续的随机变量设 货物单位成本为 K , 货物单位售价为 P, 单位存储 费为 C1 , 需 求 r 是 连续的随 机 ( r) d r 表示随机变量在 r 与 r + d r 之间的概率 , 其分布函数 F( a)变量 , 密度函数为 ( r) , =∫a 最大 ?( a > 0) , 生产或订购的数量为 Q, 问如何确定 Q 的数值 , 使赢利的期望值( r) d r0解 首先我们来考虑当订购数量 为 Q 时 , 实 际 销售 量应 该是 min [ r, Q] 。也 就是 当需求为 r 而 r 小于 Q 时 , 实际销售量为 r; r≥ Q 时 , 实际销售量只能是 Q。需支付的存储费用 C1 ( Q) =C1 ( Q - r)0r≤ Qr > Q货物的成本为 KQ, 本阶段订购量为 Q 赢利为 W ( Q) , 赢利的期望值记作 E[ W ( Q) ] 。 ·463·本阶段的赢利 :W ( Q) = P· min[ r, Q] - KQ - C1 ( Q) ( 赢利 ) = ( 实际销售货物的收入 ) - ( 货物成本 ) - ( 支付的存储费用 )赢利的期望值 :E[ W ( Q) ] =∫Q =∫ ∫Q0∞00Pr ( r) d r +∫∞QPr ( r) d r -∫∞QP Q ( r) d r - KQ -∫Q Pr ( r) d r +∫C1 ( Q - r)0∞P Q ( r) d r - KQ -QC1 ( Q - r)( r) d r( r) d r=P E( r)∞P∫Q( r - Q)( r) d rQ+∫0C1 ( Q - r)( r) d r+ KQ常量 (称为 平均盈利 )因缺货失去销售机 会损失的期望值因滞销受到损失的期望 值( 只考虑了存储费 )常量记E[ C( Q) ] = P∫∞Q( r - Q)( r) d r + C1∫Q0( Q - r)( r) d r + KQ为使赢利期望值极大化 , 有下列等式 :max E[ W ( Q) ] = P E( r) - mi n E[ C( Q) ](13-26)( 13 -27) (13 -26) 式表明了赢利最大 与损失 极 小所 得出 的 Q 值 相同。 ( 13 -27 ) 式 表明 最大 赢 利期望值与损失极小期望值之和是常数。 从表 13 -2 与表 13 -3 中对 应着 相同的 Q, 去 掉 13 -3 表中数据的负号后 , 两者期望值之和皆为 19. 25 , 称为该问题的平均盈利。max E[ W ( Q) ] + min E[ C( Q) ] = P E( r)根据上面的分析 , 求赢利极大可以转化为求 E[ C( Q) ] ( 损失期望值 ) 极小。当 Q 可以连续取值时 , E[ C( Q) ] 是 Q 的连续函数。可利用微分法求最小。 P∫∞Qd d Q = C1∫ d E[ C( Q) ] d Qd E[ C( Q) ] d Q( r) d r +∫=( r - Q)C1 ( Q - r)0Q∞Q( r) d r - P∫( r) d r + K0Q记 F( Q) =∫Q令= 0 ,( r) d r0( r) d r + KQ即C1 F( Q) - P[ 1 - F( Q) ] + K = 0F( Q) =P - K C1 + P从此式中解出 Q, 记为 Q* , Q* 为 E[ C( Q) ] 的驻点。又因d2 E[ C( Q) ] d Q2= C1( Q) + P ( Q) > 0知 Q* 为 E[ C( Q) ] 的极小值点 , 在本模型中也是最小值点。若 P - K≤ 0 , 显然由于 F( Q) ≥0 , 等式不成立 , 此时 Q* 取零值。即售价低于成本时 ,不需要订货 ( 或生产 ) 。式中只考虑了失去销售机会的损失 , 如果缺货时要付出的费用 C2 > P 时 , 应有E[ C( Q) ] = C2∫∞Q( r - Q)( r) d r + C1∫Q0( Q - r)( r) d r + KQ(13-28)按上述办法推导得·563·QF( Q) =∫0( r) d r =- K C2 C1 + C2模型五及模型六都是只解决一个阶段的 问题。从 一般 情况来 考虑 , 上 一个阶 段未 售出的货物可以在第二阶段继续出售。这时应该如何制定存储策略呢 ? 假设上一阶段未能售出的货物数量为 I , 作为本阶段初的存储 , 有min E[ C( Q) ] = K ( Q - Ⅰ ) + C2∫∞Q( r - Q)( r) d r + C1∫Q0( Q - r)( r) d r= - KI+ min∞C2∫Q( r - Q)( r) d r + C1∫Q0( Q - r)( r) d r + KQ常量与 (13-28 )式相同利用 F( Q) =∫Q0( r) d r =K C2 C1 + C2求出 Q* 值 , 相应的存储策略为 : 当 I≥ Q* 时 , 本阶段不订货。当 I < Q* 时 , 本阶段应订货 , 订货 量为 Q = Q* 这时赢利期望值最大。I, 使本 阶段 的存储 达到 Q* ,这种策略也可以称作定期订货 , 订货量不定的存储策略。3. 3 模型七: ( s, S) 型存储策略1. 需求为连续的随机变量时设 货物单位成本为 K , 单位存储费为 C1 , 单位缺货费为 C2 , 每次订购费为 C3 , 需 求∞( r) d r = 1 , 分布函数 F( a) =∫ar 是连续的随机变量 , 密度函数为 ( r) ,∫ 0) , 期初存储为 I, 定货量为 Q, 此时期初存储达到 S = I + Q。问如何确定 Q 的值 , 使损失 的期望值最小 ( 赢利的期望值最大 ) ?( r) d r, ( a >00解 期初存储 I 在本阶段中为常量 , 订货量为 Q, 则期初存储达到 S = I + Q。本阶 段需订货费 C3 + K Q, 本阶段需付存储费用的期望值为∫I + Q = S0C1 ( S - r)( r) d r需付缺货费用的期望值为∞∫S = I + QC2 ( r - S)( r) d r本阶段所需订货费及存储费、缺货费期望值之和C( I + Q) = C( S) = C3 + KQ +∫S0C1 ( S - r)( r) d r +∫∞SC2 ( r - S)( r) d rSI) +∫ Q 可以连续取值 , C( S) 是 S 的连续函数。 = K + C1∫S F( S) =∫S= C3 + K( S -0d C( S) d S令 d C( S) d S= 0 , 有0C1 ( S - r)( r) d r +∫∞SC2 ( r - S)0( r) d r - C2∫∞S( r) d r( r) d r =C2 - K C1 + C2( r) d r(13-29)·663·由C2 - K C1 + C2 为得出本阶段的存储策略 : ∫ 订货量 Q = S - I 本模型中有订购费 C3 , 如果本阶段不订货可以节 省订购 费 C3 , 因 此我 们设想 是否 存C2 - K C1 + C2严格小于 1 , 称为临界值 , 以 N 表示 := NS( r) d r = N , 确定 S 的值0在一个数值 s( s≤ S) 使下面不等式能成立。∞Ks + C1∫s ≤ C3 + KS + C1∫S 当 s = S 时 , 不等式显然成立。 当 s < S 时 , 不等式右端存储费用期望 值大于 左端 存储 费用期 望值 , 右 端缺货 费用 期 望值小于左端缺货费用期望值 ; 一增一减后 仍然 使不等 式成 立的 可能性 是存 在的。如 有 不止一个 s 的值使下列不等式成立 , 则选其中最小者作为本模型 ( s, S) 存储策略的 s。( r) d r + C2∫( s - r)( r) d r( r - s)0s∞( r) d r + C2∫( r) d r( S - r)( r - S)0SC3 + K( S - s) + C1∫s0( S - r)s( r) d r -∫0( s - r)( r) d r +∞C2∫S( r - S)∞( r) d r -∫s( r - s)( r) d r ≥ 0相应的存储策略是 : 每阶段初期检查存储 , 当库存 I < s 时 , 需订货 , 订 货的数量 为 Q,Q = S - I。当库存 I≥ s 时 , 本阶段不订货。这 种存储策 略是 : 定期订 货但订 货量不 确定。 订货数量的多少视期末库存 I 来决定订货量 Q , Q = S - I。对于 不易清点 数量的 存储 , 人 们常把存储分两堆存放 , 一 堆的 数量 为 s, 其余 的 另放 一堆。 平时 从另 放的 一 堆中 取用 , 当动用了数量为 s 的一堆时 , 期末 即订货。 如果未 动用 s 的一 堆时 , 期 末即 可 不订 货 , 俗 称两堆法。2. 需求是离散的随机变量时设 需求 r 取值为 r0 , r1 , … , rm ( ri < ri + 1 )m其概率为 P( r0 ) , P( r1 ) , … , P( rm ) ,∑P( ri ) = 1i = 0原有存储量为 I( 在本阶段内为常量 ) 当本阶段开始时订货量为 Q, 存储量达到 I + Q, 本阶段所需的各种费用 : 订货费 : C3 + K Q 存储费 : 当需求 r < I + Q 时 , 未能售出的存储部分需付存储费。当需求 r≥ I + Q 时 , 不需要付存储费。所需存储费的期望值 :∑r≤ I + QC1 ( I + Q - r) P( r)( r = I + Q 时 , 不付存储费及缺货费 )缺货费 : 当需求 r > I + Q 时 , ( r - I - Q) 部分需付缺货费。 缺货费用的期望值 :·763·∑C2 ( r -I - Q) P( r)r > I + Q本阶段所需订货费及存储费、缺货费期望之和 :C( I + Q) = C3 + KQ + ∑r≤ I + QC1 ( I + Q - r) P( r) + ∑r > I+ QC2 ( r -I - Q) P( r)I + Q 表示存储所达到的水平 , 记 S = I + Q, 上式可写为 :C( S) = C3 + K ( S -I) + ∑r≤ S( S - r) C1 P( r) + ∑r > SC2 ( r - S) P( r)求出 S 值使 C( S) 最小。 解法 : (1 ) 将需求 r 的随机值按大小顺序排列为 r0 , r1 , … , ri , ri + 1 , … , rm 。 ri < ri + 1 , ri + 1 - ri = Δri ≠ 0( i = 0 , 1 , … , m - 1) (2 ) S 只从 r0 , r1 , … , rm 中取值。当 S 取值为 r i 时 , 记为 SiΔSi = Si + 1 - Si = ri + 1 - ri = Δri ≠0( i = 0 , 1 , … , m - 1 )(3 ) 求 S 的值使 C ( S) 最小。因为C( Si + 1 ) = C3 + K( Si+ 1I) + ∑r≤ Si+ 1C1 ( Si+ 1r) P( r) + ∑ i+ 1C2 ( r - Si+ 1 ) P( r)C( Si ) = C3 + K ( Si -I) + ∑r≤ SC1 ( Si - r) P( r) + ∑r > SC2 ( r - Si ) P( r)C( Si - 1 ) = C3 + K( Si - 1I) + ∑r≤ Si - 1C1 ( Si - 1r) P( r) + ∑ i - 1C2 ( r - Si - 1 ) P( r)为选出使 C( Si ) 最小的 S 值 , Si 应满足下列不等式 : ① C( Si + 1 ) - C( Si ) ≥0 ② C( Si ) - C( Si - 1 ) ≤0 定义 ΔC( Si ) = C( Si + 1 ) - C( Si ) ,ΔC( Si - 1 ) = C( Si ) - C( Si - 1 ) 由①可推导出ΔC( Si ) = KΔSi + C1ΔSi∑r≤ SP ( r) - C2ΔSi∑r > SP ( r)= KΔSi + C1ΔSi∑r≤ SP ( r) - C2ΔSi 1 - ∑r≤ SP ( r)= KΔSi + ( C1 + C2 )ΔSi∑r≤ SP( r)C2ΔSi ≥ 0因 ΔSi ≠0 即K + ( C1 + C2 )∑r≤ SP ( r) - C2 ≥ 0有∑r≤ SP( r) ≥ C2K C1 + C2= N由②同理可推导出∑r≤ Si - 1P( r) ≤ C2K C1 + C2= N综合以上两式 , 得到为确定 Si 的不等式∑r≤ Si - 1P( r) < N =K C2 C1 + C2≤ ∑r≤ SP ( r)(13-30)取满足 (13-30) 式的 Si 为 S , 本阶段订货量为 Q = S - I·863·为使 C( Si ) 最小 , Si 的值应使下列不等式成立 :C( Si + 1 ) - C( Si ) ≥0 C( Si ) - C( Si - 1 ) ≤0其中C( Si + 1 ) - C( Si ) = KΔSi + C1ΔS1 ∑r≤ SP ( r) - C2ΔSi∑r > SP( r)= KΔSi + C1ΔS1 ∑r≤ SP ( r) - C2ΔSi 1 - ∑r≤ SP ( r)= KΔSi + ( C1 + C2 )ΔSi∑r≤ SP( r)C2ΔSi即KΔSi + ( C1 + C2 )ΔSi∑r≤ SP ( r) - C2ΔSi ≥ 0因 ΔSi ≠0 , 化简后有∑r≤ SP( r) ≥K C2 C1 + C2= N同理可推出∑r≤ Si - 1P( r) ≤ N综合上面两式 , 可利用下面不等式确定 Si∑r≤ Si - 1P( r) < N ≤ ∑r≤ SP ( r)得出满足不等式的 Si , 即令 S = Si , 本阶段订货量为 Q = S - I例 10 设某公司利用塑料作原 料制 成产 品出 售 , 已 知每 箱塑 料购 价 为 800 元 , 订 购 费 C3 = 60 元 , 存储费每箱 C1 = 40 元 , 缺货费每箱 C2 = 1015 元 , 原有存储量 I = 10 箱。已 知对原料需求的概率P( r = 30 箱 ) = 0. 20 , P( r = 50 箱 ) = 0. 40 ,P( r = 40 箱 ) = 0. 20 P( r = 60 箱 ) = 0. 20求该公司订购原料的最佳订购量。解 ① 计算临界值 N =1015 - 800 1015 + 40(cid:930) 0. 204② 选使不等式 ∑r≤ SP ( r) ≥ N 成立的 Si 最小值作 SP(30) = 0. 20≯ 0. 204P(30) + P(40) = 0. 20 + 0. 20 = 0. 40 > 0. 204 Si = 40 , 作为 S ③ 原存储 I = 10 , 订货量 Q = S - I = 40 - 10 = 30 答 该公司应订购塑料 30 箱。 下面对答案进行验证 , 分别计算 S 为 30 , 40 , 50 所需 订货费及 存储 费期 望值、缺货 费期望值三者之和。比较它们看是否当 S 为 40 时最小 ( 见表 13 -4 ) 。比较后知 S = 40 所需总费用最少 , 订购量 Q = 30。 本模型还有另一方面的问题 , 原存储量 I 达到 什么 水平 可以不 订货 ? 假设这 一水 平是 s, 当 I > s 时可以不订货 , 当 I≤ s 时要订货 , 使存储达到 S , 订货量 Q = S - I·963·表 13-4SIQ = S - I订货费C3 + K Q存储费期望值C1 ∑r≤ S( S - r) P( r)缺货费期望值C2 ∑r> S( r - S) P( r)总计30102016060016240323004010302406080812032260 *50104032060240203034330为最 优计算 s 的方法 : 考查不等式 Ks + ∑C1 ( s - r) P( r) + ∑r≤ sr > sC2 ( r - s) P( r) ≤ C3 + K S +∑r≤ sC1 ( S - r) P( r) + ∑r> SC2 ( r - S) P( r)(13-31)因 S 也只从 r0 , r1 , … , rm 中取值。使 (13 -31 ) 式成立的 ri ( ri ≤ S) 的值中最小者定为 s。当 s< S 时 , (13 -31) 式左端缺货费用的期望值虽然会增加 , 但订 货费及 存储费用 期望值都 减 少 , 一增一减之间 , 使不等式仍有可能成立。在最 不利 的情 况下 s = S 时不 等式是 成立 的 ( 因为 0 < C3 ) 。因此我们相信一定能找到 s 值。当然计算 s 要比计算 S 复杂一些 , 但就具 体问题计算 s 也不是很难的。如例 10 中要计 算 s 确 很简单。由 于已算 出 S = 40 , 可以 作 为 s 的 r 值只有 30 或 40 两个值。将 30 作为 s 值代入 (13 -31 ) 式左端得800 ×30 + 1015× [ (40 - 30) ×0. 2 + ( 50 - 30 ) ×0. 4 + (60 - 30) ×0. 2]= 40240将 40 代入 ( 13 -31 ) 式左端得60 + 800×40 + 40× [ (40 - 30) ×0. 2] + 1015 × [ ( 50 - 40 ) ×0. 4 +(60 - 40) ×0. 2] = 40260即左端数值为 40240 , 右端数值为 40260 , 不等式成立 , 30 已是 r 的最小值故 s = 30。例 10 的存储策略为 每个阶段开始时检 查存储量 I, 当 I > 30 箱时不必补充存 储。当I≤30 箱时补充存储量达到 40 箱。例 11 某厂对原料需求量的概率为 :P( r = 80 ) = 0. 1 ,P( r = 90) = 0. 2 ,P( r = 100 ) = 0. 3P( r = 110) = 0. 3 , 订货费 C3 = 2825 元 , K = 850 元 存储费 C1 = 45 元 ( 在本阶段的费用 ) 缺货费 C2 = 1250 元 ( 在本阶段的费用 ) 求该厂存储策略。P( r = 120) = 0. 1解 (1 ) 利用公式 ( 13 -30 ) 计算临界值 N =1250 - 850 1250 + 45= 0. 309(2 ) 求 SP( r = 80) + P( r = 90 ) = 0. 3 ≯0. 309P( r = 80) + P( r = 90 ) + P( r = 100 ) = 0. 6 > 0. 309·073·MÛÁ¾×6’M¾Á×6’MÛ¾Á×6’可知 S = 100(3 ) 利用 ( 13 -31 ) 式计算 sS = 100 , (13 -31 ) 式右端为2825 + 850× 100 + 45× [ (100 - 80 ) ×0. 1 + (100 - 90 ) ×0. 2 + ( 1000 - 100) × 0. 3] + 1250× [ ( 110 - 100 ) ×0. 3 + ( 120 - 100 ) ×0. 1 ] = 94255s= 80 , ( 13 -31) 式左端为850 ×80 + 45 × (80 - 80) ×0. 1 + 1250× [ (90 - 80) ×0. 2 + (100 - 80 ) ×0. 3 + (110 - 80 ) ×0. 3 + (120 - 80 ) ×0. 1 ]= 94250由于 94250 < 94255 , 故知 s= 80 答 该厂存储策略每当存储 I≤ 80 时 补充 存 储使 存 储 量达 到 100 , 每 当 存储 I > 80时不补充。例 12 某市石油公司 , 下设几 个售油 站。石 油存 放在 郊 区大 型油 库里 , 需要 时用 汽 车将油送至各售油站。该公司希望确定一种 补充存 储的 策略 , 以 确定应 储存 的油量。 该 公司经营石油品种较多 , 其中销售量较多的 一种 是柴油。 因之 希望先 确定 柴油的 存储 策 略。经调查后知每月柴油出售量服从指数分布 , 平均销售量每月为一百万升。其密度为 : 0. 000001 e- 0. 000 001 × r 0 柴油每升 2 元 , 不需订购费。由于油库归该公司管辖 , 油池灌满与未灌满时的管理费用实 际上没有多少差别 , 故可以认为存储费用为零。如缺 货就从邻 市调用 , 缺货 费3 元/ 升。求 柴油的存储策略。r≥0f ( r) =r < 0解 根据例 12 中条件知 C1 = 0 , C3 = 0 , K = 2 , C2 = 3 , 计算临界值。N =3 - 2 3 + 0= 0. 333 由于密度是连续函数 , 所以需利用积分计算求出 S。S∫0f ( r) d r =∫S00. 000001e- 0 . 000 001 × r d r = 0. 333e - 0 . 00 0001 × r 0e - 0 . 00 0001 × r 0= 0. 333e - 0. 0 000 01 × s = 0. 667两端取对数解出S = 405000 ( 升 )即利用 (13 -31) 式求 s 只需把相应的求和部分利用积分计算即可。 0 × ( s - r) f ( r) d r + 3∫ 0 × ( S - r) f ( r) d r + 3∫∞S2 × s +∫ ∫S 2 × s +∫( r - s) f ( r) d r ≤ 2 × S +S0∞( r - S) f ( r) d r。S0∞∞3 × ( r - s) f ( r) d r ≤ 2 × S +∫3 × ( r - S) f ( r) d rSS由观察 , 它有唯一解 s = S , 所 以当 库存 柴 油下 降到 405000 升 以下 时就 应订 购 , 使 库 存达到 405000 升。为什么会出现 s = S 呢 ? 原 因在 于定 购费为 零 , 可以 频繁订 货。又 存·173·储费 C1 也为零 , 存储量多一些也不会增加费用。由于 r 连续 , f ( r) 也连续 , 所以计算 S 值时要利用等式∫S0f ( r) d r = N 求解 S 的值。3. 4 模型八: 需求和备货时间都是随机离散的 ( 仅通过具体例题介绍求解法)若 t 时间内的需求量 r 是随机的 , 其概率 φt ( r) 已知 , 单位时间内的平均需求为ρ也是已知的 , 则 t 时间内的平均需求为ρt。备货时间 x 是随机的 , 其概率 P( x ) 已知。设 单位货物年存储 费 用 为 C1 , 每 阶段 单 位 货 物 缺货 费 用 为 C2 , 每 次订 购 费 用 为 C3 , 年平均需求为 D。由于需求、备货时间都是随机的 , 应有缓冲 ( 安全 ) 存储量 B, 以减少 发生缺货现象。 L: 订货点 , B: 缓冲存储量 , x1 , x2 , …备货时间 ( 见图13 -11) 。图 13 -11问如何确定缓冲存储量 B, 订货点 L, 以及订货量 Q0 , 使总费用最小 ? 对这种类型问题的解法 : 先按确定性模型求出 E. O. Q 及最佳批次 n0 。Q0 = E. O. Q =2 C3 D C1;n0 =D Q0( 存储策略全年分 n0 次订货 , 每次订货量 Q0 )订货点 L 的确定方法除 应满 足 备货 时 间内 的 平均 需 求 D L 还 要 求 维持 缓 冲存 储 量B , 由于备货时间是随机的 , 设平均备货时间为 μ。则L = DL + B = μρ+ B当存储量降至 L 时订货 , 由于备货时间延长 , 或因需求增加而引起缺货的概率记作 P LPL = ∑P ( x) Fx ( L)x其中 : P( x ) 表示备货时间为 x 天的概率 ,Fx ( L) 表示订货点为 L( 即存储量为 L 时 ) 而在 x 天内需求 r > L 的概率。 Fx ( L) = ∑φx ( r)r > LP L 的 计 算 很 繁 , 为 了 简 化 记 缺 货 费 的 期 望 值 为 C2 P L , n0 次 缺 货 费 的 期 望 值 为n0 C2 PL , 每年的存储费用为1 2Q0 + B C1 。由 于 Q0 是 根据 存储 费用 和订 购 费用 权衡 后得出的最佳值 , 因此只需要考虑维持缓冲存储 量的存 储费 用以 及缺货 费期 望值两 者之 和 最小。即令 n0 C2 PL + C1 B 最小以确定 L 和 B。 由关系式 L = μρ+ B 可知只要确定了 L 就相当于 B 也确定了。·273·例 13 ( 模型八 ) 某厂生产中需用钢材 , t 时间内需求的概率φt ( r) 服从泊松分布 :φt ( r) =e - ρt (ρt) r r !每天平均需求为一吨 ,ρ= 1 , 年平均需求量 D 为 365 吨。则 t 时间内需求为 r 的概率φt ( r) =e - t tr r !备货时间为 x 天的概率服从正态分布P( x) =1 2πσe - ( x - μ)2/ 2σ2平均备货时间 μ= 15 ( 天 ) , 方差 σ2 = 1 。 1 2πP( x ) =e-( x - 15 ) 2/ 2年存储费用每吨为 50 元 , 每次订购费用为 1500 元 , 缺货费用每吨为 5000 元 , 问每年应分多少批次 ? 又订购量 Q, 缓冲存储量 B, 订货点 L, 各为何值才使费用最少 ?解Q0 =2×365× 1500 50(cid:930) 148( 吨 )n0 =D Q0(cid:930) 2. 5 ( 次 )下面计算 L 及 B , 各步算出的数值列于表 13 -5 。表 13-5( 一 ) 备货时间 x(二 ) 备货时间的概率 P( x)P( x) =1 2πe - ( x - 15 )2/ 2(三 ) x 天内的平均需求( 算式为 ρx )①130. 0513②140. 2414③150. 4015④160. 2416⑤170. 0517( 四) 需求 r > L, Fx ( L)的概率 , 算式 Fx ( L) = ∑r> Le - x x r r !L= 1 - ∑r = 0e- x x r r !L = 15L = 21L = 22L = 23L = 24L = 25L = 26L = 31① 0. 2360. 0140. 0080. 0040. 0020. 00100② 0. 3310. 0290. 0170. 0090. 0050. 0030. 0010③ 0. 4320. 0530. 0330. 0190. 0110. 0060. 0030④ 0. 5330. 0890. 0580. 0370. 0220. 0130. 0080⑤ 0. 6290. 1380. 0950. 0630. 0400. 0250. 0150. 001·373·˜{p"(cid:30){p"(cid:30){p"(cid:30){p"(cid:30){p"(cid:30)÷õôöôõö7,6+6+5*uj5*7,6+6+uj5*5*4)7,6+6+5*uj4)5*7,6+6+4)uj5*5*7,:/6+6+5*5*4)uj( 五) 相应备货时间及需求两者概率的乘积 P( x ) Fx ( L)( 五) = (二 ) ×( 四 )L = 15L = 21L = 22L = 23L = 24L = 25L = 26① 0. 012000000② 0. 0790. 0070. 0040. 0020. 0010. 0010③ 0. 1730. 0210. 0130. 0080. 0040. 0020. 001④ 0. 1280. 0210. 0140. 0080. 0050. 0030. 002⑤ 0. 0310. 0070. 0050. 0030. 0020. 0010. 001根据表 13 -5 算出 PL 、B 和费用的各种数值见表 13 -6 所示。表 13-6LL = 15L = 21L = 22L = 23L = 24L = 25L = 26PL0. 4230. 056. 036 00. 0210. 0120. 0070. 004B067891011费用5287. 51000800663600588 *60017P L = ∑P( x ) Fx ( L) , B = L - ρxx = 1 5费用的计算式 :n0 C2 P L + C1 B = 2. 5×5000× PL + 50× B说明 ① 备货时间小于 13 , 或大于 18 者 , 因为它们的概率很小 , 故略去。 ② L 的选值可以多一些 , 如 保证 可以 选 到最 小值 , L 选值 也可 少 一些。 由表 中可 以看到当 L = 25 , B = 10 费用 588 * 为最小。据此即可确定存储策略。答 该厂定购批量为 148 吨 , 定购点为 25 吨 , 每年订货 2. 5 次 ( 两年订货 5 次 ) , 缓冲存储量为 10 吨。当清点存储花费劳动多 , 或清点困难时 , 人 们常 把存 储物分 成三 堆存放。 以例 13 来 说 , 将缓冲存储量 B = 10 吨放 一处 , 称 之为第三堆。将平 均拖后时间内的 平均需求量 DL= μρ= 15 吨放另一处称第二堆。第 三堆、第二 堆之 和等 于 订货 点 25 吨。其 余存 储另 放 一处称第一堆。平日从第一堆取用 , 第一 堆用完 , 动 用第 二堆时 , 立即订 货。动用 第三 堆 时 , 即需采取措施以防缺货。第 4 节 其他类型存储问题有些存储问题远较本章所述模型复杂 , 上述公式不能用来求解 , 也可以利用运筹学的其他方法求解。如水库储水的调度问题 , 有人利用排队论方法处理问题 , 有人利用动态规 划方法 , 都做出了成绩。 ·473·续表L = 3100000L = 31016800÷ôöõõôöuj–7,6+6+uj5*–5*7,6+6+5*4)–uj5*7,6+6+uj–5*4)5*7,6+6+–4)5*uj5*Æ—S±?õ$‚ÜñædYÂ·×Ì“ˆ5*(cid:6)ûMÀyJóï‘(cid:30)dYa¿cî(cid:29)4. 1 库容有限制的存储问题下面介绍一个例题 , 与本章前述的方法无关 , 可用线性规划方法求解。 例 14 已知仓库最大容量为 A, 原有存储量为 I , 要计 划在 m 个周期 内 , 确定每一 个 周期的合理 进货量 与销售量 , 使 总收入最 多。已知 第 i 个周 期出售一 个单位货 物的收 入 为 ai , 而订购一个单位货物的订货费为 bi , ( i = 1 , 2 , … , m) 。解 设 xi , yi 分别为第 i 个周期的进货量及售货量 , 这时总收入为 :mC = ∑( ai y i - bi x i )i = 1要求出 xi , yi 使 C 达到最大值 ( i = 1 , 2 , … , m) 。容易理解 x i , yi , 这些变量不能任意取值。(1 ) 它们受到库容的限制 , 即进货量加上原有存储量不能超过 A ; (2 ) 每个周期的售出量不能超过该周期的存储量 ; (3 ) 进货量及售出量不能取负值。 用方程组表示上述的限制 ( 约束条件 ) :s(1 ) I + ∑( x i - yi ) ≤ A ,( s = 1 , 2 , … , m)i = 1s- 1(2 ) ys ≤ I + ∑ (3 ) xi ≥ 0 , yi ≥0 ( i = 1 , 2 , … , m) 目标函数 , 约束条件 都是线 性的 , 可利用 线性规划 方( s = 1 , 2 , … , m)yi ) ,( xii = 1法求解。注记本章仅就存储问题作了简单的介绍。由于实际问题多 种多样 , 存储 模型也 远比我 们介绍 过的模 型多 , 解决存储问题的方法也比本章介绍过的方法多。例如 多阶段 存储问 题就要 利用动 态规划 方法求 解(见本书“动态规划”) 。随机型存储问题 , 有时需要 用电子 计算机 利用模 拟技术 求解。其他与 存储有 类似性质的问题可以用本章介绍的方法求解。例如制造特殊设备 , 其零部件只适用于这种设 备 , 只能 在制造设备时同时生产 , 否则制造费用要提高很多。这 时就要 考虑这 些零部 件要不 要留备 用件 ? 备用件 的数量是多少 ? 这样的问题可以利用报童问题求解方法解决。现在我国企业都很注意提高经济效益 , 因而存储问题引起企业的 注意。“ A、B、C 分类管理 法”已被许多企业采用 , 进而研究利用电子计算机管理库存的问题。随着企业管理水平的提高 , 存储问题也 更加受到人们的重视。为解决实践中提出 的问 题 , 进一 步研 究新 的存 储模 型 , 这样 便会 促使存 储论 不断 的发展。习题13. 1 设某工厂每年需用某种原料 1800 吨 , 不 需每 日供应 , 但 不得 缺货。设 每吨 每月的保管费为 60 元 , 每次订购费为 200 元 , 试求最佳订购量。13. 2 某公司采用无安全存量的存储策略。每年使用某种零件 100000 件 , 每件每年的保管费用为 30 元 , 每次订购费为 600 元 , 试求 :(1 ) 经济订购批量。·573·(2 ) 订购次数。 13. 3 设某工厂生产某种零件 , 每年需要量为 18000 个 , 该厂每月可生产 3000 个 , 每次生产的装配费为 5000 元 , 每个零件的存储费为 1. 5 元 , 求每次生产的最佳批量。13. 4 某产品每月用量为 4 件 , 装配费为 50 元 , 存储费每月每件为 8 元 , 求产品每次最佳生产量及最小费用。若生产速度每月可生产 10 件 , 求每次生产量及最小费用。13. 5 每月需要某种机构零件 2000 件 , 每 件成本 150 元 , 每年的 存储 费用为 成本 的16 % , 每次订购费 100 元 , 求 E. O. Q 及最小费用。13. 6 在题 5 中如允许缺货 , 求库存量 s 及最大缺货量 , 设缺货费为 C2 = 200 元。 13. 7 某制造厂每周购进某种机构零件 50 件 , 订购费为 40 元 , 每周保管费为3. 6 元 , (1 ) 求 E. O. Q。 (2 ) 该厂为少占用流动资金 , 希望存储量达到最低限度 , 决定可 使总费用 超过最低 费用的 4 % 作为存储策略 , 问这时订购批量为多少 ?13. 8 某公司采用无安全存量的存储策略 , 每年需电感 5000 个 , 每次订购费 500 元 , 保管费用每年每 个 10 元 , 不 允 许 缺 货。 若 采 购 少 量 电 感 每 个 单 价 30 元 , 若 一 次 采 购 1500 个以上则每个单价 18 元 , 问该公司每次应采购多少个 ? ( 提示 : 本题属于订货量多 , 价格有折扣的类型。即订货费 C3 + KQ, K 为阶梯函数 ) 13. 9 某工厂的采购情况为采购数量 ( 单位 ) 0 ～1999 2000 以上单价 ( 元 )10080假设年需要量为 10000 , 每次订货费为 2000 元 , 存储费率为 20 % , 则每次应采购多少 ?13. 10 一个允许缺货的 E. O. Q 模型的费用绝 不会超过 一个具有 相同 存储费、订 购费、但不允许缺货的 E. O. Q 模型的费用 , 试说明之。13. 11 某厂对原料需求的概率如下 :需求量 r( 吨 )20304050概率 P( r) ( ∑ P( r) = 1)0. 10. 20. 30. 3每次订购费 C3 = 500 元 , 原料每吨价 K = 400 元 , 每吨原料存储费 C1 = 50 元 , 缺货 费每吨 C2 = 600 元。该厂希望制定 ( s, S) 型存储策略 , 试求 s 及 S 值。13. 12 某厂需用配件数量 r 是一个随机 变量 , 其 概率服 从泊 松分布。 t 时间 内需 求概率为φt ( r) =e - ρt (ρt) r r !平均每日需求为 1 (ρ= 1 )备货时间为 x 天的概率服从正态分布P( x) =1 2πσe - ( x - μ)2/ 2σ2平均拖后时间 μ= 14 天 , 方差 σ2 = 1在生产循环周期内存储费 C1 = 1. 25 元 , 缺货费 C2 = 10 元 , 装配费 C3 = 3 元。问两年内应 分多少批订货 ? 每次批量及缓冲存储量各为何值才能使总费用最小 ? ·673·600. 1Äc¿5‘LA(cid:127)tðåzo(cid:19)(cid:30)参 考 资 料[1] 林文源 . 物料管理学 . 澳门 : 澳门科技丛书出版社 , 1978[2] 吴云从 . 随机存储的几个问题 . 系统工程 (第一期 ) , 1984[3] 严颖 , 程世学 , 程侃 . 运筹学随机模型 . 北京 : 中国人民大学出版社 , 1995·773·九、对 策 论对策也叫博弈 , 是自古以来的政治家和 军事 家都很 注意 研究 的问题。 作为一 门正 式 学科 , 是在 20 世纪 40 年代形成并发展起来的。直到 1944 年冯·诺依曼 ( von N eumann) 与摩根斯特恩 ( O .Morgen stern) 的《博 弈论 与经 济行 为》一 书 出版 , 标 志着 现 代系 统博 弈 理论的初步形成。书中提出的标准型、扩展型和合作型博弈模型解的概念和分析方法 , 奠 定了这门学科的理论基础 , 成为使用严谨的数 学模型 研究 冲突 对抗条 件下 最优决 策问 题 的理论。然而 , 诺依曼的博弈论的局限性也日益暴露出来。由于它过于抽象 , 使应用范围 受到很大限制 , 所以影 响力 很有 限。20 世纪 50 年 代 , 纳什 ( N ash) 建 立 了非 合 作博 弈 的 “纳什均衡”理论 , 标志着博弈的新时代开始 , 是 纳什在 经济 博弈论 领域 划时 代的贡 献 , 是 继冯·诺依曼之后最伟大的博 弈论 大师之 一。1994 年纳 什获 得了 诺 贝尔 经济 学奖。 他 提出的著名的纳什均衡概念在非合作博弈理论中起着核心作用。由于纳什均衡的提出和不断完善 , 为博弈论广泛应用于经济学、管理 学、社 会学、政 治学、军事 科学 等领域 奠定 了 坚实的理论基础。第 14 章 对策论基础第 1 节 引言1. 1 对策行为和对策论对策论亦称竞赛论或 博 弈论 , 是 研究 具有 斗争 或 竞争 性质 现象 的数 学 理论 和 方法。 一般认为 , 它是现代数学的一个新分支 , 是运筹学的一个重要学科。对策论发展的历史并 不长 , 但由于它研究的问题与政治、经济、军事活动乃至一般的日常生活等有着密切联系 , 并且处理问题的方法具有明显特色 , 所以日益引起广泛注意。在日常生活中 , 经常会看到一些相互之间具有斗争或竞争性质的行为 , 如下棋、打牌、 体育比赛等。还比如战争活动中的双方 , 都力图选取对自己最有利的策略 , 千方百计去战 胜对手。在政治方面 , 国际间的谈判 , 各种政治力 量之 间的 斗争 , 各国 际集 团之间 的斗 争 等无一不具有斗争的性质。在经济活动中 , 各 国之 间、各公 司企业 之间 的经济 谈判 , 企 业 之间为争夺市场而进行的竞争等 , 举不胜举。具有竞争或对抗性质的行为称为对策行 为。在这 类行 为中 , 参加 斗争 或竞争 的各 方 各自具有不同的目标和利益。为了达到各自的目 标和 利益 , 各 方必须 考虑 对手的 各种 可 能的行动方案 , 并力图选取对自己最有利或 最合 理的方 案。对 策论就 是研 究对策 行为 中 斗争各方是否存在着最合理行动方案 , 以及如何找到最合理行动方案的数学理论和方法。 ·873·在我国古代 ,“ 齐王赛马”就是一个典型的对策论研究的例子。 战国时期 , 有一天齐王提出要与田忌赛马 , 双方约定从各自的上、中、下三个等级的马 中各选一匹参赛 , 每匹马均只能参赛一次 , 每一 次比赛 双方 各出一 匹马 , 负 者要付 给胜 者 千金。已经知道 , 在同等级的马中 , 田忌的马不如 齐王 的马 , 而 如果田 忌的 马比齐 王的 马 高一等级 , 则田忌的马可取胜。当时 , 田忌手下的 一个 谋士 给他出 了个 主意 : 每次 比赛 时 先让齐王牵出他要参赛的马 , 然后来用下马 对齐王 的上 马 , 用中马 对齐 王的 下马 , 用上 马 对齐王的中马。比赛结果 , 田忌二胜一负 , 夺 得千金。 由此 看来 , 两个 人各 采取什 么样 的 出马次序对胜负是至关重要的。1. 2 对策行为的三个基本要素以下称具有对策行为的模型为对策模型 或对策。 对策 模型的 种类 可以千 差万 别 , 但本质上都必须包括以下三个基本要素。1. 局中人在一个对策行为 ( 或一 局对 策 ) 中 , 有权 决定 自己 行 动方 案的 对策 参 加者 , 称为 局 中 人。通常用 I 表示局中人的集合。如 果有 n 个 局中 人 , 则 I = {1 , 2 , … , n}。 一般 要求 一 个对策中至少要有两个局中人。如在“齐王赛马”的例子中 , 局中人是齐王和田忌。对策中关于局中人的概念具有广义性。局中 人除 了可 理解为 个人 外 , 还可理 解为 某 一集体 , 如球队、交战国、企业等。当研究在不 确定的 气候 条件 下进行 某项 与气候 条件 有 关的生产决策时 , 就可把大自然当作一个局中人。另外 , 在对策中利益完全一致的参加者 只能看成是一个局中人 , 例 如桥 牌中 的东、西 方 和南、北 方各 为一 个 局中 人 , 虽 有四 人 参 赛 , 但只能算有两个局中人。需要强调的一点是 , 在对策中总是假定每一个局中人都是“ 理智的”决策者或竞争者 ,即对任一局中人来讲 , 不存在利用其他局中人决策的失误来扩大自身利益的可能性。2. 策略集一局对策中 , 可供局中人选择的一个实 际可 行的完 整的 行动 方案称 为一 个策略。 参 加对策的每一局中人 i, i∈ I , 都有自己的策略集 Si 。一般 , 每一局中人的策略集中至少应包括两个策略。在“齐王赛马”的例子中 , 如果用 ( 上 , 中, 下 ) 表示以上马、中马、下马依次参 赛这样一个 次序 , 这就是一个完整的行动方案, 即为一个策略。可见 , 局中人齐王和田忌各自都有 6 个 策略 : ( 上 , 中, 下 ) 、( 上 , 下, 中) 、(中 , 上 , 下 )、( 中, 下 , 上 ) 、( 下, 中 , 上 ) 、( 下, 上, 中 ) 。3. 赢得函数 ( 支付函数 )在一局对策中 , 各局中人选定的策 略形 成的 策略 组称 为一 个局 势 , 即 若 Si 是 第 i 个局中人的一个策略 , 则 n 个局中人的策略组s = ( s1 , s2 , … , sn )就是一个局势。全体局势的集合 S 可用各局中人策略集的笛卡儿积表示 , 即·973·S = S1 × S2 ×…× Sn当一个局势出现后 , 对策的结 果也 就确定 了。也 就是说 , 对 任一 局势 s∈ S, 局 中人 i 可以得到一个赢得值 H i ( s) 。显然 , H i ( s) 是局 势 s 的 函 数 , 称为 第 i 个局 中 人的 赢得 函 数。在齐王与田忌赛马的例子中 , 局中 人集 合为 I = {1 , 2} , 齐王 和田 忌的 策 略集 可分 别 用 S1 = { a1 , a2 , a3 , a4 , a5 , a6 } 和 S2 = {β1 ,β2 ,β3 ,β4 ,β5 ,β6 } 表示。 这样 , 齐王 的任 一策略 ai 和田忌的任一策略βj 就形成了一个局势 si j 。 如果 a1 = ( 上 , 中 , 下 ) ,β1 = ( 上 , 中 , 下 ) , 则 在局势 s11 下齐王的赢得值为 H1 ( s11 ) = 3 , 田忌的赢得值为 H2 ( s11 ) = - 3 , 如此等等。以上讨论了局中人、策略集和赢得函数这三个概念。当这三个基本要素确定后 , 一个对策模型也就给定了。1. 3 对策问题举例及对策的分类对策论在经济管理的众多领域中有着十分广 泛的 应用 , 下 面列举 几个 可以用 对策 论思想和模型进行分析的例子。例 1 ( 市场 购买 力 争夺 问题 ) 据预 测 , 某 乡镇 下 一年 的饮 食品 购买 力 将有 4000 万 元。乡镇企业和中心城市企业饮食品的生产情况 是 : 乡镇 企业 有特色 饮食 品和低 档饮 食 品两类 , 中心城市企业有高档饮食品和低档 饮食 品两类 产品。 它们争 夺这 一部分 购买 力 的结局见表 14 -1 ( 表中数字的单位是万元 ) , 问题是乡镇企业 和中心 城市企业 应如何选 择 对自己最有利的产品策略。表 14 -1乡镇企业所得中心城市企业的策略乡镇策略出售高档饮食品出售低档饮食品出售特色饮食品20003000出售一般饮食品10003000例 2 ( 销售竞争问题 ) 假定企业Ⅰ , Ⅱ均能向市场 出售某一 产品 , 不妨假 定他们可 于 时间区间 [0 , 1 ] 内任一时 点出售。设企业Ⅰ 在时刻 x 出售 , 企业Ⅱ 在时刻 y 出 售 , 则企 业 Ⅰ的收益 ( 赢得 ) 函数为 :c( y - x ) 若 x < yH ( x, y ) =1 2 c(1 - x) 若 x > yc( 1 - x ) 若 x = y问这两个企业各选择什么时机出售对自己最有利 ? 在这个例子中 , 企业Ⅰ , Ⅱ可选择的策 略均有无穷多个。例 3 ( 费用分摊问题 ) 假设沿某一河流有相 邻的 3 个城市 A、B、C, 各 城市可 单独 建 立水厂 , 也可合作兴建一个大水厂。经估算 , 合建一个大水厂 , 加上敷设管道的费用 , 要比 单独建 3 个小水厂的总费用少。但合建大厂的 方案能 否实 施 , 要看总 的建 设费用 分摊 得 是否合理。如果某个城市分摊到的费用比它单独 建设 水厂 的费用 还多 的话 , 它显 然不 会 接受合作的方案。问题是应如何合理地分摊费用 , 使合作兴建大水厂的方案得以实现 ? ·083·~¿~¿例 4 ( 拍卖问题 ) 最常见的 一种拍 卖形 式是先 由拍 卖商 把拍 卖品 描述 一 番 , 然后 提 出第一个报价。接下来由买者报价 , 每一次报价都要比前一次高 , 最后谁出的价最高拍卖 品即归谁所有。假设有 n 个买主给出的报价分别为 p 1 , … , pn , 且不妨设 pn > pn - 1 > … >p1 , 则买主 n 只要报价略高于 p n - 1 , 就能买到拍卖品 , 即拍 卖品实 际上是在 次高价 格上 卖 出的。现在的问题是 , 各买主之间可能知道他 人的 估价 , 也 可能不 知道 他人的 估价 , 每 人 应如何报价对自己能以较低的价格得到拍卖品最为有利 ? 最后的结果又会怎样 ?例 5 ( 囚犯难题 ) 设有两个 嫌疑犯 因涉 嫌作案 被警 官拘 留 , 警官 分别 对 两人 进行 审 讯。根据法律 , 如果两个人都承认此案是他 们干的 , 则 每人 各判刑 7 年 ; 如 果两人 都不 承 认 , 则由于证据不足 , 两人各判刑 1 年 ; 如果只有一人承认并揭发对方 , 则承认者予以宽大 释放 , 而不承认者将判刑 9 年。因此 , 对两个囚犯 来说 , 面临 着一 个在“承 认”和“不 承认” 这两个策略间进行选择的难题。上面几个例子都可看成是一个对策问题 , 所不同的是有些是二人对策 , 有些是多人对 策 ; 有些是有限对策 , 有些是无限对策 ; 有些 是零和 对策 , 有 些是非 零和 对策 ; 有些 是合 作 对策 , 有些是非合作对策等等。为了便于对不同的对策问题进行研究 , 可以根据不同方式 进行分类 , 通常的分类方式有 :(1 ) 根据局中人的个数 , 分为二人对策和多人对策 ; (2 ) 根据各局中人的赢得函数的代数和是否为零 , 分为零和对策与非零和对策 ; (3 ) 根据各局中人间是否允许合作 , 分为合作对策和非合作对策 ; (4 ) 根据局中人的策略集中的策略个数 , 分为有限对策和无限对策。 此外 , 还有许多其他的分类方式。例如根据策略的选择是否与时间有关 , 可分为静态 对策和动态对策 ; 根据对策模型的数学特 征 , 可分为 矩阵 对策、连续 对策、微 分对策、阵 地 对策、凸对策、随机对策等。在众多对策模型 中 , 占 有 重 要地 位 的 是 二 人有 限 零 和 对 策 ( finite t wo-per son zero- s um game ) , 又称为矩阵对策。这类对 策是 到目前 为止 在理 论研 究和 求解 方 法方 面都 比 较完善的一个对策分支。矩阵对策可以说是一类 最简 单的 对策模 型 , 其研 究思想 和方 法 十分具有代表性 , 体现了对策论的一般思想和方法 , 且矩阵对策的基本结果也是研究其他 对策模型的基础。基于上述原因 , 本章将着重介绍矩阵对策的基本内容 , 只对其他对策模 型作简要介绍。第 2 节 矩阵对策的基本定理2. 1 矩阵对策的数学模型二人有限零和对策就是矩阵对策 , 是指只有两个参加对策的局中人 , 每个局中人都只 有有限个策略可供选择。在任一局势下 , 两个局中人的赢得之和总是等于零 , 即双方的利 益是激烈对抗的。“齐王赛马”就是一个矩阵对策的例子 , 齐王和田忌各有 6 个策略 , 一局 对策结束后 , 齐王的所得必为田忌的所失 , 反之亦然。在矩阵对策中 , 一般用Ⅰ、Ⅱ分别 表示 两个局 中人 , 并 设局 中人 Ⅰ有 m 个纯 策略 ( 以·183·与后面的混合策略区别 )α1 ,α2 , … ,αm , 局 中人 Ⅱ有 n 个纯 策略β1 ,β2 , … ,βn , 则 局中 人Ⅰ、 Ⅱ的策略集分别为S1 = {α1 ,α2 , … ,αm } S2 = {β1 ,β2 , … ,βn }当局中人Ⅰ选定纯策略 αi 和局中人Ⅱ选定纯策略 βj 后 , 就形成了一个纯局势 (αi ,βj ) 。可 见这样的纯局势共有 m× n 个。对任一纯局势 (αi ,βj ) , 记局中人Ⅰ的赢得值为 ai j , 并称a11a12 … a1 nA =a21⁝a22 … a2 n ⁝ ⁝am1am2 … am n为局中人Ⅰ的赢得矩阵 ( 或为局中人Ⅱ的 支付矩 阵 ) 。由于 假定对 策为 零和 的 , 故 局中 人 Ⅱ的赢得矩阵就是 - A。当局中人Ⅰ、Ⅱ和策略集 S1 、S2 及局 中人 Ⅰ的 赢得 矩 阵 A 确 定后 , 一 个 矩阵 对策 也就给定了。通常 , 将一个矩阵对策记成G = {Ⅰ , Ⅱ ; S1 , S2 ; A}或 G = { S1 , S2 ; A}在“齐王赛马”的例子中齐王的赢得可用表 14 -2 表示 :表 14 -2齐王的赢得齐王的策略田忌的策略[β1 ]( 上、中、下 )[β2 ]( 上、下、中 )[β3 ]( 中、上、下 )[β4 ]( 中、下、上 )[β5 ]( 下、中、上 )[β6 ](下、上、中)α1 ( 上、中、下) α2 ( 上、下、中)311311111111α3 ( 中、上、下) α4 ( 中、下、上) α5 ( 下、中、上)111111311131113111α6 ( 下、上、中)111113赢得矩阵为311111131111A =111131131111111131111113当矩阵对策模型给定后 , 各局中人面临的问题便是如何选取对自己最有利的纯策略 , 以谋取最大的赢得 ( 或最少损失 ) 。下面通过一个具体例子来分析应如何求解各局中人的 最优纯策略。例 6 设有一矩阵对策 G = { S1 , S2 ; A} , 其中 S1 = {α1 ,α2 ,α3 ,α4 } , S2 = {β1 ,β2 ,β3 }·283·–345d4–4345d4d345–54–d4345d–43534d4–- 61- 8A =3921410306由 A 可看出 , 局中人Ⅰ的最大赢得是 9 , 要想得到 这个赢得 , 他 就得选 择纯 策略 α3 。由 于 假定局中人Ⅱ也是理智的 , 他考虑到了局 中人Ⅰ打算 出 α3 的 心理 , 于 是便准备以 β3 对付 之 , 使局中人Ⅰ不但得 不到 9 反 而 失掉 10。局 中 人 Ⅰ当 然 也 会猜 到 局中 人 Ⅱ 的这 一 心 理 , 故想出 α4 来对付 , 使局中人Ⅱ得不到 10 反而失掉 6…… 所以 , 如果 双方 都不想 冒险 , 都不存在侥幸心理 , 而是考虑到对方必然会设法使自己的所得最少这一点 , 就应该从各自 可能出现的最不利的情形中选择一种最有利的情形作为决策的依据 , 这就是所谓的“ 理智 行为”, 也是对策双方实际上都能接受的一种稳妥的方法。在例 6 中 , 局中人Ⅰ分析到出纯策略 α1 ,α2 ,α3 ,α4 可能 带来的 最少赢得 ( 矩 阵 A 中 每行的最小元素 ) 分别为 : - 8 , 2 , - 10 , - 3 。在这些最少赢得 ( 最不利的情 形 ) 中 最好的 结果 ( 最有利 的情 形 ) 是赢 得为 2。 因此 , 局中人Ⅰ只要以 α2 参 加对策 , 无论 局中人 Ⅱ选取 什么样的 纯策略 , 都 能保证局 中人Ⅰ 的 收入不会少于 2 ; 而出其他任何纯策略 , 其 收入都 有可 能少于 2 , 甚至 输给 对方。同 理 , 对 局中人Ⅱ来说 , 各纯策略 β1 ,β2 ,β3 可能带来的最不利的结果 ( 矩 阵 A 中每 列中最大 元素 ) 分别为 : 9 , 2 , 6 。在这些最不利的结果中最好的 结果 ( 输 得最少 ) 也是 2 , 即局 中人 Ⅱ只 要 选择 纯策 略 β2 , 无论局中人Ⅰ采取什么纯策 略 , 都 能保 证自 己的 支付 不 会多 于 2 ; 而采 取 其他 任何 纯 策略 , 都有可能使自己的所失 多于 2。上 面的分 析表 明 , 局中人 Ⅰ、Ⅱ 的“ 理 智行 为”分 别 是选取纯策略 α2 和 β2 , 这 时 局 中人 Ⅰ 的 赢 得 值 和 局中 人 Ⅱ 所 失 值 的 绝对 值 相 等 ( 都 是 2) 。局中人Ⅰ是按最大最小原则 , 局中人Ⅱ是按最小最大原则选择各自的纯策略 , 这对双 方来说都是一种最为稳妥的行为 , 因此 α2 ,β2 分别为局中人Ⅰ、Ⅱ的最优纯策略。对于一般矩阵对策 , 有如下定义。 定义 1 设 G = { S1 , S2 ; A} 为 矩阵 对策。其 中 S1 = {α1 ,α2 , … ,αm } , S2 = {β1 ,β2 , … ,βn } , A = ( ai j ) m× n 若等式max imin jai j = minjmax iai j = ai * j *(14 -1)成立 , 记 V G = ai * j * 。则称 VG 为对策 G 的值 , 称 使 ( 14 -1 ) 式 成立 的纯 局势 (αi *,βj * ) 为 G在纯策略下的解 ( 或平衡局势 ) ,αi与 βj分别称为局中人Ⅰ , Ⅱ的最优纯策略。由定义 1 可知 , 在矩阵对策中两个局中人 都采取 最优 纯策略 ( 如果最 优纯 策略 存在 )才是理智的行动。例 7 求解矩阵对策 G = { S1 , S2 ; A} , 其中718A =3162143305解 根据矩阵 A , 有·383·β1β2β3min ja i jα17188α23242 *α316133α43053max iai j162 *5于是m ax imin jai j = minjm ax iai j = a22 = 2由定义 1 , VG = 2 , G 的解为 (α2 ,β2 ) ,α2 与 β2 分别是局中人Ⅰ和Ⅱ的最优纯策略。从例 7 可以看出 , 矩阵 A 的元素 a22 既 是其所在行的最 小元素 , 又是其所在列的 最大元素 , 即ai2 ≤ a22 ≤ a2 j 将这一事实推广到一般矩阵对策 , 可得如下定理。 定理 1 矩阵对策 G = { S1 , S2 ; A}在纯策略意义下有解的充分必要条件是 : 存在纯 局i = 1 , 2 , 3 , 4 ;j = 1 , 2 , 3势 (αi * ,βj * ) 使得对一切 i = 1 , … , m, j = 1 , … , n, 均有 ai j * ≤ ai * j * ≤ ai * j证明 先证充分性 , 由于对任意 i, j 均有ai j * ≤ ai * j * ≤ ai * j故max iai j * ≤ ai * j * ≤ minai * j又因min jm ax iai j ≤ m axiai j *min jai * j ≤ maximi n jai j所以min jmax iai j ≤ ai * j * ≤ maximin jai j另一方面 , 对任给 i, j 有min jai j ≤ ai j ≤ maxiai j所以max imin jai j ≤ minjmax iai j由 (14 -3 ) 式和 ( 14 -4 ) 式有max imin jai j = minjmax iai j = ai且V G = ai * j * 。现在来证明必要性。设有 i*, j * 使得 min jai * j = maximi n jai jm ax iai j= min jmax iai j·483·(14 -2)(14 -3)(14 -4)Íýåå–ýÍ(cid:22)ýåÍ(cid:22)åý–Í(cid:22)ýå–Í(cid:22)ýÍ则由max imin jai j = minjmax iai j有max iai j * = minjai * j ≤ ai * j * ≤ maxiai j * = minjai * j所以对任意 i, j 有ai j * ≤ m axiai j * ≤ ai * j * ≤ minai * j ≤ ai * j证毕。为了便于对更广泛的对策情形进行分析 , 现引进关于二元函数鞍点的概念。 定义 2 设 f ( x, y) 为一个定义 在 x∈ A 及 y ∈ B 上 的 实值 函数 , 如 果 存在 x * ∈ A,y * ∈ B, 使得对一切 x∈ A 和 y∈ B , 有f ( x, y * ) ≤ f ( x *, y * ) ≤ f ( x * , y)(14 -5)则称 ( x * , y * ) 为函数 f 的一个鞍点。由定义 2 及定理 1 可知 , 矩阵对策 G 在纯策略意义下有解 , 且 V G = ai * j * 的充要条 件是 : ai * j * 是矩阵 A 的一个鞍点。在对策论中 , 矩阵 A 的鞍点也称为对策的鞍点。关于定理 1 中 (14 -2 ) 式的直观解释是 : 如果 ai * j * 既是 矩阵 A = ( ai j ) m × n 中 第 i * 行 的 最小值 , 又是 A 中第 j * 列的最 大值 , 则 ai * j * 即为 对策 的 值 , 且 (αi * ,βi * ) 就 是 对策 的解。 其对策意义是 : 一个平衡局势 (αi 后 , 局中人Ⅱ为了使其所失 最少 , 只有 选择 纯策 略 βj * 中人Ⅱ选取了纯策略 βj,βi) 应具有这样的性 质 , 当局中人 Ⅰ选 取了纯策 略 αi, 否则 就可 能 失得 更多 ; 反 之 , 当 局 , 否 则后 , 局中人 Ⅰ 为了 得到 最 大的 赢得 也只 能选 取 纯策 略 αi就会赢得更少。双方的竞争在局势 (αi * ,βj * ) 下达到了一个平衡状态。例 8 求对策的解。设矩阵对策 G = { S1 , S2 ; A} , 其中 S1 = {α1 ,α2 ,α3 ,α4 } , S2 = {β1 ,β2 ,β3 ,β4 } , 赢得矩阵为6565A =184527152 解 直接在 A 提供的赢得表上计算 , 有062α1α2α3β1 β2 β3 β4656514218575min 5 * - 1 5 *α40 2 max 8 5 *672 5 *0于是m ax imin jai j = minjm ax iai j = ai * j * = 5其中i* = 1 , 3 ;j * = 2 , 4故 (α1 ,β2 ) , (α1 ,β4 ) , (α3 ,β2 ) , (α3 ,β4 ) 四个局势都是对策的解 , 且 V G = 5。·583·由例 8 可知 , 一般矩阵对策的解可以是不唯一的。当解不唯一时 , 解之间的关系具有下面两条性质。性质 1 无差别性。即若 (αi 性质 2 可 交 换 性。 即 若 (αi1 ,βj1 ) 和 (αi2 ,βj 1 ) 和 (αi2 ) 是对策 G 的两个解 , 则 ai 2 , βj1 = ai 2 ) 是 对 策 G 的 两 个 解 , 则 (αij11 ,βj。 2 ) 和 1 , βjj22(αi2 ,βj1 ) 也是解。上面两条性质的证明留给读者作为练习。这两条性质表明 , 矩阵对策的值是唯一的。 即当局中人Ⅰ采用构成解的最优纯策略时 , 能保证他的赢得 V G 不依赖于对方的纯策略。最后 , 举一个实际应用的例子。 例 9 某单位采购员在秋天要决定冬季取暖用煤的储 量问题。 已知在正 常的冬季 气 温条件下要消耗 15 吨煤 , 在较暖与较冷的气温条件下要消耗 10 吨和 20 吨。假定冬季时 的煤价随天气寒冷程 度而 有 所 变 化 , 在 较 暖、正常、较 冷 的 气候 条 件 下 每 吨煤 价 分 别 为 100 元 , 150 元和 200 元 , 又设秋季时煤价 为每吨 100 元。 在没 有关于 当年 冬季准 确的 气 象预报的条件下 , 秋季储煤多少吨能使单位的支出最少 ?这一储量问题可以看成是一个对策问题 , 把采购 员当 作局 中人 Ⅰ , 他有三 个策 略 : 在秋天时买 10 吨、15 吨与 20 吨 , 分别记为 α1 ,α2 ,α3 。把大自然看作局中人Ⅱ ( 可以当作理智的 局中人 来处 理 ) , 大 自然 ( 冬 季气 温 ) 有三 种策略 : 出现较暖的、正常的与较冷的冬季 , 分别记为 β1 ,β2 ,β3 。现在把该单位冬季取暖用煤实际费用 ( 即 秋季购 煤时 的用 费与冬 季不 够时再 补购 的费用总和 ) 作为局中人Ⅰ的赢得 , 得矩阵如下 :β1 ( 较暖 )β2 ( 正常 )β3 ( 较冷 )α1 (10 吨 ) α2 (15 吨 ) α3 (20 吨 )100015002000175015002000300025002000m ax imin jai j = minjm ax iai j = a33 = - 200故对策的解为 (α3 ,β3 ) , 即秋季储煤 20 吨合理。2. 2 矩阵对策的混合策略由上节的讨论可知 , 对矩阵对策 G = { S1 , S2 ; A} 来说 , 局中人Ⅰ有把握的至少赢得是v1 = maximin jai j局中人Ⅱ有把握的至多损失是v2 = minjmax iai j一般 , 局中人Ⅰ的赢得值不会多于局中人Ⅱ的所失值 , 即总有 v1 ≤ v2 。当 v1 = v2 时 , 矩阵对策 G 存在纯策略意义下的解 , 且 VG = v1 = v2 。然而 , 一般情形不总是如此 , 实际 中 出现的更多情形是 v1 < v2 , 这样根据定义 1 , 对策不存在纯策略意 义下的解。 例如对于 赢 得矩阵为A =3564的对策来说·683·v1 = maxiv2 = minjmin j max iai j = 4 , i * = 2ai j = 5 , j * = 1v2 = a21 = 5 > 4 = v1于是 , 当双方各根据从最不利情形中选取最有利结果的原则选择纯策略时 , 应分别选 取 α2 和 β1 , 此时局中人Ⅰ将赢得 5 , 比其预期 赢得 v1 = 4 还多 , 原因就 在于 局中人 Ⅱ选 择 了 β1 , 使他的对手多得了原来不该得 的赢 得。故 β1 对局 中人 Ⅱ来 说并 不是最 优的 , 因 而 他会考虑出 β2 。局中人Ⅰ亦会采取相 应的 办法 , 改出 α1 以使 赢得 为 6 , 而 局中 人Ⅱ 又 可 能仍取策略 β1 来对付局中人Ⅰ的策略 α1 。这样 , 局中 人Ⅰ出 α1 或 α2 的可 能性以 及局 中 人Ⅱ出 β1 或 β2 的可能性都不 能 排除。 对两 个局 中人 来说 , 不存 在一 个双 方 均可 接受 的 平衡局势 , 或者说当 v1 < v2 时 , 矩阵对策 G 不存在纯策略意义下的解。在这种情况下 , 一 个比较自然且合乎实际的想法是 : 既然各局中人没有最优纯策略可出 , 是否可以给出一个 选取不同策略的概率分布。 如在 上例 中 , 局 中人 Ⅰ可 以 制定 如下 一种 策 略 : 分 别以 概 率 1/ 4 和 3/ 4 选取纯策略 α1 和 α2 , 这种 策略 是局 中人 Ⅰ 的 策略 集 {α1 ,α2 } 上的 一 个概 率 分 布 , 称之为混合策略。同样 , 局中人Ⅱ 也可 制定 这样 一种 混 合策 略 : 分别 以 概率 1/ 2、1/ 2 选取纯策略 β1 、β2 。下面给出矩阵对策混合策略的定义。定义 3 设有矩阵 对 策 G = { S1 , S2 ; A} , 其中 S1 = {α1 ,α2 , … ,αm } , S2 = {β1 ,β2 , … ,βn } , A = ( ai j ) m× n 记mS * 1 =x ∈ Em | x i ≥ 0 ,i = 1 , … , m,∑xi = 1i = 1nS * 2 =y ∈ En | yj ≥ 0 ,j = 1 , … , n,∑y j = 1j = 1则 S * 为局中人Ⅰ和Ⅱ的混合策略 ( 或策略 ) ; 对 x∈ S * 势 ) , 局中人Ⅰ的赢得函数记成1 和 S *2 分别称为局中人Ⅰ和Ⅱ的混合策略集 ( 或 策略集 ) ; x∈ S *1 和 y∈ S *2 分别 称, 称 ( x, y ) 为一个混 合局势 ( 或 局, y∈ S *12E( x, y) = xT A y = ∑∑ai j x i y j( 14 -6 )这样得到的一个新的对策记成 G* = { S *1, S *2, E} , 称 G* 为对策 G 的混合扩充。由定义 3 可知 , 纯策略是混合策略的特例。例如局中人Ⅰ的纯 策略 αk 等 价于混合 策略 x = ( x1 , … , xm ) T ∈ S *1, 其中1 i = k 0 i≠ k 一个混合策略 x = ( x1 , … , xm ) T 可 设想成 当两个局 中人多 次重复进 行对策 G 时 , 局 中人Ⅰ分 别 采 取 纯策 略 α1 , … ,αm 的 频率。 若 只 进行 一 次 对 策 , 混 合 策 略 x = ( x1 , … , xm ) T 可设想成局中人Ⅰ对各纯策略的偏爱程度。xi =下面讨论矩阵对策 G 在混合策略意义下解的定义。 设两个局中人仍像前面一样地进行有理智的 对策。当局 中人 Ⅰ采取 混合 策略 x 时 ,他只能希望获得 ( 最不利的情形 )min y ∈ S * 1E( x , y)因此局中人Ⅰ应选取 x∈ S *1, 使 得上 式取 极大 值 ( 最不 利当 中的 最有 利 情形 ) , 即 局·783·中人Ⅰ可保证自己的赢得期望值不少于v1 = m ax x ∈ S * 1min y ∈ S * 2E( x, y)(14 -7)同理 , 局中人Ⅱ可保证自己的所失期望值至多是v2 = min * 1y ∈ Smax * x ∈ S 2E( x , y )(14 -8)首先 , 注意到 ( 14 -7) 式和 (14 -8) 式是有意义的。因为根据定义 , 局中人Ⅰ的赢得函数E( x , y ) 是欧氏空间 Em + n 内有界闭集 D 上的连续函数 , 其中D = {( x , y ) | xi ≥ 0 , y j ≥ 0 , i = 1 , … , m, j = 1 , … , n,∑x i = 1 ,∑y j = 1}因此 , 对固定的 x , E( x, y) 是 S *y) 也是 S *1 上 的 连 续 函 数 , 故 maxx∈ S12 上的连续函数 , 故 miny∈ S2E( x, y ) 存在 , 而且 miny∈ Smin * y∈ S 2E( x , y ) 存 在。同 样 可 说 明 miny ∈ S 2max * x ∈ S 1E( x,2 E( x, y)存在。其次 , 仍然有 v1 ≤ v2 。事实上 , 设m ax x ∈ S * 1 min * y∈ S 2min y ∈ S * 2 max * x ∈ S 1E( x, y) = mi nyE( x, y ) = maxxE ( x * , y )E( x , y * )于是v1 = min y ∈ S * 2E( x * , y) ≤ E( x *, y * ) ≤m ax x∈ S * 1E( x, y * ) = v2定义 4 设 G* = { S *1, S *2; E}是矩阵对策 G = { S1 , S2 ; A} 的混合扩充 , 如果m ax x∈ S * 1min y∈ S * 2E( x, y ) = min y∈ S * 2max x ∈ S * 1E( x, y)(14 -9)记其值为 VG 。则称 VG 为 对策 G * 的值 , 称使 ( 14 -9 ) 式成立 的混合局 势 ( x *, y * ) 为 G 在混合策略意义下的解 ( 或简称解 ) , x * 和 y * 分别称为局中人Ⅰ和Ⅱ 的最优 混合策略 ( 或 简 称最优策略 ) 。现约定 , 以下对 G = { S1 , S2 ; A} 及其混合扩充 G* = { S *, S *; E}一 般不 加区别 , 通 常 都用 G = { S1 , S2 ; A}来表示。当 G 在 纯策 略意义 下解 不存 在时 , 自动 认为 讨论的 是在 混 合策略意义下的解 , 相应的局中人Ⅰ的赢得函数为 E( x, y) 。12和定理 1 类似 , 可给出矩阵对策 G 在混合策略意义下解存在的鞍点型充要条件。 定理 2 矩阵对策 G = { S1 , S2 ; A}在混 合策 略意义 下有 解的 充要条 件是 : 存 在 x * ∈S *1, y * ∈ S *2, 使 ( x * , y * ) 为函数 E( x, y ) 的一个鞍点 , 即对一切 x∈ S *1, y∈ S *2, 有E( x , y * ) ≤ E( x * , y * ) ≤ E( x * , y)( 14 -10) 本定理的证明同定理 1 , 只需将 ai j 换写成 E ( x, y) , 读者可自行证之。应注意到 , 当 G 在纯策略意义下解存在时 , 定义 4 中关于对策 G 的值的定义 V G 与前面 的定义是 一致的。 当 G 在混合策略意义下的解 ( x * , y * ) 存在时 , V G = E( x * , y * ) 。例 10 考虑矩阵对策 G = { S1 , S2 ; A} , 其中A =3564·883·由前面的讨论已知 G 在纯策略意义下的解不存在 , 于是设 x = ( x1 , x2 ) 为局中人Ⅰ的混合 策略 , y = ( y1 , y2 ) 为局中人Ⅱ的混合策略 , 则S * 1 = {( x1 , x2 ) | x1 , x2 ≥0 , x1 + x2 = 1} S * 2 = {( y1 , y2 ) | y1 , y2 ≥ 0 , y1 + y2 = 1}局中人Ⅰ的赢得期望值是E( x, y) = 3 x1 y1 + 6 x1 y2 + 5 x2 y1 + 4 x2 y2= 3 x1 y1 + 6 x1 (1 - y1 ) + 5 y1 (1 - x1 )+ 4( 1 - x1 ) ( 1 - y1 )= - 4( x1 - 1/ 4 ) ( y1 - 1/ 2 ) + 9/ 2取 x * = (1/ 4 , 3/ 4 ) , y * = (1/ 2 , 1/ 2 ) , 则 E( x * 即有 故 x * = (1/ 4 , 3/ 4 ) 和 y * = (1/ 2 , 1/ 2 ) 分别为局中人Ⅰ和Ⅱ的最优策略 , 对策的值 ( 局中人 Ⅰ的赢得期望值 ) V G = 9/ 2。, y * ) = 9/ 2 , E( x * , y ) = E( x , y * ) = 9/ 2 ,E( x, y * ) ≤ E( x *, y * ) ≤ E( x * , y ) 。2. 3 矩阵对策的基本定理本节主要讨论矩阵对策解的存在性及解 的有关 性质。 如前所 述 , 一般 矩阵对 策在 纯 策略意义下的解往往是不存在的。但本节将证明 , 一 般矩 阵对 策在混 合策 略意义 下的 解 却总是存在的 , 并且通过一个构造性的证明 , 引出求解矩阵对策的基本方法———线性规划 方法。先给出如下两个记号 : 当局中人Ⅰ取纯策略 ai 时 , 记其相应的赢得函数为 E( i, y ) , 于是E( i, y ) = ∑ai j y j( 14 -11)当局中人 Ⅱ 取纯策略 βj 时 , 记其相应的赢得函数为 E( x, j ) , 于是E( x , j ) = ∑ai j x i( 14 -12)由 (14 -11) 式和 ( 14 -12 ) 式 , 有E( x, y ) = ∑∑ai j x i y j = ∑(∑ai j y j ) x i= ∑E ( i, y) x j( 14 -13)和E( x, y ) = ∑∑ai j x i y j = ∑(∑ai j x i ) yj= ∑E ( x , j) yj(14 -14 )根据上面的记号 , 可给出定理 2 的另一种等价表示。 定理 3 设 x * ∈ S *, y * ∈ S *, 则 ( x * , y * ) 是 G 的解的充要条件是 : 对任意 i = 1 , … ,12m 和 j = 1 , … , n, 有E( i, y * ) ≤ E( x * , y * ) ≤ E( x * , j )( 14 -15) ·983·证明 设 ( x * , y * ) 是 G 的解 , 则由定 理 2 , ( 14 -10 ) 式成 立。由于 纯策 略是混 合策 略的特例 , 故 ( 14 -15 ) 式成立。反之 , 设 (14 -15 ) 式成立 , 由E( x , y * ) = ∑E( i, y * ) xi ≤ E( x * , y * )∑x i = E( x * , y * )E( x *, y) = ∑E( x *, j ) y j ≥ E( x * , y * )∑y j = E( x *, y * )证毕。 , y * ) 是否为对 策 G 的解 时 , ( 14 -15 ) 式把 需 要对无限个不等式进 行 验 证的 问 题转 化 为只 要 对有 限 个 不 等式 ( m n 个 ) 进行 验 证 的 问 题 , 从而使下面的研究大为简化。即得 (14 -10) 式。可以这样认识定理 3 的意义 : 在验证 ( x *不难证明 , 定理 3 可表述为如下等价的形式 , 而这一形式在求解矩阵对策时是特别有用的。定理 4 设 x * ∈ S *1, y * ∈ S *2, 则 ( x *, y * ) 为 G 的解 的充要 条件 是 : 存在 数 v, 使 得x * 和 y * 分别是不等式组 ( Ⅰ ) 和 ( Ⅱ ) 的解 , 且 v = V G 。∑ai j x i ≥ v,j = 1 , … , n( Ⅰ )∑x i = 1( 14 -16)xi ≥ 0 , ∑ai j y j ≤ v,i = 1 , … , mi = 1 , … , m( Ⅱ )∑y j = 1(14 -17 )y j ≥ 0 ,j = 1 , … , n证明留给读者作为练习。下面给出矩阵对策的基本定理 , 也是本节最主要的内容。 定理 5 对任一矩阵对策 G = { S1 , S2 ; A} , 一定存在混合策略意义下的解。 证明 由定理 3 , 只要证明存在 x * ∈ S *, y * ∈ S *, 使得 (14 -15 ) 式成 立。为此 , 考 虑12如下两个线性规划问题 :max w ∑ai j x i ≥ w ,j = 1 , … , n( P )∑x i = 1x i ≥ 0i = 1 , … , m和min v ∑ai j y j ≤ v,i = 1 , … , m( D )∑y j = 1y j ≥ 0j = 1 , … , n易验证 , 问题 ( P ) 和 ( D ) 是互为对偶的线性规划问题 , 而且 ·093·x = ( 1 , 0 , … , 0 ) T ∈ Em ,w = minja1 j是问题 ( P ) 的一个可行解。y = ( 1 , 0 , … , 0 ) T ∈ En ,v = maxai1是问题 ( D ) 的一个可行解。由线性规划的对 偶理论可 知 , 问 题 ( P ) 和 ( D ) 分 别存在 最优 解 2 和 数 v * , 使 得对 任意 i = ( x * , w* ) 和 ( y * , v* ) , 且 v* = w * 。即 存在 x * ∈ S * 1 , … , m 和 j = 1 , … , n, 有, y * ∈ S *1∑j ≤ v * ≤ ∑ai j y *ai j x *(14 -18 )或E( i, y * ) ≤ v* ≤ E( x *, j)( 14 -19)又由E( x *, y * ) = ∑E( i, y * ) x *i ≤ v * ·∑x *i = v *E( x *, y * ) = ∑E ( x *, j ) y *j ≥ v * ·∑j = v* y *得到 v * = E( x * , y * ) , 故由 (14 -19) 式知 (14 -15 ) 式成立。证毕。定理 5 的证明是一个构造性的证明 , 不仅证明了矩阵对策解的存在性 , 而且给出了利用线性规划求解矩阵对策的方法。下面的定理 6 至定理 10 讨论了矩阵对策及其解的若干重要性质 , 它们在求解矩阵对策的过程中将起到重要作用。定理 6 设 ( x * (1 ) 若 xi * > 0 , 则 ∑, y * ) 是矩阵对策 G 的解 , v = V G , 则ai j y j * = v。(2 ) 若 y j> 0 , 则∑ iai j x i= v。(3 ) 若∑ai j y j< v, 则 x i= 0 。(4 ) 若∑ai j x i * > v, 则 yj * = 0 。证明 按定义有v = m ax x ∈ S * 1E( x, y * )故v - ∑ai j y *j = max x ∈ S * 1E( x , y * ) - E( i, y * ) ≥ 0又因∑x *iv - ∑ai j y *= v - ∑∑ai j x *i y *j = 0所以 , 当 x *i > 0 时 , 必有 ∑x * i ≥0 , j = v; 当∑ai j y *i = 1 , … , mai j y *j < v 时 , 必有 x *i = 0 , (1 ) 、(3 ) 得证。同理可证 (2 ) 、(4 ) 。证毕。记矩阵对策 G 的解集为 T ( G) , 下面三个定理是关于对策解集性质的主要内容。 定理 7 设有两个矩阵对策·193·G1 = { S1 , S2 ; A1 }G2 = { S1 , S2 ; A2 } 其中 A1 = ( ai j ) , A2 = ( ai j + L) , L 为任一常数 , 则有2 = V G (2 ) T( G1 ) = T ( G2 ) 定理 8 设有两个矩阵对策(1 ) V G1 + LG1 = { S1 , S2 ; A} G2 = { S1 , S2 ;αA}其中 α> 0 为任一常数。则2 =αVG (2 ) T( G1 ) = T ( G2 ) 定理 9 设 G = { S1 , S2 ; A}为—矩阵对策 , 且 A = - AT 为斜对称矩阵 ( 亦 称这种对 策(1 ) V G1为对称对策 ) 。则(1 ) V G = 0(2 ) T1 ( G) = T2 ( G) , 其中 T1 ( G) 和 T2 ( G) 分别为局中人Ⅰ和Ⅱ的最优策略集。 定理 7 至定理 9 的证明留给读者去完成。在给出定理 10 之前 , 先给出矩阵对策优超纯策略的定义。定义 5 设有矩 阵 对 策 G = { S1 , S2 ; A} , 其 中 S1 = {α1 , … ,αm } , S2 = {β1 , … ,βn } , j , 即矩 阵 A 的 第 i0 行 元素均 不小 于第 k0 j ≥ ak A = ( ai j ) , 如果对一切 j = 1 , … , n 都有 ai 行的对应元素 , 则称局中 人 Ⅰ的 纯 策 略 αi0 优 超 于 αk0 ; 同 样 , 若 对 一 切 i = 1 , … , m, 都 有 0 即矩阵 A 的第 l0 列元素 均不小 于第 j0 列的 对 应元 素 , 则称 局中 人 Ⅱ的 纯策 略000 ≤ ai lai jβj0 优超于 βl0 。定理 10 设 G = { S1 , S2 ; A} 为 矩 阵 对 策 , 其 中 S1 = {α1 , … ,αm } , S2 = {β1 , … ,βn } ,A = ( ai j ) 如果纯策略 α1 被其余纯策略 α2 , … ,αm 中之 一 所优 超 , 由 G 可得 到 一个 新的 矩 阵对策 G′G′= { S′1 , S2 ; A′}其中S′1 = {α2 , … ,αm } A′= ( ai j ′) ( m - 1 ) × nai j = ai ji = 2 , … , mj = 1 , … , n于是有(1 ) V G′ = V G ; (2 ) G′中局中人Ⅱ的最优策略就是其在 G 中的最优策略 ; , … , x * (3 ) 若 ( x * 在 G 中的最优策略。m ) T 是 G′中局中人Ⅰ的最优策略 , 则 x * = (0 , x *22, … , x *m ) T 便是 其证明 不妨设 α2 优超于 α1 , 即因 x′* = ( x *2, … , x *m ) T 和 y * = ( y *a2 j ≥ a1 j , , … , y *1j = 1 , … , nn ) 是 G′的解 , 由定理 3 , 有( 14 -20)·293·nm∑j ≤ VG′ ≤ ∑ai j y *ai j x *i(14 -21 )j = 1i = 2i = 2 , … , m; j = 1 , … , n因 α2 优超于 α1 , 由 ( 14 -20) 式有nn∑a1 j y *i ≤ ∑a2 j y *j ≤ VG′(14 -22 )j = 1j = 1合并 (14 -21) 式和 (14 -22 ) 式 , 得nm∑j = 1ai j y *j ≤ V G′ ≤ ∑ i = 1 , … , m;ai j x *i + a1 j ·0i = 2j = 1 , … , n或E( i, y * ) ≤ V G′≤ E( x * , j) j = 1 , … , n i = 1 , … , m; , … , x * 由定理 4 , ( x * , y * ) 是 G 的解 , 其中 x * = ( 0 , x *m ) T , 且 V G′ = VG 。2证毕。推论 在定理 10 中 , 若 α1 不是 为 纯策 略α2 , … ,αm 中之 一 所 优超 , 而是 为 α2 , … ,αm的某个凸线性组合所优超 , 定理的结论仍然成立。定理 10 实际给出了一个化简赢得矩阵 A 的原则 , 称之为 优超原 则。根据这 个原则 , 当局中人Ⅰ的某纯策略 ai 被其他纯策略或纯策略的凸线性组合所优超时 , 可在矩阵 A 中 划去第 i 行而得到一个与原对策 G 等价但赢得矩阵阶数较小的对策 G′, 而 G′的求解往往 比 G 的求解容易些 , 通过求解 G′而得到 G 的解。类似地 , 对局中人Ⅱ来说 , 可以在赢得矩 阵 A 中划去被其他列或其他列的凸线性组合所优超的那些列。下面 , 举例说明优超原则的应用。 例 11 设赢得矩阵为 A, 求解这个矩阵对策。3203050259A =7395946875. 560883解 由于第 4 行优超于第 1 行 , 第 3 行 优超于 第 2 行 , 故可划 去第 1 行 和第 2 行 , 得到新的赢得矩阵73959A1 =46875. 50 对于 A1 , 第 1 列优超于第 3 列 , 第 2 列优超于第 4 列 , 1/ 3 × ( 第 1 列 ) + 2/ 3× ( 第 2 列 ) 优 超于第 5 列 , 因此去掉第 3 列、第 4 列和第 5 列 , 得到68837 3A2 =4 66 0这时 , 第一行又优超于第 3 行 , 故从 A2 中划去第 3 行 , 得到·393·A3 =7436对于 A3 , 易知无鞍点存在 , 应用定理 4 , 求解不等式组 ( Ⅰ ) , ( Ⅱ )7 x3 + 4 x4 ≥ v 3 x3 + 6 x4 ≥ v7 y1 + 3 y2 ≤ v 4 y1 + 6 y2 ≤ v( Ⅰ )x3 + x4 = 1( Ⅱ )y1 + y2 = 1x3 , x4 ≥0y1 , y2 ≥ 0首先考虑满足7 x3 + 4 x4 = v7 y1 + 3 y2 = v3 x3 + 6 x4 = v4 y1 + 6 y2 = vx3 + x4 = 1y1 + y2 = 1的非负解。求得解为x * 3 = 1/ 3 , y * 1 = 1/ 2 ,x * y *4 = 2/ 32 = 1/ 2v = 5于是 , 原矩阵对策的一个解为x * = ( 0 , 0 , 1/ 3 , 2/ 3 , 0) T y * = (1/ 2 , 1/ 2 , 0 , 0 , 0 ) T V G = 5第 3 节 矩阵对策的解法3. 1 公式法、图解法和方程组法1. 2×2 对策的公式法所谓 2×2 对策是指局中人Ⅰ的赢得矩阵为 2× 2 阶的 , 即a12a11A =a21 如果 A 有鞍点 , 则很快可求出各局中人的最优纯策略 ; 如果 A 没有鞍点 , 则可证明各局 中 人最优混合策略中的 x * j 均大于零。于是 , 由定理 6 可 知 , 为求最 优混 合策略 可求 下 列等式组 :a22, y *ia11 x1 + a21 x2 = v( Ⅰ )a12 x1 + a22 x2 = vx1 + x2 = 1a1 1 y1 + a12 y2 = v( Ⅱ )a2 1 y1 + a22 y2 = vy1 + y2 = 1·493·( 14 -23)( 14 -24)当矩阵 A 不存在鞍点时 , 可以证 明上 面等式 组 ( Ⅰ ) 和 ( Ⅱ ) 一定有 严格 非负 解 x * = ( x * 2 ) 和 y * = ( y * x *, y *2 ) , 其中11x * 1 =a22 - a21 ( a1 1 + a2 2 ) - ( a1 2 + a2 1 )( 14 -25)x * 2 =a11 - a12 ( a1 1 + a2 2 ) - ( a1 2 + a2 1 )( 14 -26)y * 1 =a22 - a12 ( a11 + a22 ) - ( a12 + a21 )( 14 -27)y * 2 =a11 - a21 ( a11 + a22 ) - ( a12 + a21 )( 14 -28)V G =a11 a22 - a12 a21 ( a1 1 + a2 2 ) - ( a12 + a21 )( 14 -29)例 12 求解矩阵对策 G = { S1 , S2 ; A} , 其中31A =4 解 易知 , A 没有鞍点。由通解公式 ( 14 -25) 式～ (14 -29) 式计算得到最优解为 x * = ( 1/ 2 , 1/ 2) T , y * = ( 1/ 4 , 3/ 4) T , 对策值为 5/ 2。22. 2× n 或 m×2 对策的图解法这里 , 介绍一种求矩阵对策的 图解法 , 这 个方 法用在 赢得 矩阵为 2 × n 或 m × 2 阶 的 对策上特别方便 , 也可用在 3× n 或 m×3 对策上。但对 m 和 n 均大于 3 的矩阵对策就不 适用了。现用一个 2× n 对策的例子来说明这个方法。例 13 考虑矩阵对策 G = { S1 , S2 ; A} , 其中A =7 S1 = {α1 ,α2 } ,231152S2 = {β1 ,β2 ,β3 }设局中人Ⅰ的混合策略为 ( x, 1 - x) T , x∈ [0 , 1 ] 。过数轴上坐标为 O 和 (1 , 0 ) 的两 点 分别做两条垂线Ⅰ - Ⅰ和Ⅱ - Ⅱ , 垂线上点的 纵坐标值 分别表示 局中人 Ⅰ采 取纯策 略 α1 和 α2 时 , 局中人Ⅱ采取各纯策略时的赢得值。如图 14 -1。当局 中人Ⅰ 选择每 一策略 ( x, 1 - x) T 时 , 他的最少可能的收入为由局中人Ⅱ选择 β1 、β2 、β3 时所确定的三条直线2 x + 7 (1 - x ) = V3 x + 5 (1 - x ) = V11 x + 2( 1 - x) = V 在 x 处的纵坐标中之最小者 , 即如折线 B1 B B2 B3 所 示。所以 对局 中人 Ⅰ来说 , 他 的 最优选择就是确定 x 使他的收入尽可能 地多 , 从 图 14 -1 可 知 , 按最 小最大 原则 应选 择 x = O A, 而 A B 即为对策值。为求出点 x 和对策 值 V G , 可联 立过 B 点的 两条 线段 β2 和 β3 所确定的方程 :3 x + 5 (1 - x) = V G11 x + 2( 1 - x ) = V G 解得 x = 3/ 11 , V G = 49/ 11。所以 , 局中人Ⅰ的 最优策 略为 x * = ( 3/ 11 , 8/ 11 ) T 。此 外 , 从·593·,图 14 -1 2× n 对策的图解法图上还可以看出 , 局中人Ⅱ的最优混合策略只由 β2 和 β3 组成。事实上 , 若记 y * = ( y * E( x * E( x *13 ) T 为局中人Ⅱ的最优混合策略 , 则由 , y * , 1 ) = 2 ×3/ 11 + 7×8/ 11 = 62/ 11 > 49/ 11 = V G , 2 ) = E( x * , 3 ) = V G, y *2根据定理 6 可知 , 必有 y * 根据定理 6 , 可由1 = 0 , y *2 > 0 , y *3 > 0 。3 y2 + 11 y3 = 49/ 115 y2 + 2 y3 = 49/ 11y2 + y3 = 1求得 y *2 = 9/ 11 , y *3 = 2/ 11。所以局中人Ⅱ的最优混合策略为 y * = ( 0 , 9/ 11 , 2/ 11) T 。例 14 用图解法求解矩阵对策 G = { S1 , S2 ; A} , 其中 S1 = {α1 ,α2 ,α3 } , S2 , = {β1 ,β2 } ,27A =6611 设局中人Ⅱ的混合策略为 ( y , 1 - y ) T , 由 图 14 -3 可 知 , 直线 α1 、α2 、α3 在任 一点 y∈ [ 0 , 1] 处的纵坐标分别是局中人Ⅱ采取混合策略 ( y , 1 - y) T 时的支付。根据最不利 当中选取 最 有利的原则 , 局中人Ⅱ的最优选择就是如何确定 y, 以使三个纵坐标 值中的最 大值尽可 能 地小。从图 14 -2 可见 , 应选择 O A1 ≤ y≤ OA2 , 且对策的值显然为 6 。由方程22 y + 7( 1 - y ) = 6 和 11 y + 2 (1 - y) = 6 求得 OA1 = 1/ 5 , O A2 = 4/ 9 。故局中人Ⅱ的最优混合策略是 y * = ( y, 1 - y ) T , 其中 1/ 5 ≤ y≤4/ 9 , 而局中人Ⅰ的最优策略显然只能是 ( 0 , 1 , 0) T , 即取纯策略 α2 。·693·图 14 -2 m×2 对策的图解法例 15 求解赢得矩阵 A 的矩阵对策。A =418/ 354527首先 , 利用优超原则 , 第 2 列优超于第 3 列 , 故可划去第 3 列 , 又因( 2/ 3) × ( 第 4 列 ) + (1/ 3 ) × ( 第 1 列 ) = ( 第 2 列 )由优超原则又可划去 A 的第 2 列 , 转而求解赢得矩阵A′=4127的对策 G′, 从而解得原对策的一个解为x * = (3/ 4 , 1/ 4 ) T y * = ( 5/ 8 , 0 , 0 , 3/ 8) T V G = 13/ 4若用图解法求解本例 , 由图 14 -3 可见 , 局中人 Ⅰ 的最优策略为 x * = ( 3/ 4 , 1/ 4) T , 若 , y * 4 可由 以记局中人 Ⅱ 的最优策略为 y * = ( y * 下联立方程确定。, y *, y *4 ) T , 则有 y *, y *, y *3 = 0 , 而 y *321124 y1 + (8/ 3 ) y2 + 2 y4 = 13/ 4y1 + 5 y2 + 7 y4 = 13/ 4y1 + y2 + y4 = 1显然 , 满足上面方程组的解有无穷多个 , 故局中人Ⅱ有无穷多个最优混合策略。例 15 说明 , 利用优超原则化简赢得矩阵时 , 有可能将原矩阵对策的解也划去一些 , 这种情况在 m 和 n 均大于 3 时仍然可能发生。·793·图 14 -33. 线性方程组方法根据定理 4 , 求解矩阵 对 策解 ( x * , y * ) 的问 题 等 价于 求 解不 等 式组 ( 14 -16 ) 和 ( 14 - j 均 不为 零 , 即 可将 上述 两17 ) , 又根据定理 5 和定理 6 , 如果 假设最 优策 略中 的 x * 个不等式组的求解问题转化成求解下面两个方程组的问题 :i 和 y *∑a i j x i = v,j = 1 , … , n∑x i = 1(14 -30 )∑ai j y j = v,i = 1 , … , m和∑y j = 1(14 -31 )如果方程 组 (14 -30) 和 ( 14 -31 ) 存 在非 负解 x * 和 y * , 便 求得 了对策 的一 个解 ( x * , y * ) 。 如果由上述两个方程组求出的解 x * 和 y * 中 有负 的分量 , 则 可视 具体情 况 , 将 ( 14 -30 ) 式 和 (14 -31 ) 式中的某些等式改成不等式 , 继续 试算求 解 , 直至 求出 对策的 解。这种 方法 由 j 均 不为 零 , 故当 x * 和 y * 的实际 分量 中有 些为零 时 , ( 14 -30 ) 式 和 于事先假设 x * (14 -31 ) 式一般无非负解 , 而下面的试算过程 则是无 固定 规程可 循的。 因此 , 这种 方法 在 实际应用中具有一定的局限性。i 和 y *例 16 求解矩阵对策———“齐王赛马” 解 已知齐王的赢得矩阵为311111131111A =111131131111111131111113易知 , A 没有鞍点 , 即对齐王和田忌来说都不存在最优纯策略。设齐王和田忌的最 优·893·混合策略为6 ) T 和 y * = ( y * 从矩阵 A 的元素来看 , 每个局中 人选取 每个 纯策 略的 可 能性 都是 存在 的 , 故 可事 先x * = ( x *, x *, x *, x *, y *, x *, x *, y *6 ) T, y *, y *, y *3122145435假定 x *i > 0 和 y *j > 0 , i = 1 , … , 6 ; j = 1 , … , 6 , 于是求解线性方程组3 x1 + x2 + x3 -x4 + x5 + x6 = vx1 + 3 x2 -x3 + x4 + x5 + x6 = vx1 + x2 + 3 x3 + x4 -x5 + x6 = vx1 + x2 + x3 + 3 x4 + x5 -x6 = v( 14 -32)x1 -x2 + x3 + x4 + 3 x5 + x6 = vx1 + x2 + x3 + x4 + x5 + 3 x6 = vx1 + x2 + x3 + x4 + x5 + x6 = 1和3 y1 + y2 + y3 + y4 + y5 -y6 = vy1 + 3 y2 + y3 + y4 -y5 + y6 = vy1 -y2 + 3 y3 + y4 + y5 + y6 = vy1 + y2 + y3 + 3 y4 + y5 + y6 = v( 14 -33)y1 + y2 -y3 + y4 + 3 y5 + y6 = vy1 + y2 + y3 -y4 + y5 + 3 y6 = vy1 + y2 + y3 + y4 + y5 + y6 = 1得到x i = 1/ 6 ,y j = 1/ 6 ,i = 1 , … , 6 j = 1 , … , 6v = 1故齐王和田忌的最优混合策略为x* = (1/ 6 , 1/ 6 , 1/ 6, 1/ 6 , 1/ 6 , 1/ 6) T 和 y * = (1/ 6, 1/ 6 , 1/ 6 , 1/ 6 , 1/ 6, 1/ 6) T对策的值 ( 齐王的期望赢得 ) 为 VG = 1 。这 与我们 的设 想相符 , 即双方 都以 1/ 6 的 概 率选取每个纯策略 , 或者说每个纯策略被选 取的机 会应 是均 等的 , 则总 的结 局应该 是 : 齐 王有 5/ 6 的机会赢田忌 , 赢得的期望值是 1 千金。但是 , 如果齐王在每出一匹马前将自己 的选择告诉了对方 , 这实 际 上 等 于 公开 了 自 己 的 策略 , 如 齐 王选 取 出 马 次 序为 ( 上 , 中 , 下 ) , 则田忌根据谋士的建议便以 ( 下 , 上 , 中 ) 对之 , 结果田忌反而可得千金。因此 , 在矩阵 对策不存在鞍点时 , 竞争的双方在开局前均应对自己的策略 ( 实际上是纯策略 ) 加以保密 , 否则不保密的一方是要吃亏的。例 17 某厂用三种不同的设备 α1 、α2 、α3 加工 三种不 同的 产品 β1 、β2 、β3 , 已知 三种 设备分别加工三种产品时 , 单位时间内创造的价值由表 14 -3 给出。·993·表 14 -3被加工产品使用设备β1β2β3α1324α2 α3124226出现负值是由于设备的消耗大于创造出 的价值。 在上 述条件 下 , 求出 一个合 理的 加工方案。解 此问题可看成是一个矩阵对策问题 , 并易 知没有 鞍点。 设采用 设备 α1 、α2 、α3 的概率分别为 ( x1 , x2 , x3 ) T , 产品 β1 、β2 、β3 被接受加工的概率分别为 ( y1 , y2 , y3 ) T为简化求解计算 , 由定理 7 , 转而求赢得矩阵为142A′= A - ( 2) 3 × 3 =320004的矩阵对策 G′, 为此 , 先求解等式组x1 - 3 x24 x1 + 2 x22 x1 += v′ = v′ 4 x3 = v′( 14 -34)x1 + x2 + x3 = 1和y1 - 4 y2 + 2 y3 = v′ = v′ 4 y3 = v′3 y1 + 2 y2( 14 -35)y1 + y2 + y3 = 1经过实际计算 , 知道上述等式组不存在 非负解。 于是根 据试 算 , 将 ( 14 -34 ) 式中第 3 式 取 为不等式 , 将 ( 14 -35 ) 式中第 1 式取为不等式 , 转而求解x1 - 3 x24 x1 + 2 x22 x1 += v′ = v′ 4 x3 > v′( 14 -36)x1 + x2 + x3 = 1和y1 - 4 y2 + 2 y3 < v′ = v′3 y1 + 2 y24 y3 = v′( 14 -37)y1 + y2 + y3 = 1由定理 6 , (14 -36 ) 式和 ( 14 -37 ) 式的解 x * 及 y * 中 的分 量 x *1 = 0 , y *3 = 0。将 此结 果代回上面两组不等式 , 得到 ·004·ÍÀ4"çÀ"4çÀ4"ç2 = 0 , x * x * y * 1 = 2/ 5 ,3 = 1 y *2 = 3/ 5v′= 0故原对策最优解为 x * = (0 , 0 , 1 ) T , 对策值 ( 单位时间内创造价值的期望值 ) V G = v′+ 2 = 2y * = ( 2/ 5 , 3/ 5 , 0) T3. 2 线性规划方法由定理 5 已知 , 任一矩阵对策 G = { S1 , S2 ; A} 的 求 解均 等价 于一 对互 为 对偶 的线 性规划问题 , 而定理 4 表明 , 对策 G 的解 x * 和 y * 等价于下面两个不等式组的解。∑ai j x i ≥ v,j = 1 , … , n( Ⅰ )∑x i = 1( 14 -38)xi ≥ 0 , ∑i = 1 , … , mai j y j ≤ v,i = 1 , … , m( Ⅱ )∑y j = 1( 14 -39)y j ≥ 0 ,j = 1 , … , n其中v = max x ∈ S * 1min y ∈ S * 2E( x , y) = mi n y ∈ S * 2max x ∈ S * 1E( x, y )( 14 -40)就是对策的值 VG 。定理 11 设矩阵对策 G = { S1 , S2 ; A}的值为 V G , 则VG = max x ∈ S * 1min 1 ≤ j≤ nE ( x , j) = mi n y ∈ S * 2max 1 ≤ i≤ mE( i, y )( 14 -41)证明 因 VG 是对策的值 , 故V G = max x ∈ S * 1min y ∈ S * 2E( x , y) = mi n y ∈ S * 2max x ∈ S * 1E( x, y )( 14 -42)一方面 , 任给 x∈ S *1, 有mi n 1 ≤ j≤ nE ( x, j) ≥ min y ∈ S * 2E( x , y)( 14 -43)故max * x ∈ S 1min 1 ≤ j≤ nE ( x , j) ≥ maxx ∈ S1min * y ∈ S 2E( x, y)( 14 -44)另一方面 , 任给 x∈ S *1, y∈ S *2, 有nE( x, y ) = ∑j = 1E( x, j) · yj ≥ min 1 ≤ j≤ nE( x, j )故max x ∈ S * 1min * y ∈ S 2 min y ∈ S * 2E( x, y ) ≥ min 1 ≤ j≤ nE( x , y ) ≥ max x ∈ S * 1E ( x , j)min 1 ≤ j≤ nE ( x , j)( 14 -45)( 14 -46)由 (14 -44) 式和 (14 -46 ) 式得·104·VG = max x ∈ S * 1min 1 ≤ j≤ nE( x , j )同理可证V G = min * 2y∈ Sm ax 1 ≤ i≤ mE ( i, y)下面给出求解矩阵对策的线性规划方法。作变换 ( 根据定理 7 , 不妨设 v > 0) :x′i = xi/ v,i = 1 , … , m则不等式组 (14 -38) 变为∑ai j x′i ≥ 1 ,j = 1 , … , n( Ⅰ )∑x′i = 1/ vx′i ≥ 0 ,i = 1 , … , m根据定理 11 , v = max x∈ S * 11 ≤ j≤ n∑ miniai j x i这样 , 不等式组 ( Ⅰ ) 即等价于线性规划问题 :min z = ∑x′i( P )∑ai j x′i ≥ 1 ,j = 1 , … , nx′i ≥0同理 , 作变换y′j = y j/ v,j = 1 , … , n则不等式组 (14 -39) 变为∑ai j y′j ≤ 1 ,i = 1 , … , m( Ⅱ )∑y′j = 1/ vy′j ≥0 ,j = 1 , … , n其中 v = min y ∈ S * 21 ≤ i≤ m∑ maxjai j y j , 与之等价的线性规划问题是 :max w = ∑jy′j( D )∑ai j y′j ≤ 1 ,i = 1 , … , mj = 1 , … , n 显然 , 问题 ( P ) 和 ( D ) 是互为 对偶的 线性 规划 , 故可 利用 单纯 形或对 偶单 纯形 方法 求 解。在求解时 , 一般先求问题 ( D) 的解 , 因为这样容 易在迭代 的第一 步就找到 第一个基 本 可行解 , 而问题 ( P ) 的解从问题 ( D ) 的最后 一个 单纯形 表上 即可 得到。当 求得问 题 ( P ) 和 ( D ) 的解后 , 再利用变换 (14-47) 式和 (14-50) 式即可求出原对策问题的解及对策的值。y′j ≥0 ,例 18 利用线性规划方法求解赢得矩阵为 A 的矩阵对策。·204·证毕。( 14 -47)(14 -48 )( 14 -49)( 14 -50)( 14 -51)( 14 -52)729A =2909011解 求解问题可化成两个互为对偶的线性规划问题mi n( x1 + x2 + x3 )7 x1 + 2 x2 + 9 x3 ≥1 ≥ 1 11 x3 ≥ 12 x1 + 9 x29 x1 +( 14 -53)x1 , x2 , x3 ≥0m ax( y1 + y2 + y3 )7 y1 + 2 y2 + 9 y3 ≤1 ≤12 y1 + 9 y2( 14 -54)11 y3 ≤19 y1 + y1 , y2 , y3 ≥0表 14 -4cj111000wcBxBby1y2y3u1u2u30u117291000u212900100u31[9 ]011001cj - zj11100000u12/ 9024/ 9107/ 90u27/ 90[9 ]22/ 9012/ 91y11/ 91011/ 9001/ 9cj - zj012/ 9001/ 91/ 90u14/ 8100[ 80/ 81 ]12/ 959/ 811y27/ 810122/ 8101/ 92/ 811y11/ 91011/ 9001/ 9cj - zj004/ 8101/ 97/ 8116/ 811y34/ 8000181/ 8018/ 8059/ 801y21/ 1001022/ 804/ 8018/ 801y11/ 2010099/ 8022/ 8081/ 80cj - zj0004/ 808/ 804/ 8016/ 80利用单纯形方法求解问题 ( D ) , 迭代过程如表 14-4 所示 , 从表 14-4 中可得到问题 ( D)的解为·304·ÁKc¨í(cid:6)Ôºv\(cid:25)ÔNv6º\(cid:25)ÓÔNv6º\(cid:25)ÓNv6º(cid:25)\ÓÁKc¨í(cid:6)KNÁ4Jcd¨ÓNÁKJd4¨ÓNÁKJc4d¨ÓKÛÁJc¨NÁxc§{¨ÓNÁ§(cid:144)c{x¨ÓNÁ§c¨{ÓKÁac§¨(cid:9)NÕÁx{c(cid:4)(cid:6)ÕNÁÕ{xc(cid:4)(cid:6)ÕÕÁNc{x(cid:6)(cid:4)ÕÁ¾ac(cid:6)(cid:9)y = ( 1/ 20 , 1/ 10 , 4/ 80 ) T = (1/ 20 , 1/ 10 , 1/ 20) T w = 16/ 80 由表 14 -4 中最后一个单纯形表可得问题 ( P ) 的解为 :x = ( 4/ 80 , 8/ 80 , 4/ 80 ) T = (1/ 20 , 1/ 10 , 1/ 20) T z = 16/ 80于是VG = 80/ 16 = 5x * = V G · (1/ 20 , 1/ 10 , 1/ 20) T = ( 1/ 4 , 2/ 4 , 1/ 4) T y * = V G · ( 1/ 20 , 1/ 10 , 1/ 20 ) T = (1/ 4 , 2/ 4 , 1/ 4 ) T 至此 , 我们介绍了一些求解矩阵对策的方法。在求解一个矩阵对策时 , 应首先判断其 是否具有鞍点 , 当鞍点不存在时 , 利 用优 超原则 和定 理 7、定 理 8 等提 供的 方 法将 原对 策 的赢得矩阵尽量地化简 , 然后再利用本节介绍的各种方法去求解。在本节介绍的各类求解的方法中 , 线性规划方法是具有一般性的 , 另外还有两种具有 一般性的解法 : 求全部解的矩阵法和至少保证求出一个解的微分方程法。限于篇幅 , 这里 就不作介绍了 , 有兴趣的读者可参阅参考文献 [ 1] 。第 4 节 *其他类型对策简介4. 1 二人无限零和对策矩阵对策最简单的推广 就是 局中 人的 策略 集 从有 限集 变为 无限 集 , 例 如是 [ 0 , 1 ] 区 间。一般用 G= { S1 , S2 ; H} 表示一个二 人无 限零和 对策 , 其 中 S1 和 S2 中 至少有 一个 是 无限集合 , H 为局中人 I 的赢得函数。记v1 = max ∈ S α 1 imin ∈ S β 2 jH (αi ,βj )v2 = min ∈ S β 2 jmax ∈ S α 1 iH (αi ,βj )则 v1 为局中人Ⅰ的至少赢得 , v2 为局中人Ⅱ 的至 多所失。 显然 有 v1 ≤ v2 , 当 v1 = v2 时 , 有如下定义。定义 6 设 G = { S1 , S1 ; H}为二人无限零和对策。若存在 αi * ∈ S1 ,βj * ∈ S2 , 使得max ∈ S α 1 imin ∈ S β 2 jH (αi ,βj ) = min ∈ Sβ j2max ∈ S α 1 iH (αi ,βj ) = H (αi * ,βj * )( 14 -55)记其值为 V G , 则称 VG 为对策 G 的值 , 称使 (14 -55 ) 式成立的 (αi * ,βj * ) 为 G 在纯策略意义 下的解 ,αi * ,βj * 分别称为局中人Ⅰ和Ⅱ的最优纯策略。定理 12 (αi αi ∈ S1 ,βj ∈ S2 , 有,βj) 为 G = { S1 , S2 ; H} 在 纯 策略 意 义下 的 解 的充 要 条件 是 : 对 任 意H (αi ,βj * ) ≤ H (αi *,βj * ) ≤ H (αi *,βj )( 14 -56) 例 19 设局中人Ⅰ、Ⅱ互相独立 地从 [ 0 , 1 ] 中分 别选择一个实数 x 和 y , 局中人Ⅰ 的 赢得函数为 H ( x, y ) = 2 x2 - y2 。对策中 , 局中人Ⅰ希望 H 越大越好 , 局 中人Ⅱ则 希望 H 越小越好。图 14 -4 给出了 H ( x, y) 的等 值线 , 通过 对该 图的 分析 , 不难 看出 双方 竞争 的 ·404·= 1 分 别 平衡局 势 为 ( 1 , 1 ) , 即 αi 为局中人Ⅰ和 Ⅱ的最 优纯策 略 , VG = 1。 可 以验证 , 对 (αi * ) = ( 1 , 1 ) , (14 -56 ) 式 是 成立的。 ,βj* = 1 ,βj由矩阵对策的 结 果已 知 , ( 14 -55 ) 式 一 般并不成立 , 即对策 G = { S1 , S2 ; H }在纯 策 略意义下无解。 同矩 阵对 策 中引 入混 合 策图 14 -4略的做法类似 , 也可定义无限对策的混合策 略如下 : 局 中 人Ⅰ 和 Ⅱ 的 混合 策 略 X 和 Y 分别为策略集 S1 和 S2 上的概率分布 ( 或分布函数 ) , 混合策略集记 为 X 和 Y。 若用 于 x , y 表示纯策略 , FX ( x ) , FY ( y ) 表示混 合策 略 X , Y 的分 布 , 则局中 人 I 的赢 得函 数可 以 有以下 4 种形式 :H ( x, y) H ( X , y) =∫SH ( x , y ) d FX ( x )1H ( x, Y ) =∫S2H ( x, y) d FY ( y)H ( X , Y ) =∫S∫S12H ( x, y) d FX ( x) FY ( y)定义 7 如果有sup Xinf YH ( X , Y ) = infYsup XH ( X , Y ) = V G( 14 -57)则称 VG 为对策 G 的值 , 称使 ( 14 -57) 式成立的 ( X * , Y * ) 为对策 G 的解 , X * 和 Y * 分别 为 局中人Ⅰ和Ⅱ的最优策略。定理 13 ( X *, Y * ) 为对策 G = { S1 , S2 ; H}的解的充要条件是 : 对任意 X∈ X , Y∈ Y ,有H ( X , Y * ) ≤ H ( X *, Y * ) ≤ H ( X *( 14 -58) 当 S1 = S2 = [ 0 , 1] , 且 H ( x , y ) 为连续函 数时 , 称这样 的对策 为连续 对策。对 连续 对 策而言 , 局中人Ⅰ、Ⅱ的混合策略即为 [0 , 1 ] 区间上的分布函数。记 [ 0 , 1] 区间上的分布函 数的集合为 D, 则有, Y )0∫1 H ( X , Y ) =∫10H ( x , y) d FX ( x ) d FY ( y )对连续对策 , 记v1 = m ax X∈ Dmin Y ∈ DH ( X, Y )v2 = min Y ∈ Dm ax X∈ DH ( X, Y )这里 , 不加证明地给出关于连续对策的基本定理。定理 14 对任何连续对策 , 一定有 v1 = v2 。 例 20 ( 生产能力分配问 题 ) 某公司下属甲、乙两个 工厂 , 分别位于 A、B 两市。 设 两厂总生产能力为 1 个单位 , 两市对工厂产品的总需 求也是 1 个单位。如 果 A 市的需 求·504·量为 x , 则 B 市的需求量为 1 - x, 这时 只要安 排 A 厂 的生 产能力 为 x , 就能 使供需 平衡。 但现在不知道 A 市的确切需求量 x 是多 少 , 如果 安排 A 厂的 生产能 力为 y , 则将 产生 供 需上的不平衡。不平衡的程度可用数值表示为maxx y,1 - x 1 - y公司的目标是选择 y, 使得max 0 ≤ x ≤ 1maxx y,1 - x 1 - y( 14 -59)达到极小。如果以市场需求为一方 , 公司为另一方 , 则以上问题可转化为一个连续对策问 题 , 其中S1 = S2 = [ 0 , 1] , H ( x, y ) = maxx y,1 - x 1 - y对这个对策求解的结果为 : 公司方的最优策略 ( 为纯策略 ) 是 y * = 1/ 2 , 即两个厂各生产一 半 ; 市场需求方的最优策略 ( 为混 合策 略 ) 是 : 分别 以 0. 5 的 概率 取 0 和 1 , 即 要么 全部 需 求都集中在 A 市 , 要么都集中在 B 市 , 且两种情况发生的概率相等。该 对策的 值为 V G = 2 , 即当公司和市场均选择各自的最优策略时 , 两市中需求大 于供给的 平均程 度为 2 ( 求 解 过程较复杂 , 略去 ) 。4. 2 多人非合作对策实际问题中 , 会经常出现多人对策的问题 , 且每个局中人的赢得函数之和也不必一定 为零 , 特别是许多经济过程中的对策模型一般都是非零和的 , 因为经济过程总是有新价值 的产生。所谓非合作对策 , 就是指局中人之间互不合作 , 对策略的选择不允许事先有任何 交换信息的行为 , 不允许订立任何约定 , 矩阵对策就是一种非合作对策。一般非合作对策 模型可描述为 :(1 ) 局中人集合 : I = {1 , 2 , … , n} ; (2 ) 每个局中人的策略集 : S1 , S2 , … , Sn ( 均为有限集 ) ; (3 ) 局势 : s= ( s1 , … , sn ) ∈ S1 ×…× Sn ;n(4 ) 每个局中人 i 的赢得函数记为 H i ( s) , 一般说来 , ∑H i ( s) ≠ 0。一个非合作 n 人i = 1对策一般用符号 G = { I , { Si } , { Hi }} 表示。为讨论非合作 n 人对策的平衡局势 , 引入记号s‖ s0i = ( s1 , … , si - 1 , s0i , si + 1 , … , sn )( 14 -60)它的含义是 : 在局势 s = ( s1 , … , sn ) 中 , 局中 人 i 将自己的策 略由 si 换成 s0 策略不变而得到的一个新局势。如果存在一个局势 s, 使得对任意 s0i , 其他局中 人的i ∈ si , 有H i ( s) ≥ H i ( s‖ s0 则称局势 s 对局中人 i 有利 , 也就是说 , 若局势 s 对局中人 i 有利 , 则不论局 中人 i 将自 己 的策略如何置 换 , 都不会得 到比在 局势 s 下更多 的赢得。显 然 , 在非合作 的条件 下 , 每 个 局中人都力图选择对自己最有利的局势。i )定义 8 如果局势 s 对所有的局中人都有利 , 即对任意 i∈ I , s0i ∈ Si , 有·604·H i ( s) ≥ H i ( s‖ s0i ) 则称 s 为非合作对策 G 的一个平衡局势 ( 或平衡点 ) 。 ,βj 当 G 为二人零和对策时 , 上述定义等价为 : (αi( 14 -61)) 为平衡局势的 充要条件 是 : 对 任意 i, j , 有ai j * ≤ ai * j * ≤ ai * j( 14 -62)此与前关于矩阵对策平衡局势的定义是一致的。由矩阵对策的结果可知 , 非合 作 n 人对 策在 纯策 略 意义 下的 平衡 局 势不 一 定 存在。 因此 , 需要考虑局中人的混合 策略。对 每个 局中 人的策 略集 Si , 令 S * i 为定 义在 S i 上 的 混合策略集 ( 即 Si 上所 有概 率分布 的集 合 ) , xi 表示 局中 人 i 的 一个 混合策 略 , x = ( x1 , … , xn ) 为一个混合局势x‖ zi = ( x1 , … , x i - 1 , zi , xi + 1 , … , xn ) 表示局中人 i 在局势 x 下 , 将自己的策略由 xi 置换成 z i 而得到的一个新的混合局势。以 下 , 记 Ei ( x) 为局中人 i 在混合局势 x 下的赢得期望值 , 则有以 下关于 非合作 n 人对策 解 的定义。定义 9 若对任意 i∈ I, zi ∈ S *, 有 E i ( x‖ zi ) ≤ Ei ( x )则称 x 为非合作 n 人对策 G 的一个平衡局势 ( 或平衡点 ) 。对非合作 n 人对策 , 已经得到了一个非常重要的结论———定理 15。 定理 15 ( 纳什 ( Nash ) 定理 ) 非合作 n 人对策 在混 合策 略意义 下的 平衡局 势一 定存在。具体到二人有限非零和对策 ( 亦称为双矩阵对策 ) , 纳什定理的结论可表述为 : 一定存在 x * ∈ S *1, y * ∈ S *2, 使得x * T A y * ≥ xT A y * x * T B y * ≥ x * T B y *x∈ S * y∈ S *1( 14 -64) 和矩阵对策所不同的是 , 双矩阵对策以及一般 非合作 n 人 对策 平衡点 的计 算问题 还远 没 有解决。但对 2×2 双矩阵对策 , 可得到如下结 果 : 设 双矩 阵对 策中两 局中 人的赢 得矩 阵 分别为2( 14 -63)A =a11a21a1 2a2 2B =b1 1b2 1b1 2b2 2分别记局中人Ⅰ和Ⅱ的混合策略为 ( x, 1 - x ) 和 ( y, 1 - y ) , 由 ( 14 -63 ) 式和 ( 14 -64 ) 式 , 局 势 ( x, y) 的对策平衡点的充要条件是E1 ( x, y ) ≥ E1 (1 , y ) E1 ( x, y ) ≥ E1 (0 , y ) E2 ( x, y) ≥ E2 ( x, 1 ) E2 ( x, y) ≥ E2 ( x, 0 )( 14 -65)( 14 -66)( 14 -67)( 14 -68)由 (14 -65) 式 , ( 14 -66) 式 , 有Q( 1 - x) y - q( 1 - x) ≤ 0 Q x y - qx≥0( 14 -69)( 14 -70)其中 Q = a11 + a22 - a21 - a12 , q = a2 2 - a1 2 , 对 (14 -69 ) 式 , (14 -70 ) 式求解 , 得到·704·(1 ) 当 Q = 0 , q = 0 时 , (2 ) 当 Q = 0 , q > 0 时 , (3 ) 当 Q = 0 , q < 0 时 , (4 ) 当 Q≠0 时 , 记 q/ Q = a, 有0≤ x≤1 0≤ y≤1 x = 0 0≤ y≤1 x = 1 0≤ y≤1x = 00 < x < 1x = 1y≤α y =α y≥α类似地 , 由 ( 14 -67 ) 式和 ( 14 -68) 式 , 有R x (1 - y) - r( 1 - y ) ≤0 R x y - ry≥ 0其中 R = b1 1 + b2 2 - b2 1 - b12 , r = b22 - b21 , 对 ( 14 -71) 式 , ( 14 -72 ) 式求解 , 得到 0≤ x≤1 0≤ y≤1 0≤ x≤1 y = 0 0≤ x≤1 y = 1(1 ) 当 R = 0 , r = 0 时 , (2 ) 当 R = 0 , r > 0 时 , (3 ) 当 R = 0 , r < 0 时 , (4 ) 当 R≠ 0 时 , 记 r/ R = β, 有x≤β y = 0 x = β 0 < y < 1 x≥β y = 1例 21 求解 2 ×2 双矩阵对策 , 其中21B =A =11 解 由上面关于 2×2 双矩阵对策解的讨论 , 可知1112Q = 5 > 0 q = 2 α= q/ Q = 2/ 5 R = 5 > 0 r = 3 β= r/ R = 3/ 5将这些结果代入双矩阵对策解的公式 , 得到x = 0y≤2/ 50 < x < 1x = 1 x≤3/ 5y = 2/ 5 y≥2/ 5y = 0x = 3/ 5 x≥3/ 50 < y < 1y = 1解不等式 (14 -73) 式和 (14 -74 ) 式 , 得到对策的 3 个平衡点。3 5 不等式组 (14 -73 ) 的解在图 14 -5 中以粗线 表示 , 不 等式组 ( 14 -74 ) 的解 以虚线 表示 ,2 5( x, y) = (0 , 0 ) ,,, ( 1 , 1)粗线与虚线的 3 个交点即为对策的 3 个平衡点。 由E1 ( x, y) = 5 x y - 2( x + y) + 1E2 ( x, y) = 5 x y - 3( x + y) + 2·804·( 14 -71)( 14 -72)( 14 -73)( 14 -74)( 14 -75)( 14 -76)可得E13 5,2 5= E23 5,2 5=1 5( 14 -77)E1 (0 , 0 ) = 1 ,E1 (1 , 1 ) = 2( 14 -78)E2 (0 , 0 ) = 2 ,( 14 -79) 不难发现 , 在平衡点 (0 , 0 ) 和 ( 1 , 1) 处 , 两 个局中人 的 期望收益都比在平衡点 ( 3/ 5 , 2/ 5) 的期望收 益要好。 但由于这是一 个非 合作 对策 , 不允 许在 选 择策 略 前 进行协商 , 所以两 个局 中人 没 有办 法保 证 一定 能 达 到平衡局势 ( 0 , 0 ) 或 ( 1 , 1 ) 。 因而 , 尽 管 这个 对策 有 3 个平衡点 , 但哪 一 个 平衡 点 作 为 对 策的 解 都 是 难 以令人信服的。E2 (1 , 1 ) = 1对“ 囚犯的难 题”的 例题 ( 见本 章 例 5 ) , 不 难 得到两个囚犯的赢得矩阵分别为图 14 -5A =7901, B =7091( 14 -80)由Q = 1 > 0 q = - 1 α= q/ Q = - 1 R = 1 > 0 r = - 1 β= r/ R = - 1 不难确定该对策问题的唯一平衡点 ( x, y ) = ( 1 , 1 ) , 即 两个 人 都承 认犯 罪 , 所 得支 付为 各 判刑 7 年。从赢得矩阵 (14 -80) 式来看 , 这个平衡局势显然不是最有利的。如果两人都不 承认犯罪 , 得到的赢得都是 - 1 , 相当于各 判刑 1 年 , 这才 是最 有利的 结果。 但是 , 在非 合 作的条件下 , 这个最有利的结局也是难以达到的。4. 3 合作对策由于非合作对策模型在适用性和理论上存在 的局 限性 , 使 人们开 始研 究合作 对策 问 题。合作对策的基本特征是参加对策的局中人可以进行充分的合作 , 即可以事先商定好 , 把各自的策略协调起来 ; 可以在对策后对所 得到 的支付 进行 重新 分配。合 作的形 式是 所 有局中人可以形成若干联盟 , 每个局中人仅参加一个联盟 , 联盟的所得要在联盟的所有成 员中进行重新分配。一般说来 , 合作可以提高联盟的所得 , 因而也可以提高每个联盟成员 的所得。但联盟能否形成以及形成哪种联盟 , 或者说 一个 局中 人是否 参加 联盟以 及参 加 哪个联盟 , 不仅取决于对策的规则 , 更取决于联盟获得的所得如何在成员间进行合理的重 新分配。如果分配方案不合理 , 就可能破坏联盟的形成 , 以至于不能形成有效的联盟。因 此 , 在合作对策中 , 每个局中人如何选择自己的 策略已 经不 是要研 究的 主要 问题了 , 应 当 强调的是如何形成联盟 , 以及联盟的所得如何被合理分配 ( 即如何维持联盟 ) 。合作对策研究问题重点的转变 , 使得合作对策的模型、解的概念都和非合作对策问题 有很大的不同。具体来说 , 构成 合作 对策 的 两个 基本 要素 是 : 局 中人 集 合 I 和 特征 函 数 v ( S) , 其中 I = {1 , 2 , … , n} , S 为 I 的任一子集 , 也就是任何一个可能形成的 联盟 , v( S) 表 示联盟 S 在对策中的所得。合作对策的可行解是一个满足下列条件的 n 维向量 x = ( x1 , x2 , … , xn ) :·904·xi ≥ v( { i} )i = 1 , … , nn∑xi = v( I)i = 1将满足 (14 -81) 式和 (14 -82 ) 式的向量 x 称 为一个分 配。合作对 策研究 的核 心问题 就是 : 如何定义“最优的”分配 ? 是否存在“最优的”分配 ? 怎样去求解“最优的”分配 ? 鉴于对合 作对策的系统阐述需要较多的数学知识和学时 , 超出了本书的基本要求 , 故不再作详细介 绍 , 下面通过一个例子来说明合作对策的意义。例 22 ( 产品定价问题 ) 设有两家厂商 ( 厂商 1 , 厂商 2 ) 为 同一市 场生产同 样产品 ,可选择的竞争策略是价格 , 目的是赚得最多的利润。已知两个厂商的需求函数为Q1 = 12 - 2 P1 + P2( 14 -84) Q2 = 12 - 2 P2 + P1 其中 P1 , P2 分别为两个厂商的价 格 , Q1 , Q2 分 别为 市场 对 两个 厂商 产品 的需 求 量 ( 实 际 销售量 ) ; 又知 , 两家厂商的固定成本均为 20 元。于是 , 厂商 1 的利润函数为 π1 = P1 Q1 - 20 = 12 P1 - 2 P21 + P1 P2 - 20为求厂商 1 利润最大化时的价格 , 令 dπ1 d P1= 12 - 4 P1 + P2 = 0得到P1 = 3 +1 4P2(14 -87 ) 式称为厂商 1 对厂商 2 的价格的反 应函数 ; 同 理 , 可得 到厂商 2 对 厂商 1 的价 格 的反应函数为P2 = 3 +1 4P1由图 14 -6 可以看出 , 如果两个厂商互不合作 , 各自从自身利润最大化出发 , 最稳妥的策略 显然是都选择“定价 4 元”, 也就是实现纳 什均 衡 , 各自可 以得 到 12 元的 利润。但 我们 发 现 , 如果两个厂商合作起来 , 都选择“定价 6 元”, 则 双方 都可 以赚得 16 元的 利润 , 显然 比 不合作时要好。因此 , 两个厂商可以结成一 个“ 价格 联盟”, 统一把 价格 定在 6 元 , 形成 一 个合作均衡 , 争取一个双赢的结果。图 14 -6 产品定价问题中的纳什均衡和合作均衡·014·( 14 -81)( 14 -82)( 14 -83)( 14 -85)( 14 -86)( 14 -87)( 14 -88)图 14 -7但如 果厂 商 1 遵守 价格联 盟达 成的 合作 协 议 , 把价格定在 6 元 , 而厂商 2 却违反合 作协议 , 将价格 定在 4 元 ( 即厂商 1 合 作 , 而厂 商 2 不 合 作 ) , 则厂商 1 的利润只有 4 元 , 而厂商 2 的利 润 却可以达到 20 元 , 如图 14 -7 所示。这就给两个厂商带来了一个定价难题 : 到底采取哪个价格 ? 一方面 ,“合作”的前景很 诱人 , 但各厂商都担心 , 如果竞争对手不合作 怎么办 ? 而现 实当中 , 一 些厂 商的确 存在 为 了自身利益而违背市场竞争规则、与竞争对手进行削价竞争的冲动。不难看出 , 定价问题 实际上正是“囚犯难题”在微观经济学中的一 个实例。 目前 ,“ 囚犯 难题”的 模型已 被应 用 于经济学、社会学、心理学、伦理学、政治学等众 多领域 , 充 分说 明由此 模型 而引出 的合 作 对策模型具有十分广泛的适应性和应用背景。习题14. 1 甲、乙两个儿童玩游戏 , 双方可分别出拳头 ( 代表石头 ) 、手掌 ( 代表布 ) 、两个手 指 ( 代表剪刀 ) , 规则是 : 剪刀赢布 , 布赢石 头 , 石头赢 剪刀 , 赢 者得 一分。若 双方所 出相 同 算和局 , 均不得分。试列出儿童甲的赢得矩阵。14. 2 “二指莫拉问题”。甲、乙二人游戏 , 每 人出 一个 或两个 手指 , 同 时又把 猜测 对 方所出的指数叫出来。如果只有一个人猜测正确 , 则 他所 赢得 的数目 为二 人所出 指数 之 和 , 否则重新开始 , 写出该对策中各局中人的策 略集合 及甲 的赢得 矩阵 , 并 回答局 中人 是 否存在某种出法比其他出法更为有利。14. 3 求解下列矩阵对策 , 其中赢得矩阵 A 分别为2124221(1 )148( 2)3445232163198071226547642232343( 4)(3 )835442651212363 14. 4 证明本章 2. 1 节中的性质 1 和性质 2。 14. 5 甲、乙两个企业生产同一种电子产品 , 两个企业都想通过改革管理获取更多的3254市场销售份额。甲企业的策略措施有 : ① 降低产品价格 ; ② 提高产品质量 , 延长保修年限 ; ③ 推出新产品。乙企业考虑的措施有 : ① 增加广告费用 ; ② 增设维修网点 , 扩大维修服务 ; ③ 改进产品性能。假定市场份额一定 , 由于各自采取的策略 措施 不同 , 通 过预测 , 今 后两 个企业 的市 场 占有份额变动情况如表 14 -5 所示 ( 正值为甲企 业增加 的市 场占有 份额 , 负 值为减 少的 市·114·场占有份额 ) 。试通过对策分析 , 确定两个企业各自的最优策略。表 14 -5乙企业策略甲企业策略123110132121053685( y *14. 6 证明本章中的定理 2。 14. 7 证明本章中的定理 4。 14. 8 证明本章中的定理 7、定理 8 和定理 9 。 14. 9 设 G 为 2 × 2 对 策 , 且 不 存 在 鞍 点。 证 明 若 x * = ( x * , y * 214. 6 证明本章中的定理 2。 14. 7 证明本章中的定理 4。 14. 8 证明本章中的定理 7、定理 8 和定理 9 。 14. 9 设 G 为 2 × 2 对 策 , 且 不 存 在 鞍 点。 证 明 若 x * = ( x * , y * 2) T 和 y * =x * i > 0 y * j > 0i = 1 , 2j = 1 , 214. 10 *证明 : 矩阵对策A =a11a21a12a22的鞍点不存在 的 充 要 条 件 是 有 一条 对 角 线 的 每 一 个 元 素 均 大 于 另 一 对 角 线 上 的 每 一元素。14. 11 *推导 2×2 对策的 求解 公 式 ( 14 -25) 式 ～ ( 14 -29 ) 式 , 并 由习 题 14. 10 的 结果证明习题 14. 9。14. 12 设 m× m 对策的矩阵为a11a12 … a1 mA =a22 … a2 m ⁝a21⁝ ⁝am1am2 … am m其中当 i≠ j 时 , ai j = 1 , 当 i = j 时 , aii = - 1 , 证明此对策的最优策略为x * = y * = ( 1/ m, 1/ m, … , 1/ m) TV G =m - 2 m14. 13 利用优超原则求解下列矩阵对策(1 ) A =1120042430214131( 2) A =3574640360029883557809963·214·À"(cid:5)Ù×4"Ù×"4Ù×"414. 14 利用图解法求解下列矩阵对策 , 其中 A 为(1 )22324326( 2)567708645423(3 )40 14. 15 已知矩阵对策212( 4)1835112400A =008060的解为 x * = ( 6/ 13 , 3/ 13 , 4/ 13 ) T , y * = ( 6/ 13 , 4/ 13 , 3/ 13) T , 对策 值为 24/ 13。 求下列 矩 阵对策的解 , 其赢得矩阵 A 分别为622222322020(1 )2210( 2)622( 3)20204428224220382014. 16 用线性规划方法求解下列矩阵对策 , 其中 A 为824202(1 )266( 2)031644121参 考 资 料[1] 中国科学院数学研究所第二室 . 对策论 ( 博弈论 ) 讲义 . 北京 : 人民教育出版社 , 1960[2] J. 麦克金赛 , 高鸿勋 , 曾鼎 , 王厦生译 . 博弈论导引 . 北京 : 人民教育出版社 , 1960[3] 张盛开 . 对策论及其应用 . 武汉 : 华中工学院出版社 , 1985[4] O wen G .Game T heory . Academic Pr ess , 1982·314·十、决 策 论决策是人们在政治、经济、技术以及日常生活中普遍遇到的一种选择方案的行为。其困难是如何从多种方案中作出正确的选择 , 以便 获得好 的结 果或 达到预 期的 目标。管 理 国家、企业时刻都遇到大大小小的决 策问题。 诺贝 尔奖金 获得 者西 蒙 ( A .Simon ) 有一 句 名言 :“ 管理就是决策。”就是说管理的核心是决策。决策的失误是最大的失误。将会造成 巨大的损失 ( 政治的、经济的…… ) 。人们 必须 冥思苦 想地 学会 正确的 决策。 决策 是由 直 观经验决策发展到科学 民主 的决 策。将 现代 科学 技 术和 现代 文明 的成 就 应用 于研 究 决策 , 称为决策科学。决策科学是在研究决策活动基本规律的基础上 , 总结出一套进行决策 必须遵循的原则、规则、程序、方法和技术。研究决策的问题包括 : 决策的基本原理、决策 的程 序、决策的 信息、决 策的 方法 ( 定 量 与定性的方法 ) 、决策的风险、决策中的人因素、决策的思维方式、决策的组织、决策的实施 等。决策科学包括的内容十分广泛 : 涉及社会学、决策心理学、决策行为学、决策的量化方 法和评价、决策支持系统和决策自动化等多学科和多领域的综合应用。近十年来 , 决策科学的研究发展很快 , 在单人单目标决策、单人多目标决策方面 , 特别 是群决策方面 ( 群决策或群体决策是指参与 决策的 人数多 于一 人的 决策行 为 ) , 引 起理 论 工作者与实践工作者的广泛关注。这里仅从运筹学中的定量分析方法的角度向读者作入门的介绍。第 15 章 单目标决策第 1 节 决策的分类从不同的角度出发可得不同的决策分类。1. 按性质的重要性分类可将决策分为战略决策、策略决策和执行决策 , 或叫战略计划、管理控制和运行控制。 战略决策是涉及某组织发展和生存有关的 全局 性、长远问 题的 决策 , 如 厂址的 选择、新产品开发方向、新市场的开发、原料供应地的选择等。策略决策是为完成战略决策所规定的目的而 进行 的决 策 , 如对一 个企 业产品 规格 的选择、工艺方案和设备的选择、厂区和车间内工艺路线的布置等。执行决策是根据策略决策的要求对执行行为 方案 的选 择 , 如生产 中产 品合格 标准 的选择、日常生产调度的决策等。·414·2. 按决策的结构分类分为程序决策和非程序决策。程序决策是一种有章可循的决策 , 一般是可重复的。 非程序决策一般是无章可 循 的决 策 , 只能 凭 经验 直觉 作出 应 变的 决 策 , 一 般是 一 次性的。由于决策的结构不同 , 解决问题的方式也不同 , 现归纳于表 15 -1 。表 15 -1解决问题的方式程 序 决 策非程序决策传统方式习惯 , 标准规程直观判断 , 创造性观察 , 选拔人才现代方式运筹学 , 管理信息系统培训决策者 , 人工智能 , 专家系统3. 按定量和定性分类分为定量决策和定性决策 , 描述决策对象的指标都可以量化时可用定量决策 , 否则只能用定性决策。总的发展趋势是尽可能地把决策问题量化。4. 按决策环境分类可将决策问题分为确定型的、风险型的 和不 确定型 的三 种。确定 型的 决策是 指决 策环境是完全确定的 , 作出的选择的结果也是 确定 的。风险 型决 策是指 决策 的环境 不是 完 全确定的 , 而其发生的概率是已知的。不确定 型决策 是指 决策 者对将 发生 结果的 概率 一 无所知 , 只能凭决策者的主观倾向进行决策。5. 按决策过程的连续性分类可分为单项决策和序贯 决 策。单项 决策 是 指整 个决 策过 程只 作 一 次决 策 就得 到 结果 , 序贯决策是指整个决策过程由一系列决策组成 , 一般讲管理活动是由一系列决策组成 的 , 但在这一系列决策中往往有几个关键环节要作决策 , 可以把这些关键的决策分别看作 单项决策。第 2 节 决 策 过 程构造人们决策行为的模型主要有两种方法 : 一种是面向决策结果的方法 ; 另一种是面向决策过程的方法。面向决策结果的方法认为 : 若决策者能正确地预见到决策结果 , 其核心是决策的结果和正确的预测。通常的单目标和多目标决策是属这类型的。面向决策过程的方法认为 : 若决策者了解 了决 策过程 , 掌握了 过程 和能控 制过 程 , 他就能正确地预见决策的结果。对于面向决策结果的方法的程序比较简单 , 见图 15 -1。·514·图 15 -1由图 15 -1 可知 , 任何决策都有一个过程 和程序 , 绝 非决 策者 灵机一 动拍 板就行。 面向决策过程的方法一般包括预决策→决策→决策后三个互相依赖的阶段。预决策阶段是指当要决策的问题摆在决策者 面前 时 , 决策 者能立 即想 到各种 可能 方 案 , 并意识到没有理想方案时 , 就会产生矛盾。他 开始 企图 寻找减 少矛 盾的方 案 , 沿着 这 企图扩大线索时 , 就需要收集信息。收集信息 时开 始时比 较客 观 , 无倾 向性 , 以后 逐渐 变 得主观和有倾向了。当预决策进行得较顺利 , 可以进行局部决策。决策阶段可分为分部决策和最终决策两个阶段。分部决策包括对决策处境作方向性的调整 , 如排除劣解 , 重新考虑已放弃的方案 , 增 加和去 掉一 些评 价准则。 在合并 一些 方 案后 , 减少了变量数和方案数 , 决策者按主观倾 向重新 估价 各方案 , 并 保留 倾向的 少数 方 案 , 以便进行最终决策。决策后阶段 , 当进行了最终决策 , 这时主要考虑的问题是决策后看法不一致。这时决 策者倾向于解释和强调已选方案的优点 , 并寻 找更多 的信 息来 证明已 选方 案的优 点和 正 确性。应克服愿听取相同意见、不愿听取不 同意 见的现 象。决 策后阶 段要 对决策 实施 进行了解 , 这是十分重要的 , 决策实施是决策的继 续 , 决 策后 阶段 往往也 是下 次决策 的预 决 策阶段。任何决策问题都有以下要素构成决策模型 : (1 ) 决策者 , 他的任务是进行决策。决策者可以是个人、委员 会或某个 组织。一般 指领导者或领导集体。(2 ) 可供选择的方案 ( 替代 方案 ) 、行动 或策略。 参谋人 员的 任务 是为决 策者 提供 各种可行方案。这里包括了解研究对象的属性 , 确定目的和目标。属性是指研究对象的特性 , 它们是客观存 在的 , 是 可以 客观量 度的 , 并 由决策 者主 观选定的 , 如选拔飞行员时 , 按身高、年龄、健康状况等数值来表明其属性。目的是表明选择属性的方向 , 如要优秀还是良好 , 反映了决策者的要求和愿望。 目标是给出了参数值的目的 , 如目的是选择一种省油的汽车时 , 那么以每公升能行驶60 公里为目标。(3 ) 准则是衡量选择方案 , 包 括目的、目 标、属性、正确 性的 标准 , 在决 策 时有 单一 准则和多准则。(4 ) 事件是指不为决策者所控制的客观存在的将发生的状态。 (5 ) 每一事件的发生将会产生某种结果 , 如获得收益或损失。 (6 ) 决策者的价值观 , 如决策者对货币额或不同风险程度的主观价值观念。 确定型的决策是指不包含有随机因素的决策 问题 , 每 个决 策都会 得到 一个唯 一的 事 先可知的结果。从决策论的 观 点来 看 , 前几 章 讨论 的规 划论 等都 是 确定 型的 决 策 问题。 本章讨论的决策问题都是具有不确定因素和有风险的决策。·614·第 3 节 不确定型的决策所谓不确定型的决策是指决策者对环境情况一无所知。这时决策者是根据自己的主观倾向进行决策 , 由决策者的主观态度不同 基本可 分为 四种 准则 : 悲观 主义 准则、乐观 主 义准则、等可能性准则、最小机会准则。以下用例子分别说明之。例 1 设某工厂是按批生产某 产品 并按批 销售 , 每件 产品 的成 本为 30 元 , 批 发价 格 为每件 35 元。若每月生 产的 产品 当月 销售 不 完 , 则每 件损 失 1 元。 工 厂每 投 产一 批 是 10 件 , 最大月生产能力是 40 件 , 决策者可选择的生产方案为 0、10、20、30、40 五种。假 设 决策者对其产品的需求情况一无所知 , 试问这时决策者应如何决策 ?这个问题可用决策矩阵来描述。决策者可选的行动方案有五种 , 这是他的策略集合 , 记作{ Si } , i = 1 , 2 , … , 5。 经分 析他可 断定 将发生 五种 销售 情况 : 即 销量 为 0 , 10 , 20 , 30 , 40 , 但不知它们发生的概率。这就是事件集合 , 记 作 { E j } , j = 1 , 2 , … , 5。每 个“策 略—事 件”对都可以计算出相应的收益值或损失值。如当选择 月产量为 20 件时 , 而销出量 为 10 件 , 这时收益额为10× ( 35 - 30 ) - 1× (20 - 10) = 40 ( 元 ) 可以一一计算出各“策略—事件”对应的收益值或损失值 , 记作 ai j 。将这些数 据汇总在 矩 阵中 , 见表 15 -2。表 15 -2Ej事 件S i010203040000000策101050505050202040100100100略3030309015015040402080140200这就是决策矩阵。根据决 策矩 阵中 元素 所示 的 含义 不 同 , 可 称为 收 益矩 阵、损 失 矩阵、风险矩阵、后悔值矩阵等。下面讨论决策者是如何应用决策准则进行决策的。3. 1 悲观主义 (max min)决策准则悲观主义决策准则亦称保守主义决策准则。当决策者面临着各事件的发生概率不清时 , 决策者考虑可能由于决策错误而造成重大经济损失。由于自己的经济实力比较脆弱 , 他在处理问题时就较谨慎。他分析各种最坏的可能结果 , 从中选择最好者 , 以它对应的策 略为决策策略 , 用符号表示为 max min 决策准则。在收益矩阵中先从各策略 所对应的 可 能发生的“策略—事件”对的结果中选出最小 值 , 将它们 列于 表的 最右列。 再从此 列的 数 值中选出最大者 , 以它对应的策略为决策者应选的决策策略。计算见表 15 -3。·714·3{–¨(cid:29){ð(cid:127)‘(cid:28)(cid:6){(cid:127)ð‘(cid:28)(cid:6)(cid:127)ð{‘(cid:28)(cid:6)(cid:127){ð‘(cid:6)(cid:28){ð(cid:127)‘(cid:28)(cid:6)表 15 -3E j事 件minS i0102030400000000← max策1010505050501020204010010010020略30303090150150304040208014020040根据 m ax min 决策准则有max ( 0 , - 10 , - 20 , - 30 , - 40) = 0 它对应的策略为 S1 , 即为决策 者应 选的策 略。在这 里是“什 么也 不生 产”, 这 结论 似乎 荒 谬 , 但在实际中表示先看一看 , 以后再作决定。上述计算用公式表示为 S * k → m ax min ( ai j )3. 2 乐观主义 (max max) 决策准则持乐观主义 ( max max) 决策准则 的决 策者对 待风 险的 态度与 悲观 主义者 不同 , 当 他 面临情况不明的策略问题时 , 他绝不放弃任何一个可获得最好结果的机会 , 以争取好中之 好的乐观态度来选择他的决策策略。决策者在分析收益矩阵各策略的“策略—事件”对的结果中选出最大者 , 记在表的最右列。再从该列数值中选择最大者 , 以它对应的策略为决 策策略 , 见表 15 -4。表 15 -4E j事 件maxS i0102030400000000策10105050505050202040100100100100略3030309015015015040402080140200200← max根据 m ax max 决策准则有m ax (0 , 50 , 100 , 150 , 200) = 200它对应的策略为 S5 。用公式表示为 S * k →m axm ax j( ai j )3. 3 等可能性 ( Laplace) 准则等可能性 ( Laplace) 准则是 19 世纪数学家 Laplace 提出的。他认为 : 当一个人面临着 某事件集合 , 在没有什么确切理由来说明这一事件比那一事件有更多发生机会时 , 只能认 ·814·ØîíîïÙíïîî(cid:30)Ù~íïîî(cid:30)Ù~ï(cid:4)(cid:5)(cid:5)(cid:30)Ù~îï(cid:5)(cid:4)(cid:30)Ù~ïî(cid:5)(cid:4)(cid:30)KÁ©z(cid:28)ÅÂÁ4c’(cid:5)ÅÂÁc4’(cid:5)ÅÂÁ4c’(cid:5)ÂÅÁc4’(cid:5)ÂÁ4c’(cid:5)为各事件发生的机会是均等的。 即每一 事件 发生 的概 率都 是 1/ 事 件 数。决 策者 计算 各 策略的收益期望值 , 然后在所有这些期望值 中选择 最大 者 , 以它对 应的 策略 为决策 策略 , 见表 15 -5 。然后按下式决定决策策略。S * k →m axi{ E( Si ) }表 15 -5S iEj010事 件203040E( Si ) = ∑jpai j0000000策1010505050503820204010010010064略30303090150150784040208014020080← ma x在本例中 P =1 5, 期望值E( si ) = ∑p ai jmax{ E( Si ) } = max{0 , 38 , 64 , 78 , 80} = 80它对应的策略 S5 为决策策略。3. 4 最小机会损失准则最小机会 损失决策 准则亦 称最小遗 憾值决策 准则或 Savage 决策准则。 首先将收 益 矩阵中各元素变换为每一“策略—事件”对的机会损失值 ( 遗憾值 , 后悔值 ) 。其含义是 : 当 某一事件发生后 , 由于决 策者 没 有选 用收 益最 大的 策 略 , 而形 成的 损 失值。 若发 生 k 事 件 , 各策略的收益为 aik , i = 1 , 2 , … , 5 , 其中最大者为ai k = maxi( ai k )这时各策略的机会损失值为a′i k = {maxi( ai k ) - ai k } , i = 1 , … , 5计算结果见表 15 -6表 15 -6E j事 件maxS i0102030400050100150200200策1010050100150150202010050100100略30302010050504040302010030← min·914·Á©Kz(cid:28)ÅÂÁ4c’(cid:5)ÂÁÅc4’(cid:5)ÁÂÅc4’(cid:5)ÂÁÅ4c’(cid:5)ÁÂ4c’(cid:5)©ÁKz(cid:28)©ÁÂbó3‘ÁÂ©ób3‘ÂÁ©bó3‘Â©Á3ób‘ÁÂ©3b‘从所有最大机会损失值中选取最小者 , 它对应的策略为决策策略。用公式表示为 :S * k → minim ax ja′i j本例的决策策略为min (200 , 150 , 100 , 50 , 30 ) = 30→ S5在分析产品废品率时 , 应用本决策准则就比较方便。3. 5 折中主义准则当用 min m ax 决策准则或 m ax max 决 策准 则来 处理问 题时 , 有 的决 策 者认 为这 样 太极端了。于是提出把这两种决策准则给予综合 , 令 a 为乐 观系数 , 且 0 ≤ a≤ 1。并用 以 下关系式表示H i = aaim ax + (1 - a) aimin分别表示第 i 个策略可能得到的 最大 收益值 与最 小收益 值。设 a = 1/ 3 , 将计 算m ax , ai ai 得的 H i 值记在表 15 -7 的右端。min然后选择S * k → maxi{ H i }本例的决策策略为m ax (0 , 10 , 20 , 30 , 40 ) = 40→ S5表 15 -7E j事 件HiS i0102030400000000策1010505050501020204010010010020略30303090150150304040208014020040← max在不确定性决策中是因人因地因时选择决策 准则 的 , 但在 实际中 当决 策者面 临不 确 定性决策问题时 , 他首先是获取有关各事件发生的信息 , 使不确定性决策问题转化为风险 决策 , 风险决策将是讨论的重点。第 4 节 风 险 决 策风险决策是指决策者对客观情况不甚了 解 , 但对将 发生 各事 件的概 率是 已知的。 决 策者往往通过调查 , 根据过去的经验或主观 估计 等途径 获得 这些 概率。在 风险决 策中 一 般采用期望值作为决策准则 , 常用的有最大期望收益决策准则和最小机会损失决策准则。4. 1 最大期望收益决策准则 (expected monetary value, EMV)决策矩阵的各元素代表“策略—事件”对的收益值 , 各事件发生的概率为 pj 先计算 各·024·ÁÁÜÂ4c’(cid:5)ÁÂÜ4c’(cid:5)ÜÂÁ4c’(cid:5)ÜÁÂc4’(cid:5)ÂÁc4’(cid:5)策略的期望收益值 :∑p J ai j ,i = 1 , 2 , … , n然后从这些期望收益值中选取最大者 , 它对应的策略为决策应选策略。即i ∑ maxjp j ai j → S *k以例 1 的数据进行计算 , 见表 15 -8表 15 -8Ej事 件Sip j00. 1100. 2200. 4300. 2400. 1EMV0000000策1010505050504420204010010010076略3030309015015084← max4040208014020080这时m ax (0 , 44 , 76 , 84 , 80 ) = 84→ S4即选择策略 S4 = 30EM V 决策准则适用于一次 决策 多次 重 复进 行生 产的 情况 , 所 以 它是 平均 意义 下 的最大收益。4. 2 最小机会损失决策准则 (expected opportunity loss, EOL)矩阵的各元素代表“策略—事件”对的 机会 损失 值 , 各 事件 发生 的 概率 为 pj , 先计 算各策略的期望损失值。∑p j a′i j ,i = 1 , 2 , … , n然后从这些期望损失值中选取最小者 , 它对应的策略应是决策者所选策略。即 ( ∑p j a′i j ) → S *min ikj表上运算与上述相似。4. 3 EMV 与 EOL 决策准则的关系从本质上讲 E M V 与 EO L 决策准则是一样的。 设 ai j 为决策矩阵的收益值。因为当发生的事件的所需量等于所选策略的生 产量时 , 收益值最大 , 即在收益矩阵的对角线上的值 都是 其所在 列中 的最 大者。于 是机会 损失 矩 阵可通过以下求得 , 见表 15 -9。·124·ÁÂ·dY(cid:6)û5*“ˆÅÁÂc4’(cid:5)ÂÁÅ4c’(cid:5)ÅÂÁ4c’(cid:5)ÁÂc4’(cid:5)ÂÅÁc4’(cid:5)表 15 -9SiEj pjE1p1E2p2……EnpnS1a11 - a11a22 - a12ann - a1nS2a11 - a21a22 - a22ann - a2n⁝⁝⁝…⁝Sna11 - an1a22 - an2an n - ann第 i 策略的机会损失 :EOL i = p1 ( a11 - a1 i ) + p2 ( a2 2 - a2 i ) + … + p n ( an n - an i )= p1 a11 + p2 a2 2 + … + pn an n - ( p1 a1 i + p2 a2 i + … + pn an i ) = K - ( p1 a1 i + p2 a2 i + … + pn a n i )= K - EM V i故当 E M V 为最大时 , EO L 便为最小。所以在决 策时用这 两个决 策准 则所得 结果 是相同的。4. 4 全情报的价值 (EVPI)当决策者耗费了一定经费进行调研 , 获得 了各事 件发 生概率 的信 息 , 应采 用“ 随机 应 变”的战术。这时所得的期望 收益称 为全 情报 的期望 收 益记 作 EP PL。这 收 益应 当大 于 至少等于最大期望收益 , 即 EP PL≥ EM V * 。则EP PL - E MV * = E VPI 称为对全情报的价值。这就是说明获 取情 报的 费用不 能超 过 EV PI 值 , 否 则就没 有增 加 收入。实际应用时考虑费用构成很复杂 , 这里仅说明全情报价值的概念和其意义。4. 5 主观概率风险决策时决策者要估计各事件出现的概率 , 而 许多 决策 问题的 概率 不能通 过随 机 试验去确定 , 根本无法进行重复试验。如估计某企业倒闭的可能性 , 只能由决策者根据他 对这事件的了解去确定。这样确定的概率反映了 决策 者对 事件出 现的 信念程 度 , 称为 主 观概率。客观概率论者认为 概率 如 同重 量、容积、硬度 等一 样 , 是 研究 对 象的 物 理 属性。 而主观概率论者则认为概率是人们对现象的知识的现状的测度 , 而不是现象本身的测度 , 因此不是研究对象的物理属性。主观概率论者不 是主 观臆 造事件 发生 的概率 , 而 是依 赖 于对事件作周密的观察 , 去 获得 事前 信 息。事前 信息 愈 丰富 , 则 确定 的 主观 概 率就 愈 准 确。主观概率论者并不否认实践是第一性的观点。所以主观概率是进行决策的依据。确定主观概率时 , 一般采用专家估计法。1. 直接估计法直接估计法是要求参加估计者直接给出概率的估计方法。例如推荐三名大学生考研究生时 , 请五 位任 课教师 估计 他们 谁得第 一的 概率。若 各·224·ñ“LL任课教师作出如下的估计 , 见表 15 -10 。由表 15 -10 的末行得到学生 1 的概率是 0. 47 , 他 是最高者。表 15 -10教师代号权 数学 生 1学 生 2学 生 3∑10. 60. 6. 6 00. 120. 70. 4. 5 00. 130. 90. 5. 3 00. 240. 70. 6. 3 00. 150. 80. 2. 5 00. 31. 671. 310. 553. 53归一化后0. 470. 370. 1612. 间接估计法参加估计者通过排队或相互比较等间接途径给出概率的估计方法。例如估计五个球队 ( Ai , i = 1 , … , 5 ) 比赛谁得第一的问题 , 请十名专 家作出估 计 , 每 位都给出一个优胜顺序的排列名单 , 排队名单汇总在表 15 -11 。表 15 -11专家号名次12qj345评定者权数 wi1A2A5A1A3A40. 72A3A1A5A4A20. 83A5A3A2A1A40. 64A1A2A5A4A30. 75A5A2A1A3A40. 96A2A5A3A1A40. 87A5A1A3A2A40. 78A5A2A4A1A30. 99A2A1A5A4A30. 710A5A2A3A1A40. 8分别从表 15 -11 查得每队被排的名次的次数 , 如 A1 所处各名次的意见为 :qj次数 nj 评定权数 wi11w4 = 0. 723w2 = 0. 8 , w7 = 0. 7 , w9 = 0. 732w1 = 0. 7 , w5 = 0. 944w10 = 0. 8 , w3 = 0. 6 , w6 = 0. 8 , w8 = 0. 950·324·<T$Â·ªŸ’‡zo(cid:8)Â·ªŸzo’‡(cid:8)Â·ªŸ’‡zo(cid:8)Â·ªŸzo’‡(cid:8)ªŸÂ·’‡zo(cid:8)—ŒcX{p“ˆXpˆØÖØ××(cid:11)6òóóòñ(cid:11)6ñòòóó(cid:11)6óñóòò(cid:11)6óñóòò(cid:11)6óñòóò(cid:11)6òòóóñ(cid:11)6óñòóò(cid:11)6òñóòó(cid:11)6ñòóòóM(cid:11)òòñóó(cid:7)ú¾¢¼(cid:7)ú~¾¢¼(cid:7)ú¾¢&(cid:25)Û_(cid:157)¾¢¾¢然后计算加权平均数w( A1 ) =1 × w4 + 2 ( w2 + w7 + w9 ) + 3 ( w1 + w5 ) + 4 ( w3 + w6 + w8 + w1 0 ) ∑ wi= 3采用同样方法得到w( A2 ) = 2. 26 ; w( A3 ) = 3. 43 ; w( A4 ) = 4. 56 ; w( A5 ) = 1. 78这就可以按此加权平均数给出各队的估计名次 , 即A5 > A2 > A1 > A3 > A4下面再将各队的估计名次转换成概率 , 这 时需假 设各 队按 估计名 次出 现的概 率是 等可能的。 ( A5 → 1) 表示 A5 的估计名次为 1 , 其余类推。那么( A5 →1) ∶ ( A2 →2 ) ∶ ( A1 →3) ∶ ( A3 → 4) ∶ ( A4 →5 ) = 1∶ 1∶1∶ 1∶1因所有事件发生的概率和为 1 , 即∑p j = 1于是各队按估计名次出现的主观概率为P( A5 →1 ) = 1/ 5 ; P( A2 →2) = 1/ 5 ; P( A3 →4 ) = 1/ 5 ; P( A4 →5) = 1/ 5P( A1 →3 ) = 1/ 5当然决策者还可根据了解的情况 , 作其他的假设 , 这样就能得到另外的结果。4. 6 修正概率的方法———贝叶斯公式的应用前面曾提到决策者常常碰到的问题是没有掌 握充 分的 信息 , 于是 决策 者通过 调查 及 做试验等途径去获得更多的更确切的信息 , 以便掌握各事件发生的概率 , 这可以利用贝叶 斯公式来实现 , 它体 现了 最 大 限 度 的利 用 现 有 信 息 , 并 加 以 连续 观 察 和 重 新估 计 , 其 步 骤为 :① 先由过去的经验或专家估计获得将发生事件的事前 ( 先验 ) 概率。 ② 根据调查或试验计算得到条件概率 , 利用贝叶斯公式 :P( Bi | A) =P( Bi ) P( A | Bi ) ∑ P( Bi ) P( A | B i )i = 1 , 2 , … , n计算出各事件的事后 ( 后验 ) 概率。例 2 某钻探大队 在 某地 区 进 行 石 油勘 探 , 主观 估 计 该 地 区有 油 的 概 率 为 P( O) = 0. 5 ; 无油的概率为 P( D) = 0. 5。为了提高钻探的效果 , 先做地震试验。根据积累的资料 得 知 : 凡有 油 地 区 做 试 验 结 果 亦 好 的 概 率 为 P ( F | O) = 0. 9 ; 做 试 验 结 果 不 好 的 概 率 为 P( U | O) = 0. 1。凡无油地区做试验结果好的概率为 P( F| D) = 0. 2 ; 做 试验 结果不 好的 概 率为 P( U | D) = 0. 8。问在该地区做试验后 , 有油与无油的概率各是多少 ?解 先计算做地震试验好与不好的概率。 做地震试验好的概率P( F) = P( O) · P( F | O) + P( D) · P( F| D)= 0. 5×0. 9 + 0. 5×0. 2= 0. 55·424·做地震试验不好的概率P( U ) = P( O) · P( U | D) + P( D) · P( U | D) = 0. 5×0. 8 + 0. 5×0. 1 = 0. 45利用贝叶斯公式计算各事件的事后 ( 后验 ) 概率。 做地震试验好的条件下有油的概率P( O| F) =P( O) · P( F| O) P( F)=0. 45 0. 55=9 11做地震试验好的条件下无油的概率P( D | F) =P( D) · P( F | D) P( F)=0. 10 0. 55=2 11做地震试验不好的条件下有油的概率P( O| U ) =P( O) · P( U | O) P( U )=0. 05 0. 45=1 9做地震试验不好的条件下无油的概率P( D | U ) =P( D) · P( U | D) P( U )=0. 40 0. 45=8 9以上计算可在图 15 -2 上进行。图 15 -2例 3 某厂生产电子元件 , 每批的次品率的概 率分布 见表 15 -12 。该厂 不进行 100 %的检验 , 现抽样 20 件 , 次品为 1 件 , 试修订事前概率。表 15 -12次品率 p0. 020. 050. 100. 150. 20事前概率 p0 ( p)0. 40. 30. 150. 100. 05解 为了便于计算 , 将表 15 -12 的数据填入表 15 -13 的 (1 ) 、(2 ) 列中。·524·Á¶:/LA6+×ÌMBØÍ:/LA×Ì表 15 -13(1) 次品率( 2) 事前概率(3) 条件概率(4 )联合概率(5) 事后概率pP0 ( p)P( x = 1 | 20 , p)P( x = 1∩ p)P ( p | x = 1)0. 020. 40. 27250. 109000. 390300. 050. 30. 37740. 113190. 405310. 100. 150. 27010. 040520. 145090. 150. 100. 13680. 013680. 048990. 200. 050. 05770. 002880. 01031合计1. 00P( x = 1 ) = 0. 279271. 0000第 (3 ) 列的数字表示在次品率为 P 的母 体中 抽 20 个检 验 , 有 1 个 次品 的概 率 , 这 概率可用以下计算得到。因产品抽样检验的次品率是服从二项分布的 , 可得到P( x | n, p) =n ! x ! ( n - x ) !px q n - x可用 MS .Excel 计算或查表得到p( x = 1 | 20 , 0. 02) = 0. 2725p( x = 1 | 20 , 0. 05) = 0. 3774……第 (4 ) 列的数字是按 ( 4) = (2 ) × ( 3) 求得的。然后求P( x = 1 ) = ∑ P( x = 1 ∩ pi ) = 0. 27927事后概率按 (5 ) =( 4) 0. 27927求得。由以上两例可见 , 求修正概率时 , 可用树形图或表格计算。第 5 节 效用理论在决策中的应用5. 1 效用及效用曲线效用这概念首先是由贝努利 ( D. Berneulli ) 提出的 , 他 认为 人们对 其钱 财的真 实价 值的考虑与他的钱财拥有量之间有对数关系。 如图 15 -3 所 示 , 这 就是贝努利的货 币效 用函 数。经 济管 理学 家将 效 用作 为指 标 , 用它来衡量人 们 对 某 些事 物 的 主 观 价 值、态 度、偏 爱、倾 向 等。例如在风险情 况 下 进 行 决策 , 决 策 者对 风 险 的 态 度 是 不 同 的。 用效用这指标来量化 决 策者 对待 风险 的态 度 , 可 以给 每个 决 策 者测定他的对待风险的态度的效用曲线 ( 函数 ) 。效用 值是一 个 相对的指标值 , 一般可规定 : 凡对决策者最爱 好、最 倾向、最愿 意 的事物 ( 事件 ) 的效用值赋予 1 ; 而最不 爱好的 ……赋予 0。也 可 以用其他数值 范围 , 如 ( 100 ～ 0 ) 。这 如 同 水的 冰 点 可以 用 0 ℃ 表示或用 32℉ 表示 , 但效用 无量纲 指标。通过 效用这 指标可 将图 15 -3·624·MBMBñæ˜(cid:141){pMBMBñæ{p˜(cid:141)MBñæ6+{p˜(cid:141)MBñæ6+{p˜(cid:141)MBñæ6+{p˜(cid:141)YN6+£˜某些难于量化有质的差别的事物 ( 事件 ) 给予 量化。如 某人 面临多 种方 案的 选择工 作时 , 要考虑地点、工作性质、单位福利等等。可将要考虑的因素都折合为效用值。得到各方案的综合效用值 , 然后选择效用值最大的方案 , 这就是最大效用值决策准则。在风险情况下 , 只 作 一 次 决 策 时 , 再 用 最 大 期 望 值 决 策 准 则 , 就 不 那 么 合 理 了 , 如 表 15 -14是各方案及按最大收益期望值的计 算结 果。表 15 -14 的三 个方案 的 E MV 都 相 同 , 显然这三个方案并不是等 价的。另 一方面 因 E M V * 给 出 的是 平均 意义 下的 最 大 , 当 决策后只实现一次时 , 用 E MV * 决策准则就不恰当了。这时 可用最 大效用值 决策准则 来 解决这矛盾。表 15 -14EjE1E2E3E4Sipj0. 350. 350. 150. 15EM VA418. 3418. 36060275B650100650100275C483211. 34802672755. 2 效用曲线的确定确定效用曲线的基本方法有两种 , 一种是直接提问法 , 另一种是对比提问法。1. 直接提问法直接提问法是向决策者提出一系列问题 , 要 求决策 者进 行主 观衡量 并作 出回答。 例 如向某决策者提问 :“ 今年你企业获利 100 万 元 , 你 是满 意的 , 那么 获利 多少 , 你会 加倍 满 意 ?”若这决策者回答 200 万元。这样不断提问与 回答 , 可 绘制 出这决 策者 的获利 效用 曲 线。显然这种提问与回答是十分含糊的 , 很难确切 , 所以应用较少。2. 对比提问法设决策者面临两种可选方 案 A1 , A2 。 A1 表示 他可 无任 何风 险 地得 到一 笔金 额 x2 ;A2 表示他可以概率 p 得到一笔金额 x 1 , 或以概率 (1 - p) 损失金 额 x3 ; 且 x1 > x2 > x3 , 设 U ( x1 ) 表 示金 额 x1 的效 用值 , 若 在某 条件下 , 这 决策 者认 为 A1 、A2 两 方案 等价 时 , 可 表 示为p U( x1 ) + (1 - p) U( x3 ) = U( x2 ) (15 -1) 确切地讲 , 这决策者认为 x2 的效用值等价于 x1 , x3 的效用期望值。于是可用对比提问 法 来测定决策者的风险效用曲线。从式 (15 -1 ) 可 见 , 其 中有 x1 、x2 、x3 、p 四个 变量 , 若其 中 任意三个为已知时 , 向决策者提问第四个变 量应 取何值 ? 并请 决策者 作出 主观判 断第 四 个变量应取的值是多少。提问的方式大致有三种 :(1 ) 每次固定 x1 、x2 、x3 的值 , 改变 p , 问决策者 :“ p 取何值时 , 认为 A1 与 A2 等价”。 (2 ) 每次固定 p, x1 , x3 的值 , 改革 x2 , 问决策者 :“ x2 取何值时 , 认为 A1 与 A2 等价。” ( 3) 每次固定 p、x2 、x3 ( 或 x1 ) 的值 , 改变 x3 ( 或 x1 ) , 问决策者 :“ x3 ( 或 x1 ) 取何值时 ,·724·Á7e“LAßÔ±¦(cid:7)üÛLA¿í(cid:19)(cid:30)AÛ¿í(cid:19)LAÛ¿í(cid:19)认为 A1 与 A2 等价”。一般采用 改进的 V - M ( Von Neumann- Morgenste rn) 法。即每 次 取 p = 0. 5 , 固定 x1 、x3 利用0. 5 U ( x1 ) + 0. 5 U ( x3 ) = U ( x2 )改变 x2 三次 , 提三问 , 确定三点 , 即可绘出这决策者的效用曲线 , 下面用数字说明。设 x1 = 1000000 , x3 = - 500000 取 U (1000000 ) = 1 , U( - 500000 ) = 0(15 -2) 0. 5U ( x1 ) + 0. 5( x3 ) = U( x2 ) 第一问 :“ 你 认 为 x2 取 何 值 时 , 式 ( 15 -2 ) 成 立 ?”若 回 答 为“在 x2 = - 250000 时”, 那 么 U ( - 250000 ) = 0. 5 , 那 x2 的效用值为 0. 5。在坐标系中给出第一个点 , 见图 15 -3。利用 0. 5 U ( x1 ) + 0. 5( x2 ) = U ( x′2 )提第二问 ,“ 你认为 x′2 取何值时 , 式 (15 -3) 成立 ?”若回答为“在 x′2 = 75000 时”, 那么U ( 75000) = 0. 5×1 + 0. 5×0. 5 = 0. 75即 x′2 的效用值为 0. 75 , 在坐标系中给出第二个点。利用0. 5U ( x2 ) + 0. 5 U ( x3 ) = U ( x″2 ) (15 -4) 提第三问 ,“ 你认为 x″2 取何值时 , 式 (15 -4) 成立 ?”若回答为“在 x″2 = - 420 000 时”, 那么 U ( - 420 000) = 0. 5×0. 5 + 0. 5×0 = 0. 25 即 x″2 的效用值为 0. 25 , 在坐标系 中给出 第三 点。这就 可以 绘制 出这 决策 者 对风 险的 效 用曲线 , 见图 15 -4。 从以上向决策者提问 及回 答 的情 况来 看 , 不同 的 决 策者 会 选 择 不 同 的 x2 、x′2 、x″2 的 值 , 使 式 ( 15 -2 ) , 式 (15 -3 ) , 式 (15 -4) 成立。这 就 能得 到不 同形 状的 效 用 曲线 , 并表示了不同 决策 者对 待风 险的 不 同态 度。一 般 可分为 : 保守型、中间型、冒险 型三 种。其 对应 的曲 线 见 图 15 -5 。具有中间型效用曲线的决策 者 , 他认为 他的 收 入金额的增长与效用值 的增 长成 等比 关系 ; 具 有保 守 型 效用曲线的决策者 , 他认为他对损失金额愈多愈敏感 , 相 反地对收入的增加比较迟钝 , 即他不愿承受 损失的 风险 ; 具 有冒险 型效 用曲 线的决 策者 , 他认为他对损失金额比较 迟 钝 , 相反 地对 收入 的增 加 比较 敏感 , 即 他可 以 承受 损失 的 风 险。这是三种典型 , 某一决策者可能兼有三种类型 , 如图 15 -6 所示。图 15 -4图 15 -5图 15 -6·824·(15 -3)5. 3 效用曲线的拟合当用计算机时需用解析式来表示效用曲线 , 并对决策者测得的数据进行拟合 , 常用的关系式有以下六种。(1 ) 线性函数 U ( x ) = c1 + a1 ( x - c2 ) U ( x ) = c1 + a1 ( 1 - ea (2 ) 指数函数 U ( x ) = c1 + a1 ( 2 - ea (3 ) 双指数函数 (4 ) 指数加线性函数 U ( x ) = c1 + a1 ( 1 - ea (5 ) 幂函数 (6 ) 对数函数( x - c 2) ) ) - ea ) ) + a3 ( x - c2 )2( x - c 2) )( x - c 223( x - c 22U ( x ) = a1 + c1 . a2 [ c1 ( x - a3 ) ] a4U ( x ) = c1 + a1 log( c3 x - c2 )第 6 节 决 策 树有些决策问题 , 当进行决策后又产生一些 新情 况 , 并需 要进行 新的 决策 , 接着 又有 一 些新情况 , 又需要进行新的决策。这样决策、情况、决策……构成一 个序列 , 这就是序列决 策。描述序列决策的有力工具之一是决策树 , 决策树是由决策点 , 事件点及结果构成的树形 图。一般选用最大收益期望值和最大效用期望值或最大效用值为决策准则 , 下面用例子说 明。例 4 设有某石油钻探队 , 在一片估计能出油的荒 田钻探。 可以先做 地震试 验 , 然 后 决定钻井与否。或不做地震试验 , 只凭经验决定钻井 与否。做地 震试验的 费用每 次 3000 元 , 钻井费用为 10000 元。若钻井后出油 , 这 井队可 收入 40000 元 , 若 不出 油就没 有任 何 收入。各种情况下估计出油的概率已估计出 , 并标在图 15 -7 上。问钻井队的决策者如何 作出决策使收入的期望值为最大。解 上述决策问题用决策树来求解 , 并将有关数据标在图上 , 见图 15 -7 。图 15 -7[ ] 表示决策点 ; ( )表示事件点 ;Δ表示收益点 ; 负值表示支付。·924·图 15 -7 表明这是两级随机决策问题 , 采用逆决策顺序方法求解 , 计算步骤是 : (1 ) 计算各事件点的收入期望值事件点收入期望值(2 )40000×0. 85 + 0 ×0. 15 = 34000(3 )40000×0. 10 + 0 ×0. 90 = 4000(4 )40000×0. 55 + 0 ×0. 46 = 22000将收入期望值标在相应的各点处 , 这时可将原决策树 ( 图 15 -7 ) 简化为图 15 -8( a ) 。图 15 -8(2 ) 按最大收入 期 望值 决 策 准则 在 图 15 -8 ( a ) 上 给 出 各 决策 点 的 抉 择。在 决 策 点[2 ] , 按max [ (34000 - 10000) , 0 ] = 24000所对应的策略为应选策略 , 即钻井 , 在决策点 [3 ] , 按max [ ( 4000 - 10000) , 0 ] = 0所对应的策略为应选策 , 即不钻井 , 在决策点 [4 ] , 按max [ (22000 - 10000) , 0 ] = 12000所对应的策略为应选策略 , 即钻井。(3 ) 在决策树上保留各决 策点 的应 选方 案 , 把 淘汰 策略 去 掉 , 得到 图 15 -8 ( b ) , 这 时再计算事件点 (1 ) 的收入期望值。24000×0. 60 + 0× 0. 40 = 14400将它标在 (1 ) 旁。(4 ) 决策 点 [ 1 ] 有 两 个 方 案 : 做 地 震 试 验 和 不 做 地 震 试 验 , 各 自 的 收 入 期 望 值 为(14400 - 3000 ) 和 12000。按max [ ( 14400 - 3000) , 12000 ] = 12000所对应的策略为应选策略 , 即不做地震试验。这个决策问题 的 决 策 序 列 为 : 选 择 不 做 地 震 试 验 , 直 接 判 断 钻 井 , 收 入 期 望 值 为12000 元。·034·ê(cid:4)(cid:17)ê(cid:17)(cid:4)ê(cid:17)(cid:4)例 5 设 决 策 者 的 效 用 曲 线 如 图 15 -9所示。试以最 大效 用期望 值为 决 策准则 , 对例 4 进行决策。解 如同 例 4 一 样 采用 决 策树 为 工具 , 在决策树的右端标上纯收入 纯收入 = 收入 - 支出 然后由决策 者的 效用 曲 线查 得 各纯 收 入图 15 -9相应的效用值 , 并将此值记在相应的纯收 入旁 , 见图 15 -10。图 15 -10决策分析可在图上进行。见图 15 -11。以 下按逆 序先 计算事 件点 ( 2 ) 、( 3 ) 、( 4 ) 的 效 用期望值分别为 0. 833、0. 60、0. 68 , 并标 在相 应各 点旁 , 然后 在各 决策 点 [ 2 ] 、[ 3 ] 、[ 4 ] 进 行选择 , 其计算为max2 ( 0. 833 , 0. 60 ) = 0. 833max3 ( 0. 098 , 0. 60 ) = 0. 60max4 ( 0. 672 , 0. 68 ) = 0. 68接着计算事件点 (1 ) 的效用期望值为 0. 7398 , 记在 (1 ) 旁 , 决策点 [1 ] 的选择为m ax (0. 7398 , 0. 68 ) = 0. 7398根据以上计算在决策树上可见决策序列为 : 先做地震试验 , 若结果好 , 则钻井 ; 若结果不好 , 则不钻井。显然这决策是保守型的。因决策者的效用曲线是保守型的。·134·图 15 -11第 7 节 灵敏度分析7. 1 灵敏度分析的意义通常在决策模型中自然状态的概率和损益 值往往 由估 计或预 测得 到 , 不可能 十分 正 确 , 此外实际情况也在不断地变化 , 现需分析为 决策所 用的 数据可 在多 大范 围内变 动 , 原 最优决策方案继续有效 , 进行这种分析称为灵敏度分析 , 下面用例来说明。例 6 假设有外表完全相同的木 盒 100 只 , 将 其 分为 两组 , 一 组内 装 白球 , 有 70 盒 , 另一组内装黑球 , 有 30 盒。现从这 100 盒中任 取一盒 , 请 你猜 , 如 这盒 内装的 是白 球 , 猜 对了得 500 分 , 猜错了罚 200 分 ; 如这 盒内 装 的是 黑球 , 猜 对了 得 1000 分 , 猜 错了 罚 150 分。为使期望得分最多 , 应选那一方案 , 有关数据列于表 15 -15。表 15 -15概率自然状态方案白 0. 7黑 0. 3猜白500200猜黑1501000解 先画出决策树 , 见图 15 -12 、计算各方案的期望值。“猜白”的期望值为0. 7×500 + 0. 3× ( - 200) = 290“猜黑”的期望值为0. 7× ( - 150) + 0. 3×1000 = 195·234·èÝž“À9À9图 15 -12经比较可知“猜白”方案是最优 , 现假定出现白球的概 率从 0. 7 变为 0. 8 , 这时各方 案的期望值为“猜白”的期望值为 “猜黑”的期望值为0. 8×500 + 0. 2× ( - 200) = 360 0. 8× ( - 150) + 0. 2×1000 = 80可见猜白方案仍是最优。再假定出 现 白球 的概 率从 0. 7 变为 0. 6 , 这 时 各方 案的 期望值为0. 6×500 + 0. 4× ( - 200) = 220 0. 6× ( - 150) + 0. 4×1000 = 310 现在的最优方案不是猜白 , 而是猜黑了。可见由于各自然状态发生的概率的变化 , 可引起 最优方案的改变。那么转折点如何确定 ? 见 7. 2 小节的分析。“猜白”的期望值为 “猜黑”的期望值为7. 2 转折概率设 p 为出 现白 球 的概 率 , ( 1 - p) 为 出现 黑球 的概 率。当 这两 个 方案 的期 望值 相 等时 , 即p×500 + (1 - p) × ( - 200) = p× ( - 150 ) + ( 1 - p) ×1000 求得 p = 0. 6486 , 称它为转折概率。即当 p > 0. 6486 , 猜 白是最 优方 案 ; 当 p < 0. 6486 , 猜 黑是最优方案。 p 可推导 , 表示为a12 - a22 a12 - a22 + a21 - a11 若这些数据在某允许范围内变动 , 而最优方案保持不变 , 这方案就是比较稳定的。反 之 , 这些数据在某允许范围内稍加变动 , 则最 优方案 就有 变化 , 这 方案就 是不 稳定的。 由 此可以得出那些非常敏感的变量 , 那些不太 敏感的 变量 , 以 及最优 方案 不变 条件下 , 这 些 变量允许变化的范围。p =习题15. 1 某厂考虑生产甲、乙两种产品 , 根据过去市场需求统计见表 15 -16。·334·表 15 -16自然状态旺 季淡 季方案概率a1 = 0. 7a2 = 0. 3甲 种 乙 种4732用最大可能性法进行决策。15. 2 对第 1 题用期望值法进行决策并进行灵敏度分析 , 求出转折概率。 15. 3 某公司为了扩大市场 , 要举行一个展销会 , 会址打算选择在甲、乙、丙三地。获 利情况除了与会址有 关 系 外 , 还 与 天 气有 关 , 天 气可 区 分 为 晴、普 通、多雨 三 种 ( 分 别 以 N1 、N2 、N3 表示 ) 。通 过 天 气 预 报 , 估 计 三 种 天 气 情 况 可 能 发 生 的 概 率 为 0. 25 , 0. 50 , 0. 25 。其收益情况见表 15 -17 , 用期望值准则进行决策。 单位/ 万元15. 2 对第 1 题用期望值法进行决策并进行灵敏度分析 , 求出转折概率。 15. 3 某公司为了扩大市场 , 要举行一个展销会 , 会址打算选择在甲、乙、丙三地。获 利情况除了与会址有 关 系 外 , 还 与 天 气有 关 , 天 气可 区 分 为 晴、普 通、多雨 三 种 ( 分 别 以 N1 、N2 、N3 表示 ) 。通 过 天 气 预 报 , 估 计 三 种 天 气 情 况 可 能 发 生 的 概 率 为 0. 25 , 0. 50 , 0. 25 。其收益情况见表 15 -17 , 用期望值准则进行决策。 单位/ 万元15. 2 对第 1 题用期望值法进行决策并进行灵敏度分析 , 求出转折概率。 15. 3 某公司为了扩大市场 , 要举行一个展销会 , 会址打算选择在甲、乙、丙三地。获 利情况除了与会址有 关 系 外 , 还 与 天 气有 关 , 天 气可 区 分 为 晴、普 通、多雨 三 种 ( 分 别 以 N1 、N2 、N3 表示 ) 。通 过 天 气 预 报 , 估 计 三 种 天 气 情 况 可 能 发 生 的 概 率 为 0. 25 , 0. 50 , 0. 25 。其收益情况见表 15 -17 , 用期望值准则进行决策。 单位/ 万元自然状态晴( N1 )普通 ( N2 )多雨 ( N3 )选址方案0. 250. 500. 25甲 地 乙 地456411. 5丙 地61. 215. 4 将第 3 题用矩阵法进行决策。 15. 5 今要建立一个企业 , 有 4 个投资方案 , 三种自然状态 , 投资数量见表 15 -18 。表 15 -18单位/ 百万元自然状态Q1Q2Q3投资方案概率1/ 21/ 31/ 6A1474A2523A38610A4319用矩阵法进行决策。15. 6 某公司需要决定建大厂还是建小厂来 生产 一种 新产品 , 该 产品 的市场 寿命 为 10 年 , 建大工厂的投资费用为 280 万 , 建 小厂的 投资 为 140 万。10 年 内销 售状况 的离 散 分布的状态如下 : 高要求量的可能性为 0. 5 ; 中等需求量的可能性为 0. 3 ; 低需求量的可能性为 0. 2。 公司进行了成本—产量—利润分析 , 在工厂规模和市场容量的组合下 , 它们的条件收益如下 : ·434·6+ìáÀ(cid:11)À(cid:11)®£(cid:7)ü(cid:6)ûKLóKLþóKLþófeKLó(cid:11)KLó(cid:11)KLó(cid:11)KLó(cid:11)① 大工厂 , 高需求 , 每年获利 100 万元。 ② 大工厂 , 中等需求 , 每年获利 60 万元。 ③ 大工厂 , 低需求 , 由于开工不足 , 引起亏损 20 万元。 ④ 小工厂 , 高需求 , 每年获利 25 万元 ( 供不应求引起销售损失较大 ) 。 ⑤ 小工厂 , 中需求 , 每年获利 45 万元 ( 销售损失引起的费用较低 ) 。 ⑥ 小工厂 , 低需求 , 每年获利 55 万元 ( 因工厂规模与市场容量配合得好 ) 。 用决策树方法进行决策。15. 7 将第 5 题用决策树法进行决策。 15. 8 将第 6 题用矩阵法决策。 15. 9 将第 3 题用决策树方法进行决策。 15. 10 某厂有一种新产品 , 其推销策略有 S1 , S2 , S3 三种可供选择 , 但各方案所需的 资金、时间都不同 , 加上市场情况的差别 , 因 而获 利和亏 损情 况不 同。而市 场情况 也有 三 种 : Q1 ( 需要量大 ) , Q2 ( 需要 量一 般 ) , Q3 ( 需 要量低 ) 。市 场情 况的概 率并 不知 道 , 其益 损 矩阵见表 15 -19 , 用乐观法进行决策。 单位/ 万元15. 7 将第 5 题用决策树法进行决策。 15. 8 将第 6 题用矩阵法决策。 15. 9 将第 3 题用决策树方法进行决策。 15. 10 某厂有一种新产品 , 其推销策略有 S1 , S2 , S3 三种可供选择 , 但各方案所需的 资金、时间都不同 , 加上市场情况的差别 , 因 而获 利和亏 损情 况不 同。而市 场情况 也有 三 种 : Q1 ( 需要量大 ) , Q2 ( 需要 量一 般 ) , Q3 ( 需 要量低 ) 。市 场情 况的概 率并 不知 道 , 其益 损 矩阵见表 15 -19 , 用乐观法进行决策。 单位/ 万元15. 7 将第 5 题用决策树法进行决策。 15. 8 将第 6 题用矩阵法决策。 15. 9 将第 3 题用决策树方法进行决策。 15. 10 某厂有一种新产品 , 其推销策略有 S1 , S2 , S3 三种可供选择 , 但各方案所需的 资金、时间都不同 , 加上市场情况的差别 , 因 而获 利和亏 损情 况不 同。而市 场情况 也有 三 种 : Q1 ( 需要量大 ) , Q2 ( 需要 量一 般 ) , Q3 ( 需 要量低 ) 。市 场情 况的概 率并 不知 道 , 其益 损 矩阵见表 15 -19 , 用乐观法进行决策。 单位/ 万元15. 7 将第 5 题用决策树法进行决策。 15. 8 将第 6 题用矩阵法决策。 15. 9 将第 3 题用决策树方法进行决策。 15. 10 某厂有一种新产品 , 其推销策略有 S1 , S2 , S3 三种可供选择 , 但各方案所需的 资金、时间都不同 , 加上市场情况的差别 , 因 而获 利和亏 损情 况不 同。而市 场情况 也有 三 种 : Q1 ( 需要量大 ) , Q2 ( 需要 量一 般 ) , Q3 ( 需 要量低 ) 。市 场情 况的概 率并 不知 道 , 其益 损 矩阵见表 15 -19 , 用乐观法进行决策。 单位/ 万元Q1Q2Q3S150105S230250S31015. 11 将 10 题用悲观准则进行决策。 15. 12 某 企 业 面 临 三 种 方 案 可 以 选 择 , 五 年 内 的 益 损 表 如 下 , 用 乐 观 系 数 法( a1 = 0. 3 , a2 = 0. 7) 决策 , 然后加以比较。15. 13 将 12 题用等可能准则 ( Laplace) 进行决策 , 并与上题比较结果。 15. 14 在开采油 井 时 , 出 现 不 定 情 况 , 用 后 悔 值准 则 决 定 是 否 开 采。 益 损 矩 阵 见表 15 -20。表 15 -20自然状态有 油无 油方案QQ开 采51不开采0015. 15 某企业要投产一种新产品 , 投资方案有三个 : S1 、S2 、S3 , 不同经济形势下的利润如表 15 -21 所示。用乐观系数准则 ( a1 = 0. 6 , a2 = 0. 4 ) 进行决策。·534·“ñ"ï‘c"‘ïc"‘ïc–z–z表 15 -21单位/ 万元不同经济形势投资方案好平差S11001S225105S35004015. 16 将 15 题用等可能准则进行决策。 15. 17 建 厂 投 资 有 三 个 行 动 方 案 可 以 选 择 , 并 有 三 种 自 然 状 态 , 其 损 失 表 见表 15 -22 , 用乐观准则进行决策。表 15 -22状态自然状态损失值方案Q1Q2Q3A1373A2654A3561015. 18 将 15. 17 题用悲观准则进行决策。参 考 资 料[1] 姜青舫编著 . 实用决策分析 . 贵阳 : 贵州人民出版社 , 1985[2] 黄孟藩 . 管理决策概论 . 北京 : 中国人民大学出版社 1982[3] Milan Zele ny . Multiple Creteria Decision Ma king . McGraw H ill Book Co mpany , 1982·634·cccÚ6(cid:13)Áó(cid:29)®Áó(cid:29)®Á(cid:10)(cid:29)®第 16 章 多目标决策第 1 节 引言在生产、经济、科学和工程活动中经常需要对多个目标 ( 指标 ) 的方案、计划、设计进行 好坏的判断 , 例如设计一个导弹 , 既要其射程 远 , 又 要耗 燃料 少 , 还 要命 中率 高等 ; 又如 选 择新厂的厂址 , 除了要考虑运费、造价、燃料供应费等经济指标外 , 还要考虑对环境的污染 等社会因素 , 只有对各种因素的指标进行综合衡量后 , 才能作出合理的决策。例 1 由 n 种成分 x 1 , x2 , … , xn 组成一个橡胶配方 , 可 用 x = ( x1 , x2 , … , xn ) T 表示。对于每一个配方要同时考查几个指标 , 如强 度 f1 , 硬 度 f2 , 伸长 率 f3 , 变 形度 f 4 等。 假 定有 m 个指标。它们都与配方方案 x 有关 , 它们与 x 的关系为 f 1 ( x ) , f2 ( x) , … , f m ( x ) 。 当 m 很多时 , 要比较两方案的 优劣 时 , 就 往往 很难 下决断 了。于 是有 人把 这 问题 用数 学 规划来处理。先以某指标作为主要指标 , 如 以强 度 f1 为 主要指 标 , 并且 越大 越好。而 其 他指标只要落在一定规格范围内就可以。这就把这问题化为求 :max x ∈ Rf1 ( x)R = { x | f′i ≤ f i ( x) ≤ f″i , i = 2 , … , m, x∈ A}这里 A 表示对 x 本身的一个限制 , f′i 、 f″i 分别表示第 i 个指标的上、下限。例 2 门坐式起重机四连杆变幅机构的最优设计。 衡量变幅机构设计的好坏一般要求 : (1 ) 货物尽量走水平 , 即高度变化小 ; (2 ) 货物在移动时 , 水平速度的变化量尽量小 ; (3 ) 由吊装的货物所引起的倾覆力矩尽量小。 为了达到这三项要求 , 需用五个 指标 f1 , … , f5 来 描述。 关于 要求 ( 1 ) , 用 落 差 f1 =Δy 表示 ; 要求 (2 ) , 用速比 f2 = iv 表示 ; 要求 (3 ) , 用三个指标 : 大幅 度时力 矩 f3 = M( a0 ) ; 小幅度时力矩 f4 = M( a1 ) , 力矩变化量 f5 =ΔM。要求 f1 、 f2 、f5 越小越好 ; f3 、 f4 适中 为好。对这样一个多目标问题可采用功效系数 法来 解决。可 以列举 出很 多种 多目标 问题 , 针对不同的问题可采用不同的方法去解决。如房屋合理分配问题 , 由于新建房屋少 , 如何 合理地从很多需要房屋的人按原有居住面积、工龄、年 龄和 人口等 指标 定出 打分标 准 , 使 每个需要者都按取得的总分多少进行排队 , 以使分房更为公平合理。第 2 节 基 本 概 念在考虑单目标最优化问题时 , 只要比较任意两个解对应的目标函数值后 , 就能确定谁·734·优谁劣 ( 目标值相等时除外 ) 。在多目标情况 , 就不能 作这 样简 单的比 较来 确定谁 优谁 劣 了。例如有两个目标都要求实现最大化 , 这样的决策问题 , 若能列出 10 个方案 , 各方案能 实现的不同的目标值如图 16 -1 所示。从图 中可 见 , 对 于第 一个 目标 来讲 方 案① 优 于② ; 而对于第二个目 标 则方 案② 优于 ①。因 此无 法 确定 谁优谁劣 ; 但是它们都比方案③、⑤劣。方案③、⑤之 间又 无法相比。在图 16 -1中 10 个方案 , 除方 案③、④、⑤ 以 外 , 其他 方 案 都 比 它 们中 的 某 一 个 劣。 因 而 称 ①、②、 ⑥、⑦、⑧、⑨、⑩为劣解 , 而③、④、⑤之间 又无法比 较谁 优谁劣 , 但又不 存在 一个 比它 们 中任 一个 还好 的 方案 , 故称此三个方 案为 非劣 解 ( 或 称 为有 效解 ) 。以 后再 给 出确切的定义。假定有 m 个目标 f 1 ( x) , … , f m ( x ) 同 时要 考查 , 并 要求都越大越好。在不考虑其他目 标时 , 记 第 i 个目 标 的最优值为图 16 -1f ( o) i = max x∈ Rf i ( x)相应的最优解记为 x( i) , i = 1 , 2 , … , m; 其中 R 是解的约束集合。R = { x | g( x) ≥0}g( x) = { g1 ( x) , … , gl ( x )}T当这些 x( i) 都相同 时 , 就 以这 共 同解 作 为多 目 标 的共 同 最优 解。一 般 不 会 全 相同 , 例 如 x( 1 ) ≠ x( 2 ) 时 , 这两个解就难比 优 劣 , 但是 它们 一 定都 是非 劣解。 为了 与单 目 标最 优化 的 记号有所区别 , 今后用V——— m ax x ∈ R 表示在约束集合 R 内求多目标问题的最优 ( 亦称求向量最优 ) ; 其中F ( x ) 或 V ——— max g( x) ≥ 0F( x)F( x ) = { f 1 ( x) , … , f m ( x) }T若各目标值都要求越小越好 , 就用下式表示。 V——— min x∈ RF( x )下面考查使目标值越大越好 , 为了简易起见 , 本节一般只考虑 n 维欧氏空间 E n , 即x = ( x1 , x2 , … , xn ) T ∈ En ,REn ,F( x ) ∈ Em实际上当 x0 是最优解时 , 即表示 " x∈ R, 有F( x ) ≤ F( x0 )当 x0 是非劣解时 , 即不存在 x∈ R, 有F( x ) ≥ F( x0 ) 以后用“≥”表示 F( x) (cid:929) F( x0 ) , 但 F( x ) ≠ F( x0 ) , 即至 少有一 个分 量 ,“ > ”才成立 , 即 一 定大于。相应的 F( x0 ) 在目标函数空间中称为非劣点或有效点。有的还进一步引入弱 非 劣解 , 即当 x0 是弱非劣解 , 若不存在 x∈ R, 有F( x ) > F( x0 )为直观起见 , 举几个数值例子。例 3 设 f 1 ( x) = 2 x - x2 ,f2 ( x ) =x2 x + 3 ,0≤ x≤1 1≤ x≤2·834·R = [ 0 , 2] , 求 V——— m axx ∈ RF ( x )解 先对单个目标分别求出其最优解。显然第一个目标的最优解 x( 1 ) = 1 , 这时f ( 0 ) 1 = f1 ( x = 1) = m ax x ∈ Rf 1 ( x )第二个目标的最优解是 x( 2 ) = 1 , 这时f ( 0 ) 2 = f2 ( x = 1) = m ax x ∈ Rf 2 ( x )因为 x( 1 ) = x( 2 ) = 1 , 故取 x * = 1 作为这多目标问题 的最优解。 下面用变 量空间和 目标 函 数空间分别来描述各种解的情况 , 见图 16 -2。图中 α和β两个解彼此无法比较 , 但都劣于 x * = 1。例 4 设 f 1 ( x) = 2 x - x2 , f2 ( x ) = x, R = [ 0 , 2] , 求 V——— m axx ∈ RF( x )解 容易求得 x( 1 ) = 1 , x( 2 ) = 2 , 这 时多目 标问 题没有 共同 最优 解 , 从 图 16 -3 可 见 ,α 和β两个解彼此无法比较 , 但是容易找到 α′比α优 ,α′比β仍无法比较优劣 , 但还可找到α″ 比 α′优。解β却不存在β′可以比它优 , 这时β为非劣解。本例中 x∈ [1 , 2 ] 时都是非劣解。图 16 -2图 16 -3例 5 设 f 1 ( x) = 2 x - x2 ,1 8 V ——— max x∈ R( - 12 x2 + 36 x - 15 ) , R = [ 0 , 2] , 求f2 ( x ) =F ( x)解 易求得 x( 1 ) = 1 , x( 2 ) = 1 .5 , 这时 多目 标问题 无 最优 解 , 而 x∈ [ 1 , 1 .5 ] 都 是非 劣解 , 见图 16 -4。图 16 -4例 6 设 f 1 ( x) = - 3 x1 + 2 x2 ,R:f 2 ( x) = x1 + 2 x2 - 2 x1 - 3 x2 + 18≥0 - 2 x1 - x2 + 10 ≥0 x1 ≥ 0 , x2 ≥0·934·求 V——— maxx ∈ RF( x )解 易求 得 x( 1 ) = ( 0 , 6 ) , x( 2 ) = ( 0 , 6 ) , 因 而多 目 标问 题 最 优解 即 x * = ( 0 , 6 ) 。 图16 - 5所示的 α、β之间无法比较 , 但都劣于 A。图 16 -5例 7 设 f 1 ( x) = - 3 x1 + 2 x2 , f 2 ( x) = 4 x1 + 3 x2 , R 同例 6 , 求 V——— maxx ∈ RF( x )解 易求得 x( 1 ) = ( 0 , 6) , x( 2 ) = ( 3 , 4 ) , 这 时多 目标问 题无 最优 解 , 但有非 劣解 , 在 联 结点 x( 1 ) = ( 0 , 6) 到 x( 2 ) = (3 , 4 ) 之间的线段上的点 ( 见图 16 -6 ( a ) ) 都是 非劣解 , 而连接 点 A′、B′( 见图 16 -6( b) ) 的直线上的点都是非劣点。图 16 -6在单目标时任何两个解都可以比较其优劣 , 因此是完全有序的。可是在多目标时 , 任 何两个解不一定都是可比出其优劣的 , 因此 只能是半 有序的。假 定所有 解 x 是属 于全 空 间 ∑ 中某一个约束集合 R, 即 x∈ R ∑ , 在∑ 上对 任一 个解 x 可 以定 义一个 半序 : <～ , ( a > b 表示 a 优于 b) , 且可把 ∑ 分成三个子集 : ( x) 所有比 x 优的解集合 ;(1 ) ∑ > (2 ) ∑ <～ ( x) 所有比 x 劣或相等的解集合 ; (3 )∑ ～ ( x) 所有与 x 无法比较的解集合。显然∑ = ∑ >( x) ∪ ∑ <～ ( x) ∪ ∑ ～ ( x)·044·按照这些子集的划分 , Zadeh 给出“ 非劣”和“ 最优”的定义 ①定义 1 解 x0 ∈ R ∑ 叫做在 R 内“非劣”, 如果 R∩ ∑ > 定义 2 解 x0 ∈ R ∑ 叫做在 R 内最优 , 如果 R ∑ <～ ( x0 ) 。 推论 若 x0 是最优解 , 则必为非劣解。反之不然。 证 因 为 由 定 义 2 , x0 是 最 优 , R ∑ <～ ( x0 ) , 而 ∑ <～ ( x0 ) ∩ ∑ > ( x0 ) = , 故( x0 ) = 。R∩ ∑ > ( x0 ) = , 所以 x0 也为非劣解。这推论反之不一定对 , 即 x0 是非劣解 , 有 R∩ ∑ > ( x0 ) = 成立。但是由于 R 不一 定全在 ∑ <～ ( x0 ) 内 , 而只能保证 R ∑ <～ ( x0 ) ∪ ∑ ～ ( x0 ) , 所以不一定是最优解。但 在单目标时 , 由于是全有序 , 因此 ∑ ～ ( x0 ) = , 所以 x0 是非劣时 , 必有 R ∑ <～ ( x0 ) , 即 x0 自然就是最优解。由此可见在单目标最 优化 问题时 , 对最优 和非 劣可以 不区 分 ; 但 在多目标最优化问题时 , 这两个概念必须加以区别。第 3 节 化多为少的方法要求若干目标同时都实现最优往往是很 难的。经 常是 有所失 才能 有所得 , 那 么问 题 的失得在何时最好。各种不同的思路可引出各种合理处理得失的方法。以下介绍化多为少的方法。由于直接解决多目标问题的最优化较困难 , 于是 很多 人想 办法将 它们 化为较 容易 求解的单目标或双目标问题。由于化法不一 , 就形成多种方法。3. 1 主要目标法解决主要问题 , 并适当兼顾其他要求。1. 优选法在实际问题中通过分析讨论 , 抓住其中一 两个 主要目 标 , 让它 们尽 可能地 好 , 而其 他指标只要满足一定要求即可 , 通过若干次试验以达到最佳。2. 数学规划法设有 m 个目标 f 1 ( x ) , f 2 ( x) , … , f m ( x ) 要 考查 , 其 中方案 变量 x∈ R( 约束 集合 ) , 若 以某目标为主要目标 , 如 f 1 ( x) 要求实现最优 ( 最大 ) , 而对其他目标 只满足一 定规格要 求 即可 , 如f′i ≤ f i ( x ) ≤ f″i( i = 2 , … , m)① 这里 用“ 非劣解”的 名词 , 主 要来 源于 Zad eh 。有不 少文章 使用“有 效解”, 还有 人用“ Pa r et o 解”等各 种名 词 , 其含义基 本一 致。·144·其中当f′i = - ∞或 f″i = ∞就变成单边限制 , 这样问题便可化成求下述非线性规划问题 :max x∈ R′f 1 ( x)R′= { x | f′i ≤ f i ( x) ≤ f″i , i = 2 , … , m, x∈ R}3. 2 线性加权和法若有 m 个目标 f i ( x ) , 分别给以权系数 λi ( i = 1 , 2 , … , m) , 然后作新的目标函数 ( 也称效用函数 ) 。mU ( x) = ∑λi f i ( x ) ①i = 1该方法的难点是如何找到合理的权系统 , 使 多个目 标用 同一 尺度统 一起 来。同时 所 找到的最优解又是向量极值的好的非劣解。在多 目标 最优 化问题 中不 论用何 方法 , 至 少 应找到一个非劣解 ( 或近 似非 劣解 ) 。其 次 , 因 非劣 解可 能 有很 多 , 如何 从 中挑 出较 好 的 解 , 这个解有时就要用到另一个目标。下面介绍几种选择特定权系数的方法。1. α—法先以两个目标为例 , 假设一个目标是要求劳动量消耗 f 1 ( x) 为最小 , 另一 个目标是 收益 f2 ( x) 为最高。它们都是线性函数 , 都以元为单位。 R 也为线性约束 , 即R = { x | A x≤ b}A 为矩阵 , b 为列向量。 作为新目标函数U ( x) =α2 f2 ( x ) - α1 f1 ( x )其中 α1 ,α2 由下述方程组来确定其中f 0 1 = min x ∈ Rα1 f 0 - α1 f *1 +α2 f * 1 +α2 f 02 = c12 = c1 f 1 ( x) = f1 ( x( 1 ) ) , f *2 = f 2 ( x( 1 ) ) ②f 0 2 = max x∈ Rf 2 ( x) = f2 ( x ( 2 ) ) , f *1 = f1 ( x( 2 ) )c1 可为任意的常数 ( c1 ≠0 ) , 这方程组可解得α1 =α2 =c1 ( f 0 f * f * c1 ( f * f * f *121212 - f * f 0 - - f 0 f 02 ) f 0211 ) f 012若规定 α1 + α2 = 1 , 即可得到①一般 用和形 式的新 目标 函数 , 其 中所有 目标必 须是 具有 相同 量 纲 , 若 量 纲不 同 , 必 须 进 行 统一 量 纲 或 无量 纲化处理 , 以 后无 特别说 明 , 一般 都指经 处理 过的目 标。②假定 x( 1 ) 是 唯一 的。若 有多个 x( 1 ) 达 到最 小 , 就必须 从中 进一步 找出 使 f 2 达到最 优的 那个解 , 同样 x(2 ) 也应如此处 理。·244·c1 =f * 1 f 0 2 -- f 0 f * 2 + f * f *211f 0 -2f 01从而有易见2 - f * f 0 2 + f * 2 - f * f 0 - f 0 f * 2 + f * 2 - f * f 0 2 - f * f 0 f 0 f * -α1 =1α2 =α1 α22=112111= kf 01f 01由这样定义的 α1 、α2 作出的新目标函数为U ( x) =α2 f2 ( x ) - α1 f1 ( x )=( f *11 ) f2 ( x ) - ( f 0 f 0 2 + f * f * f 0 2 -12 - f * f 0 -2 ) f1 ( x)1当要求实现最大时 , 可表示为m ax x ∈ RU ( x ) = max x∈ R(α2 f2 ( x ) - α1 f1 ( x) )若作目标值空 间 ( f 1 , f2 ) , 则 U ( x ) 取 不 同 数时 , 相 当 一簇平行线 , 其斜率为 k =α1/ α2 。 2 ) 与 M2 ( f * 请注意点 M1 ( f 0 2 ) 的连 线 的 斜 率 为 ( f 0 f 0 2 )/ ( f * 2 - f * 1 ) , 与新 目标函 数 U ( x ) 的平 行 线簇的斜率 是一 致 的 , 见 图 16 -7 。 U 取 最 大值 时 , 正 好是此平行线簇中与 c 点相交。1 , f *, f 011图 16 -7f m ( x ) 的 情 况 , 不 妨设其中 f1 ( x ) , … , f k ( x ) 要 求 最 小化 , 而 f k + 1 ( x ) , … , f m ( x ) 要求最大化 , 这时可构成下述新目标函数。对于有 m 个 目 标 f 1 ( x ) , … ,kmmax x∈ RU ( x) = max x∈ R∑ j = 1∑ j = 1αj f j ( x ) + ∑j = k+ 1其中{αj } 满足方程组km其中∑ f i i = f 0 f i i = f 0∑ f i i = f 0 f i i = f 0αj f i j + ∑αj f i j = c1 ,j = k+ 1i = min x ∈ Rf i ( x ) = f i ( x( i) ) ,i = max x∈ Rf i ( x) = f i ( x( i) ) ,i = 1 , 2 , … , ki = k + 1 , … , mf i j = f j ( x( i ) ) ,j≠ i,i,j = 1 , 2 , … , m例 8 设有 f 1 ( x) = 4 x1 + x2 → min , f2 ( x ) = 3 x1 + 2 x2 → maxR = { x | 2 x1 + x2 ≤4 , x1 + x2 ≤3 , x1 , x2 ≥0 , x∈ E2 } , 试用 α- 法求解。解 先分别对 f1 ( x) , f 2 ( x ) 求得其最优解 , 它们是f1 ( x( 1 ) ) = f1 ( 0 , 0) = minx∈ Rf 1 ( x ) = f 01 = 0f 2 ( x( 2 ) ) = f2 ( 1 , 2) = maxx∈ Rf 2 ( x ) = f02 = 7然后求出2 = f2 ( x( 1 ) ) = 0 , f * f *1 = f 1 ( x( 2 ) ) = 6·344·由此可得α1 =f 0 f * 2 - 2 + f * 2 - f * f 021f 01=7 7 + 6=7 13,α2 =6 13U ( x) = - α1 f1 ( x ) + α2 f 2 ( x) = -7 13f 1 ( x) +6 13f 2 ( x) =1 13( - 10 x1 + 5 x2 )易求得max x∈ RU ( x) = U (0 , 3 ) = 15/ 132. λ—法当 m 个目标都要求实现最大时 , 可用下述加权和效用函数 , 即m其中 λi 取U ( x) = ∑ f 0 i = max x∈ Rλi f i ( x )i = 1f 0 i ,λi = 1/f i ( x)3. 3 平方和加权法设有 m 个规定值 f *1, … , f *m , 要求 m 个函数 f 1 ( x ) , … , f m ( x ) 分 别与 规定的 值相 差尽量小 , 若对其中不同值的要求相差程度又 可不完 全一 样 , 即有的 要求 重一 些 , 有 的轻 一 些。这时可采用下述评价函数 :mU ( x ) = ∑λi [ f i ( x ) - f *i ] 2i = 1要求 min x ∈ RU ( x ) , 其中 λi 可按要求相差程度分别给出。3. 4 理想点法有 m 个目标 f 1 ( x) , … , f m ( x ) , 每个目标分别有其最优值f 0 i = max x∈ Rf i ( x) = f i ( x( i) )i = 1 , 2 , … , m若所有 x( i) ( i = 1 , 2 , … , m) 都相同 , 设为 x0 , 则令 x = x0 时 , 对每个目标都能达到其各自的 最优点 , 可惜一般做不到 , 因此对向量函数F( x ) = ( f 1 ( x) , … , f m ( x) ) T来说 , 向量F0 = ( f 01 , … , f 0m ) T只是一个理想点 ( 即一般达不到它 ) 。Caлуквадзе提出的理想点法 , 其 中心 思想 是 定义 了一 定的 模 , 在 这 个模 意 义下 找 一个点尽量接近理想点 , 即让模‖ F( x ) - F0 ‖→ min‖ F( x) - F0 ‖ 对于不同的模 , 可以找到不同意义下的最 优点 , 这 个模也 可看 作评价 函数 , 一 般定 义的 p- 模是 :m‖ F( x ) - F0 ‖ = ∑( f 0if i ( x ) ) p1/ p= Lp ( x)i = 1·444·其中 , p 的取值一般在 [ 1 , ∞ ) 。当取 p = 2 , 这时模即为 欧氏空间中向量 F( x) 与向量 F0 的 距离 , 见 图 16 -8。要 求 模最小 , 也就 要找到一解 , 它对应的目 标值与理想点的 目标 值距离最近 , 可表示为min x ∈ RL p ( x)m图 16-8当 p = 1 时 , L1 ( x) = ∑ p = ∞时 , L∞ ( x ) = maxi = 11 ≤ i≤ m( f 0i| f 0if i ( x) )f i ( x ) |如 x1 = ( 8 , 6) , x2 = ( 4 , 3 ) 两 点之 间 , 当 p = 1 , 2 , … , ∞时 其距离的取值见下表。p( x11 - x21 ) p( x12 - x22 ) pLp ( x )143721695364274.498⁝⁝⁝∞4∞3∞4当 p = 2 时 , 其 几何 意 义是 两点 之间 的最 短 距离 为直 线 ; 而 当 p > 2 时 , 其 距离 就 小 于这两点 之 间 的 直线 距 离 ; 并 且 p 愈 大 , 距 离 值就 愈 趋 向 于 较大 的 分 量 ( 属 性、目 标 ) 。 因此可取 不 同 的 p 值 代表 人 们 对 较 大分 量 ( 属 性、目 标 ) 的 偏爱 程 度 , 它 就不 是 几 何 概 念了。上述 3. 3 小节和 3. 4 小节的方法也是目标规划法的一类 , 即事先规定一些指标值 , 然 后另设目标 , 看其接近这些规定值的程度。新设的目标有时也称超目标 , 易证明理想点法 求出的解一定是非劣解 , 自然它在目标值空间中就是有效点。例 9 设 f 1 ( x) = - 3 x1 + 2 x2 , f 2 ( x) = 4 x1 + 3 x2 都要求实现最大。约束集为R = { x | 2 x1 + 3 x2 ≤18 , 2 x1 + x2 ≤10 , x1 x2 ≥0 , x∈ E2 }试用理想点法求解。解 先分别对单目标求出最优解 x( 1 ) = ( 0 , 6) x( 2 ) = ( 3 , 4) 。对应的目标值为 f1 ( x( 1 ) ) = f1 ( 0 , 6) = f 0 f2 ( x( 2 ) ) = f2 ( 3 , 4) = f 0 1 , f 01 = 122 = 24F0 = ( f 0故理想点为2 ) = (12 , 24 )取 p = 2 , 这时要求min x ∈ RL2 ( x) = {[ f1 ( x ) -1 ] 2 + [ f2 ( x) - f 0 f 02 ] 2 }1/ 2这时可求得最优解为 x * = (0 .53 , 5 .65 ) , 对应的目标值分别为 f * 图 16 -9 。1 = 9 .72 , f *2 = 19 .06 , 见·544·“–‘’–“‘’“–’‘–图 16 -93. 5 乘除法当在 m 个目标 f 1 ( x ) , … , f m ( x ) 中 , 不 妨设 其 中 k 个 f 1 ( x ) , … , f k ( x ) 要 求实 现 最小 , 其余 f k + 1 ( x) , … , f m ( x) 要求实现最大 , 并假定f k + 1 ( x ) , … , f m ( x) > 0这时可采用评价函数U ( x ) =f1 ( x) f2 ( x ) … f k ( x ) f k + 1 ( x ) … f m ( x )→ min3. 6 功效系数法———几何平均法设 m 个目标 f 1 ( x ) , … , f m ( x ) , 其 中 k1 个目标 要求 实现 最大 , k2 个目 标要求 实现 最 小 , 其余的目标是过大不行 , 过小也不行。对于这些目标 f i ( x ) 分别 给以一定 的功效系 数 ( 即评分 ) di , di 是 在 [ 0 , 1 ] 之间 的 某一 数。当 目标 最满 意达 到时 , 取 di = 1 ; 当 最差 时 取 di = 0。描述 di 与 f i ( x) 的关系 , 称为功效函数 , 表示为 di = Fi ( f i ) 。对于不同类型目标 应 选用不同类型的功效函数。Ⅰ型 : 当 f i 越大 ; di 也越大 ; f i 越小 , di 也越小。 Ⅱ型 : f i 越小 , di 越大 ; f i 越大 , di 越小。 Ⅲ型 : 当 f i 取适当值时 , di 最大 ; 而 f i 取偏值 ( 即过大或过小 ) 时 , di 变小。 具体功效函数构造法可以很多 , 有直线法 , 折线法 , 见图 16 -10 和图 16 -11 , 指数法 见图 16 -12。图 16 -10用指数法构造Ⅰ型功效函数 ( 见图 6 -12) , 可设其表达式为·644·图 16 -11图 16 -12d = e-( e( b 0+ b 1f ))其中 b0 , b1 可这样确定 :当 f 达到某一刚合格值 f 1 时 , 取 d1 = e - 1 (cid:930) 0 .3679 当 f 达到某一不合格值 f 0 时 , 取 d0 = e - e (cid:930) 0 .06598将上述要求代入上式即有d1 = e- 1 = e -( e - ( b0 + b1 f1) )d0 = e - e = e - ( e - ( b0 + b1 f0) )由这两式可得b0 + b1b0 + b1f 1 = 0 f 0 = - 1解之得b0 =f 1 f 0 -f 1 ,b1 =1 f 0 - f 1即d = e- ef - f″-f′ f′同样对Ⅱ型功效函数 , 可取为d = 1 - e - ef′ f - f″- f′对于Ⅲ型功效函数 , 取d = e -| Y | n其中Y =2 f - ( f ′+ f ″) f ′- f ″这样 , 当 f = f′或 f = f″时 , Y = ±1 , d = e - 1 , 为 刚 好可 接受 的值 ; 当 f =f′+ f″ 2时 , Y = 0 ,·744·d = 1 , 即 f 达到比较适当的值。为了确定 n, 可再取一个 f 对应 , 这时可给出, 使其与某一个适当 的 d 值 相n =ln ( ln 1/ d) ln | Y |例如 , 取 f = f =2 f′+ f″ 3, 这时 Y = 1/ 3 , 使其与 d = e - 1/ 2 相对应 ( 见图 16 -12 ) , 则n =ln1/ 2 ln1/ 3≈0 .6309即d = e - | Y |0 .6309, Y =2 f - ( f′+ f″) f′-f″有了功效函数后 , 对每个目标都可对应 为相 应的功 效函 数。目标 值可 转换为 功效 系 数。这样每确定一方案 x 后 , 就有 m 个目标函数 值 f 1 ( x ) , … , f m ( x ) 。然 后用其 对应 的 功效函数转换为相应的功效系数 d1 , … , dm 。并可用它们的几何平均值。D =md 1 d2 … dm为评价函数 , 显然 D 越 大越好 , D = 1 是最 满意的 , D = 0 是最 差的 , 这样定 义的评 价函 数 有一个好处 , 一个方案中只要有一个 目标 值太 差 , 如 di = 0 , 就会 使 D = 0 , 而 不会 采用 这 个方案。第 4 节 分层序列法由于同时处理 m 个目标是比较麻烦 , 故可采用分层法。 分层法 的思想是 把目标按 其重要性给出一个序列 , 分为最重要目标、次要目标等。设给出的重要性序列为f1 ( x) , f2 ( x ) , … , f m ( x )下面介绍逐个地求最优化的序列最优化。首先对第一个目标求最优 , 并找出 所有 最优解 的集 合记 为 R0 。 然后在 R0 内 求第 二 个目标的最优解 , 记这时的最优解集合为 R1 , 如此 等等一直 到求出 第 m 个 目标的 最优 解 x0 , 其模型如下 :f1 ( x0 ) = maxx ∈ R0Rf 1 ( x )f2 ( x0 ) = maxx ∈ R1R0f2 ( x )⁝f m ( x0 ) =x ∈ Rmax R m - 1m - 2f m ( x )该方法有解的前提是 R0 , R1 , … , Rm - 1 非空 , 同时 R0 , R1 , … , Rm - 2 都不能只有一个元素 , 否 则就很难进行下去。当 R 是紧致集 , 函数 f1 ( x ) … f m ( x) 都是上半连续 , 则按下式定义的集求解。k = 1 , 2 , … , m, 其 中 R * 优解。R *k - 1 = x | f k ( x) = sup u ∈ R * k - 2 k - 1 = R 都非 空 , 特 别 R *f k ( u) ; x∈ R *k - 2m - 1 是非 空。故 有 最优 解 , 而且 是 共同 的 最·844·第 5 节 直解求非劣解上述种种方法的基本点是将多目标最优化问题转换为一个或一系列单目标最优化问题。把对后者求得的解作为多目标问题的解 , 这 种解往 往是 非劣 解。对经 转换后 的问 题 所求出的最优解往往只是原问题的一个 ( 或 部分 ) 非劣 解 , 至于 其他非 劣解 的情况 却不 得 而知。于是出现第三类直接求所有非劣解的方法 , 当这些非劣解都找到后 , 就可供决策者 作最后的选择 , 选出的好解就称为选好解。显然决策者这时的选好 , 必须取决于他心中的 另一个目标。这可能是定性的或无法奉告的。运 筹学 工作 者主要 是根 据已知 的目 标 , 尽 可能地列出非劣解 , 以供决策者选择 , 非劣解求 法很多 , 这 里仅 介绍线 性加 权和改 变权 系 数的方法。在第 3 节中已提到了线性加权和的方法 , 但那里是按一定想法确定权系数 , 然后组成 线性加权和的函数 , 并从中求出最优解。可以证明当对目标函数作一定假设 , 例如目标函 数都是严格凹函数 , 则用线性加权和法求得的最优解是多目标最优化问题的一个非劣解。 若再假设约束集合 R 为凸 集 , 只要 不 断 改 变 权系 数 λi (λi ≥ 0 ) , 对 其 相 应 的加 权 和 目 标 函数mU ( x) = ∑λi f i ( x )i = 1求出的最优解可以跑遍所有多目标问题V——— max x ∈ R 的非劣解集 , 但这方法只是从原则上 ( 而且要有一定假设 ) 可以求出所有非劣解 , 而在实际 处理上却有一定困难。如何依次变动权系数 , 而使 其得 出最优 解 , 正好 得到 所有非 劣解 , 下面举例说明。f ( x)例 10 求 V ——— max x∈ Rf ( x ) , 其中f ( x) = { f1 ( x ) , f2 ( x) }T f1 ( x) = 2 x - x2f2 ( x ) = xR = [0 , 2 ]解 易看出这个多目标问题的非劣解x * ∈ [ 1 , 2]而利用线性加权和方法 , 需要作新目标函数U ( x ) = λ( 2 x - x2 ) + (1 - λ) x,λ∈ [ 0 , 1]在 R 中找其最优解 , 对 U ( x ) 求导 , 并令其为零U′( x ) =λ( 2 - 2 x) + (1 - λ) = 0可得x =1 + λ 2λ显然当 λ= 1/ 3 时 , x * = 2 ;λ= 1 时 , x * = 1 。当 λ从 1/ 3 变 到 1 时 , 即 可得 到 全部 非劣 解 ·944·[1 , 2 ] ; 而 λ从 0 变到 1/ 3 时 , U ( x ) 的 最优解 都是 x * = 2 , 即 这时得 不到新的 非劣解。 此 例说明了原问题的解和转换后问题的解并不是简单地一一对应的。所以如何“依次”变动权系数仍然不是那么清楚的事。第 6 节 多目标线性规划的解法当所有目标函数是线性函数 , 约束条件也都是线性时 , 可有些特殊的解法。特别是泽勒内 (Zeleny ) 等将解线性规划的单纯形法给予适当修正后 , 用来 解多目 标线性规 划问题 , 或把多目标线性规划问题化成单目标的线性规划问题后求解 , 以下介绍两种方法。6. 1 逐步法 (STEM)逐步法是一种迭代法。在求解过程中 , 每进行 一步 , 分 析者把 计算 结果 告诉决 策者 , 决策者对计算结果作出评价。若认为已满意了 , 则迭代停止 ; 否则分析者再根据决策者的 意见进行修改和再计算 , 如此直到求得决策者认为满意的解为止 , 故称此法为逐步进行法 或对话式方法。设有 k 个目标的线性规划问题。V——— m axx ∈ RCx其中 R = { x | A x≤ b, x≥0} , A 为 m× n 矩阵 C 为 k× n 矩阵 , 也可表示为C=c1 ⁝ck=1 , c1 c12 , … , c1 … 2 , … , ck1 , ck cknn求解的计算步骤为 : 第 1 步 : 分别求 k 个单目标线性规划问题的解。m ax x ∈ Rc j x ,j = 1 , 2 , … , k得到最优解 x( j ) ,j = 1 , 2 , … , k, 及相应的 cj x ( j ) 。显然cj x ( j ) = maxx∈ Rc j x并作表 Z = ( zji ) , 其中 zji = ci x ( j ) , zjj = max x∈ Rc j x = cj x ( j) = Mj表 16 -1z1z2zizkx( 1 ) ⁝ x( i) ⁝ x( k)z1 1 ⁝ zi 1 ⁝ zk1z1 2 ⁝ zi 2 ⁝ zk2… z1 ⁝ … zi ⁝ … zki …i …i …z1 k ⁝ zi k ⁝ zkkMjz11z22zizkk第 2 步 : 求权系数。·054·从表 16 -1 中得到M j 及 m j = min1 ≤ i≤ kz j i ,j = 1 , 2 , … k为了找出目标值的相对偏差以及消除不同目标值的量纲不同的问题 , 进行如下处理。当 Mj > 0 ,αi =Mjmj m jn1∑( cji ) 2i = 1Mj < 0 ,αj =mjM j M jn1∑( cji ) 2i = 1经归一化后 , 得权系数πj =αj k,0 ≤ πj ≤ 1 ,∑πj = 1 ,j = 1 , 2 , … , k∑αjj = 1第 3 步 : 构造以下线性规划问题 , 并求解。L p(1 )min λ λ≥ ( Mi - ci x )πi ,i = 1 , 2 , … , kx∈ R,λ≥0假定求得的解为 x( 1 ) , 相 应的 k 个目标 值为 c1 x( 1 ) , c2 x( 1 ) , … , ck x ( 1 ) , 若 x( 1 ) 为决 策者的 理 想解 , 其相应的 k 个目标值为 c1 x( 1 ) , … , ck x ( 1 ) 。这时决策者将 x( 1 ) 的目 标值进行 比较后 , 认为满意了就可以停止计算。若认为相差 太远 , 则 考虑适 当修 正。如 考虑对 第 j 个目 标 宽容一下 , 即让点步 , 减少或增加一个 Δcj , 并将约束集 R 改为R1cj x ≥ cj x ( 1 ) - Δcj ci x ≥ ci x ( 1 ) x∈ Ri≠ j并令第 j 个 目 标 的 权系 数 πj = 0 , 这 表示 降 低 这 个 目标 的 要 求。 再求 解 以 下 线 性 规 划 问题。L p( 2)mi n λ λ≥ ( Mi - ci x )πi x∈ R1 ,λ≥0i = 1 , 2 , … , k,i≠ j若求得的解为 x( 2 ) , 再与决策者对话 , 如此重复 , 直到决策者满意为止。例 11 试求解多目标线性规划问题。max z1 = 100 x1 + 90 x2 + 80 x3 + 70 x4mi n z2 = 3 x2 + 2 x4x1 + x2 ≥30Rx3 + x4 ≥30 3 x1 + 2 x3 ≤120 3 x2 + 2 x4 ≤48 xi ≥ 0 ,i = 1～4解 为了使问题的目标函数统一为求最大化的规划问题 , 将 z2 化为·154·max w2 = - 3 x2 - 2 x4第 1 步 : 求理想解。 分别求解两个单目标线性规划问题m ax x ∈ Rz1 和 maxx∈ Rw2得到最优解x( 1 ) = ( 14 , 16 , 39 , 0 ) T相应的目标值 z11 = 5960 , w12 = - 48 , 即 z12 = 48x( 2 ) = ( 20 , 10 , 30 , 0 ) T相应的目标值 z21 = 5300 , w22 = - 30 , 即 z22 = 30第 2 步 : 作 z 和求权系数表。z1w2x(1 )596048x(2 )530030Mj596030用表中 z 的数据 , 可计算得到α1 = 0 .000645 ,α2 = 0 .1664 。于是求得权系数π1 = 0 .00387 ,π2 = 0 .99613第 3 步 : 求解以下线性规划问题。L p( 1)min λ λ≥0 .00387 [5960 - ( 100 x1 + 90 x2 + 80 x3 + 70 x4 ) ] λ≥0 .99613 (3 x2 + 2 x4 - 30)x∈ R, 由此可求得解 ( 整数近似值 ) 为λ≥0x( 1 ) = ( 19 , 11 , 31 , 0 ) T相应的目标函数值 z11 = 5370 , w12 = - 33第 4 步 : 对话再计算。 分析者把计算的结果告诉决策者 , 决策 者将这结 果与理想 值 ( Z11 , Z22 ) = ( 5960 , 30 ) 进行比较 , 认为求得的 Z1 1 = 5370 , 低于 理想值 5960 太多。 决策者要求提高 Z1 的值 , 为此他提出将 Z2 提高到 36 , 以便使 Z1 增大。这时 分析者根 据 决策者的要求 , 将原约束条件修改为 R1 。2 = 33 已接近理想 值 Z22 = 30 , 而 Z1R1C2 x≤36 C1 x≥5370 x∈ R因将第二个目标值的要求放宽了 , 故权系数 π2 = 0 , 于是有线性规划问题 :L p(2 )minλ λ≥5960 - ( 100 x1 + 90 x2 + 80 x3 + 70 x4 ) x∈ R1·254·ùŠ¿""¿¿"求解 L P( 2) 得到x( 2 ) = ( 18 , 12 , 33 , 0 ) T相应的目标值Z( 2 ) 1 = 5520 ,Z( 2 )2 = 36若这时决策者对此结果表示满意 , 即停止计算。6. 2 妥协约束法设有两个目标的情况 , 即 k = 2V - max x∈ RC xR = { x | A x≤ b, x≥0} , A 为 m× n 矩阵 , x∈ Enc1 c2 = 这方法的中心是引进一个新的超目标函 数 z = w1 c1 x + w2 c2 x。 w1 、w2 为权 系数 , w11 … c1 c1 1 … c2 c2nb∈ Em , C =n+ w2 = 1 , wi ≥0 , i = 1 , 2 ; 此外构造一个妥协约束R1 : w1 [ c1 x - z11 ] - w2 [ c2 x - z22 ] = 0 x∈ R。1 、z2 z12 分别为 c1 x、c2 x 的最大值 ( 当 x∈ R) 。求解的具体步骤为 第 1 步 : 解线性规划问题。max x∈ Rc1 x得到最优解 x( 1 ) 及相应的目标函数值 z11 。第 2 步 : 解线性规划问题。max x∈ Rc2 x得到最优解 x( 2 ) 及相应的目标函数值 z2 在具体求解时可以先用 x( 1 ) 试一试 , 看是否是 max2 。x ∈ Rc2 x 的最优 解。若是 , 则这 问题已找 到完全最优解 , 停止求解 ; 若不是 , 则求 x( 2 ) 及相应的 z2 第 3 步 : 解下面三个线性规划问题之一。2 。max x ∈ R1z ,max x∈ R1c1 x ,max x∈ R1c2 x得到的解为妥协解。例 12 试求解多目标线性规划问题。maxz1 = 3 x1 + x2z2 = x1 + 2 x2Rx1 + x2 ≤7 ≤ 5 x2 ≤ 5 x1 , x2 ≥0x1解 分别求解线性规划问题。max x ∈ Rz1和 max x ∈ Rz2得到最优解 x( 1 ) = ( 5 , 2) , z1 = 17 , x( 2 ) = (2 , 5 ) , z2 = 12 , 见图 16 -13。 若取 w1 = w2 = 0 .5 , 表示等权妥协。则有超目标函数·354·z = 0 .5 [3 x1 + x2 ] + 0 .5 [ x1 + 2 x2 ]= 2 x1 + 1 .5 x2妥协约束 R10 .5 [3 x1 + x2 - 17] - 0 .5[ x1 + 2 x2 - 12] = 0即x1 - 0 .5 x2 = 2 .5 ,x∈ R于是可以求得妥协解 x = ( 4 , 3) , w1 、w2 的取值可由决策者决定 , 这时可有不同的解。解多目标线性规划问 题的 方法 , 还有 目标 线 性规 划法 ( 详见 本 书的 第 4 章 ) 和 其 他方 法。 读 者可 参 考 有关文献资料。图 16 -13第 7 节 层次分析法层次分析法 ( analy tic hie rar chy process , A H P 法 ) 是美 国运 筹学 家沙 旦 ( T . L . Saa- t y) 于 20 世纪 70 年代提出的 , 是一种定性与定量分析相结合的多目标决策 分析方法。 特 别是将决策者的经验判断给予量化 , 对目标 ( 因素 ) 结 构复 杂且 缺乏必 要的 数据情 况下 更 为实用 , 所以近几年来此法在我国实际应用中发展较快。7. 1 AHP 法原理例如某工厂在扩大企业自主权后 , 有一笔企业留成的利润 , 这时厂领导要合理使用这 笔资金。根据各方面 反映 和 意 见 , 提出 可 供 领 导 决策 的 方 案 有 : ① 作 为 奖 金 发 给职 工 ; ②扩建职工食堂、托儿所 ; ③开办职工业余技术学校和培训班 ; ④建立图书馆 ; ⑤引进新技 术扩大生产规模等。领导在决策时 , 要考虑到调动职工劳动生产积极性 , 提高职工文化技 术水平 , 改善职工物质文化生活状况等方 面。对这 些方案 的优 劣性 进行评 价 , 排队 后 , 才 能作出决策。面对这类复杂的决策问题 , 处理的方法是 , 先 对问 题所 涉及的 因素 进行分 类 , 然后 构 造一个各因素之间相互联结的层次结构模型。因素分类 : 一为目标类 , 如合理使用今年企 业留利××万元 , 以促进企业发展 ; 二为准则类 , 这是衡量目标能否实现的标准 , 如调动职 工劳动积极性 , 提高企业的生产技术水平 ; 三 为措施 类 , 是指 实现目 标的 方案、方法、手 段 等 , 如发奖金 , 扩建集体福利设施 , 引进新技 术等 等。按目 标到 措施的 自上 而下地 将各 类 因素之间的直接影响关系排列于不同层次 , 并构成一层次结构图 , 如图 16 -14 所示。构造好各类问题的层次结构图是一项细 致的分 析工 作 , 要有 一定经 验。根据 层次 结 构图确定每一层的各因素 的 相对 重要 性的 权数 , 直 至 计算 出措 施层 各方 案 的相 对 权数。 这就给出了各方案的优劣次序 , 以便供领导决策。这个方法的原理是这样的。设有 n 件物体 A 1 , A2 , … , An ; 它们的重量分别为 w1 , w2 , … , wn 。若将它 们两两的 比较重量 , 其比值可构成 n× n 矩阵 A。·454·图 16 -14A =w1/ w1w2/ w1 …wn/ w1w1/ w2w2/ w2 …wn/ w2… w1/ wn … w2/ wn … … … wn/ wnA 矩阵具有如下性质 : 若用重量向量W = ( w1 , w2 , … , wn ) T右乘 A 矩阵 , 得到w1/ w1w1/ w2… w1/ wnw1w1A W =w2/ w1 …wn/ w1w2/ w2 …wn/ w2… w2/ wn … … … wn/ wnw2 ⁝wn= nw2 ⁝wn= n W即( A - n I) W = 0 由矩阵理论可知 , W 为特征向量 , n 为特征值。若 W 为未知时 , 则可根据决策 者对物体 之 间两两相比的关系 , 主观作出比值的判断 , 或用 Delphi 法来确定这些比值 , 使 A 矩阵为已 知 , 故判断矩阵记作 A。根据正矩阵的理论 , 可以证明 : 若 A 矩阵有以下特点 ( 设 aij = wi/ wj ) :(1 ) ai i = 1(2 ) ai j = 1/ aj i ,( i, j = 1 , 2 , … , n)(3 ) ai j = aij/ ai k ,( i, j = 1 , 2 , … , n)则该矩阵具有唯一非零的最大特征值 λm ax , 且 λm a x = n若给出的判断矩阵 A 具有上述特征 , 则该矩阵具有完 全一致 性。然而人 们对复杂 事 物的各因素 , 采用两两比较时 , 不可能做到判断的完全一致性 , 而存在估计误差 , 这必然导 致特征值及特征向量也有偏差。这时问题由 A W = n W 变成 A W′≡λm ax W′, 这里 λm ax 是 矩阵 A 的最大特征值 , W′便是带有偏差的相对权重向量。这就是由判断不相容而引起的误差。为了避免误差太大 , 所以要衡量 A 矩阵的一致性 , 当 A 矩阵完全一致时 , 因 ai i = 1 ,nn∑λi = ∑ai i = ni = 1i = 1存在唯一的非零 λ= λm ax = n。而当 A 矩阵存在判别不一致时 , 一般是 λm ax ≥ n。这时·554·nλm ax + ∑i≠ m axλi = ∑i = 1ai i = n由于是λm axn = - ∑ i≠ m axn = - ∑ i≠ m ax以其平均值作为检验判断矩阵一致性指标 ( CI)CI =λm axnn - 1=∑ i≠ m ax n - 1λi当 λm ax = n, CI = 0 , 为完全一致 ; CI 值越 大 , 判断 矩阵的 完全 一致 性越 差。一 般只 要 CI ≤ 0. 1 , 认为判断矩阵的一致性可以接受 , 否则重新进行两两比较判断。判断矩阵的维数 n 越大 , 判断的一致性将越差 , 故应放宽对高维判断矩阵一致性的要 求。于是引入修正值 RI, 见表 16-2 , 并取更为合理的 CR 为衡量判断矩阵一致性的指标。C R =CI RI表 16 -2维数12345678RI0.000.000.580.901.121.241.321.417. 2 标度为了使各因素之间进行两两比较得到量化的判断矩阵 , 引入 1～ 9 的标度。根据心理学家的研究提出 : 人们区分信息等级的极限能力为 7± 2 , 特制定表 16 -3。因为自己与自己比是同等重要的 , 因此对角线上元素不用作判断比较 , 只需要给出矩阵对角线上三角形中的元素。可见 n× n 矩阵 , 只需要给出 n( n - 1 )2个判断数值。除表 16 -3 的标度方法以外 , 还可以用其他标度方法。表 16 -3标 度 ai j定义1i 因素与 j 因素相同重要3i 因素比 j 因素略重要5i 因素比 j 因素较重要7i 因素比 j 因素非常重要9i 因素比 j 因素绝对重要2 , 4 , 6 , 8为以上两判断之间的中间状态对应的标度值倒数若 j 因素与 i 因素比较 , 得到判断值为 aj i = 1/ ai jai j = 1·654·19.45ÁT3çz.Ì(cid:13)È5é‡¢|î[(cid:15)ðððððzH7. 3 层次模型根据具体问题一般分为目标层、准 则层 和措 施层 ( 见图 16 -15 ) 。 复杂 的 问题 可分 为 总目标层、子目标层、准则 层 ( 或 制约 因 素 层 ) 、方 案 措 施 层 , 或 分 为 层 次更 多 的 结 构 ( 见 图 16 -16) 。下面举若干例子加以说明。按给出的层次结构模型 , 设为目 标层 A、 准则层 C( 有 k 个 准则 因素 ) 、措 施 层 p ( 有 n 个方案 ) 。由决 策者 用 其 他 方 法给 出 各 层 因 素之间的两两比较得出 A-C 判断矩阵为 :AC1C2…CkC1a11a12…a1 kC2a21a22…a2 k⁝⁝⁝⁝Ckak1ak2…akk图 16 -15图 16 -16然后分别给出 Ci -P 的判断矩阵 ( i = 1 , 2 , … , k) 。CiP1P2…PnP1a1 1a1 2…a1 nP2a2 1a2 2…a2 n⁝⁝⁝⁝Pnan1an2…an n用近似法计算各判断矩阵的最大特征值和特征向量。·754·¯k¸t007. 4 计算方法一般地讲 , 在 A H P 法中计算判断矩阵的最大特征 值与特征 向量 , 并不需 要很高 的精 度 , 故 用 近 似 法 计 算 即 可。 最 简 单 的 方 法 是 求 和 法 及 其 改 进 的 方 法 , 但 方 根 法 更好 , 这里只介绍方根法。1. 方根法这是一种近似计算法 , 其计算步骤为 : (1 ) 计算判断矩阵每行所有元素的几何平均值 :nnωi =∏ai ji = 1 , 2 , … , nj = 1得到 ω= (ω1 ,ω2 , … ,ωn ) T 。(2 ) 将 ωi 归一化 , 即计算 :ωi =ωi ni = 1 , 2 , … , n∑ωii = 1得到 ω= (ω1 ,ω2 , … ,ωn ) T , 即为所求特征向量的近似值 , 这也是各因素的相对权重。(3 ) 计算判断矩阵的最大特征值 λm axnλm ax = ∑i = 1( Aω) i nωi其中 ( A ω) i 为向量 Aω的第 i 个元素。(4 ) 计算判断矩阵一致性指标 , 检验其一致性。 当各层次的诸因素的相对权重都得到后 , 进行措施层的组合权重计算。2. 组合权重计算设有目标层 A、准则层 C、方案层 P 构成的层次模型 ( 当层次更多的模型 , 计算相同 ) ,目标层 A 对准则层 C 的相对权重为 :) T 准则层的各准则 Ci , 对方案层 P n 个方案的相对权重为 :ω( 1 ) = (ω( 1 ),ω( 1 ), … ,ω( 1 )12k= (ω( 2 ) 那么各方案对目标而言 , 其相对权重是通过权重 ω( 1 ) 与 ω( 2 ) 其计算可采用表格式进行 ( 见表 16 -4) 。 , … , v( 2 )ω( 2 ), … ,ω( 2 ),ω( 2 )) Tl = 1 , 2 , … , kl1 lnl2 l( l = 1 , 2 , … , k) 组合而 得到的 ,l) T 为 P 层各方案的相对权重。这时得到的 V( 2 ) = ( v( 2 ), v( 2 )1n2·854·表 16 -4权重C 层因素及权重组合权重 V( 2 )C1 C2 … CkP 层ω( 1 )1 ω(1 )2 … ω( 1) kP1ω( 2 )11 ω(2 )12 … ω( 2) 1kk v(2 ) 1 = ∑ j = 1ω( 1)j ω( 2 ) 1 jP2ω( 2 )21 ω(2 )22 … ω( 2) 2kk 2 = ∑ v(2 ) j = 1ω( 1)j ω( 2 ) 2 j⁝……Pnω( 2 )n1 ω(2 )n2 … ω( 2) nkk v(2 ) n = ∑ j = 1ω( 1)j ω( 2 ) nj注记决策论从单目标发展到多目标是在理论和实践上的一个飞跃。用多目标决策方法 来处理决策 问题更能满足实践的要求。从理论上看多目标决策方法吸取了 行为科 学等社 会科学 方面的 成就 , 强调了 决策者本人在决策过程中的中心地位 ; 此外在解的概念方面 , 提出有效解 (非劣解 )、满意解、妥协解等 更能反映复杂现实情况的解的概念。在应用方面具有广阔的前景。1974 年 Zele ny 所 编著的《线性多目 标规划》一书较系统地总结了各种处理线性多目标规划问题的 方法。20 世纪 70 年 代中期后 , 各种交互 式的多目标决策方法迅速发展起来。1982 年 Zeleny 编写了 第一本论述 多目标决策 问题的教 科书。20 世 纪70 年代以来多目标决策发展的另一特点是各种计算方法都已有较实用的软件 , 便于实用。我 国自 1977年以来也开始了多目标决策方面的研究和应用工作 , 为广大的运筹学工作者和实际工作部 门所重视 , 并取得了一定的成果。参 考 文 献[1] Zeleny M . M ultiple Crite ria Decision Making . Kyot o , 1975[2] Church man C W . In t roduction t o Opera tions Researc h . John Wiley and Son , 1957[3] СалуквадзеM E .задачиВекторнойоптимизациивтеорииуправления .медниереба, 1975[4 ] H wang C L and Mas ud A S . M ultiple Objective Decision Ma king . Met hods and Applications .Springer - Ver lag . Ber lin , 1979[5] H wang C L and Yoon K S . Multiple Att ribute Decision Making . Springea Ver lag , 1981[6] 陈 . 决策分析 . 北京 : 科学出版社 , 1987[7] 顾基发 , 魏权龄 .多目标决策问题 .应用数学与计算数学 , 1980 .1·954·99十一、启发式方法在前面各章中 , 讨 论 了 一 些 常 用 的 和 标 准 的 运 筹 学 模 型 , 给 出 并 证 明 了 它 们 的 优 化算法 , 借助这些算法 , 可 以求 出 模 型 的 最优 解。 在 论述 时 , 大 多 数 是 从 科 学 分 析 的 角 度出发 , 尽可能给出理论 的 解释 和 数 学 的 证明 , 力 求 既能 解 决 实 际 问 题 , 又 有 逻 辑 的 严 密性。但必须说明的是 , 大多数实际问题的模型 并不是 自然 而然 地呈现 在研 究者或 管理 者 的面前 , 而是需要通过人们的感知去认识和发现问题 , 经过分析然后提炼成模型。所发现 的问题往往是嵌入在大系统中的一个子系统 或子子 系统 , 关 联着社 会、经济、文化 和生 态 环境等诸多方面。而很多模型往往是在边界清晰、条件明确、判别准则合理等较理想的条件下才能进行求解的 , 所得结果与实际情况常常存在差别 , 有时差别可能很大。人们对客观世界的一般认识 , 或对某一 具体对 象的 认识 , 都要 经过 由浅 入深的 过程 ,大致包含以下步骤 :( 1) 水平 1 : 朦胧。在复杂的社会经济系统中 , 存在着很多未被人们认识清楚 , 但又能 若明若暗地感觉得到的问题的胚芽 , 这类对 象是否 需要 进一 步研究 , 还 有争 议 , 需 加以 认 真分析。(2 ) 水平 2 : 提出问题。在人们对对象进行系 统观察和 分析的 基础 上 , 将问题 的胚 芽加以总结抽象 , 而形成明确的问题。(3 ) 水 平 3 : 建 立 数 学 模 型。通 过 对 问 题 的 系 统 研 究 和 深 刻 理 解 , 明 确 其 本 质 属 性 , 将问题一般化 , 并表述为数学模型。运用数学 模型 不仅 能解决 一个 具体问 题 , 而且 可 以用来分析和处理一类 问 题 , 或 便 于 研 究 某 问 题 在 多 参 数、多 方 案 情 况 下 的 性 态 及 其 优化。( 4) 水平 4 : 求解数学模型。通常是运用某些已有的算法或提出新的算法 ( 包括移植、 改造、综合 ) , 通 过 一 定 的 步骤 , 求 出 问 题 的 解。 人 们 往 往 希 望 得 到 问 题 的 最 优 解 或 满 意解。(5 ) 水平 5 : 使用和改进。将其用于解决实际 问题并在 实践中 验证 模型 和修正 模型。这是提高人们认识水平和发展科学不可缺少的步骤。运筹学工作者或管理工作者面对的实际问题 是多 种多 样的 , 有的 问题 的结构 与运 筹 学中已有模型十分相近 , 可用相应的标准运筹学模型和算法来解决 ; 有的问题与运筹学已 有模型的结构有较大的差异 , 这时就很难套 用运 筹学中 已有 的方 法来求 解。人们 不仅 需 要掌握运筹学中已有的模型和算法 , 更重要的 是学会 去发 现和 创造能 解决 更复杂 实际 问 题的新思路、新模型和新算法。启发式方法就是人们面对复杂问题或新问题时时常借助的一种解决问题的思考模式和途径。·064·第 17 章 *启发式方法第 1 节 基 本 概 念1. 1 问题的结构有些实际问题的结构比较清晰 , 各元素 之间的 关系 明确 , 边界 清楚 , 容 易为人 们所 认 识 , 能够通过建模和使用一定的算法求得 解决 , 这 类问题 称为 良好结 构问 题。一般 而言 , 良好结构问题具有以下特征 :(1 ) 能建立起正确反映该 问题性 质的 一种“可 接受”模 型 , 与问题 有关 的主要 信息 可纳入模型之中。(2 ) 模型所需要的数据能够获得。 (3 ) 模型可解 , 能拟订出求解的 程序 性步 骤和求 解方 法 , 而且 , 得到 的解 能体 现解 决问题的可行方案。(4 ) 可拟订出明确的准则 , 用以判定解的可行性和最优性。 (5 ) 求解所需的计算量不太大 , 所需的费用不太多。 对于良好结构问题 , 常可用传统的 ( 标准的 ) 运筹学 方法 加以 解决。如 果问题 的结 构 不良 , 使用传统的运筹学方法去处理就难 以奏效。 这时 , 与 其歪曲 事实 , 忽 略或修 正某 些 重要的条件 , 勉强使用某种标准模型而使问 题易于 求解 , 还 不如保 持问 题的 本来面 目 , 建 立基本符合问题实际情况的非标准模型。前者虽 可用 已有 的标准 算法 求解 , 但由 于问 题 的模型失真 , 得到的解难于符合实际和付诸实施 ; 后者由于模型涉及因素多 , 结构复杂 , 而 与传统的标准模型相去甚远 , 难于套用已有的标准算法。在后面这种情况下 , 为得到近似 可用的解 , 分析人员必须运用自己的感知和洞察力 , 从与其有关而较基本的模型及算法中 寻求其间的联系 , 从中得到启发 , 去发现适于解 决该问 题的 思路和 途径 , 这 种方法 称为 启 发式方法 ( heuristic m ethod) , 由此建立的算法称为启发式算法 ( heuristic al gorith m) 。1. 2 启发式方法的特点由上面的叙述可知 , 启发式方法是寻求解 决问 题的一 种方 法和 策略 ; 当然 , 它 也可 以 是面向某种具体问题的一种求解方法。它建立在 人们 经验 和判断 的基 础之上 , 体 现了 人 的主观能动作用和创造力。用启发式方法解决问题时强调“满意”, 常 常是 得到满 意解 , 决 策者 就认为 可以 了 , 而不去刻意追求最优性和探求最优解。之所以这样 , 其原因是 :(1 ) 很多问题不存在严格最优解 ( 例如目标之间矛盾的多目标问题 ) , 这时 , 对目标 的满意性常比最优性更能准确地描述人们的选择行为。(2 ) 对有些问题 , 要得到它的最优解所花的代价太大 , 不合算。·164·(3 ) 从实际决策的需要出发 , 有时要求解具有过高的精度没有必要。 假定为解决某类问题设计了一个算法 , 它能用于求解所有这类问题 , 而且获得最优解 的计算工作量可表示为这类问题“大小”的多项 式函数 , 就 称这 个算法 是确 定型的 多项 式 算法 , 简称为多项式算法或有效算法。很多组 合优 化问题 ( 如设施 定位 问题、旅行 售货 员 问题、多个工件在多个设备上的加工排序问题 等 ) 不存 在多 项式算 法 , 要求 其最优 解就 需 花费巨大的代价。用启发式方法求解问题常常是通过迭代过程 实现 的 , 因而 需要拟 定出 一套科 学合 理 的解的搜索规则。为能得到满意解 , 在整个迭代过程中要不断注意和吸收新的信息 , 及时 考察所使用的求解策略 , 必要时改变原来拟定的不合适的或过时的策略 , 建立新的搜索规 则 , 注意从失败中吸取教训 , 并逐步缩小搜索范围。在工业、商业、管理等方面的很多问题 , 目前不可能找到多项式算法 , 为使问题得以解决 , 自然需要求助于启发式方法。 启发式方法具有下述优点 : (1 ) 计算步骤简单 , 要求的理论基础不高 , 可由未经高级训练的人员实现 ; (2 ) 比优化方法常可减少大量的计算工作量 , 从而显著节约开支和时间 ; (3 ) 易于将定量分析与定性分析相结合。 使用启发式方法时应注意得到的解的质量 , 使由 于采 用启 发式方 法而 使最终 决策 效 果明显有所改善。在选用方法时要考虑是否有现 成的 标准 优化方 法可 以采用 , 如 果使 用 优化方法的工作量可以接受 , 则应慎重考虑是否要选用启发式算法。1. 3 启发式策略用启发式方法解决问题时, 需要采用一定的策略。下面列出几个常用的策略, 使用时可 根据问题的性质和要求选用其中之一 ; 为得到理想的效果 , 也可将几个策略联合起来使用。 (1 ) 逐步构解策略。一个完 整的 解通常 是由 若干 个分量 组成 的。当用 该 策略 时 , 应 建立某种规则 , 按一定次序每次确定解的一个分量 , 直至得到包含所有解分量的一个完整 的解为止。(2 ) 分解合成策略。为求解 一个复 杂的 大问题 , 可 首先 将其分 解为 若干 个小 的子 问 题 , 再选用合适的方法 ( 包括启发式方法、优化 方法、模 拟方法 等 ) 按一 定顺 序求解 每个 子 问题 , 根据 子问题 之间 及其 与总问 题的 关系 ( 例 如递 进关系、包含 ( 嵌 套 ) 关系、平 行关 系 等 ) , 将子问题的解作为下一阶子问题的输入 , 或在相容原则下将子问题的解进行综合 , 经 合成最后得到总问题合乎要求的解。(3 ) 改进策略。运用这一策 略时 , 首先 从一 个初始 解 ( 初 始解不 必一 定是可 行解 ) 出 发 , 然后对解的质量 ( 包括它产生的目标函数值、可 行性及 可接 受性 等 ) 进行 评价 , 并采 用 某种启发式方法设计改进规则 , 对解加以改 进 , 反复进 行如 上的评 价和 改进 , 直至 得到 满 意的解为止。为获得初始解 , 可用逐步构解策略或 ( 和 ) 分解合成策略 , 也可使用其他近似方法。在启发式方法中 , 好的初始解可大大提高求解效率和质量。(4 ) 搜索学习策略。本策略包括在解空间中的定向搜索以及在 搜索过程 中发现和 收 集新的信息 , 并根据对新信息的分析 , 重新确认或改变搜索方向 , 修正搜索参数 , 消去不必 ·264·要的搜索范围 , 以有效提高搜索效率 , 尽快获得问题的解。第 2 节 应用及例子启发式方法在理论上是基于对比、分析、探索、综合的一种科学方法 , 同时它在使用上 又是一种艺术 , 其成功程度取决于使用者的 水平。为 能较 好地 运用启 发式 方法解 决实 际 问题 , 使用者必须具有比较广阔的知识 , 较好 的基础 和善 于观察、分 析、联想 的能力 , 以 及 善于从类似问题的解决方法中获得启示的敏感性和素质。下面结合几个例子研究如何使用启发式方法来解决实际问题。2. 1 多个工件在多个设备上加工的排序问题n 个工件在 m 台设备上加工的最优顺序问题 , 目前尚无多项式算法。此处为简单计 , 仅考虑两台设备 A 和 B , 研究 n 个工件 ( j = 1 , 2 , … , n) 在这两台设备上顺次加工时应如何 排列工件的顺序 , 才能使总加工时间 ( 从在设 备 A 上 加工 第一个 工件 起到在 设备 B 上 加 工完最后一个工件止这段时间 ) 尽可 能短。此 处要 求每 个工 件都 先在 设备 A 上 加 工 , 加 工完后再在设备 B 上加工。在第 9 章中曾经指出 , 如果工件在设备 A 上的加工顺序与在设备 B 上的加工顺序 不 同 , 由于增加了等待时间 , 将使总加工时间延 长。因此 , 在 研究 该问题 时可 将这种 情况 排 除在外 , 不予考虑。即使如此 , 可能的排序方案仍有 n ! 个 , 随着工 作数 n 的增多 , 其计 算 工作量增加很快。下面寻求用启发式方法的解决途径。下面这个例子给出了 6 个工 件 分别 在 设 备 A 和 设备 B 上 的加 工 时间 A j 和 B j ( 分 钟 ) ( 见表 17 -1 ) , 所有工件均先在设 备 A 上加 工 , 再在 设 备 B 上加 工。要 求 确定 使总 加 工时间最短的加工顺序。表 17 -1加工工时件123456间设备A306060208090B707050603040为了得到该问题的启发式方法 , 此处运用逐步构解策略。 先考虑工 件 1 和工件 2 , 其 可能的排序方案有两个 : 1 -2 和 2 -1( 图 17 -1 ) 。由于 B1 = B2 , A1 < A2 , 故将工件 1 排在 前 面加工所需的总加工时间较少。再看工件 2 和工件 3 , 由 于 A2 = A3 , B3 < B2 , 故 将工件 3 排在工件 2 的后面加工所需的总加工时间较少 ( 图 17 -2) 。虽然表 17 -1 和表 17 -2 分别比较了两个工件 的不 同加 工顺序 , 且 依据 的是例 子中 给 定的特定情况 , 但我们可由此得到启发 , 将其推广应用到 n 个工件在两台设备上的加工顺·364·Ù"c5‘(cid:7)L9ðz¨(cid:30)Lz9ð¨(cid:30)图 17 -1图 17 -2序问题 , 拟定出以下启发式迭代步骤。(1 ) 令 i = 1 , k = 0。 (2 ) 找最小加工时间 , 即tr = min{ A1 , A2 , … , An , B1 , B2 , … , Bn }(3 ) 若 tr = A j , 则安排工件 j 为第 i 个加工工 件 , 并 置 i: = i + 1 ; 若 tr = B j , 则 安排 工件 j 为第 ( n - k) 个加工工件 , 并置 k: = k + 1。(4 ) 将 A j 和 B j 从式 ( 17 -1 ) 的工件加 工时间 表中 删去 , 即 不再考 虑已 排好加 工顺 序的工件 j。(5 ) 转步骤 ( 2) , 直至式 ( 17 -1) 中的工件加工时间表变成空集。 现将上述步骤应用于表 17 -1 所示的排序问题 , 得到各工件的加工顺序如下 :4→1 →2→3 →6→5 总加工时间等于 370 分钟 , 具体情况示于图 17 -3 中。需要指出的是 , 对在两台设备上加工 n 个工 件的 问题来 说 , 用图 17 -3 所示方 法求 得 的解是最优解。但是 , 如将其扩展应用到在 m 台设备上加工 n 个工 件的一般 加工排序 问 题 , 所得结果一般就不再是最优解了。然而 , 用这种思想却常常能得到较好的解。 ·464·(17 -1)图 17 -32. 2 旅行售货员( 旅行商 ) 问题旅行售货员问题 ( tr aveling salesm an problem , TSP ) 指 的是 : 一个 售货 员从某 城市 出 发 , 访问 n 个城市 ( 售货 ) 各一次且仅一次 , 然后 回到原 地 , 他走 什么样 的路 线才能 使走 过 的路程最短 ( 或旅行费用最低 ) 。在第 10 章曾经说到 , 这个问题就是寻求总权最小的哈密 尔顿 ( Ha milton ) 回路问题。到目前为止 , 一般 T SP 问 题还 没有多 项式 算法 , 对于 较大 的 问题 ( 例如 n 大于 40 ) 就需要使用启发式方法求解。下面介绍两种可用的启发式算法。1. C-W 节约算法这种算法由 Clarke 和 Wrigh t 提出 , 下面说明其基本思想和迭代步骤。 假定有 n 个访问地 ( 例如城市 ) , 把每个访问地看成一个点 , 并取其中的一个点为基点 ( 起点 ) , 例 如 以 1 点 为 基 点。 首 先 将 每 个 点 与该 点 相 连 接 , 构 成 线 路 1 → j → 1 ( j = 2 , 3 , … , n) , 这样就得到了一个具有 n - 1 条线路的图 ( 当然 , 这时尚未形成 H amilton 回路 ) 。 旅行者按此线路访问这 n 个点所走的路程总和为nz = 2 ∑c1 j(17 -2)j = 2其中 c1 j 为由点 1 到点 j ( j = 2 , … , n) 的路段长度 , 注意此处假定 c1 j = cj1 ( 对所有 j ) 。若连接点 i 和点 j ( i, j≠ 1) , 即使旅行者走弧 ( i, j ) 时 ( 当然这时就不再经过弧 ( i, 1 ) 和(1 , j) ) , 所引起的路程节约值 s( i, j) 可计算如下 :s( i, j) = 2c1 i + 2c1 j - ( c1 i + c1 j + ci j )(17 -3) 对不同的点对 ( i, j ) , s( i, j ) 越大 , 旅行者通过弧 ( i, j ) 时 所节约的 路程越 多 , 因 而应优先 将 其安排到旅行线路中去 , 使旅行者旅行时通过这一条弧。= c1 i + c1 j - ci j在具体应用该方法时 , 可按以下步骤进行。 ( 1) 选取基点 , 例如选取点 1 为基点。将基点与其他各点连接 , 得到 n - 1 条线路 1 →j→ 1( j = 2 , 3 , … , n) 。(2 ) 对不违背限制条件的所有可连接点对 ( i, j) , 如下计算其节约值 ( i, j 不为基点 ) :s( i, j) = c1 i + c1 j - ci j (3 ) 将所有 s( i, j) 按其值的大小由大到小排列。·564·(4 ) 按 s( i, j) 的上述顺序 , 逐个考查其端点 i 和 j , 若满足以下条件 , 就将弧 ( i, j) 插入到线路中。其条件是 :① 点 i 和点 j 不在一条线路上 , 而且 ② 点 i 和点 j 均与基点相邻。 (5 ) 返回步骤 ( 4) , 直至考查完所有可插入弧 ( i, j) 为止。 通过以上各迭代步骤 , 使问题的解逐步得 到改善 , 最 后达 到满意 解 ( 也 有可能 达到 最优解 ) 。例 1 试用 C-W 节约算法求解下 述旅 行售 货员 问 题 , 已知 有 7 个 访问 点 , 其 位置 如图 17 -4 中所示。图 17 -4解 先按图 17 -4 给出的数据计算各点对之间的欧氏距离 c( i, j) , 计算结果列入距 离 表 ( 表 17 -2) 中。由于已假设 ci j = cj i ( 对所有 i 和 j ) , 故该表 中各元 素的值以 主对角线 为 对称。表 17 -2终点ABCDEF始点A014. 1424. 7023. 7119. 2417. 0313B14. 14013.0423.7115.8113.0410C24.7013.04020.1012.6511.6613D23.7123.7120.1008.2510.7713E19.2415.8112.658.2502.836F17.0313.0411.6610.772.8304G13.0010.4413.4513.606.714.120取 G 为 基 点 ( 也 可 取 其 他 的 访 问 点 为 基 点 ) , 构 成 初 始 线 路 图 ( 图 17 -5 ) 。 再 用 式 (17 -3 ) 计算将弧 ( i, j ) ( i, j≠ G) 插入到线路中时引起 的路程节 约值 , 并按节 约值由大 到 ·664·G. 00.44.45.60.71.12MB]RA6=2" (cid:18)" (cid:18)BR|q26"(cid:18)BR26"|(cid:18)BR26"|(cid:18)BR6"2|(cid:18)BR26"|(cid:18)BR62"(cid:18)小的顺序将它们填入表 17 -3 中。图 17 -5表 17 -3序号弧节约值序号弧节约值1( D, E)12.069( A , D)2.892( B, C)10.8510( A, C)1.753( A , B)9.3011( B, F)1.524( E , F)8.0012( B, E)1.345( C, E)7.5113( A, E)0.476( C, D)6.9514( B, D)0.337( D, F)6.9515( A, F)0.098( C, F)5.91按节约值从大到小的顺序 , 对每条弧加以考查 , 看能否将其插入到旅行线路中。若能将其插入 , 就对旅行线路作相应的改变。本例的线路调整过程如表 17 -4 所示。表 17 -4序号弧线路与说明插入该弧的节约值0G→ A→ G,G→ B→ G,G→ C→ G,G→ D→ G,G→ E→ G,G→ F→ G1( D, E)G→ A→ G,G→ B→ G,G→ C→ G,G→ D→ E→ G,G→ F→ G12.062( B, C)G→ A→ G,G→ B→ C→ G,G→ D→ E→ G,G→ F→ G10.853( A, B)G→ A→ B→ C→ G,G→ D→ E→ G,G→ F→ G9.304( E, F)G→ A→ B→ C→ G,G→ D→ E→ F→ G8.005( C, E)E 点与基点 G 不相邻 , 不插入06( C, D)G→ A→ B→ C→ D→ E→ F→ G6.95·764·©Ý«ðÀÝ«ðÀÝ«ðÝÀð«ÝÀ«ðÝÀð«ÝÀð««ð当插入弧 ( C, D) 之后 , 线路已包含所有要访问的点 , 这时算法终止。用该 方法得到 的旅行线路 ( 见图 17 -6) 是G→ A→ B→ C→ D→ E→ F→ G该条旅行线路的总长度z = 2 (13 .0 + 10 .44 + 13 .45 + 13 .60 + 6 .71 + 4 .12 ) -( 12 .06 + 10 .85 + 9 .30 + 8 .00 + 6 .95 )= 2× 61 .32 - 47 .16 = 75 .48图 17 -6用这种方法得出的解不一定是最优解 , 但这里得到的解是本例的最优解。 在实际问题中 , 点对点 的距 离应 以路 段 的真 实长 度为 准 ( 不 一定 为 两点 间 的欧 氏 距 离 ) , 其间的往返距离也可以不相等。这时 , 插 入某一 段弧 引起 的路程 节约 值的计 算应 根 据实际情况进行。2. 几何法该方法由 J .P .Norback 和 R .F .Love 提出 , 它基 于对 各访 问点构 成的 几何图 形的 分析 , 以此确定初始旅行线路和不在初始线路上的各点的插入顺序和插入位置。根据一般几何观察可知 , 最短旅行线路应具有以下直观性质 : ① 线路自身不相交 ; ② 各段线路 应 处 于 由 所 有 访 问 点 形 成 的 凸 包 上 或 其 凸 包 内 部 ( 这 里 所 说 的 凸 包( convex h ull ) 是指包含所有访问点的最小凸集 ) 。图 17 -7 中给出了连接同样 4 个点 的两条线 路 , 显 然 , 自 相 交的线路 ( 图 17 -7 中虚线所示者 ) A→ C→ B→ D 要比不自交 的 线路 A → B→ C→ D 为长。根据上述分析 , 启发我们拟定出求解 旅行售货 员问题的 下述迭代步骤 :图 17 -7(1 ) 找出由欲访问各点构成的凸包。·864·(2 ) 在凸包上的点 , 按其出现的自然顺序访问 ( 注意不要使旅行 线路自交 ) , 从而形 成一初始旅行线路。(3 ) 将不在初始旅行线路上的各个点 I( 位于凸包内的访问点 ) , 与已在旅行线路上的 所有点相连。设 P 与 Q 为已 在旅 行线路 上的 任两个 相邻 点 , ∠ P0 I0 Q0 为 所有 ∠ PI Q 角 度中的最大者 , 则将 I0 插入到 P0 和 Q0 之间。(4 ) 重复进行步骤 ( 3) , 每 次在旅 行线 路上 增加一 个新 点 , 直至所 有欲 访问点 都被 引入到旅行线路中为止。这时就构成了一条哈密尔顿回路。下面用这种方法求解 例 1 。其迭 代 过程 示 于图 17 -8 中。开 始时 构 成 凸包 A BCD A ( 图 17 -8( a ) ) , 以它为初始旅行线 路 , 然后 将不在 初始 旅行 线路上 的 E、F 和 G 三 点分 别 与 A , B, C, D 四点相连 ( 图 17 -8 ( b ) ) , 考 查以 E, F 和 G 为 角顶 , 分别 以 A B, BC, CD 和 D A 为对边形成的各个角度 , 由于∠ CE D 最 大 , 故将 点 E 插 入在 C 和 D 两 点之 间 , 形 成 新的旅行线路 A BCE D A ( 图 17 -8 ( c ) ) 。现 不 在 访 问 线路 上 的 点 为 F 和 G, 连 接 E F 和 EG, 考查以 F 和 G 为角顶的各角 , 因∠ DG A 最大 , 从而将 G 点插入 到 D 点 和 A 点之间 , 这时的访问线路变为 A BCE DGA( 图 17 -8( d) ) 。如上继续 , 将点 F 插入到 D 点和 G 点之 间 , 这就得到了本问题的哈密尔 顿回路 , 可 以它 作为 本问 题的 解 ( 图 17 -8 ( e ) ) , 其 线路 总 长为 :14 .14 + 13 .04 + 12 .65 + 8 .25 + 10 .77 + 4 .12 + 13 .00 = 75 .97作为比较 , 将该问题的最优解示于图 17 -8( f) 中 , 其最优线路总长度 为 75 .48 , 它可 以通过交换线路中 E 和 D 这两个相邻点的连接顺序而得到。图 17 -8用几何法虽未得到例 1 的最优解 , 但它的精确度还是很高的 , 常常可以达到比较满意的结果。·964·除上述两种方法外 , 还有一些其他的算法可用于求解旅行售货员问题 , 在解决实际问题时 , 可同时使用几种算法 , 从中选取最好的结果。2. 3 车辆调度问题车辆调度问题 ( vehicle schedu ling problem , VSP ) 是由 Dan tzig 和 Ra mser 于 1959 年 提出的 , 虽经多人潜心研究 , 但由于其复杂性大 , 目前仍未找到多项式算法 , 专家们多把精 力集中于研究高质量的启发式算法方面。所谓 VSP 问题 , 一般指的是 : 对一 系列发 货点 和收货 点 , 组织 适当 的行车 路线 , 使 车 辆有序地通过它们 , 在满足一定的约束条件下 ( 例如货物需求量与发送量 , 交发货时间 , 车 量容量限制 , 行驶里程限制 , 行驶时间限制等 ) , 力争实现一定的目标 ( 如空驶里程最短 , 运 输费用极小 , 车辆按时到达 , 使用车辆数量尽可能少等 ) 。车辆调度问题的分类法很多 , 例如可根据车辆满载与否分为满载问题与非满载问题 , 根据可用车场数分为单车场问题与多车场问题 , 根据 可用 车辆 的车型 数分 为单车 型问 题 与多车型问题 , 根据决策者的要求分为单目标问题与多目标问题等。下面研究单车型、多车场、满载运输问题的一 种启 发式 算法 , 并考 虑使 总空驶 里程 极小这一目标 ( 它对运输公司的运输效益有极大影响 ) 。1. 数学模型设某运输公司有 n 个车场可以使用 , 即可从车 场 Am + 1 , A m + 2 , … , Am + n 发出空 车和 接 收空车 , 它们与各货运业务的发货点和收货 点位 于同一 个道 路网 上。各车 场可派 出的 空 车数分别为 bm + 1 , bm + 2 , … , bm + n , 可接收的空车数分别为 b′m + 1 , b′m + 2 , … , b′m + n 。假定运 输 公司要完成的货运业务有 m 项 : A1 , A2 , … , Am , 其货运 量分别 是 g1 , g2 , … , g m , 完 成各 项 业务所需的车辆数分别为 a1 , a2 , … , am 。按照每项业务的要求将货物由发货点运到收 货点 全部 为重车 行驶 , 其 行车路 线可 由网络上任意点对间的最短路方法确定 ( 参看本书第 10 章有关部分 ) 。现考虑第 i 项货运业务 , 用 i′表示其发点 , i″表示其收点。 由于由 i′到 i″是重 车行驶 , 按照运输计划的要求 , 不管选用什么运输组 织方案 , 都 必须 完成此 项工 作 , 并已假 定选 择 的运输路径为“最短路径”, 故在研究使总空驶里程极小化问题时 , 可将这一运输业务看成 一个点 , 称为收缩点或重载点 i。对于每一个重载点 i, 为运出 其货物 量 gi 需 ai 辆空 车 , 它们 将货 物运 抵 目的 地卸 车 后 , 又提供出 ai 辆空车 , 这些空车驶向其他货运业务的发点 ( 这时为 空车行驶 ) , 继续装 货 执行运输任务。由此可见 , 执行运输任务的每输货车都如此交替地进行空驶和重驶 , 直至 完成一天 ( 或半天 ) 的运输任务 , 返回某一车场为止。设由点 i 发往点 j ( i, j 为车场或重载点 ) 的空车数为 xi j , 其空驶里程为 ci j , 则使总 空驶里程极小化的空车调度问题可描述如下 ( 称为问题 T ) 。·074·m+ nm+ nmin z = ∑i = 1∑j = 1ci j x i jm+ n∑xi j = ai ,i = 1 , 2 , … , mj = 1m+ n∑xi j ≤ bi ,i = m + 1 , m + 2 , … , m + nT :j = 1(17 -4)m+ n∑xi j = aj ,j = 1 , 2 , … , mi = 1m+ n∑xi j ≤ b′j ,j = m + 1 , m + 2 , … , m + ni = 1xi j ≥0 且为整数此处 ai ( aj ) 可由下式得出ai = gi/ q,若 gi/ q 为整数ai =gi q+ 1 , 若 gi/ q 不为整数(17 -5)式中 ,gi q为数值不大于 g i/ q 的最大整数 ;q 为一辆车的可载量。 ci j 根据 实际情况 选用 , 可取为 点 i 到点 j 的 广义最短 距离。为 避免由车 场发出的 空车不经重载点直接驶向车场 , 令ci j = M ,i, j = m + 1 , m + 2 , … , m + n其中 M 为一足够大的正数。问题 T 的运输表示于表 17 -5。表 17 -5收空车重 载 点车场发 车 数发空车A1 A2 … AmAm + 1A m+ 2 … Am + n重A1a1载点A2⁝C - CC - Fa2⁝Amam车Am + 1bm+ 1Am + 2bm+ 2场⁝F - CF - F⁝A m+ nbm+ n收 车 数a1a2… amb′m+ 1 b′m + 2… b′m+ n2. 算法从所周知 , 运输问题的表上作业法是一种有效的标准算法 , 而且能方便地得出整数最优·174·解, 在构造求解问题式 (17 -4) 的启发式算法时, 应注意充分利用表上作业法的优点。首先仅考虑重载点 , 得问题 T 0 :mmmin z1 = ∑i = 1∑j = 1ci j x i jm∑j = 1xi j = ai ,i = 1 , 2 , … , m(17 -6)m∑xi j = aj ,j = 1 , 2 , … , mi = 1xi j ≥0 且为整数这是一个一般的产销平衡运输问题 , 可直接用表上作业法求解 , 设求出的最优解为 X( 0 ) = ( x( 0 ) i j ) 。以这个解中的非零变量的值作为问题 T 中对应变 量的值 , 其他 变量取值 为零 , 这 就得到了问题 T 的一个可行解。但是 , 用上述方法得到的解无法以它 为根据 进行 派车 , 因而 是不 可接 受的。为 此 , 需 要设计一套解的判别和调整规则 , 使从 X( 0 ) 出发 , 经有限步迭 代 , 而得到问 题 T 的可接 受 最优解或满意解。其步骤如下。(1 ) 解的扩展 对解 X( 0 ) 中的每一个非零分量 x( 0 )i j > 0 ( i, j = 1 , 2 , … , m) , 计算δi j = minm + 1 ≤ i≤ m + n{ ci j| bi > 0} + minm + 1 ≤ j≤ m + n{ ci j | b′j > 0} - ci j(17 -7)m式中 ,bi = bi - ∑x( 0 )ij,i = m + 1 , … , m + n(17 -8)j = 1mb′j = b′j - ∑x( 0 )i j,j = m + 1 , … , m + n(17 -9)i = 1由式 (17 -7 ) 算出的 δi j 值 , 为按 下述 方法 调整 x ( 0 )i j 一 个单 位引 起的 空驶 里 程增 加量。若由式 (17 -7) 得出的 δi j 来自 k 行和 l 列 [ k, l∈ ( m + 1 , m + n) ] , 则把 x( 0 ) 和 x i l , 这时 , 将 x( 0 )i j 、x( 0 )k j 和 x ( 0 )i l 三者的值分别调整为 :i j > 0 扩展 至 xk jxi j : = x( 0 )i jmin{ x( 0 ) i j, bk , b′l }xk j : = x( 0 )k j + min{ x( 0 )i j, bk , b′l }( 17 -10)xi l : = x( 0 )i l + min{ x( 0 )i, bk , b′l }解的 扩 展 工 作 按 δi j 的 大 小 由 小 到 大 依 次 进 行 , 直 至 找 出 要 求 的 可 接 受 解 , 即 在表 17 -5 中的 F— C 和 C— F 区含有适当的非零解分量。如此得到的解记为 X( 1 ) = ( x( 1 ) 显然 , 它对问题 T 是可行的。当 δi j < 0 时 , 按此调整得到的解 X( 1 ) 优于 X( 0 ) 。i j ) ,(2 ) 解的收缩 本步骤是步骤 ( 1 ) 的 逆 过 程。当 表 17 -5 中 F— C 区和 C— F 区 的 非 零解 分 量 的 值mm+ nmm+ n∑ 每一对 x( 1 )∑∑ k j 和∑ x( 1 ) k j > 0 和 x( 1 )x( 1 ) i l 比派车数要大时 , 需将非零解分量 向 C— C 区 收缩。这 时 , 对k = m+ 1i = 1l = m+ 1j = 1i l > 0 k, l ∈ ( m + 1 , m + n) ; i, j ∈ ( 1 , m), 计算δ′i j = min{ ci j - ck j - ci l | x( 1 )k j > 0 , x( 1 )i l > 0}( 17 -11)·274·并以此进行解的调整 :xk j : = x ( 1 ) xi l : = x( 1 ) j : = x( 1 )min{ x ( 1 ) - min{ x( 1 ) j + min{ x( 1 ) k jmin{ x ( 1 ) - min{ x( 1 ) j + min{ x( 1 ) k jk jk ji li, x ( 1 ) , x( 1 ) , x( 1 )i l }i l }i l }( 17 -12)调整后得到的解记为 X( 2 ) = ( x( 2 )j ) , 这个解也是问题 T 的可行解。3. 安排行车路线经上述调整得到的解 ( X( 1 ) 和 X( 2 ) ) , 是问题 T 的可接受可行解 , 可作为安排行车路线的依据。安排行车路线时首先在可接受可行解 X 的非零分量中寻求下述序列 :x k 1k2 > 0 ,xk 2k3 > 0 ,其中下标 k1 , kq ∈ m + 1 , m + n , 即 xk 区。如此即可得到一条初始行车路线如下 :1k2xk 3 和 xkkp… ,4 > 0 ,xk( 17 -13) 分别 位于表 17 -5 中的 F— C 区和 C— Fq > 0kpkqAk1 → Ak2 → Ak3 → Ak4 →…→ Akp → Ak q车场重载点车场有了初始行车路线 ( 一条或若干条 ) 之后 , 再根据具体的约束条件 ( 例如一条线路的长 度限制 , 时间限制 , 各条线路的均匀性要求等 ) 进行调整 ( 包括某些线路的截短或合并 ) , 最 后由调度员选择合适的驾驶员执行。实用证明 , 本启发式方法的运算速度快 , 精度高 , 可达到很好的效果。需要指出 , 解的调整工作 ( 扩展、收缩 ) 应结合安排行车路线反复进行。注记寻求和接受“启发”是人们认识问题和解决问题的一种常用的思维模式和手段 , 从而使“启发式方法”成为人们解决复杂的、非结构化问题的一种常用方法和策略。近年来 , 在启发式方法理论研究和应用技术不断深入和扩大的同时 , 人们对神经网络( neural networks )算法、模拟退火( simulated annealing)算法、禁忌搜索( tabusearch)算法和遗传算法(genetic algorithm)等亚启发式算法的研究和应用也得到了广泛重视和发展 , 取得了许多有价值的研究成果。对该方面有兴趣的读者 , 请参阅有关专著和教材。例如 :参 考 文 献[ 1] [ 日 ]玄光男 , 程润伟著 . 遗传算法与工程设计 . 北京 : 科学出版社 , 2000[ 2] 胡守仁 , 余少波 , 戴葵著 . 神经网络导论 . 北京 : 国防科技大学出版社 , 1993启发式方法在计算机和信息科学方面的应用 , 可参阅 :[ 美 ] Georg e E .L ug er 著 .史忠植 , 张银 奎 , 赵志 译 . 人工 智能 . 复 杂问 题求 解的 结构 和策 略 . 北京 : 机械工业出版社 , 2004习题17. 1 什么是启发式方法 ? 说明用启发式方法解决实际问题的过程和步骤。 17. 2 在解决实际问题时应如何运用启发式策略 ? 除本书上列出的几个启发式策略 ·374·之外 , 你认为还有什么样的策略可以使用 ?17. 3 对在多台设备上加工多个工件的工件 排序 问题 来说 , 应如 何衡 量不同 排序 方 案的优劣 ? 你认为应有哪些准则 ? 这些准则的适用条件是什么 ? 请举出两个实例加以详 细说明。17. 4 试说明 C-W 节约算法的基本思想 , 你认为还可用它解决哪些方面的问题 ? 举例加以说明。17. 5 试将 N orback 和 Love 提出的几何法与 C-W 节约算法进行比较。 17. 6 说明本书所述货运车辆优化调度算法 的原 理和 求解步 骤 , 并绘 出求解 过程 框图。请简要回答以下问题 :(1 ) 若有两种车型的车可 用 , 书中提 出的 模型应 怎样 修改 ? 在 书中 所提 算法 的启 发下 , 试拟定出一套求解的迭代步骤。(2 ) 你认为应如何将书中提出的模型和算法推广到多目标的情形。 17. 7 表 17-6 给出了 12 个工件在设备 A 和 B 上的加工时间 , 要求 : (1 ) 若所有工件都先在设 备 A 上加 工 , 再在 设备 B 上加 工 , 试确 定使 总 加工 时间 最短的工件加工顺序 , 并计算总加工时间。(2 ) 若工件 8～ 12 先在设备 B 上加工 , 再在设备 A 上 加工 , 其他条 件同上 , 试设计 一启发式算法 , 以计算最小总加工时间和安排相应的工件最优加工顺序。表 17 -6工件1234567891011设备A5811247123936B5943769458917. 8 有 4 个工件 J1 , J2 , J3 , J4 , 要求 在三 台设备 A , B, C 上 顺次 加工 , 各工 件在 各 设备上的加工时间示于表 17 -7 中 , 试构造一启 发式算 法 , 用于 寻求使 总加 工时间 最短 的 工件加工顺序。 表 17 -7工件J1J2J3J4设备A51095B7578C9451017. 9 有 10 个城市 , 它们在坐标系中的位置如表 17-8 所示 , 试完成以下工作 : (1 ) 用 C-W 节约算法求出经过每个城市一次且仅一次的一条最短线路。 (2 ) 用 N orback 和 Love 提出的几何法 , 求出经过上述每个城市一次且仅一次的最短线路。·474·12104MÄÀ©×3Jd{’î(cid:5)M©ÄÀ3dî’’î(cid:28)(cid:5)M©À×3d{î’(cid:28)(cid:5)¨J7ìJ7ì¨7J¨ì7Jì¨(3 ) 比较上述两种方法得出的结果 , 并设计一种启发式方法 , 对 上述较差 的结果进 行改进。表 17-8城市坐标12345678910x0587101516181820y020124154188151717. 10 有一运输问题 , 它有 3 个重载点和 2 个车场 , 其运 输表如表 17-9 所示。表 中 小方框内的数字为两点间的车辆空驶距离 , 1 , 2 和 3 三项 运输业务 的重载 里程 ( 已将装 卸 车时间折算在内 ) 分别为 7 , 8 和 9 , 其他有 关情 况如表 中所 示。此 外 , 要求 车 辆的 每条 行 车路线总长度 ( 包括重驶、空驶及装卸车所用时 间的折 算长度 ) L 在45～ 60 之 间。试用 本 章给出的车辆优化调度启发式算法 , 求出其满意的可接受可行解 , 并据此排出行车路线。 表 17 -9收空车重 载 点车场发车数发空车1234541210810110重288610载26点124614237646MM车4≤4场51428MM≤6收车数1067≤8≤7参 考 资 料[1] Kan ti S warup P K .Gupta a nd Man Moohan . Opera tions Resear ch . Sulta n Chand & Sons . 1982[2] Ham dy A Ta ha . Oper ations R esea rch : An In t roduction . 3rd Edition . T he Macmillan Compa ny ,1980[3] 郭耀煌等编著 . 运筹学原理与方法 . 成都 : 西南交通大学出版社 , 1994[4] 郭耀煌 , 李军 . 满载问题的车辆路线安排 . 系统工程学报 , 1995 年第 2 期[5] 郭耀煌 . 安排城市卡车行车路线的一种新算法 . 系统工程学报 , 1989 年第 2 期·574·YÓ÷–5}ürº(cid:28)ÓÑ”–p35ür(cid:14)ÑYL–êü”r(cid:28)(cid:14)×5d¨(cid:6)K©ØcðÂKÁcð’Â–Á4z’(cid:7)Â–Áð’ÅÂÁ’(cid:7)ÅÂ5{(cid:6)(cid:6)