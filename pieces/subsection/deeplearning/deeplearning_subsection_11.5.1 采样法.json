[
    {
        "strategy": "subsection",
        "source": "deeplearning",
        "title": "11.5.1 采样法",
        "content_length": 1793,
        "content": "Title: 11.5.1 采样法\nContent:\n采样法 (Sampling Method) 也称为蒙特卡罗方法 (Monte Carlo Method)或统计模拟方法, 是 20 世纪 40 年代中期提出的一种通过随机采样来近似估计一采样也叫抽样。\n\n在本节中, 我们假设 $x$ 为连续变量. 如果 $x$是离散变量, 可以将积分替换为求和。\n\n蒙特卡罗方法诞生于 20 世纪 40 年代美国的 “曼哈顿计划”, 其名字来源于摩纳哥的一个以赌博业闻名的城市蒙特卡罗, 象征概率。\\\\\n些计算问题数值解的方法. 随机采样指从给定概率密度函数 $p(x)$ 中抽取出符合其概率分布的样本.\n\n由于电子计算机的出现和快速发展, 这种方法作为一种独立方法被提出来,使得当时很多难以计算的问题都可以通过随机模拟的方法来进行估计.\n\n为了计算公式(11.95)中的 $\\mathbb{E}_{p}[f(x)]$, 我们可以通过数值解的方法来近似计算. 首先从 $p(x)$ 中独立抽取 $N$ 个样本 $x^{(1)}, x^{(2)}, \\cdots, x^{(N)}, f(x)$ 的期望可以用这 $N$个样本的均值 $\\bar{f}_{N}$ 来近似, 即\n\n\n\\begin{equation*}\n\\bar{f}_{N}=\\frac{1}{N}\\left(f\\left(x^{(1)}\\right)+\\cdots+f\\left(x^{(N)}\\right)\\right) \\tag{11.96}\n\\end{equation*}\n\n\n根据大数定律, 当 $N$ 趋向于无穷大时, 样本均值收玫于期望值.\n\n\n\\begin{equation*}\n\\bar{f}_{N} \\xrightarrow{P} \\mathbb{E}_{p}[f(x)] \\quad \\text { 当 } N \\rightarrow \\infty . \\tag{11.97}\n\\end{equation*}\n\n\n这就是采样法的理论依据.\n\n采样法的一个最简单的应用例子是计算圆周率 $\\pi$. 我们知道半径为 $r$ 的圆的面积为 $\\pi r^{2}$, 而直径为 $2 r$ 的正方形的面积为 $4 r^{2}$. 当我们用正方形去嵌套一个相切的圆时, 它们的面积之比是 $\\frac{1}{4} \\pi$. 当不知道 $\\pi$ 时, 我们无法计算圆的面积. 因此,需要通过模拟的方法来进行近似估计. 首先在正方形内部按均值采样的方式随机生成若干点, 计算它们与圆心点的距离, 从而判断它们是否落在圆的内部. 然后去统计落在圆内部的点占到所有点的比例. 当有足够的点时, 这个比例应该接近于 $\\frac{1}{4} \\pi$, 从而近似估算出 $\\pi$ 的值.\n\n随机采样 采样法的难点是如何进行随机采样, 即如何让计算机生成满足概率密度函数 $p(x)$ 的样本. 我们知道, 计算机可以比较容易地随机生成一个在 $[0,1]$区间上均布分布的样本 $\\xi$. 如果要随机生成服从某个非均匀分布的样本, 就需要一些间接的采样方法.\n\n如果一个分布的概率密度函数为 $p(x)$, 其累积分布函数 $\\operatorname{cdf}(x)$ 为连续的严格增函数, 且存在逆函数 $\\operatorname{cdf}^{-1}(y), y \\in[0,1]$, 那么我们可以利用累积分布函数的逆函数来生成服从该随机分布的样本. 假设 $\\xi$ 是 $[0,1]$ 区间上均匀分布的随机变量, 则 $\\operatorname{cdf}^{-1}(\\xi)$ 服从概率密度函数为 $p(x)$ 的分布.\n\n但当 $p(x)$ 非常复杂, 其累积分布函数的逆函数难以计算, 或者不知道 $p(x)$的精确值, 只知道未归一化的分布 $\\hat{p}(x)$ 时, 就难以直接对 $p(x)$ 进行采样, 往往需要使用一些间接的采样策略, 比如拒绝采样、重要性采样、马尔可夫链蒙特卡罗采样等. 这些方法一般是先根据一个比较容易采样的分布进行采样, 然后通过一些策略来间接得到符合 $p(x)$ 分布的样本.\n\n数值解就是用数值方法求出解, 给出一系列对应的自变量和解. 数值解和解析解或闭式解相对应。"
    },
    {
        "id": "chatcmpl-9458346LVtRlMEgYUcGeQLrlQPU3Q",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"采样法和蒙特卡罗方法有何关联？\",\n    \"回答1\": \"采样法也称为蒙特卡罗方法，是一种通过随机采样来近似估计一些计算问题数值解的方法。因此，采样法与蒙特卡罗方法密切相关，都是利用随机采样来进行数值估计。\",\n    \"问题2\": \"蒙特卡罗方法的理论依据是什么？\",\n    \"回答2\": \"蒙特卡罗方法的理论依据是大数定律。根据大数定律，当随机样本数量趋向于无穷大时，样本均值收敛于期望值。这一理论依据支持了蒙特卡罗方法的数值估计过程。\",\n    \"问题3\": \"采样法如何应用于计算公式中的期望值？\",\n    \"回答3\": \"为了计算公式中的 $\\text{E}_{p}[f(x)]$，可以通过数值解的方法来近似计算。首先从概率密度函数 $p(x)$ 中独立抽取 $N$ 个样本 $x^{(1)}, x^{(2)}, \\text{...}, x^{(N)}$，然后利用这些样本的均值 $\\bar{f}_{N}$ 来近似期望值。\",\n    \"问题4\": \"采样法如何应用于计算圆周率 $\\boldsymbol{\\text{π}}$ 的例子中？\",\n    \"回答4\": \"采样法可以应用于计算圆周率 $\\boldsymbol{\\text{π}}$。通过在正方形内部按均匀采样的方式随机生成若干点，并计算它们与圆心点的距离，可以统计落在圆内部的点占到所有点的比例。当有足够的点时，这个比例应该接近于 $\\frac{1}{4} \\boldsymbol{\\text{π}}$，从而近似估算出 $\\boldsymbol{\\text{π}}$ 的值。\",\n    \"问题5\": \"在采样法中，如何进行随机采样？\",\n    \"回答5\": \"在采样法中，如果要随机生成服从某个非均匀分布的样本，就需要一些间接的采样方法。当一个分布的概率密度函数为 $p(x)$ 且其累积分布函数 $\\text{cdf}(x)$ 存在逆函数 $\\text{cdf}^{-1}(y), y \\text{ 在 } [0,1]$ 时，可以利用累积分布函数的逆函数来生成服从该随机分布的样本。\",\n    \"问题6\": \"当概率密度函数 $p(x)$ 非常复杂时，如何进行采样？\",\n    \"回答6\": \"当概率密度函数 $p(x)$ 非常复杂或者不知道 $p(x)$ 的精确值时，往往需要使用一些间接的采样策略，比如拒绝采样、重要性采样、马尔可夫链蒙特卡罗采样等。这些方法一般是先根据一个比较容易采样的分布进行采样，然后通过一些策略来间接得到符合 $p(x)$ 分布的样本。\",\n    \"问题7\": \"数值解和解析解有何区别？\",\n    \"回答7\": \"数值解是用数值方法求出解，给出一系列对应的自变量和解。而解析解或闭式解则是通过代数或解析方法得到的精确解。因此，数值解和解析解相对应，但其求解过程和结果表达形式有所不同。\",\n    \"问题8\": \"为什么蒙特卡罗方法也称为统计模拟方法？\",\n    \"回答8\": \"蒙特卡罗方法也称为统计模拟方法，因为它利用随机采样来进行数值估计，通过模拟大量随机实验来近似计算数学问题的数值解。这种模拟过程与统计学中对随机现象进行模拟和推断的思想相吻合。\",\n    \"问题9\": \"蒙特卡罗方法诞生于哪个历史背景？\",\n    \"回答9\": \"蒙特卡罗方法诞生于20世纪40年代美国的 “曼哈顿计划”，起源于摩纳哥的一个以赌博业闻名的城市蒙特卡罗。它最初作为一种独立方法被提出来，使得当时很多难以计算的问题都可以通过随机模拟的方法来进行估计。\",\n    \"问题10\": \"为什么在蒙特卡罗方法中需要大量随机实验？\",\n    \"回答10\": \"在蒙特卡罗方法中需要大量随机实验，因为通过大量随机实验可以更好地逼近真实情况，并且根据大数定律，当实验次数足够多时，实验结果会逐渐收敛于真实值。因此，大量随机实验是保证蒙特卡罗方法准确性和可靠性的重要手段。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710760055,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1493,
            "prompt_tokens": 4038,
            "total_tokens": 5531
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]