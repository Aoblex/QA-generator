[
    {
        "strategy": "subsection",
        "source": "deeplearning",
        "title": "12.2.1 生成模型",
        "content_length": 4598,
        "content": "Title: 12.2.1 生成模型\nContent:\n在给定受限玻尔兹曼机的联合概率分布 $p(\\boldsymbol{h}, \\boldsymbol{v})$ 后, 可以通过吉布斯采样方法生成一组服从 $p(\\boldsymbol{h}, \\boldsymbol{v})$ 分布的样本.\n\n吉布斯采样参见第11.5.4.3节。\n\n全条件概率 吉布斯采样需要计算每个变量 $V_{i}$ 和 $H_{j}$ 的全条件概率. 受限玻尔兹曼机中同层的变量之间没有连接. 从无向图的性质可知, 在给定可观测变量时,隐变量之间互相条件独立. 同样, 在给定隐变量时, 可观测变量之间也互相条件独立. 因此有\n\n\n\\begin{align*}\n& p\\left(v_{i} \\mid \\boldsymbol{v}_{\\backslash i}, \\boldsymbol{h}\\right)=p\\left(v_{i} \\mid \\boldsymbol{h}\\right),  \\tag{12.31}\\\\\n& p\\left(h_{j} \\mid \\boldsymbol{v}, \\boldsymbol{h}_{\\backslash j}\\right)=p\\left(h_{j} \\mid \\boldsymbol{v}\\right), \\tag{12.32}\n\\end{align*}\n\n\n其中 $\\boldsymbol{v}_{\\backslash i}$ 为除变量 $V_{i}$ 外其他可观测变量的取值, $\\boldsymbol{h}_{\\backslash j}$ 为除变量 $H_{j}$ 外其他隐变量的取值. 因此, $V_{i}$ 的全条件概率只需要计算 $p\\left(v_{i} \\mid \\boldsymbol{h}\\right)$, 而 $H_{j}$ 的全条件概率只需要计算 $p\\left(h_{j} \\mid \\boldsymbol{v}\\right)$.\n\n定理 12.2 -受限玻尔兹曼机中变量的条件概率: 在受限玻尔兹曼机中, 每个可观测变量和隐变量的条件概率为\n\n\n\\begin{align*}\n& p\\left(v_{i}=1 \\mid \\boldsymbol{h}\\right)=\\sigma\\left(a_{i}+\\sum_{j} w_{i j} h_{j}\\right)  \\tag{12.33}\\\\\n& \\left.p\\left(h_{j}=1 \\mid \\boldsymbol{v}\\right)=\\sigma\\left(b_{j}+\\sum_{i} w_{i j} v_{i}\\right)\\right) \\tag{12.34}\n\\end{align*}\n\n\n其中 $\\sigma$ 为 Logistic 函数.\n\n证明. (1) 先计算 $p\\left(h_{j}=1 \\mid \\boldsymbol{v}\\right)$. 可观测层变量 $\\boldsymbol{v}$ 的边际概率为\n\n\n\\begin{align*}\nP(\\boldsymbol{v}) & =\\sum_{\\boldsymbol{h}} P(\\boldsymbol{v}, \\boldsymbol{h})=\\frac{1}{Z} \\sum_{\\boldsymbol{h}} \\exp (-E(\\boldsymbol{v}, \\boldsymbol{h}))  \\tag{12.35}\\\\\n& =\\frac{1}{Z} \\sum_{\\boldsymbol{h}} \\exp \\left(\\boldsymbol{a}^{\\top} \\boldsymbol{v}+\\sum_{j} b_{j} h_{j}+\\sum_{i} \\sum_{j} v_{i} w_{i j} h_{j}\\right)  \\tag{12.36}\\\\\n& =\\frac{\\exp \\left(\\boldsymbol{a}^{\\top} \\boldsymbol{v}\\right)}{Z} \\sum_{\\boldsymbol{h}} \\exp \\left(\\sum_{j} h_{j}\\left(b_{j}+\\sum_{i} w_{i j} v_{i}\\right)\\right)  \\tag{12.37}\\\\\n& =\\frac{\\exp \\left(\\boldsymbol{a}^{\\top} \\boldsymbol{v}\\right)}{Z} \\sum_{\\boldsymbol{h}} \\prod_{j} \\exp \\left(h_{j}\\left(b_{j}+\\sum_{i} w_{i j} v_{i}\\right)\\right)  \\tag{12.38}\\\\\n& =\\frac{\\exp \\left(\\boldsymbol{a}^{\\top} \\boldsymbol{v}\\right)}{Z} \\sum_{h_{1}} \\sum_{h_{2}} \\cdots \\sum_{h_{h}} \\prod_{j} \\exp \\left(h_{j}\\left(b_{j}+\\sum_{i} w_{i j} v_{i}\\right)\\right) \\tag{12.39}\n\\end{align*}\n\n\n利用分配律。\n\n\\href{https://nndl.github.io/}{https://nndl.github.io/}\n\n\n\\begin{align*}\n& =\\frac{\\exp \\left(\\boldsymbol{a}^{\\top} \\boldsymbol{v}\\right)}{Z} \\prod_{j} \\sum_{h_{j}} \\exp \\left(h_{j}\\left(b_{j}+\\sum_{i} w_{i j} v_{i}\\right)\\right)  \\tag{12.40}\\\\\n& =\\frac{\\exp \\left(\\boldsymbol{a}^{\\top} \\boldsymbol{v}\\right)}{Z} \\prod_{j}\\left(1+\\exp \\left(b_{j}+\\sum_{i} w_{i j} v_{i}\\right)\\right) . \\tag{12.41}\n\\end{align*}\n\n\n将 $h_{j}$ 为 0 或 1 的取值代入计算.\n\n固定 $h_{j}=1$ 时, $p\\left(h_{j}=1, \\boldsymbol{v}\\right)$ 的边际概率为\n\n\n\\begin{align*}\n& p\\left(h_{j}=1, \\boldsymbol{v}\\right)=\\frac{1}{Z} \\sum_{\\boldsymbol{h}, h_{j}=1} \\exp (-E(\\boldsymbol{v}, \\boldsymbol{h}))  \\tag{12.42}\\\\\n& =\\frac{\\exp \\left(\\boldsymbol{a}^{\\top} \\boldsymbol{v}\\right)}{Z} \\prod_{k, k \\neq j}\\left(1+\\exp \\left(b_{k}+\\sum_{i} w_{i k} v_{i}\\right)\\right) \\exp \\left(b_{j}+\\sum_{i} w_{i j} v_{i}\\right) . \\tag{12.43}\n\\end{align*}\n\n\n由公式 (12.41) 和公式 (12.43), 可以计算隐变量 $h_{j}$ 的条件概率为\n\n\n\\begin{align*}\np\\left(h_{j}=1 \\mid \\boldsymbol{v}\\right) & =\\frac{p\\left(h_{i}=1, \\boldsymbol{v}\\right)}{p(\\boldsymbol{v})}  \\tag{12.44}\\\\\n& =\\frac{\\exp \\left(b_{j}+\\sum_{i} w_{i j} v_{i}\\right)}{1+\\exp \\left(b_{j}+\\sum_{i} w_{i j} v_{i}\\right)}  \\tag{12.45}\\\\\n& =\\sigma\\left(b_{j}+\\sum_{i} w_{i j} v_{i}\\right) \\tag{12.46}\n\\end{align*}\n\n\n(2) 同理, 可观测变量 $v_{i}$ 的条件概率 $p\\left(v_{i}=1 \\mid \\boldsymbol{h}\\right)$ 为\n\n\n\\begin{equation*}\np\\left(v_{i}=1 \\mid \\boldsymbol{h}\\right)=\\sigma\\left(a_{i}+\\sum_{j} w_{i j} h_{j}\\right) \\tag{12.47}\n\\end{equation*}\n\n\n公式(12.46)和公式(12.47)也可以写为向量形式, 即\n\n\n\\begin{align*}\n& p(\\boldsymbol{h}=\\mathbf{1} \\mid \\boldsymbol{v})=\\sigma\\left(\\boldsymbol{W}^{\\top} \\boldsymbol{v}+\\boldsymbol{b}\\right)  \\tag{12.48}\\\\\n& p(\\boldsymbol{v}=\\mathbf{1} \\mid \\boldsymbol{h})=\\sigma(\\boldsymbol{W} \\boldsymbol{h}+\\boldsymbol{a}) \\tag{12.49}\n\\end{align*}\n\n\n吉布斯采样 在受限玻尔兹曼机的全条件概率中, 可观测变量之间互相条件独立, 隐变量之间也互相条件独立. 因此, 受限玻尔兹曼机可以并行地对所有的可观测变量 (或所有的隐变量) 同时进行采样, 从而可以更快地达到热平衡状态.受限玻尔兹曼机的采样过程如下:\n\n（1）给定或随机初始化一个可观测的向量 $\\boldsymbol{v}_{0}$, 计算隐变量的概率, 并从中采样一个隐向量 $\\boldsymbol{h}_{0}$.\n\n（2）基于 $\\boldsymbol{h}_{0}$, 计算可观测变量的概率, 并从中采样一个可观测的向量 $\\boldsymbol{v}_{1}$.\n\n(3) 重复 $t$ 次后,获得 $\\left(\\boldsymbol{v}_{t}, \\boldsymbol{h}_{t}\\right)$.\n\n(4) 当 $t \\rightarrow \\infty$ 时, $\\left(\\boldsymbol{v}_{t}, \\boldsymbol{h}_{t}\\right)$ 的采样服从 $p(\\boldsymbol{v}, \\boldsymbol{h})$ 分布.\n\n图12.4也给出了上述过程的示例.\n\n\\href{https://nndl.github.io/}{https://nndl.github.io/}\n\n\n\n图 12.4 受限玻尔兹曼机的采样过程"
    },
    {
        "id": "chatcmpl-945IrLpZfo7hoPCphp7HCbY0LK2ys",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"什么是吉布斯采样方法？它可以用来生成什么样的样本？\",\n    \"回答1\": \"吉布斯采样方法是一种用于从给定受限玻尔兹曼机的联合概率分布 $p(\\boldsymbol{h}, \\boldsymbol{v})$ 中生成样本的方法。通过吉布斯采样方法，可以生成一组服从 $p(\\boldsymbol{h}, \\boldsymbol{v})$ 分布的样本。\",\n    \"问题2\": \"在受限玻尔兹曼机中，全条件概率吉布斯采样需要计算哪些变量的全条件概率？\",\n    \"回答2\": \"在受限玻尔兹曼机中，全条件概率吉布斯采样需要计算每个可观测变量 $V_{i}$ 和每个隐变量 $H_{j}$ 的全条件概率。根据受限玻尔兹曼机的性质，在给定可观测变量时，隐变量之间互相条件独立；同样，在给定隐变量时，可观测变量之间也互相条件独立。\",\n    \"问题3\": \"受限玻尔兹曼机中变量的条件概率是如何定义的？\",\n    \"回答3\": \"在受限玻尔兹曼机中，每个可观测变量和隐变量的条件概率分别为 $p\\big(v_{i}=1 \\big| \\boldsymbol{h}\\big)=\\frac{1}{1+e^{-(a_{i}+\\boldsymbol{w}_{i}^{\\top} \\boldsymbol{h})}}$ 和 $p\\big(h_{j}=1 \\big| \\boldsymbol{v}\\big)=\\frac{1}{1+e^{-(b_{j}+\\boldsymbol{v}^{\\top} \\boldsymbol{w}_{j})}}$，其中 $\\boldsymbol{w}_{i}$ 为第 $i$ 个权重向量，$\\boldsymbol{w}_{j}$ 为第 $j$ 个权重向量。\",\n    \"问题4\": \"受限玻尔兹曼机中的吉布斯采样过程是如何进行的？\",\n    \"回答4\": \"在受限玻尔兹曼机中的吉布斯采样过程包括以下步骤：（1）给定或随机初始化一个可观测的向量 $\\boldsymbol{v}_{0}$, 计算隐变量的概率, 并从中采样一个隐向量 $\\boldsymbol{h}_{0}$；（2）基于 $\\boldsymbol{h}_{0}$, 计算可观测变量的概率, 并从中采样一个可观测的向量 $\\boldsymbol{v}_{1}$；（3）重复 $t$ 次后,获得 $\\big(\\boldsymbol{v}_{t}, \\boldsymbol{h}_{t}\\big)$；（4）当 $t \\rightarrow \\text{无穷大}$ 时, $\\big(\\boldsymbol{v}_{t}, \\boldsymbol{h}_{t}\\big)$ 的采样服从 $p(\\boldsymbol{v}, \\boldsymbol{h})$ 分布。\",\n    \"问题5\": \"受限玻尔兹曼机中的全条件概率吉布斯采样具有什么优势？\",\n    \"回答5\": \"受限玻尔兹曼机中的全条件概率吉布斯采样具有并行性优势。在全条件概率中，可观测变量之间互相条件独立，隐变量之间也互相条件独立。因此，可以并行地对所有的可观测变量或所有的隐变量同时进行采样，从而更快地达到热平衡状态。\",\n    \"问题6\": \"受限玻尔兹曼机中的边际概率公式是怎样计算得到的？\",\n    \"回答6\": \"在受限玻尔兹曼机中，可观测层变量 $\\boldsymbol{v}$ 的边际概率 $P(\\boldsymbol{v})$ 可以通过对所有可能状态下的联合概率求和得到。利用分配律和指数函数的性质，最终可以得到边际概率公式。\",\n    \"问题7\": \"受限玻尔兹曼机中的边际概率公式如何计算隐变量的条件概率？\",\n    \"回答7\": \"通过边际概率公式和对隐变量取不同取值进行计算，可以得到隐变量 $h_{j}$ 的条件概率为 $p\\big(h_{j}=1 \\big| \\boldsymbol{v}\\big)=\\frac{1}{1+e^{-(b_{j}+\\boldsymbol{w}_{j}^{\\top} \\boldsymbol{v})}}$。这一过程利用了边际概率公式和条件概率定义。\",\n    \"问题8\": \"受限玻尔兹曼机中的边际概率公式如何计算可观测变量的条件概率？\",\n    \"回答8\": \"通过边际概率公式和对可观测变量取不同取值进行计算，可以得到可观测变量 $v_{i}$ 的条件概率为 $p\\big(v_{i}=1 \\big| \\boldsymbol{h}\\big)=\\frac{1}{1+e^{-(a_{i}+\\boldsymbol{w}_{i}^{\\top} \\boldsymbol{h})}}$。这一过程利用了边际概率公式和条件概率定义。\",\n    \"问题9\": \"受限玻尔兹曼机中的边际概率公式如何写成向量形式？\",\n    \"回答9\": \"受限玻尔兹曼机中的边际概率公式可以写成向量形式，即 $p(\\boldsymbol{h}=\\textbf{1} \\big| \\boldsymbol{v})=\\frac{1}{1+e^{-(\\boldsymbol{W}^{\\top} \\boldsymbol{v}+\\boldsymbol{b})}}$ 和 $p(\\boldsymbol{v}=\\textbf{1} \\big| \\boldsymbol{h})=\\frac{1}{1+e^{-(\\boldsymbol{W} \\boldsymbol{h}+\\boldsymbol{a})}}$。\",\n    \"问题10\": \"受限玻尔兹曼机中吉布斯采样过程如何帮助实现更快地达到热平衡状态？\",\n    \"回答10\": \"在受限玻尔兹曼机中，吉布斯采样过程可以并行地对所有的可观测变量或所有的隐变量同时进行采样。这使得系统能够更快地达到热平衡状态，并且能够更快地生成服从联合概率分布 $p(\\boldsymbol{h}, \\boldsymbol{v})$ 的样本。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710760725,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1886,
            "prompt_tokens": 5055,
            "total_tokens": 6941
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]