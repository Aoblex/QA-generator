[
    {
        "strategy": "subsection",
        "source": "deeplearning",
        "title": "11.5.2 拒绝采样",
        "content_length": 1279,
        "content": "Title: 11.5.2 拒绝采样\nContent:\n拒绝采样 (Rejection Sampling) 是一种间接采样方法, 也称为接受-拒绝采样 (Acceptance-Rejection Sampling ).\n\n假设原始分布 $p(x)$ 难以直接采样, 我们可以引入一个容易采样的分布 $q(x)$,一般称为提议分布 (Proposal Distribution), 然后以某个标准来拒绝一部分的样本使得最终采集的样本服从分布 $p(x)$. 在拒绝采样中, 已知未归一化的分布 $\\hat{p}(x)$, 我们需要构建一个提议分布 $q(x)$ 和一个常数 $k$, 使得 $k q(x)$ 可以覆盖函数 $\\hat{p}(x)$, 即 $k q(x) \\geq \\hat{p}(x), \\forall x$, 如图11.15所示.\n\n\n\n图 11.15 拒绝采样\n\n对于每次抽取的样本 $\\hat{x}$, 计算接受概率 (Acceptance Probability):\n\n\n\\begin{equation*}\n\\alpha(\\hat{x})=\\frac{\\hat{p}(\\hat{x})}{k q(\\hat{x})} \\tag{11.98}\n\\end{equation*}\n\n\n并以概率 $\\alpha(\\hat{x})$ 来接受样本 $\\hat{x}$. 拒绝采样的采样过程如算法11.2 所示.\n\n\\section*{算法 11.2 拒绝采样的采样过程}\n输入: 提议分布 $q(x)$, 常数 $k$, 样本集合 $\\mathcal{V}=\\varnothing$;\n\n1 repeat\n\n\\begin{center}\n\\begin{tabular}{l|l}\n2 & 根据 $q(x)$ 随机生成 \\\\\n3 & 计算接受概率 $\\alpha(\\hat{x}) ;$ \\\\\n$\\mathbf{4}$ & 从 $(0,1)$ 的均匀分 \\\\\n$\\mathbf{5}$ & if $z \\leq \\alpha(\\hat{x})$ then \\\\\n$\\mathbf{6}$ & $\\mathcal{V}=\\mathcal{V} \\cup\\{\\hat{x}\\} ;$ \\\\\n7 & end \\\\\n\\end{tabular}\n\\end{center}\n\n8 until 获得 $N$ 个样本 $(|\\mathcal{V}|=N)$;\n\n输出: 样本集合 $\\mathcal{V}$\n\n为简单起见, 我们把概率密度函数为 $p(x)$ 的分布简称为分布 $p(x)$,下同\n\n提议分布在很多文献中也翻译为参考分布。\\\\\n判断一个拒绝采样方法的好坏就是看其采样效率, 即总体的接受率. 如果函数 $k q(x)$ 远大于原始分布函数 $\\hat{p}(x)$, 拒绝率会比较高, 采样效率会非常不理想. 但要找到一个和 $\\hat{p}(x)$ 比较接近的提议分布往往比较困难. 特别是在高维空间中, 其采样率会非常低,导致很难应用到实际问题中."
    },
    {
        "id": "chatcmpl-9459SelBZH9N4cYels8e1aoEK49vn",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"拒绝采样与直接采样有何区别？\",\n    \"回答1\": \"拒绝采样是一种间接采样方法，需要引入一个容易采样的提议分布 $q(x)$，并以某个标准来拒绝一部分的样本使得最终采集的样本服从分布 $p(x)$。而直接采样则是从目标分布 $p(x)$ 中直接生成样本，无需引入其他分布。\",\n    \"问题2\": \"在拒绝采样中，如何计算每次抽取的样本的接受概率？\",\n    \"回答2\": \"对于每次抽取的样本 $\\tilde{x}$，计算其接受概率 $\\frac{\\tilde{p}(\\tilde{x})}{k q(\\tilde{x})}$，其中 $\\tilde{p}(\\tilde{x})$ 为未归一化的目标分布在点 $\\tilde{x}$ 处的值，$q(\\tilde{x})$ 为提议分布在点 $\\tilde{x}$ 处的值，$k$ 为常数。\",\n    \"问题3\": \"拒绝采样的采样过程中，如何确定是否接受抽取的样本？\",\n    \"回答3\": \"在拒绝采样的采样过程中，根据计算得到的接受概率 $\\frac{\\tilde{p}(\\tilde{x})}{k q(\\tilde{x})}$，以概率 $\\frac{\\tilde{p}(\\tilde{x})}{k q(\\tilde{x})}$ 来接受样本 $\\tilde{x}$。\",\n    \"问题4\": \"拒绝采样方法的好坏如何评判？\",\n    \"回答4\": \"判断一个拒绝采样方法的好坏主要看其采样效率，即总体的接受率。如果函数 $k q(x)$ 远大于原始分布函数 $\\tilde{p}(x)$，拒绝率会比较高，采样效率会非常不理想。但要找到一个和 $\\tilde{p}(x)$ 比较接近的提议分布往往比较困难。特别是在高维空间中，其采样率会非常低，导致很难应用到实际问题中。\",\n    \"问题5\": \"拒绝采样中提议分布的作用是什么？\",\n    \"回答5\": \"在拒绝采样中，提议分布的作用是引入一个容易采样的分布 $q(x)$，并通过合适选择提议分布和常数 $k$ 来覆盖目标分布函数 $\\tilde{p}(x)$。这有助于实现间接采样，并最终得到服从目标分布的样本。\",\n    \"问题6\": \"为什么在高维空间中拒绝采样的采样率会非常低？\",\n    \"回答6\": \"在高维空间中，要找到一个和目标分布函数 $\\tilde{p}(x)$ 比较接近的提议分布往往比较困难。由于高维空间中样本空间巨大且复杂度高，导致拒绝率会比较高，采样效率会非常不理想。\",\n    \"问题7\": \"拒绝采样方法中常数 $k$ 的作用是什么？\",\n    \"回答7\": \"在拒绝采样方法中，常数 $k$ 的作用是调整提议分布 $q(x)$ 和未归一化的目标分布 $\\tilde{p}(x)$ 之间的比例关系。通过合适选择常数 $k$，可以使得 $k q(x)$ 能够覆盖函数 $\\tilde{p}(x)$。\",\n    \"问题8\": \"拒绝采样方法与马尔可夫链蒙特卡洛方法有何异同？\",\n    \"回答8\": \"拒绝采样方法和马尔可夫链蒙特卡洛方法都是用于从复杂分布中抽取样本的方法。不同之处在于拒绝采样是一种间接采样方法，需要引入提议分布；而马尔可夫链蒙特卡洛方法则是通过构建马尔可夫链来实现直接抽取符合目标分布的样本。\",\n    \"问题9\": \"拒绝采样方法适用于哪些类型的分布？\",\n    \"回答9\": \"拒绝采样方法适用于原始分布 $p(x)$ 难以直接采样的情况。通过引入一个容易采样的提议分布 $q(x)$ 和合适选择常数 $k$，可以使得最终采集的样本服从原始分布 $p(x)$。\",\n    \"问题10\": \"为什么要求提议分布能够覆盖未归一化的目标分布函数？\",\n    \"回答10\": \"要求提议分布能够覆盖未归一化的目标分布函数是为了确保最终采集的样本能够服从目标分布。通过合适选择提议分布和常数 $k$，使得 $k q(x)$ 能够覆盖函数 $\\tilde{p}(x)$，从而实现间接采样并得到符合目标分布的样本。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710760142,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1487,
            "prompt_tokens": 3419,
            "total_tokens": 4906
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]