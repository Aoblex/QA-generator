[
    {
        "strategy": "subsection",
        "source": "deeplearning",
        "title": "8.5.1 端到端记忆网络",
        "content_length": 1752,
        "content": "Title: 8.5.1 端到端记忆网络\nContent:\n端到端记忆网络 ( End-To-End Memory Network,MemN2N) [Sukhbaatar et al., 2015] 采用一种可微的网络结构, 可以多次从外部记忆中读取信息. 在端到端记忆网络中, 外部记忆单元是只读的.\n\n\\href{https://nndl.github.io/}{https://nndl.github.io/}\\\\\n给定一组需要存储的信息 $m_{1: N}=\\left\\{m_{1}, \\cdots, m_{N}\\right\\}$, 首先将其转换成两组记忆片段 $A=\\left[\\boldsymbol{a}_{1}, \\cdots, \\boldsymbol{a}_{N}\\right]$ 和 $C=\\left[\\boldsymbol{c}_{1}, \\cdots, \\boldsymbol{c}_{N}\\right]$, 分别存放在两个外部记忆单元中, 其中 $A$ 用来进行寻址, $C$ 用来进行输出.\n\n主网络根据输入 $\\boldsymbol{x}$ 生成 $\\boldsymbol{q}$, 并使用键值对注意力机制来从外部记忆中读取相关信息 $\\boldsymbol{r}$,\n\n\n\\begin{equation*}\n\\boldsymbol{r}=\\sum_{n=1}^{N} \\operatorname{softmax}\\left(\\boldsymbol{a}_{n}^{\\top} \\boldsymbol{q}\\right) \\boldsymbol{c}_{n} \\tag{8.25}\n\\end{equation*}\n\n\n并产生输出\n\n\n\\begin{equation*}\n\\boldsymbol{y}=f(\\boldsymbol{q}+\\boldsymbol{r}), \\tag{8.26}\n\\end{equation*}\n\n\n其中 $f(\\cdot)$ 为预测函数. 当应用到分类任务时, $f(\\cdot)$ 可以设为 Softmax 函数.\n\n多跳操作 为了实现更复杂的计算, 我们可以让主网络和外部记忆进行多轮交互. 在第 $k$ 轮交互中, 主网络根据上次从外部记忆中读取的信息 $\\boldsymbol{r}^{(k-1)}$, 产生新的查询向量\n\n\n\\begin{equation*}\n\\boldsymbol{q}^{(k)}=\\boldsymbol{r}^{(k-1)}+\\boldsymbol{q}^{(k-1)} \\tag{8.27}\n\\end{equation*}\n\n\n其中 $\\boldsymbol{q}^{(0)}$ 为初始的查询向量, $\\boldsymbol{r}^{(0)}=0$.\n\n假设第 $k$ 轮交互的外部记忆为 $A^{(k)}$ 和 $C^{(k)}$,主网络从外部记忆读取信息为\n\n\n\\begin{equation*}\n\\boldsymbol{r}^{(k)}=\\sum_{n=1}^{N} \\operatorname{softmax}\\left(\\left(\\boldsymbol{a}_{n}^{(k)}\\right)^{\\top} \\boldsymbol{q}^{(k)}\\right) \\boldsymbol{c}_{n}^{(k)} \\tag{8.28}\n\\end{equation*}\n\n\n在 $K$ 轮交互后, 用 $\\boldsymbol{y}=f\\left(\\boldsymbol{q}^{(K)}+\\boldsymbol{r}^{(K)}\\right)$ 进行预测. 这种多轮的交互方式也称为多跳 (Multi-Hop ) 操作. 多跳操作中的参数一般是共享的. 为了简化起见, 每轮交互的外部记忆也可以共享使用, 比如 $A^{(1)}=\\cdots=A^{(K)}$ 和 $C^{(1)}=\\cdots=C^{(K)}$.\n\n端到端记忆网络结构如图8.7所示.\n\n\n\n图 8.7 端到端记忆网络\n\n\\href{https://nndl.github.io/}{https://nndl.github.io/}"
    },
    {
        "id": "chatcmpl-944XEBdWesAQJpqriLlkJq9FFAgwL",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"端到端记忆网络中的外部记忆单元具有什么特点？\",\n    \"回答1\": \"在端到端记忆网络中，外部记忆单元是只读的。它们存储了需要存储的信息，并且可以被多次从中读取信息，但不能进行写入或修改。\",\n    \"问题2\": \"端到端记忆网络是如何处理给定一组需要存储的信息的？\",\n    \"回答2\": \"端到端记忆网络首先将给定的一组需要存储的信息转换成两组记忆片段 $A=\\big[\\boldsymbol{a}_{1}, \\text{...}, \\boldsymbol{a}_{N}\\big]$ 和 $C=\\big[\\boldsymbol{c}_{1}, \\text{...}, \\boldsymbol{c}_{N}\\big]$，分别存放在两个外部记忆单元中。其中 $A$ 用来进行寻址，$C$ 用来进行输出。\",\n    \"问题3\": \"端到端记忆网络是如何从外部记忆中读取相关信息的？\",\n    \"回答3\": \"主网络根据输入 $\\boldsymbol{x}$ 生成查询向量 $\\boldsymbol{q}$，并使用键值对注意力机制来从外部记忆中读取相关信息 $\\boldsymbol{r}$。具体地，通过计算 $\\boldsymbol{r}=\\text{softmax}\\big(\\boldsymbol{a}_{n}^{\\top} \\boldsymbol{q}\\big) \\boldsymbol{c}_{n}$ 来实现。\",\n    \"问题4\": \"端到端记忆网络是如何产生输出的？\",\n    \"回答4\": \"端到端记忆网络产生输出的过程是通过 $\\boldsymbol{y}=f\\big(\\boldsymbol{q}+\\boldsymbol{r}\\big)$ 实现的，其中 $f(\\bullet)$ 为预测函数。在应用到分类任务时，$f(\\bullet)$ 可以设为 Softmax 函数。\",\n    \"问题5\": \"多跳操作在端到端记忆网络中起到什么作用？\",\n    \"回答5\": \"多跳操作在端到端记忆网络中用于实现更复杂的计算。通过多轮交互，主网络可以根据上次从外部记忆中读取的信息产生新的查询向量，从而更好地获取和利用外部记忆中的信息。\",\n    \"问题6\": \"第 $k$ 轮交互中主网络如何产生新的查询向量？\",\n    \"回答6\": \"在第 $k$ 轮交互中，主网络根据上次从外部记忆中读取的信息 $\\boldsymbol{r}^{(k-1)}$，产生新的查询向量 $\\boldsymbol{q}^{(k)}$，计算方式为 $\\boldsymbol{q}^{(k)}=\\boldsymbol{r}^{(k-1)}+\\boldsymbol{q}^{(k-1)}$。\",\n    \"问题7\": \"多跳操作后如何进行预测？\",\n    \"回答7\": \"在经过 $K$ 轮交互后，使用 $\\boldsymbol{y}=f\\big(\\boldsymbol{q}^{(K)}+\\boldsymbol{r}^{(K)}\\big)$ 进行预测。这种多轮的交互方式也称为多跳操作。\",\n    \"问题8\": \"端到端记忆网络结构中的多跳操作是否涉及参数共享？\",\n    \"回答8\": \"是的，多跳操作中的参数一般是共享的。为了简化起见，每轮交互的外部记忆也可以共享使用，比如 $A^{(1)}=\\text{...}=A^{(K)}$ 和 $C^{(1)}=\\text{...}=C^{(K)}$。\",\n    \"问题9\": \"端到端记忆网络结构如何实现多轮交互？\",\n    \"回答9\": \"端到端记忆网络结构通过让主网络和外部记忆进行多轮交互来实现多跳操作。在每一轮交互中，主网络根据上一次从外部记忆中读取的信息产生新的查询向量，并继续与外部记忆进行交互。\",\n    \"问题10\": \"端到端记忆网络如何处理给定一组需要存储的信息以实现多次读取？\",\n    \"回答10\": \"为了实现多次从外部记忆中读取信息，端到端记忆网络首先将给定的一组需要存储的信息转换成两组记忆片段，并将它们分别存放在两个外部记忆单元中。然后通过多轮交互和多跳操作，主网络可以多次从外部记忆中读取相关信息，并进行预测或其他处理。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710757772,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1258,
            "prompt_tokens": 3558,
            "total_tokens": 4816
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]