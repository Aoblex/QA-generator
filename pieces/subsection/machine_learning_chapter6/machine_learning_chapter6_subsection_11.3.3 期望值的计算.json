[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter6",
        "title": "11.3.3 期望值的计算",
        "content_length": 1524,
        "content": "Title: 11.3.3 期望值的计算\nContent:\n利用前向-后向向量, 可以计算特征函数关于联合分布 $P(X, Y)$ 和条件分布 $P(Y \\mid X)$ 的数学期望。\n\n特征函数 $f_{k}$ 关于条件分布 $P(Y \\mid X)$ 的数学期望是\n\n\n\\begin{align*}\nE_{P(Y \\mid X)}\\left[f_{k}\\right]= & \\sum_{y} P(y \\mid x) f_{k}(y, x) \\\\\n= & \\\\\n&  \\tag{11.34}\\\\\n& k=1,2, \\cdots, K\n\\end{align*}\n\n\n其中,\n\n$$\nZ(x)=\\alpha_{n}^{\\mathrm{T}}(x) 1\n$$\n\n假设经验分布为 $\\tilde{P}(X)$, 特征函数 $f_{k}$ 关于联合分布 $P(X, Y)$ 的数学期望是\n\n\n\\begin{align*}\n& E_{P(X, Y)}\\left[f_{k}\\right]=\\sum_{x, y} P(x, y) \\sum_{i=1}^{n+1} f_{k}\\left(y_{i-1}, y_{i}, x, i\\right) \\\\\n&=\\sum_{x} \\tilde{P}(x) \\sum_{y} P(y \\mid x) \\sum_{i=1}^{n+1} f_{k}\\left(y_{i-1}, y_{i}, x, i\\right) \\\\\n&=\\sum_{x} \\tilde{P}(x) \\sum_{i=1}^{n+1} \\sum_{y_{i-1} y_{i}} f_{k}\\left(y_{i-1}, y_{i}, x, i\\right) \\frac{\\alpha_{i-1}^{\\mathrm{T}}\\left(y_{i-1} \\mid x\\right) M_{i}\\left(y_{i-1}, y_{i} \\mid x\\right) \\beta_{i}\\left(y_{i} \\mid x\\right)}{Z(x)} \\\\\n& k=1,2, \\cdots, K \\tag{11.35}\n\\end{align*}\n\n\n其中，\n\n$$\nZ(x)=\\alpha_{n}^{\\mathrm{T}}(x) 1\n$$\n\n式 (11.34) 和式 (11.35) 是特征函数数学期望的一般计算公式。对于转移特征 $t_{k}\\left(y_{i-1}, y_{i}, x, i\\right)$,\\\\\n$k=1,2, \\cdots, K_{1}$, 可以将式中的 $f_{k}$ 换成 $t_{k}$; 对于状态特征, 可以将式中的 $f_{k}$ 换成 $s_{i}$, 表示为 $s_{l}\\left(y_{i}, x, i\\right), k=K_{1}+l, l=1,2, \\cdots, K_{2}$ 。\n\n有了式 (11.32) 式 (11.35), 对于给定的观测序列 $x$ 与标记序列 $y$, 可以通过一次前向扫描计算 $\\alpha_{i}$ 及 $Z(x)$, 通过一次后向扫描计算 $\\beta_{i}$, 从而计算所有的概率和特征的期望。\n\n\\section*{11.4 条件随机场的学习算法}\n本节讨论给定训练数据集估计条件随机场模型参数的问题, 即条件随机场的学习问题。条件随机场模型实际上是定义在时序数据上的对数线性模型, 其学习方法包括极大似然估计和正则化的极大似然估计。具体的优化实现算法有改进的迭代尺度法 IIS、梯度下降法以及拟牛顿法 (参阅附录 $\\mathrm{A}$ 和附录 $\\mathrm{B}$ )。"
    },
    {
        "id": "chatcmpl-947DqF2YrhnKdGtbUrlhTPhFNXS7T",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"利用前向-后向向量可以计算特征函数关于哪两种分布的数学期望？\",\n    \"回答1\": \"利用前向-后向向量，可以计算特征函数关于联合分布 $P(X, Y)$ 和条件分布 $P(Y \\text{ | } X)$ 的数学期望。\",\n    \"问题2\": \"特征函数 $f_{k}$ 关于条件分布 $P(Y \\text{ | } X)$ 的数学期望是如何计算的？\",\n    \"回答2\": \"特征函数 $f_{k}$ 关于条件分布 $P(Y \\text{ | } X)$ 的数学期望 $E_{P(Y \\text{ | } X)}\\big[f_{k}\\big]$ 是通过对所有可能的 $y$ 进行求和，乘以对应的条件概率 $P(y \\text{ | } x)$ 和特征函数值 $f_{k}(y, x)$ 而得到的。\",\n    \"问题3\": \"特征函数 $f_{k}$ 关于联合分布 $P(X, Y)$ 的数学期望是如何计算的？\",\n    \"回答3\": \"特征函数 $f_{k}$ 关于联合分布 $P(X, Y)$ 的数学期望 $E_{P(X, Y)}\\big[f_{k}\\big]$ 是通过对所有可能的 $x$ 和 $y$ 进行求和，乘以对应的联合概率 $P(x, y)$ 和特征函数值 $f_{k}(y_{i-1}, y_{i}, x, i)$ 而得到的。\",\n    \"问题4\": \"特征函数数学期望的一般计算公式是什么？\",\n    \"回答4\": \"特征函数数学期望的一般计算公式是 $E_{P}\\big[f_{k}\\big]=\\text{sum over all possible values of } x \\text{ and } y \\text{ of } P(x, y) \\times f_{k}(x, y)$。\",\n    \"问题5\": \"条件随机场模型实际上是定义在哪种数据上的对数线性模型？\",\n    \"回答5\": \"条件随机场模型实际上是定义在时序数据上的对数线性模型。\",\n    \"问题6\": \"条件随机场模型的学习方法包括哪些？\",\n    \"回答6\": \"条件随机场模型的学习方法包括极大似然估计和正则化的极大似然估计。具体的优化实现算法有改进的迭代尺度法 IIS、梯度下降法以及拟牛顿法。\",\n    \"问题7\": \"给定训练数据集，条件随机场模型参数的估计问题是指什么？\",\n    \"回答7\": \"给定训练数据集估计条件随机场模型参数的问题，即条件随机场的学习问题。这个问题涉及如何根据训练数据来估计模型中的参数，以使得模型能够更好地拟合数据和预测未知样本。\",\n    \"问题8\": \"改进的迭代尺度法 IIS 是用于解决什么问题的？\",\n    \"回答8\": \"改进的迭代尺度法 IIS 是用于解决条件随机场模型参数估计问题的优化实现算法，旨在通过迭代优化来求解模型参数，以使得模型能够更好地拟合训练数据。\",\n    \"问题9\": \"梯度下降法和拟牛顿法在条件随机场模型中起到什么作用？\",\n    \"回答9\": \"梯度下降法和拟牛顿法是用于优化条件随机场模型参数的算法。它们通过迭代地调整参数值，以最小化损失函数并提高模型对训练数据的拟合程度。\",\n    \"问题10\": \"通过一次前向扫描和一次后向扫描可以实现什么目标？\",\n    \"回答10\": \"通过一次前向扫描和一次后向扫描可以实现对给定的观测序列 $x$ 与标记序列 $y$，计算所有的概率和特征的期望。这有助于了解在给定观测序列下，各种标记序列出现的可能性，并为模型参数估计提供基础。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710768102,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1211,
            "prompt_tokens": 3563,
            "total_tokens": 4774
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]