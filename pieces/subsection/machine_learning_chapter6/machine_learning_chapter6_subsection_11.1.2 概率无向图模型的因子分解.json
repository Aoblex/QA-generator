[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter6",
        "title": "11.1.2 概率无向图模型的因子分解",
        "content_length": 3665,
        "content": "Title: 11.1.2 概率无向图模型的因子分解\nContent:\n首先给出无向图中的团与最大团的定义。\n\n定义 11.2 (团与最大团) 无向图 $G$ 中任何两个结点均有边连接的结点子集称为团 (clique)。若 $C$ 是无向图 $G$ 的一个团, 并且不能再加进任何一个 $G$ 的结点使其成为一个更大的团, 则称此 $C$ 为最大团 (maximal clique)。\n\n图 11.3 表示由 4 个结点组成的无向图。图中由两个结点组成的团有 5 个: $\\left\\{Y_{1}, Y_{2}\\right\\}$, $\\left\\{Y_{2}, Y_{3}\\right\\},\\left\\{Y_{3}, Y_{4}\\right\\},\\left\\{Y_{4}, Y_{2}\\right\\}$ 和 $\\left\\{Y_{1}, Y_{3}\\right\\}$ 。有两个最大团: $\\left\\{Y_{1}, Y_{2}, Y_{3}\\right\\}$ 和 $\\left\\{Y_{2}, Y_{3}, Y_{4}\\right\\}$ 。而 $\\left\\{Y_{1}, Y_{2}, Y_{3}, Y_{4}\\right\\}$ 不是一个团, 因为 $Y_{1}$ 和 $Y_{4}$ 没有边连接。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_32592c58f22d1a77d634g-06}\n\\end{center}\n\n图 11.3 无向图的团和最大团\n\n将概率无向图模型的联合概率分布表示为其最大团上的随机变量的函数的乘积形式的操作，称为概率无向图模型的因子分解（factorization）。\n\n给定概率无向图模型, 设其无向图为 $G, C$ 为 $G$ 上的最大团, $Y_{C}$ 表示 $C$ 对应的随机变量。那么概率无向图模型的联合概率分布 $P(Y)$ 可写作图中所有最大团 $C$ 上的函数 $\\Psi_{C}\\left(Y_{C}\\right)$的乘积形式, 即\n\n\n\\begin{equation*}\nP(Y)=\\frac{1}{Z} \\prod_{C} \\Psi_{C}\\left(Y_{C}\\right) \\tag{11.5}\n\\end{equation*}\n\n\n其中, $Z$ 是规范化因子 (normalization factor), 由式\n\n\n\\begin{equation*}\nZ=\\sum_{Y} \\prod_{C} \\Psi_{C}\\left(Y_{C}\\right) \\tag{11.6}\n\\end{equation*}\n\n\n给出。规范化因子保证 $P(Y)$ 构成一个概率分布。函数 $\\Psi_{C}\\left(Y_{C}\\right)$ 称为势函数 (potential function）。这里要求势函数 $\\Psi_{C}\\left(Y_{C}\\right)$ 是严格正的, 通常定义为指数函数:\n\n\n\\begin{equation*}\n\\Psi_{C}\\left(Y_{C}\\right)=\\exp \\left(-E\\left(Y_{C}\\right)\\right) \\tag{11.7}\n\\end{equation*}\n\n\n概率无向图模型的因子分解由下述定理来保证。\n\n定理 11.1 (Hammersley-Clifford 定理) 概率无向图模型的联合概率分布 $P(Y)$ 可以表示为如下形式:\n\n$$\nP(Y)=\\frac{1}{Z} \\prod_{C} \\Psi_{C}\\left(Y_{C}\\right)\n$$\n\n$$\nZ=\\sum_{Y} \\prod_{C} \\Psi_{C}\\left(Y_{C}\\right)\n$$\n\n其中, $C$ 是无向图的最大团, $Y_{C}$ 是 $C$ 的结点对应的随机变量, $\\Psi_{C}\\left(Y_{C}\\right)$ 是 $C$ 上定义的严格正函数，乘积是在无向图所有的最大团上进行的。\n\n\\section*{11.2 条件随机场的定义与形式}\n\\section*{11.2 .1 条件随机场的定义}\n条件随机场（conditional random field）是给定随机变量 $X$ 条件下, 随机变量 $Y$ 的马尔可夫随机场。这里主要介绍定义在线性链上的特殊的条件随机场, 称为线性链条件随机场（linear chain conditional random field）。线性链条件随机场可以用于标注等问题。这时,在条件概率模型 $P(Y \\mid X)$ 中, $Y$ 是输出变量, 表示标记序列, $X$ 是输入变量, 表示需要标注的观测序列。也把标记序列称为状态序列 (参见隐马尔可夫模型)。学习时, 利用训练数据集通过极大似然估计或正则化的极大似然估计得到条件概率模型 $\\hat{P}(Y \\mid X)$; 预测时, 对于给定的输入序列 $x$, 求出条件概率 $\\hat{P}(y \\mid x)$ 最大的输出序列 $\\hat{y}$ 。\n\n首先定义一般的条件随机场, 然后定义线性链条件随机场。\n\n定义 11.3 (条件随机场) 设 $X$ 与 $Y$ 是随机变量, $P(Y \\mid X)$ 是在给定 $X$ 的条件下 $Y$ 的条件概率分布。若随机变量 $Y$ 构成一个由无向图 $G=(V, E)$ 表示的马尔可夫随机场, 即\n\n\n\\begin{equation*}\nP\\left(Y_{v} \\mid X, Y_{w}, w \\neq v\\right)=P\\left(Y_{v} \\mid X, Y_{w}, w \\sim v\\right) \\tag{11.8}\n\\end{equation*}\n\n\n对任意结点 $v$ 成立, 则称条件概率分布 $P(Y \\mid X)$ 为条件随机场。式中 $w \\sim v$ 表示在图 $G=(V, E)$ 中与结点 $v$ 有边连接的所有结点 $w, w \\neq v$ 表示结点 $v$ 以外的所有结点, $Y_{v}, Y_{u}$与 $Y_{w}$ 为结点 $v, u$ 与 $w$ 对应的随机变量。\n\n在定义中并没有要求 $X$ 和 $Y$ 具有相同的结构。现实中,一般假设 $X$ 和 $Y$ 有相同的图结构。本书主要考虑无向图为如图 11.4 与图 11.5 所示的线性链的情况, 即\n\n$$\nG=(V=\\{1,2, \\cdots, n\\}, E=\\{(i, i+1)\\}), \\quad i=1,2, \\cdots, n-1\n$$\n\n在此情况下, $X=\\left(X_{1}, X_{2}, \\cdots, X_{n}\\right), Y=\\left(Y_{1}, Y_{2}, \\cdots, Y_{n}\\right)$, 最大团是相邻两个结点的集合。线性链条件随机场有下面的定义。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_32592c58f22d1a77d634g-07}\n\\end{center}\n\n图 11.4 线性链条件随机场\n\n定义 11.4 (线性链条件随机场) 设 $X=\\left(X_{1}, X_{2}, \\cdots, X_{n}\\right), Y=\\left(Y_{1}, Y_{2}, \\cdots, Y_{n}\\right)$ 均为线性链表示的随机变量序列, 若在给定随机变量序列 $X$ 的条件下, 随机变量序列 $Y$ 的条件\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_32592c58f22d1a77d634g-08}\n\\end{center}\n\n图 $11.5 X$ 和 $Y$ 有相同的图结构的线性链条件随机场\n\n概率分布 $P(Y \\mid X)$ 构成条件随机场，即满足马尔可夫性\n\n\n\\begin{gather*}\nP\\left(Y_{i} \\mid X, Y_{1}, \\cdots, Y_{i-1}, Y_{i+1}, \\cdots, Y_{n}\\right)=P\\left(Y_{i} \\mid X, Y_{i-1}, Y_{i+1}\\right), \\\\\ni=1,2, \\cdots, n(\\text { 在 } i=1 \\text { 和 } i=n \\text { 时只考虑单边 }) \\tag{11.9}\n\\end{gather*}\n\n\n则称 $P(Y \\mid X)$ 为线性链条件随机场。在标注问题中, $X$ 表示输入观测序列, $Y$ 表示对应的输出标记序列或状态序列。"
    },
    {
        "id": "chatcmpl-9477xtsGAzGBQ1wQVIRzKZvX7chau",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"无向图中的团和最大团的定义分别是什么？\",\n    \"回答1\": \"无向图中任何两个结点均有边连接的结点子集称为团（clique）。若一个团不能再加进任何一个结点使其成为一个更大的团，则称此团为最大团（maximal clique）。\",\n    \"问题2\": \"概率无向图模型的因子分解是指什么操作？\",\n    \"回答2\": \"概率无向图模型的因子分解是将概率无向图模型的联合概率分布表示为其最大团上的随机变量的函数的乘积形式。即将联合概率分布 $P(Y)$ 表示为所有最大团 $C$ 上的函数 $\\boldsymbol{\\text{Ψ}}_{C}\\big(Y_{C}\\big)$ 的乘积形式。\",\n    \"问题3\": \"概率无向图模型的联合概率分布 $P(Y)$ 的乘积形式是如何表示的？\",\n    \"回答3\": \"概率无向图模型的联合概率分布 $P(Y)$ 可写作图中所有最大团 $C$ 上的函数 $\\boldsymbol{\\text{Ψ}}_{C}\\big(Y_{C}\\big)$ 的乘积形式，即 $P(Y)=\\frac{1}{Z} \\bigg( \\text{∏}_{C} \\boldsymbol{\\text{Ψ}}_{C}\\big(Y_{C}\\big) \\bigg)$，其中 $Z$ 是规范化因子。\",\n    \"问题4\": \"规范化因子 $Z$ 的作用是什么？\",\n    \"回答4\": \"规范化因子 $Z$ 保证了 $P(Y)$ 构成一个概率分布。它由求和式 $Z=\\text{∑}_{Y} \\bigg( \\text{∏}_{C} \\boldsymbol{\\text{Ψ}}_{C}\\big(Y_{C}\\big) \\bigg)$ 给出，确保了联合概率分布的总和为1，从而满足概率分布的性质。\",\n    \"问题5\": \"势函数 $\\boldsymbol{\\text{Ψ}}_{C}\\big(Y_{C}\\big)$ 通常如何定义？\",\n    \"回答5\": \"势函数 $\\boldsymbol{\\text{Ψ}}_{C}\\big(Y_{C}\\big)$ 通常定义为严格正的函数，通常被定义为指数函数，即 $\\boldsymbol{\\text{Ψ}}_{C}\\big(Y_{C}\\big)=\\text{exp}(-E\\big(Y_{C}\\big))$。\",\n    \"问题6\": \"Hammersley-Clifford 定理是用来保证什么？\",\n    \"回答6\": \"Hammersley-Clifford 定理用来保证概率无向图模型的联合概率分布 $P(Y)$ 可以表示为特定形式，并且给出了联合概率分布和规范化因子的具体表达式。\",\n    \"问题7\": \"条件随机场（conditional random field）是什么？\",\n    \"回答7\": \"条件随机场是给定随机变量 $X$ 条件下，随机变量 $Y$ 的马尔可夫随机场。在线性链上特殊的情况下，称为线性链条件随机场，主要用于标注等问题。\",\n    \"问题8\": \"线性链条件随机场中的马尔可夫性是如何定义的？\",\n    \"回答8\": \"在线性链条件随机场中，马尔可夫性指满足条件 $P\\big(Y_{i} \\big| X, Y_{1}, \\text{...}, Y_{i-1}, Y_{i+1}, \\text{...}, Y_{n}\\big)=P\\big(Y_{i} \\big| X, Y_{i-1}, Y_{i+1}\\big)$ 对任意结点 $i$ 成立。这保证了给定其他结点条件下，当前结点与相邻结点之间的条件概率关系。\",\n    \"问题9\": \"线性链条件随机场在标注问题中有何应用？\",\n    \"回答9\": \"在线性链条件随机场中，$X$ 表示输入观测序列，$Y$ 表示对应的输出标记序列或状态序列。它主要用于标注等问题，通过学习得到条件概率模型 $\\boldsymbol{\\text{P}}(Y \\big| X)$ 并用于预测给定输入序列时最可能的输出序列。\",\n    \"问题10\": \"线性链条件随机场与一般条件随机场有何区别？\",\n    \"回答10\": \"线性链条件随机场是一种特殊情况下的条件随机场，在给定随机变量序列 $X$ 的条件下，满足马尔可夫性质。而一般条件随机场没有对随机变量之间关系做出特定约束，可以适用于更广泛的情况。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710767737,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1347,
            "prompt_tokens": 4948,
            "total_tokens": 6295
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]