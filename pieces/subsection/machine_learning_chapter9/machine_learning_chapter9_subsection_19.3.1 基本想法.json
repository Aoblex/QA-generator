[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter9",
        "title": "19.3.1 基本想法",
        "content_length": 1436,
        "content": "Title: 19.3.1 基本想法\nContent:\n假设目标是对一个概率分布进行随机抽样, 或者是求函数关于该概率分布的数学期望。可以采用传统的蒙特卡罗法, 如接受-拒绝法、重要性抽样法, 也可以使用马尔可夫链蒙特卡罗法。马尔可夫链蒙特卡罗法更适用于随机变量是多元的、密度函数是非标准形式的、随机变量各分量不独立等情况。\n\n假设多元随机变量 $x$ 满足 $x \\in \\mathcal{X}$, 其概率密度函数为 $p(x), f(x)$ 为定义在 $x \\in \\mathcal{X}$ 上的函数, 目标是获得概率分布 $p(x)$ 的样本集合, 以及求函数 $f(x)$ 的数学期望 $E_{p(x)}[f(x)]$ 。\n\n应用马尔可夫链蒙特卡罗法解决这个问题。基本想法是: 在随机变量 $x$ 的状态空间 $\\mathcal{S}$ 上定义一个满足遍历定理的马尔可夫链 $X=\\left\\{X_{0}, X_{1}, \\cdots, X_{t}, \\cdots\\right\\}$, 使其平稳分布就是抽样的目标分布 $p(x)$ 。然后在这个马尔可夫链上进行随机游走, 每个时刻得到一个样本。根据遍历定理, 当时间趋于无穷时, 样本的分布趋近平稳分布, 样本的函数均值趋近函数的数学期望。所以, 当时间足够长时 (时刻大于某个正整数 $m$ ), 在之后的时间 (时刻小于等于某个正整数 $n, n>m)$ 里随机游走得到的样本集合 $\\left\\{x_{m+1}, x_{m+2}, \\cdots, x_{n}\\right\\}$ 就是目标概率分布的抽样结果, 得到的函数均值 (遍历均值) 就是要计算的数学期望值:\n\n\n\\begin{equation*}\n\\hat{E} f=\\frac{1}{n-m} \\sum_{i=m+1}^{n} f\\left(x_{i}\\right) \\tag{19.32}\n\\end{equation*}\n\n\n到时刻 $m$ 为止的时间段称为燃烧期。\n\n如何构建具体的马尔可夫链成为这个方法的关键。连续变量的时候, 需要定义转移核函数; 离散变量的时候, 需要定义转移矩阵。一个方法是定义特殊的转移核函数或者转移矩阵, 构建可逆马尔可夫链, 这样可以保证遍历定理成立。常用的马尔可夫链蒙特卡罗法有 Metropolis-Hastings 算法、吉布斯抽样。\n\n由于这个马尔可夫链满足遍历定理, 随机游走的起始点并不影响得到的结果, 即从不同的起始点出发, 都会收玫到同一平稳分布。\n\n马尔可夫链蒙特卡罗法的收玫性的判断通常是经验性的, 比如, 在马尔可夫链上进行随机游走, 检验遍历均值是否收玫。具体地, 每隔一段时间取一次样本, 得到多个样本以后, 计算遍历均值, 当计算的均值稳定后, 认为马尔可夫链已经收玫。再比如, 在马尔可夫链上并行进行多个随机游走, 比较各个随机游走的遍历均值是否接近一致。\\\\\n对于马尔可夫链蒙特卡罗法中得到的样本序列, 相邻的样本点是相关的, 而不是独立的。因此, 在需要独立样本时, 可以在该样本序列中再次进行随机抽样, 比如每隔一段时间取一次样本, 将这样得到的子样本集合作为独立样本集合。\n\n马尔可夫链蒙特卡罗法比接受-拒绝法更容易实现, 因为只需要定义马尔可夫链, 而不需要定义建议分布。一般来说马尔可夫链蒙特卡罗法比接受-拒绝法效率更高, 没有大量被拒绝的样本, 虽然燃烧期的样本也要抛弃。"
    },
    {
        "id": "chatcmpl-947w3YoTgP2eMWnI8fbmKCGMQQ1ny",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"马尔可夫链蒙特卡罗法相比传统的蒙特卡罗法有什么优势？\",\n    \"回答1\": \"马尔可夫链蒙特卡罗法相比传统的蒙特卡罗法更适用于随机变量是多元的、密度函数是非标准形式的、随机变量各分量不独立等情况。它不需要定义建议分布，而只需要定义马尔可夫链，因此更容易实现。此外，马尔可夫链蒙特卡罗法效率更高，没有大量被拒绝的样本，虽然燃烧期的样本也要抛弃。\",\n    \"问题2\": \"马尔可夫链蒙特卡罗法中的燃烧期是指什么？\",\n    \"回答2\": \"在马尔可夫链蒙特卡罗法中，燃烧期是指到时刻 $m$ 为止的时间段。在这段时间内，随机游走得到的样本并不稳定，需要抛弃这部分样本，直到样本的分布趋近平稳分布。\",\n    \"问题3\": \"马尔可夫链蒙特卡罗法中如何判断收敛性？\",\n    \"回答3\": \"马尔可夫链蒙特卡罗法中的收敛性通常是经验性的判断。一种方法是在马尔可夫链上进行随机游走，检验遍历均值是否收敛；另一种方法是在马尔可夫链上并行进行多个随机游走，比较各个随机游走的遍历均值是否接近一致。\",\n    \"问题4\": \"马尔可夫链蒙特卡罗法中如何构建具体的马尔可夫链？\",\n    \"回答4\": \"在马尔可夫链蒙特卡罗法中，构建具体的马尔可夫链需要在随机变量 $x$ 的状态空间 $\\text{S}$ 上定义一个满足遍历定理的马尔可夫链 $X=\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big{X_{0}, X_{1}, \\text{...}, X_{t}, \\text{...}\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big}$，使其平稳分布就是抽样的目标分布 $p(x)$。对于连续变量，需要定义转移核函数；对于离散变量，需要定义转移矩阵。常用的方法包括定义特殊的转移核函数或者转移矩阵，构建可逆马尔可夫链，以保证遍历定理成立。\",\n    \"问题5\": \"在马尔可夫链蒙特卡罗法中如何得到独立样本集合？\",\n    \"回答5\": \"在马尔可夫链蒙特卡罗法中得到的样本序列中，相邻的样本点是相关的，而不是独立的。因此，在需要独立样本时，可以在该样本序列中再次进行随机抽样，比如每隔一段时间取一次样本，将这样得到的子样本集合作为独立样本集合。\",\n    \"问题6\": \"什么是马尔可夫链蒙特卡罗法中的遍历定理？\",\n    \"回答6\": \"在马尔可夫链蒙特卡罗法中，遍历定理指的是当时间趋于无穷时，样本的分布趋近平稳分布，样本的函数均值趋近函数的数学期望。因此，在足够长的时间后，在随机游走得到的样本集合就是目标概率分布的抽样结果，并且得到的函数均值就是要计算的数学期望值。\",\n    \"问题7\": \"为什么说马尔可夫链蒙特卡罗法中随机游走的起始点并不影响最终结果？\",\n    \"回答7\": \"由于马尔可夫链满足遍历定理，在随机游走过程中，随机游走的起始点并不影响最终结果。即从不同的起始点出发，都会收敛到同一平稳分布。\",\n    \"问题8\": \"在马尔可夫链蒙特卡罗法中常用的方法有哪些？\",\n    \"回答8\": \"常用的马尔可夫链蒙特卡罗法包括 Metropolis-Hastings 算法和吉布斯抽样。这些方法可以帮助构建满足遍历定理的马尔可夫链，并实现对目标概率分布进行抽样和数学期望计算。\",\n    \"问题9\": \"马尔可夫链蒙特卡罗法相对于重要性抽样法有什么优势？\",\n    \"回答9\": \"相对于重要性抽样法，马尔可夫链蒙特卡罗法更适用于随机变量是多元的、密度函数是非标准形式的、随机变量各分量不独立等情况。它不需要定义建议分布，而只需要定义马尔可夫链，并且效率更高，没有大量被拒绝的样本。\",\n    \"问题10\": \"在马尔可夫链蒙特卡罗法中如何计算函数均值？\",\n    \"回答10\": \"在马尔可夫链蒙特卡罗法中，可以通过每隔一段时间取一次样本，并计算这些样本对应函数值的均值来估计函数均值。具体地，在时刻大于某个正整数 $m$ 之后，在之后的时间里得到的样本集合就是目标概率分布的抽样结果，并且得到的函数均值（遍历均值）就是要计算的数学期望值。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710770843,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1785,
            "prompt_tokens": 3941,
            "total_tokens": 5726
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]