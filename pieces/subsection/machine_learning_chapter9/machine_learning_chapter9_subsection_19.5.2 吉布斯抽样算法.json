[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter9",
        "title": "19.5.2 吉布斯抽样算法",
        "content_length": 2836,
        "content": "Title: 19.5.2 吉布斯抽样算法\nContent:\n\\section*{算法 19.3 (吉布斯抽样)}\n输入: 目标概率分布的密度函数 $p(x)$, 函数 $f(x)$ 。\n\n输出: $p(x)$ 的随机样本 $x_{m+1}, x_{m+2}, \\cdots, x_{n}$, 函数样本均值 $f_{m n}$ 。\n\n参数: 收玫步数 $m$, 迭代步数 $n$ 。\n\n(1) 初始化。给出初始样本 $x^{(0)}=\\left(x_{1}^{(0)}, x_{2}^{(0)}, \\cdots, x_{k}^{(0)}\\right)^{\\mathrm{T}}$ 。\n\n(2) 对 $i$ 循环执行:\n\n设第 $(i-1)$ 次迭代结束时的样本为 $x^{(i-1)}=\\left(x_{1}^{(i-1)}, x_{2}^{(i-1)}, \\cdots, x_{k}^{(i-1)}\\right)^{\\mathrm{T}}$, 则第 $i$ 次迭代进行如下几步操作:\n\n$\\left\\{\\begin{array}{l}(1) \\text { 由满条件分布 } p\\left(x_{1} \\mid x_{2}^{(i-1)}, x_{3}^{(i-1)}, \\cdots, x_{k}^{(i-1)}\\right) \\text { 抽取 } x_{1}^{(i)} \\text {; } \\\\ \\vdots \\\\ (\\mathrm{j}) \\text { 由满条件分布 } p\\left(x_{j} \\mid x_{1}^{(i)}, x_{2}^{(i)}, \\cdots, x_{j-1}^{(i)}, x_{j+1}^{(i-1)}, \\cdots, x_{k}^{(i-1)}\\right) \\text { 抽取 } x_{j}^{(i)} \\text {; } \\\\ \\vdots \\\\ \\text { (k) 由满条件分布 } p\\left(x_{k} \\mid x_{1}^{(i)}, x_{2}^{(i)}, \\cdots, x_{k-1}^{(i)}\\right) \\text { 抽取 } x_{k}^{(i)} ;\\end{array}\\right.$\n\n得到第 $i$ 次迭代值 $x^{(i)}=\\left(x_{1}^{(i)}, x_{2}^{(i)}, \\cdots, x_{k}^{(i)}\\right)^{\\mathrm{T}}$ 。\n\n(3) 得到样本集合\n\n$$\n\\left\\{x^{(m+1)}, x^{(m+2)}, \\cdots, x^{(n)}\\right\\}\n$$\n\n(4) 计算\n\n$$\nf_{m n}=\\frac{1}{n-m} \\sum_{i=m+1}^{n} f\\left(x^{(i)}\\right)\n$$\n\n例 19.10 用吉布斯抽样从以下二元正态分布中抽取随机样本。\n\n$$\n\\begin{gathered}\nx=\\left(x_{1}, x_{2}\\right)^{\\mathrm{T}} \\sim p\\left(x_{1}, x_{2}\\right) \\\\\np\\left(x_{1}, x_{2}\\right)=N(0, \\Sigma), \\quad \\Sigma=\\left[\\begin{array}{ll}\n1 & \\rho \\\\\n\\rho & 1\n\\end{array}\\right]\n\\end{gathered}\n$$\n\n解 条件概率分布为一元正态分布:\n\n$$\n\\begin{aligned}\n& p\\left(x_{1} \\mid x_{2}\\right)=N\\left(\\rho x_{2}, 1-\\rho^{2}\\right) \\\\\n& p\\left(x_{2} \\mid x_{1}\\right)=N\\left(\\rho x_{1}, 1-\\rho^{2}\\right)\n\\end{aligned}\n$$\n\n假设初始样本为 $x^{(0)}=\\left(x_{1}^{(0)}, x_{2}^{(0)}\\right)$, 通过吉布斯抽样, 可以得到以下样本序列:\n\n\\begin{center}\n\\begin{tabular}{c|c|c|c}\n\\hline\n迭代次数 & 对 $x_{1}$ 抽样 & 对 $x_{2}$ 抽样 & 产生样本 \\\\\n\\hline\n1 & $x_{1} \\sim N\\left(\\rho x_{2}^{(0)}, 1-\\rho^{2}\\right)$, 得到 $x_{1}^{(1)}$ & $x_{2} \\sim N\\left(\\rho x_{1}^{(1)}, 1-\\rho^{2}\\right)$, 得到 $x_{2}^{(1)}$ & $x^{(1)}=\\left(x_{1}^{(1)}, x_{2}^{(1)}\\right)^{\\mathrm{T}}$ \\\\\n$\\vdots$ & $\\vdots$ & $\\vdots$ & $\\vdots$ \\\\\n$i$ & $x_{1} \\sim N\\left(\\rho x_{2}^{(t-1)}, 1-\\rho^{2}\\right)$, 得到 $x_{1}^{(t)}$ & $x_{2} \\sim N\\left(\\rho x_{1}^{(t)}, 1-\\rho^{2}\\right)$, 得到 $x_{2}^{(t)}$ & $x^{(t)}=\\left(x_{1}^{(t)}, x_{2}^{(t)}\\right)^{\\mathrm{T}}$ \\\\\n$\\vdots$ & $\\vdots$ & $\\vdots$ & $\\vdots$ \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\n得到的样本集合 $\\left\\{x^{(m+1)}, x^{(m+2)}, \\cdots, x^{(n)}\\right\\}, m<n$ 就是二元正态分布的随机抽样。图 19.11 示意了吉布斯抽样的过程。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_f9cfd3d77aa90e83e0d5g-22(1)}\n\\end{center}\n\n图 19.11 吉布斯抽样例\n\n单分量 Metropolis-Hastings 算法和吉布斯抽样的不同之处在于, 在前者算法中, 抽样会在样本点之间移动, 但其间可能在某一些样本点上停留 (由于抽样被拒绝); 而在后者算法中，抽样会在样本点之间持续移动。\n\n吉布斯抽样适合于满条件概率分布容易抽样的情况, 而单分量 Metropolis-Hastings 算法适合于满条件概率分布不容易抽样的情况, 这时使用容易抽样的条件分布作建议分布。"
    },
    {
        "id": "chatcmpl-948F0X67JxOn8K50d8CiIL1m1C2Z8",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"吉布斯抽样算法的输入和输出是什么？\",\n    \"回答1\": \"吉布斯抽样算法的输入是目标概率分布的密度函数 $p(x)$ 和函数 $f(x)$，输出是$p(x)$的随机样本 $x_{m+1}, x_{m+2}, \\text{...}, x_{n}$，以及函数样本均值 $f_{mn}$。\",\n    \"问题2\": \"吉布斯抽样算法中的参数 $m$ 和 $n$ 分别代表什么意义？\",\n    \"回答2\": \"在吉布斯抽样算法中，参数 $m$ 代表收玫步数，参数 $n$ 代表迭代步数。收玫步数表示初始化后进行多少步收玫，迭代步数表示进行多少步迭代操作。\",\n    \"问题3\": \"吉布斯抽样算法中的第二步操作是如何进行的？\",\n    \"回答3\": \"在吉布斯抽样算法中的第二步操作是对每个变量循环执行，根据满条件分布依次抽取对应变量的值，直到得到第 $i$ 次迭代值 $x^{(i)}=\\big(x_{1}^{(i)}, x_{2}^{(i)}, \\text{...}, x_{k}^{(i)}\\big)^{\\top}$。\",\n    \"问题4\": \"吉布斯抽样算法中的第四步操作是用来做什么的？\",\n    \"回答4\": \"吉布斯抽样算法中的第四步操作是用来计算函数样本均值 $f_{mn}$ 的。通过计算 $\\frac{1}{n-m} \\text{ 从 } m+1 \\text{ 到 } n \\text{ 的 } f\\big(x^{(i)}\\big) \\text{ 的和}$，得到函数样本均值。\",\n    \"问题5\": \"吉布斯抽样算法适合于什么样的条件概率分布情况？\",\n    \"回答5\": \"吉布斯抽样算法适合于满条件概率分布容易抽样的情况。当条件概率分布容易抽样时，吉布斯抽样算法能够高效地生成目标概率分布的随机样本。\",\n    \"问题6\": \"吉布斯抽样和单分量 Metropolis-Hastings 算法之间有什么不同之处？\",\n    \"回答6\": \"吉布斯抽样和单分量 Metropolis-Hastings 算法的不同之处在于，在前者算法中，抽样会在样本点之间持续移动；而在后者算法中，抽样会在样本点之间移动，但其间可能在某些样本点上停留（由于抽样被拒绝）。\",\n    \"问题7\": \"例 19.10 中使用吉布斯抽样从哪种概率分布中抽取随机样本？\",\n    \"回答7\": \"例 19.10 中使用吉布斯抽样从二元正态分布中抽取随机样本。该二元正态分布由密度函数 $p(x_1, x_2)=N(0, \\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\rho}}}}}}}}}}}}}}}}}}}}}}}}}, \\text{其中} \\rho=\\begin{bmatrix} 1 & \\rho \\\\ \\rho & 1 \\\\\\rho\\right]$ 给定。\",\n    \"问题8\": \"在例 19.10 中，条件概率分布 $p(x_1|x_2)$ 是什么？\",\n    \"回答8\": \"在例 19.10 中，条件概率分布 $p(x_1|x_2)$ 是一元正态分布，具体为 $N(\\rho x_2, 1-\\rho^2)$。\",\n    \"问题9\": \"在例 19.10 中，初始样本为何？\",\n    \"回答9\": \"在例 19.10 中，初始样本为 $x^{(0)}=\\big(x_1^{(0)}, x_2^{(0)}\\big)$。\",\n    \"问题10\": \"图 19.11 展示了什么内容？\",\n    \"回答10\": \"图 19.11 展示了吉布斯抽样的过程示意图。它描述了通过吉布斯抽样得到的随机样本序列以及对应的抽取过程。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710772018,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1259,
            "prompt_tokens": 4269,
            "total_tokens": 5528
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]