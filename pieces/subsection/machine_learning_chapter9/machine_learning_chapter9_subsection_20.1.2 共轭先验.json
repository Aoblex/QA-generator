[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter9",
        "title": "20.1.2 共轭先验",
        "content_length": 2368,
        "content": "Title: 20.1.2 共轭先验\nContent:\n狄利克雷分布有一些重要性质: (1)狄利克雷分布属于指数分布族; (2)狄利克雷分布是多项分布的共轭先验（conjugate prior）。\n\n贝叶斯学习中常使用共轭分布。如果后验分布与先验分布属于同类, 则先验分布与后验分布称为共轭分布 (conjugate distributions), 先验分布称为共轭先验（conjugate prior）。如果多项分布的先验分布是狄利克雷分布, 则其后验分布也为狄利克雷分布, 两者构成共轭分布。作为先验分布的狄利克雷分布的参数又称为超参数。使用共轭分布的好处是便于从先验分布计算后验分布。\\\\\n设 $\\mathcal{W}=\\left\\{w_{1}, w_{2}, \\cdots, w_{k}\\right\\}$ 是由 $k$ 个元素组成的集合。随机变量 $X$ 服从 $\\mathcal{W}$ 上的多项分布, $X \\sim \\operatorname{Mult}(n, \\theta)$, 其中 $n=\\left(n_{1}, n_{2}, \\cdots, n_{k}\\right)$ 和 $\\theta=\\left(\\theta_{1}, \\theta_{2}, \\cdots, \\theta_{k}\\right)$ 是参数。参数 $n$ 为从 $\\mathcal{W}$ 中重复独立抽取样本的次数, $n_{i}$ 为样本中 $w_{i}$ 出现的次数 $(i=1,2, \\cdots, k)$; 参数 $\\theta_{i}$ 为 $w_{i}$出现的概率 $(i=1,2, \\cdots, k)$ 。\n\n将样本数据表示为 $D$, 目标是计算在样本数据 $D$ 给定条件下参数 $\\theta$ 的后验概率 $p(\\theta \\mid D)$ 。对于给定的样本数据 $D$, 似然函数是\n\n\n\\begin{equation*}\np(D \\mid \\theta)=\\theta_{1}^{n_{1}} \\theta_{2}^{n_{2}} \\cdots \\theta_{k}^{n_{k}}=\\prod_{i=1}^{k} \\theta_{i}^{n_{i}} \\tag{20.10}\n\\end{equation*}\n\n\n假设随机变量 $\\theta$ 服从狄利克雷分布 $p(\\theta \\mid \\alpha)$, 其中 $\\alpha=\\left(\\alpha_{1}, \\alpha_{2}, \\cdots, \\alpha_{k}\\right)$ 为参数, 则 $\\theta$ 的先验分布为\n\n\n\\begin{equation*}\np(\\theta \\mid \\alpha)=\\frac{\\Gamma\\left(\\sum_{i=1}^{k} \\alpha_{i}\\right)}{\\prod_{i=1}^{k} \\Gamma\\left(\\alpha_{i}\\right)} \\prod_{i=1}^{k} \\theta_{i}^{\\alpha_{i}-1}=\\frac{1}{\\mathrm{~B}(\\alpha)} \\prod_{i=1}^{k} \\theta_{i}^{\\alpha_{i}-1}=\\operatorname{Dir}(\\theta \\mid \\alpha), \\quad \\alpha_{i}>0 \\tag{20.11}\n\\end{equation*}\n\n\n根据贝叶斯规则, 在给定样本数据 $D$ 和参数 $\\alpha$ 的条件下, $\\theta$ 的后验概率分布是\n\n\n\\begin{align*}\np(\\theta \\mid D, \\alpha) & =\\frac{p(D \\mid \\theta) p(\\theta \\mid \\alpha)}{p(D \\mid \\alpha)} \\\\\n& =\\frac{\\prod_{i=1}^{k} \\theta_{i}^{n_{i}} \\frac{1}{\\mathrm{~B}(\\alpha)} \\theta_{i}^{\\alpha_{i}-1}}{\\int \\prod_{i=1}^{k} \\theta_{i}^{n_{i}} \\frac{1}{\\mathrm{~B}(\\alpha)} \\theta_{i}^{\\alpha_{i}-1} \\mathrm{~d} \\theta} \\\\\n& =\\frac{1}{\\mathrm{~B}(\\alpha+n)} \\prod_{i=1}^{k} \\theta_{i}^{\\alpha_{i}+n_{i}-1} \\\\\n& =\\operatorname{Dir}(\\theta \\mid \\alpha+n) \\tag{20.12}\n\\end{align*}\n\n\n可以看出先验分布 (20.11) 和后验分布 (20.12) 都是狄利克雷分布, 两者有不同的参数,所以狄利克雷分布是多项分布的共轭先验。狄利克雷后验分布的参数等于狄利克雷先验分布参数 $\\alpha=\\left(\\alpha_{1}, \\alpha_{2}, \\cdots, \\alpha_{k}\\right)$ 加上多项分布的观测计数 $n=\\left(n_{1}, n_{2}, \\cdots, n_{k}\\right)$, 好像试验之前就已经观察到计数 $\\alpha=\\left(\\alpha_{1}, \\alpha_{2}, \\cdots, \\alpha_{k}\\right)$, 因此也把 $\\alpha$ 叫做先验伪计数（prior pseudo-counts）。\n\n\\section*{20.2 潜在狄利克雷分配模型}"
    },
    {
        "id": "chatcmpl-948FxxDjlag6MBpfPI8wLb3baGt6u",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"狄利克雷分布的共轭先验具有什么重要性质？\",\n    \"回答1\": \"狄利克雷分布是多项分布的共轭先验，这意味着如果多项分布的先验分布是狄利克雷分布，那么其后验分布也为狄利克雷分布，两者构成共轭分布。这种特性使得从先验分布计算后验分布更加便利。\",\n    \"问题2\": \"多项分布的先验分布是狄利克雷分布时，其后验分布的参数如何计算？\",\n    \"回答2\": \"多项分布的先验分布是狄利克雷分布时，其后验分布的参数等于狄利克雷先验分布参数加上多项分布的观测计数。换言之，后验分布的参数是先验分布参数 $\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\theta}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}$ 加上观测到的样本数据计数。\",\n    \"问题3\": \"在贝叶斯学习中，为什么常使用共轭先验？\",\n    \"回答3\": \"在贝叶斯学习中常使用共轭先验是因为如果后验分布与先验分布属于同类, 则先验分布与后验分布称为共轭分布。这种情况下，先验分布称为共轭先验。使用共轭先验的好处是便于从先验分布计算后验分布，简化了贝叶斯推断的计算过程。\",\n    \"问题4\": \"多项分布的似然函数是如何定义的？\",\n    \"回答4\": \"对于给定的样本数据 $D$，多项分布的似然函数定义为 $p(D \\text{ 为 } \\theta)=\\theta_{1}^{n_{1}} \\theta_{2}^{n_{2}} \\text{...} \\theta_{k}^{n_{k}}=\\bigprod_{i=1}^{k} \\theta_{i}^{n_{i}}$，其中 $n_i$ 表示样本中第 $i$ 个元素出现的次数，$\\theta_i$ 表示第 $i$ 个元素出现的概率。\",\n    \"问题5\": \"狄利克雷分布的先验概率密度函数是如何定义的？\",\n    \"回答5\": \"假设随机变量 $\\theta$ 服从狄利克雷分布 $p(\\theta \\text{ 为 } \\boldsymbol{\\boldsymbol{\\theta}})$, 其中 $\\boldsymbol{\\boldsymbol{\\theta}}=\\big(\\theta_1, \\theta_2, \\text{...}, \\theta_k\\big)$ 为参数, 则 $\\theta$ 的先验概率密度函数定义为 $p(\\theta \\text{ 为 } \\boldsymbol{\\theta})=\\frac{\\text{Γ}\\big(\\bigsum_{i=1}^{k} \\theta_i\\big)}{\\bigprod_{i=1}^{k} \\text{Γ}\\big(\\theta_i\\big)} \\bigprod_{i=1}^{k} \\theta_i^{\\theta_i-1}=\\frac{1}{\\text{B}(\\boldsymbol{\\theta})} \\bigprod_{i=1}^{k} \\theta_i^{\\theta_i-1}=\\text{Dir}(\\theta \\text{ 为 } \\boldsymbol{\\theta})$，其中 $\\text{B}(\\boldsymbol{\\theta})$ 是狄利克雷函数。\",\n    \"问题6\": \"根据贝叶斯规则，如何计算参数 $\\theta$ 的后验概率分布？\",\n    \"回答6\": \"根据贝叶斯规则，在给定样本数据 $D$ 和参数 $\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{n}}}}}}}}$ 的条件下, $\\theta$ 的后验概率分布可以通过公式 $p(\\theta \\text{ 为 } D, \\text{ 为 } \\text{α}) =\\frac{p(D \\text{ 为 } \\theta) p(\\theta \\text{ 为 } \\text{α})}{p(D \\text{ 为 } \\text{α})}$ 计算得到。\",\n    \"问题7\": \"狄利克雷后验分布和先验分布有何关联？\",\n    \"回答7\": \"可以看出狄利克雷后验分布和先验分布都是狄利克雷分布，两者有不同的参数。因此狄利克雷分布是多项分布的共轭先验。狄利克雷后验分布的参数等于狄利克雷先验分布参数加上多项分布的观测计数。\",\n    \"问题8\": \"什么是超参数在狄利克雷分布中的作用？\",\n    \"回答8\": \"在狄利克雷分布中，超参数 $\\text{α}=\\big(\\text{α}_1, \\text{α}_2, \\text{...}, \\text{α}_k\\big)$ 起到调节先验概率密度函数形状和性质的作用。它们影响着先验概率密度函数曲线的峰值、尖度等特征，从而影响了对参数 $\\theta$ 先验信念的表达。\",\n    \"问题9\": \"什么是先验伪计数在贝叶斯推断中的作用？\",\n    \"回答9\": \"在贝叶斯推断中，将超参数 $\\text{α}$ 视作观察到的计数，因此也把 $\\text{α}$ 叫做先验伪计数（prior pseudo-counts）。这种视角使得超参数 $\\text{α}$ 在贝叶斯推断中起到了类似于已观察到的样本数据计数的作用。\",\n    \"问题10\": \"什么是潜在狄利克雷分配模型？\",\n    \"回答10\": \"潜在狄利克雷分配模型是一种用于聚类和主题建模的概率生成模型。它基于狄利克雷过程构建，在无限维空间上定义了一个无限维混合模型，并通过观测数据和隐变量之间的关系进行聚类和主题建模。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710772077,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1783,
            "prompt_tokens": 3952,
            "total_tokens": 5735
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]