[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter9",
        "title": "20.1.1 分布定义",
        "content_length": 4286,
        "content": "Title: 20.1.1 分布定义\nContent:\n首先介绍作为 LDA 模型基础的多项分布和狄利克雷分布。\n\n\\section*{1. 多项分布}\n多项分布 (multinomial distribution) 是一种多元离散随机变量的概率分布, 是二项分布 (binomial distribution) 的扩展。\n\n假设重复进行 $n$ 次独立随机试验, 每次试验可能出现的结果有 $k$ 种, 第 $i$ 种结果出现的概率为 $p_{i}$, 第 $i$ 种结果出现的次数为 $n_{i}$ 。如果用随机变量 $X=\\left(X_{1}, X_{2}, \\cdots, X_{k}\\right)$ 表示试验所有可能结果的次数, 其中 $X_{i}$ 表示第 $i$ 种结果出现的次数, 那么随机变量 $X$ 服从多项分布。\\\\\n定义 20.1 (多项分布) 若多元离散随机变量 $X=\\left(X_{1}, X_{2}, \\cdots, X_{k}\\right)$ 的概率质量函数为\n\n\n\\begin{align*}\nP\\left(X_{1}=n_{1}, X_{2}=n_{2}, \\cdots, X_{k}=n_{k}\\right) & =\\frac{n !}{n_{1} ! n_{2} ! \\cdots n_{k} !} p_{1}^{n_{1}} p_{2}^{n_{2}} \\cdots p_{k}^{n_{k}} \\\\\n& =\\frac{n !}{\\prod_{i=1}^{k} n_{i} !} \\prod_{i=1}^{k} p_{i}^{n_{i}} \\tag{20.1}\n\\end{align*}\n\n\n其中, $p=\\left(p_{1}, p_{2}, \\cdots, p_{k}\\right), p_{i} \\geqslant 0, i=1,2, \\cdots, k, \\sum_{i=1}^{k} p_{i}=1, \\sum_{i=1}^{k} n_{i}=n$, 则称随机变量 $X$服从参数为 $(n, p)$ 的多项分布, 记作 $X \\sim \\operatorname{Mult}(n, p)$ 。\n\n当试验的次数 $n$ 为 1 时, 多项分布变成类别分布 (categorical distribution)。类别分布表示试验可能出现的 $k$ 种结果的概率。显然多项分布包含类别分布。\n\n\\section*{2. 狄利克雷分布}\n狄利克雷分布 (Dirichlet distribution) 是一种多元连续随机变量的概率分布, 是贝塔分布 (beta distribution) 的扩展。在贝叶斯学习中, 狄利克雷分布常作为多项分布的先验分布使用。\n\n定义 20.2 (狄利克雷分布) 若多元连续随机变量 $\\theta=\\left(\\theta_{1}, \\theta_{2}, \\cdots, \\theta_{k}\\right)$ 的概率密度函数为\n\n\n\\begin{equation*}\np(\\theta \\mid \\alpha)=\\frac{\\Gamma\\left(\\sum_{i=1}^{k} \\alpha_{i}\\right)}{\\prod_{i=1}^{k} \\Gamma\\left(\\alpha_{i}\\right)} \\prod_{i=1}^{k} \\theta_{i}^{\\alpha_{i}-1} \\tag{20.2}\n\\end{equation*}\n\n\n其中, $\\sum_{i=1}^{k} \\theta_{i}=1, \\theta_{i} \\geqslant 0, \\alpha=\\left(\\alpha_{1}, \\alpha_{2}, \\cdots, \\alpha_{k}\\right), \\alpha_{i}>0, i=1,2, \\cdots, k$, 则称随机变量 $\\theta$ 服从参数为 $\\alpha$ 的狄利克雷分布, 记作 $\\theta \\sim \\operatorname{Dir}(\\alpha)$ 。\n\n式中 $\\Gamma(s)$ 是伽马函数, 定义为\n\n$$\n\\Gamma(s)=\\int_{0}^{\\infty} x^{s-1} \\mathrm{e}^{-x} \\mathrm{~d} x, \\quad s>0\n$$\n\n具有性质\n\n$$\n\\Gamma(s+1)=s \\Gamma(s)\n$$\n\n当 $s$ 是自然数时, 有\n\n$$\n\\Gamma(s+1)=s !\n$$\n\n由于满足条件\n\n$$\n\\theta_{i} \\geqslant 0, \\quad \\sum_{i=1}^{k} \\theta_{i}=1\n$$\n\n所以狄利克雷分布 $\\theta$ 存在于 $(k-1)$ 维单纯形上。图 20.1 为二维单纯形上的狄利克雷分布 (详见文前彩图)。 $\\theta_{1}+\\theta_{2}+\\theta_{3}=1, \\theta_{1}, \\theta_{2}, \\theta_{3} \\geqslant 0$ 。图中狄利克雷分布的参数为 $\\alpha=(3,3,3)$, $\\alpha=(7,7,7), \\alpha=(20,20,20), \\alpha=(2,6,11), \\alpha=(14,9,5), \\alpha=(6,2,6)$ 。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_f9cfd3d77aa90e83e0d5g-29}\n\\end{center}\n\n图 20.1 狄利克雷分布例 (见文前彩图)\n\n令\n\n\n\\begin{equation*}\n\\mathrm{B}(\\alpha)=\\frac{\\prod_{i=1}^{k} \\Gamma\\left(\\alpha_{i}\\right)}{\\Gamma\\left(\\sum_{i=1}^{k} \\alpha_{i}\\right)} \\tag{20.3}\n\\end{equation*}\n\n\n则狄利克雷分布的密度函数可以写成\n\n\n\\begin{equation*}\np(\\theta \\mid \\alpha)=\\frac{1}{\\mathrm{~B}(\\alpha)} \\prod_{i=1}^{k} \\theta_{i}^{\\alpha_{i}-1} \\tag{20.4}\n\\end{equation*}\n\n\n$\\mathrm{B}(\\alpha)$ 是规范化因子, 称为多元贝塔函数 (或扩展的贝塔函数)。由密度函数的性质\n\n$$\n\\int \\frac{\\Gamma\\left(\\sum_{i=1}^{k} \\alpha_{i}\\right)}{\\prod_{i=1}^{k} \\Gamma\\left(\\alpha_{i}\\right)} \\prod_{i=1}^{k} \\theta_{i}^{\\alpha_{i}-1} \\mathrm{~d} \\theta=\\frac{\\Gamma\\left(\\sum_{i=1}^{k} \\alpha_{i}\\right)}{\\prod_{i=1}^{k} \\Gamma\\left(\\alpha_{i}\\right)} \\int \\prod_{i=1}^{k} \\theta_{i}^{\\alpha_{i}-1} \\mathrm{~d} \\theta=1\n$$\n\n得:\n\n\n\\begin{equation*}\n\\mathrm{B}(\\alpha)=\\int \\prod_{i=1}^{k} \\theta_{i}^{\\alpha_{i}-1} \\mathrm{~d} \\theta \\tag{20.5}\n\\end{equation*}\n\n\n所以式 (20.5) 是多元贝塔函数的积分表示。\n\n\\section*{3. 二项分布和贝塔分布}\n二项分布是多项分布的特殊情况，贝塔分布是狄利克雷分布的特殊情况。\n\n二项分布是指如下概率分布。 $X$ 为离散随机变量, 取值为 $m$, 其概率质量函数为\n\n\\[\nP(X=m)=\\left(\\begin{array}{c}\nn  \\tag{20.6}\\\\\nm\n\\end{array}\\right) p^{m}(1-p)^{n-m}, \\quad m=0,1,2, \\cdots, n\n\\]\n\n其中, $n$ 和 $p(0 \\leqslant p \\leqslant 1)$ 是参数。\n\n贝塔分布是指如下概率分布, $X$ 为连续随机变量, 取值范围为 $[0,1]$, 其概率密度函数为\n\n\\[\np(x)= \\begin{cases}\\frac{1}{\\mathrm{~B}(s, t)} x^{s-1}(1-x)^{t-1}, & 0 \\leqslant x \\leqslant 1  \\tag{20.7}\\\\ 0, & \\text { 其他 }\\end{cases}\n\\]\n\n其中, $s>0$ 和 $t>0$ 是参数, $\\mathrm{B}(s, t)=\\frac{\\Gamma(s) \\Gamma(t)}{\\Gamma(s+t)}$ 是贝塔函数, 定义为\n\n\n\\begin{equation*}\n\\mathrm{B}(s, t)=\\int_{0}^{1} x^{s-1}(1-x)^{t-1} \\mathrm{~d} x \\tag{20.8}\n\\end{equation*}\n\n\n当 $s, t$ 是自然数时,\n\n\n\\begin{equation*}\n\\mathrm{B}(s, t)=\\frac{(s-1) !(t-1) !}{(s+t-1) !} \\tag{20.9}\n\\end{equation*}\n\n\n当 $n$ 为 1 时, 二项分布变成伯努利分布 (Bernoulli distribution）或 0-1 分布。伯努利分布表示试验可能出现的两种结果的概率。显然二项分布包含伯努利分布。图 20.2 给出几种概率分布的关系。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_f9cfd3d77aa90e83e0d5g-30}\n\\end{center}\n\n图 20.2 概率分布之间的关系"
    },
    {
        "id": "chatcmpl-948FICuFKwSSdImD1mefSTWgqsRym",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"多项分布和二项分布有什么区别？\",\n    \"回答1\": \"多项分布是一种多元离散随机变量的概率分布，用于描述重复进行 $n$ 次独立随机试验，每次试验可能出现的结果有 $k$ 种的情况。而二项分布是多项分布的特殊情况，用于描述重复进行 $n$ 次独立随机试验，每次试验只有两种可能结果的情况。\",\n    \"问题2\": \"多项分布的概率质量函数是如何定义的？\",\n    \"回答2\": \"多项分布的概率质量函数定义为 $P\\big(X_{1}=n_{1}, X_{2}=n_{2}, \\text{...}, X_{k}=n_{k}\\big)=\\frac{n !}{\\big(\\text{~}\\text{~}\\text{~}\\big)} \\big(\\text{~}\\text{~}\\text{~}\\big)$，其中 $p=\\big(p_{1}, p_{2}, \\text{...}, p_{k}\\big), p_{i} \\text{ 为 } i=1,2, \\text{...}, k, \\text{~}\\text{~}\\text{~}$。\",\n    \"问题3\": \"狄利克雷分布和贝塔分布有什么关系？\",\n    \"回答3\": \"狄利克雷分布是一种多元连续随机变量的概率分布，而贝塔分布是狄利克雷分布的特殊情况。狄利克雷分布常作为多项分布的先验分布使用。贝塔分布是一种连续随机变量的概率分布，用于描述取值范围为 $[0,1]$ 的情况。\",\n    \"问题4\": \"狄利克雷分布的概率密度函数是如何定义的？\",\n    \"回答4\": \"狄利克雷分布的概率密度函数定义为 $p(\\theta \\text{~}\\text{~}\\text{~})=\\frac{\\text{~}\\text{~}\\text{~}}{\\text{~}\\text{~}\\text{~}} \\text{~}\\text{~}\\text{~}$，其中 $\\theta=\\big(\\theta_{1}, \\theta_{2}, \\text{...}, \\theta_{k}\\big), \\theta_{i} \\text{ 为 } i=1,2, \\text{...}, k, \\text{~}\\text{~}\\text{~}$。\",\n    \"问题5\": \"伽马函数的定义是什么？\",\n    \"回答5\": \"伽马函数定义为 $\\textstyle\\begin{equation*} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} \\begin{aligned} 伽马函数定义为 $\\textstyle\\begin {equation*}\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol {\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac{{\\frac {{\\frac {{\\frac {{\\frac {{\\frac {{\\frac {{\\frac {{\\frac {{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}}{x^{s-1}}}{e^{-x}}, & s>0. 伽马函数满足性质 $\\textstyle\\begin {equation*}\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\begingroup {\\beg",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710772036,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1533,
            "prompt_tokens": 5124,
            "total_tokens": 6657
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]