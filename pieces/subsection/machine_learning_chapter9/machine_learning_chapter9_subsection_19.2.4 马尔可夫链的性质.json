[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter9",
        "title": "19.2.4 马尔可夫链的性质",
        "content_length": 5764,
        "content": "Title: 19.2.4 马尔可夫链的性质\nContent:\n以下介绍离散状态马尔可夫链的性质, 可以自然推广到连续状态马尔可夫链。\n\n\\section*{1. 不可约}\n定义 19.3 (不可约) 设有马尔可夫链 $X=\\left\\{X_{0}, X_{1}, \\cdots, X_{t}, \\cdots\\right\\}$, 状态空间为 $\\mathcal{S}$, 对于任意状态 $i, j \\in \\mathcal{S}$, 如果存在一个时刻 $t(t>0)$ 满足\n\n\n\\begin{equation*}\nP\\left(X_{t}=i \\mid X_{0}=j\\right)>0 \\tag{19.24}\n\\end{equation*}\n\n\n也就是说, 时刻 0 从状态 $j$ 出发、时刻 $t$ 到达状态 $i$ 的概率大于 0 , 则称此马尔可夫链 $X$ 是不可约的 (irreducible), 否则称马尔可夫链是可约的 (reducible )。\n\n直观上, 一个不可约的马尔可夫链从任意状态出发, 当经过充分长时间后, 可以到达任意状态。例 19.3 中的马尔可夫链是不可约的, 例 19.5 中的马尔可夫链是可约的。\n\n例 19.5 图 19.6 所示马尔可夫链是可约的。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_f9cfd3d77aa90e83e0d5g-09}\n\\end{center}\n\n图 19.6 马尔可夫链例\n\n解 转移概率矩阵为\n\n$$\n\\left[\\begin{array}{ccc}\n0 & 1 / 2 & 0 \\\\\n1 & 0 & 0 \\\\\n0 & 1 / 2 & 1\n\\end{array}\\right]\n$$\n\n平稳分布 $\\pi=\\left(\\begin{array}{lll}0 & 0 & 1\\end{array}\\right)^{\\mathrm{T}}$ 。此马尔可夫链转移到状态 3 后, 就在该状态上循环跳转, 不能到达状态 1 和状态 2 , 最终停留在状态 3 。\n\n\\section*{2. 非周期}\n定义 19.4 (非周期) 设有马尔可夫链 $X=\\left\\{X_{0}, X_{1}, \\cdots, X_{t}, \\cdots\\right\\}$, 状态空间为 $\\mathcal{S}$, 对于任意状态 $i \\in \\mathcal{S}$, 如果时刻 0 从状态 $i$ 出发、时刻 $t$ 返回状态的所有时间长 $\\left\\{t: P\\left(X_{t}=i \\mid X_{0}=i\\right)>0\\right\\}$\\\\\n的最大公约数是 1 , 则称此马尔可夫链 $X$ 是非周期的 (aperiodic), 否则称马尔可夫链是周期的 ( periodic)。\n\n直观上, 一个非周期性马尔可夫链不存在一个状态, 从这一个状态出发, 再返回到这个状态时所经历的时间长呈一定的周期性。例 19.3 中的马尔可夫链是非周期的, 例 19.6 中的马尔可夫链是周期的。\n\n例 19.6 图 19.7 所示的马尔可夫链是周期的。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_f9cfd3d77aa90e83e0d5g-10}\n\\end{center}\n\n图 19.7 马尔可夫链例\n\n解 转移概率矩阵为\n\n$$\n\\left[\\begin{array}{lll}\n0 & 0 & 1 \\\\\n1 & 0 & 0 \\\\\n0 & 1 & 0\n\\end{array}\\right]\n$$\n\n其平稳分布是 $\\pi=\\left(\\begin{array}{lll}1 / 3 & 1 / 3 & 1 / 3\\end{array}\\right)^{\\mathrm{T}}$ 。此马尔可夫链从每个状态出发返回该状态的时刻都是 3 的倍数, $\\{3,6,9\\}$, 具有周期性, 最终停留在每个状态的概率都为 $1 / 3$ 。\n\n\\section*{定理 19.2 不可约且非周期的有限状态马尔可夫链有唯一平稳分布存在。}\n\\section*{3. 正常返}\n定义 19.5 (正常返) 设有马尔可夫链 $X=\\left\\{X_{0}, X_{1}, \\cdots, X_{t}, \\cdots\\right\\}$, 状态空间为 $\\mathcal{S}$, 对于任意状态 $i, j \\in \\mathcal{S}$, 定义概率 $p_{i j}^{t}$ 为时刻 0 从状态 $j$ 出发、时刻 $t$ 首次转移到状态 $i$ 的概率,即 $p_{i j}^{t}=P\\left(X_{t}=i, X_{s} \\neq i, s=1,2, \\cdots, t-1 \\mid X_{0}=j\\right), t=1,2, \\cdots$ 。若对所有状态 $i, j$ 都满足 $\\lim _{t \\rightarrow \\infty} p_{i j}^{t}>0$, 则称马尔可夫链 $X$ 是正常返的 (positive recurrent)。\n\n直观上, 对于一个正常返的马尔可夫链中的任意一个状态, 从其他任意一个状态出发,当时间趋于无穷时, 首次转移到这个状态的概率不为 0 。例 19.7 中的马尔可夫链根据不同条件是正常返的或不是正常返的。\n\n例 19.7 对于图 19.8 所示无限状态马尔可夫链, 证明当 $p>q$ 时是正常返的, 当 $p \\leqslant q$时不是正常返的。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_f9cfd3d77aa90e83e0d5g-10(1)}\n\\end{center}\n\n图 19.8 马尔可夫链例\\\\\n解 转移概率矩阵为\n\n$$\n\\left[\\begin{array}{ccccc}\np & p & 0 & 0 & \\\\\nq & 0 & p & 0 & \\\\\n0 & q & 0 & p & \\\\\n0 & 0 & q & 0 & \\\\\n& \\vdots & & & \\ddots\n\\end{array}\\right]\n$$\n\n当 $p>q$ 时, 平稳分布是\n\n$$\n\\pi_{i}=\\left(\\frac{q}{p}\\right)^{i}\\left(\\frac{p-q}{p}\\right), \\quad i=1,2, \\cdots\n$$\n\n当时间趋于无穷时, 转移到任何一个状态的概率不为 0 , 马尔可夫链是正常返的。\n\n当 $p \\leqslant q$ 时, 不存在平稳分布, 马尔可夫链不是正常返的。\n\n定理 19.3 不可约、非周期且正常返的马尔可夫链有唯一平稳分布存在。\n\n\\section*{4. 遍历定理}\n下面叙述马尔可夫链的遍历定理。\n\n定理 19.4 (遍历定理) 设有马尔可夫链 $X=\\left\\{X_{0}, X_{1}, \\cdots, X_{t}, \\cdots\\right\\}$, 状态空间为 $\\mathcal{S}$, 若马尔可夫链 $X$ 是不可约、非周期且正常返的, 则该马尔可夫链有唯一平稳分布 $\\pi=\\left(\\pi_{1}, \\pi_{2}, \\cdots\\right)^{\\mathrm{T}}$, 并且转移概率的极限分布是马尔可夫链的平稳分布。\n\n\n\\begin{equation*}\n\\lim _{t \\rightarrow \\infty} P\\left(X_{t}=i \\mid X_{0}=j\\right)=\\pi_{i}, \\quad i=1,2, \\cdots, \\quad j=1,2, \\cdots \\tag{19.25}\n\\end{equation*}\n\n\n若 $f(X)$ 是定义在状态空间上的函数, $E_{\\pi}[|f(X)|]<\\infty$, 则\n\n\n\\begin{equation*}\nP\\left\\{\\hat{f}_{t} \\rightarrow E_{\\pi}[f(X)]\\right\\}=1 \\tag{19.26}\n\\end{equation*}\n\n\n其中,\n\n$$\n\\hat{f}_{t}=\\frac{1}{t} \\sum_{s=1}^{t} f\\left(x_{s}\\right)\n$$\n\n$E_{\\pi}[f(X)]=\\sum_{i} f(i) \\pi_{i}$ 是 $f(X)$ 关于平稳分布 $\\pi=\\left(\\pi_{1}, \\pi_{2}, \\cdots\\right)^{\\mathrm{T}}$ 的数学期望, 式 (19.26)表示\n\n\n\\begin{equation*}\n\\hat{f}_{t} \\rightarrow E_{\\pi}[f(X)], \\quad t \\rightarrow \\infty \\tag{19.27}\n\\end{equation*}\n\n\n几乎处处成立或以概率 1 成立。\n\n遍历定理的直观解释: 对于满足相应条件的马尔可夫链, 当时间趋于无穷时, 马尔可夫链的状态分布趋近于平稳分布, 随机变量的函数的样本均值以概率 1 收玫于该函数的数学期望。样本均值可以认为是时间均值, 而数学期望是空间均值。遍历定理实际表述了遍历性的含义: 当时间趋于无穷时, 时间均值等于空间均值。遍历定理的三个条件: 不可约、非周期、正常返, 保证了当时间趋于无穷时达到任意一个状态的概率不为 0 。\n\n理论上并不知道经过多少次迭代, 马尔可夫链的状态分布才能接近于平稳分布, 在实际\\\\\n应用遍历定理时, 取一个足够大的整数 $m$, 经过 $m$ 次迭代之后认为状态分布就是平稳分布,这时计算从第 $m+1$ 次迭代到第 $n$ 次迭代的均值, 即\n\n\n\\begin{equation*}\n\\hat{E} f=\\frac{1}{n-m} \\sum_{i=m+1}^{n} f\\left(x_{i}\\right) \\tag{19.28}\n\\end{equation*}\n\n\n称为遍历均值。\n\n\\section*{5. 可逆马尔可夫链}\n定义 19.6 (可逆马尔可夫链) 设有马尔可夫链 $X=\\left\\{X_{0}, X_{1}, \\cdots, X_{t}, \\cdots\\right\\}$, 状态空间为 $\\mathcal{S}$, 转移概率矩阵为 $P$, 如果有状态分布 $\\pi=\\left(\\pi_{1}, \\pi_{2}, \\cdots\\right)^{\\mathrm{T}}$, 对于任意状态 $i, j \\in \\mathcal{S}$, 对任意一个时刻 $t$ 满足\n\n\n\\begin{equation*}\nP\\left(X_{t}=i \\mid X_{t-1}=j\\right) \\pi_{j}=P\\left(X_{t-1}=j \\mid X_{t}=i\\right) \\pi_{i}, \\quad i, j=1,2, \\cdots \\tag{19.29}\n\\end{equation*}\n\n\n或简写为\n\n\n\\begin{equation*}\np_{i j} \\pi_{j}=p_{j i} \\pi_{i}, \\quad i, j=1,2, \\cdots \\tag{19.30}\n\\end{equation*}\n\n\n则称此马尔可夫链 $X$ 为可逆马尔可夫链 (reversible Markov chain), 式 (19.30) 称为细致平衡方程 (detailed balance equation)。\n\n直观上, 如果有可逆的马尔可夫链, 那么以该马尔可夫链的平稳分布作为初始分布, 进行随机状态转移, 无论是面向未来还是面向过去, 任何一个时刻的状态分布都是该平稳分布。例 19.3 中的马尔可夫链是可逆的, 例 19.8 中的马尔可夫链是不可逆的。\n\n例 19.8 图 19.9 所示马尔可夫链是不可逆的。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_f9cfd3d77aa90e83e0d5g-12}\n\\end{center}\n\n图 19.9 马尔可夫链例\n\n解 转移概率矩阵为\n\n$$\n\\left[\\begin{array}{ccc}\n1 / 4 & 1 / 2 & 1 / 4 \\\\\n1 / 4 & 0 & 1 / 2 \\\\\n1 / 2 & 1 / 2 & 1 / 4\n\\end{array}\\right]\n$$\n\n平稳分布 $\\pi=\\left(\\begin{array}{lll}8 / 25 & 7 / 25 & 2 / 5\\end{array}\\right)^{\\mathrm{T}}$, 不满足细致平稳方程。\n\n定理 19.5 (细致平衡方程) 满足细致平衡方程的状态分布 $\\boldsymbol{\\pi}$ 就是该马尔可夫链的平稳分布。即\n\n$$\nP \\pi=\\pi\n$$\n\n证明 事实上,\n\n\n\\begin{equation*}\n(P \\pi)_{i}=\\sum_{j} p_{i j} \\pi_{j}=\\sum_{j} p_{j i} \\pi_{i}=\\pi_{i} \\sum_{j} p_{j i}=\\pi_{i}, \\quad i=1,2, \\cdots \\tag{19.31}\n\\end{equation*}\n\n\n定理 19.5 说明, 可逆马尔可夫链一定有唯一平稳分布, 给出了一个马尔可夫链有平稳分布的充分条件 (不是必要条件)。也就是说, 可逆马尔可夫链满足遍历定理 19.4 的条件。\n\n\\section*{19.3 马尔可夫链蒙特卡罗法}"
    },
    {
        "id": "chatcmpl-947noFbj9UkpMTdwETdxR7iEgfknW",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"什么是不可约的马尔可夫链？\",\n    \"回答1\": \"对于马尔可夫链中的任意两个状态 $i, j$，如果存在一个时刻 $t(t>0)$，使得从状态 $j$ 出发经过时刻 $t$ 到达状态 $i$ 的概率大于 0，则称该马尔可夫链是不可约的。换言之，不可约的马尔可夫链意味着从任意一个状态出发，经过充分长时间后可以到达任意其他状态。\",\n    \"问题2\": \"什么是非周期的马尔可夫链？\",\n    \"回答2\": \"对于马尔可夫链中的任意一个状态 $i$，如果从状态 $i$ 出发返回该状态的所有时间长的最大公约数是 1，则称该马尔可夫链是非周期的。非周期的马尔可夫链意味着不存在一个状态，从这个状态出发再返回到这个状态时所经历的时间长呈一定的周期性。\",\n    \"问题3\": \"什么是正常返的马尔可夫链？\",\n    \"回答3\": \"对于马尔可夫链中的任意两个状态 $i, j$，如果当时间趋于无穷时，从状态 $j$ 出发首次转移到状态 $i$ 的概率不为 0，则称该马尔可夫链是正常返的。正常返的马尔可夫链意味着在无限时间内，从任意一个状态出发都有可能到达任意其他状态。\",\n    \"问题4\": \"什么是遍历定理？\",\n    \"回答4\": \"遍历定理指出了对于满足不可约、非周期且正常返条件的马尔可夫链，其具有唯一平稳分布，并且转移概率的极限分布就是马尔可夫链的平稳分布。此外，遍历定理还表述了随机变量函数的样本均值以概率 1 收敛于该函数的数学期望。\",\n    \"问题5\": \"什么是可逆马尔可夫链？\",\n    \"回答5\": \"可逆马尔可夫链指的是具有细致平衡方程（也称为细致平衡条件）的马尔可夫链。细致平衡方程要求对于任意两个状态 $i, j$，转移概率乘以平稳分布等于反向转移概率乘以平稳分布。这意味着以该平稳分布作为初始分布进行随机状态转移时，无论是面向未来还是面向过去，任何一个时刻的状态分布都是该平稳分布。\",\n    \"问题6\": \"不可约、非周期和正常返条件保证了什么？\",\n    \"回答6\": \"这三个条件保证了当时间趋于无穷时，马尔可夫链达到任意一个状态的概率不为 0。这意味着在无限时间内，从任意一个状态出发都有可能到达任意其他状态。\",\n    \"问题7\": \"遍历定理对于满足条件的马尔可夫链有何作用？\",\n    \"回答7\": \"遍历定理对于满足条件的马尔可夫链表明其具有唯一平稳分布，并且随机变量函数的样本均值以概率 1 收敛于该函数的数学期望。这为研究者提供了一种判断和计算马尔可夫链平稳分布及相关随机变量函数期望值的方法。\",\n    \"问题8\": \"细致平衡方程在可逆马尔可夫链中有何作用？\",\n    \"回答8\": \"细致平衡方程在可逆马尔可夫链中表明以该平稳分布作为初始分布进行随机状态转移时，无论是面向未来还是面向过去，任何一个时刻的状态分布都是该平稳分布。这为研究者提供了一种判断和计算马尔可夫链平稳分布及相关随机变量函数期望值的方法。\",\n    \"问题9\": \"遍历定理和细致平衡方程在实际应用中有何价值？\",\n    \"回答9\": \"遍历定理和细致平衡方程为研究者提供了一种判断和计算马尔可夫链平稳分布及相关随机变量函数期望值的方法。这些方法在实际应用中对于评估和预测系统或过程中各种状态出现的概率、期望值等具有重要价值。\",\n    \"问题10\": \"例 19.8 中所示的马尔可夫链为什么是不可逆的？\",\n    \"回答10\": \"例 19.8 中所示的马尔可夫链不满足细致平衡方程，因此被认为是不可逆的。具体来说，在该马尔可夫链中转移概率矩阵与平稳分布不满足细致平衡方程条件，因此无法被归类为可逆马尔可夫链。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710770332,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1501,
            "prompt_tokens": 6486,
            "total_tokens": 7987
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]