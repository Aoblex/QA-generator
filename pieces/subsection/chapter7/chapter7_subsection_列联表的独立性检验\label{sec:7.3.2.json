[
    {
        "strategy": "subsection",
        "source": "chapter7",
        "title": "列联表的独立性检验\\label{sec:7.3.2",
        "content_length": 4047,
        "content": "Title: 列联表的独立性检验\\label{sec:7.3.2\nContent:\n}\n列联表是将观测数据按两个或更多属性（定性变量）分类时所列出的频数表.例如，对随机抽取的1000人按性别（男或女）及色觉（正常或色育）两个属性分类，得到如下二维列联表，又称$2\\times2$表或四格表.\n\n若所考虑的属性多于两个，也可按类似的方式作出列联表，称为多维列联表.本节只限于讨论二维列联表，列联表分析在应用统计，特别在医学、生物学及社会科学中，有着广泛的应用.\n\n列联表分析的基本问题是，考察各属性之间有无关联，即判别二属性是否独立.如在前例中，问题是：一个人是否色育与其性别是否有关？在$r\\times c$表中，若以$p_{i\\cdot},p_{\\cdot j}$和$p_{ij}$分别表示总体中的个体仅属于$A_i$，仅属于$B_j$和同时属于$A_i$与$B_j$的概率，可得一个二维离散分布表（表 \\ref{tab7.4.4}），则“$A$、$B$两属性独立”的假设可以表述为\n\\[\n  H_0: p_{ij} = p_{i\\cdot}p_{\\cdot j},\\quad i = 1,\\cdots,r,j = 1,\\cdots,c.\n\\]\n\\begin{table}[!ht]\n  \\centering\n  \\caption{二维离散分布表}\\label{tab7.4.4}\n  \\begin{tabular}{c|*{5}{c}|c}\n    \\toprule\n    $A\\backslash B$ & 1 & $\\cdots$ & $j$ & $\\cdots$ & $c$ & 行和 \\\\\n    \\midrule\n    1 & $p_{11}$ & $\\cdots$ & $p_{1j}$ & $\\cdots$ & $p_{1c}$ & $p_{1\\cdot}$  \\\\\n    $\\vdots$ & $\\vdots$ & & $\\vdots$ & & $\\vdots$ & $\\vdots$ \\\\\n    $i$ & $p_{i1}$ & $\\cdots$ & $p_{ij}$ & $\\cdots$ & $p_{ic}$ & $p_{i\\cdot}$ \\\\\n    $\\vdots$ & $\\vdots$ & & $\\vdots$ & & $\\vdots$ & $\\vdots$ \\\\\n    $r$ & $p_{r1}$ & $\\cdots$ & $p_{rj}$ & $\\cdots$ & $p_{rc}$ & $p_{r\\cdot}$ \\\\\n    \\midrule\n    和 & $p_{\\cdot1}$ & $\\cdots$ & $p_{\\cdot j}$ & $\\cdots$ & $p_{\\cdot c}$ & $1$ \\\\\n    \\bottomrule\n  \\end{tabular}\n\\end{table}\n\n这就变为上一小节中诸$p_{ij}$的不完全已知时的分布拟合检验.这里诸$p_{ij}$共有$rc$个参数，在原假设$H_0$成立时，这$rc$个参数$p_{ij}$由$r+c$个参数$p_1,\\cdots,p_r$和$p_{\\cdot1},\\cdots,p_{\\cdot c}$决定. 在这后$r+c$个参数中存在两个约束提哦啊见：$\\sum_{i=1}^rp_{i\\cdot}=1,\\sum_{j=1}^cp_{\\cdot j}=1$，所以，此时$p_{ij}$实际上由$r+c-2$个独立参数所确定.据此，检验统计量为\n\\[\n  \\chi^2 = \\sum_{i=1}^r\\sum_{j=1}^c\\frac{(n_{ij}-n\\hat p_{ij})^2}{n\\hat p_{ij}},\n\\]\n在原假设$H-0$成立时上式近似服从自由度为$rc-(r+c-2)-1=(r-1)(c-1)$的$\\chi^2$分布. 其中诸$\\hat p_{ij}$是在$H_0$成立下得到的$p_{ij}$的最大似然估计，其表达式为\n\\[\n  \\hat p_{ij} = \\hat p_{i\\cdot} \\hat p_{\\cdot j} = \\frac{n_{i\\cdot}}n\\cdot \\frac{n_{\\cdot j}}n,\n\\]\n对给定的显著性水平$\\alpha$（$0<\\alpha<1$），检验的拒绝域为$W=\\left\\{ \\chi^2\\ge\\chi_{1-\\alpha}^2\\big((r-1)(c-1)\\big) \\right\\}$.\n\n\\begin{example}\\label{exam7.4.3}\n  为研究儿童智力发展与营养的关系，某研究机构调查了1436名儿童，得到如表 \\ref{tab7.4.5} 的数据，试在显著性水平0.05下判断智力发展与营养有无关系.\n  \\begin{table}[!ht]\n    \\centering\n    \\caption{儿意智力与营养的调查数据}\\label{tab7.4.5}\n    \\begin{tabular}{c|cccc|c}\n      \\toprule\n        & \\multicolumn{4}{c}{智商} & \\multirow{2}*{合计} \\\\\n        &  $<80$ & $80\\sim89$ & $90\\sim99$ & $\\ge100$ & \\\\\n      \\midrule\n      营养良好 & 367 & 342 & 266 & 329 & 1304 \\\\\n      营养不良 & 56 & 40 & 20 & 16 & 132 \\\\\n      \\midrule\n      合计 & 423 & 382 & 826 & 345 & 1436 \\\\\n      \\bottomrule\n    \\end{tabular}\n  \\end{table}\n\\end{example}\n\\begin{solution}\n  用$A$表示营养状况，它有两个水平：$A_1$表示营养良好，$A_2$表示营养不良；$B$表示儿童智商，它有四个水平，$B_1,B_2,B_3,B_4$分别表示表中四种情况.沿用前面的记号，首先建立假设$H_0$：营养状况与智商无关联，即$A$与$B$是独立的.统计表示如下：\n  \\[\n    H_0:p_{ij}=p_{i\\cdot}p_{\\cdot j},\\quad i=1,2,j=1,2,3,4.\n  \\]\n\n  在原假设$H_0$成立下，我们可以计算诸参数的最大似然估计值，\n  \\begin{gather*}\n    \\hat p_{1\\cdot} = 1304/1436 = 0.9801,\\quad \\hat p_{2\\cdot} = 132/1436 = 0.0919, \\\\\n    \\hat p_{\\cdot1} = 423/1436 = 0.2946,\\quad \\hat p_{\\cdot2} = 382/1436 = 0.2660, \\\\\n    \\hat p_{\\cdot 3} = 286/1436 = 0.1992,\\quad \\hat p_{\\cdot 4} = 345/1436 = 0.2403,\n  \\end{gather*}\n  进而可给出诸$n\\hat p_{ij}=n\\hat p_{i\\cdot}\\hat p_{\\cdot j}$，如\n  \\[\n    n\\hat p_{11} = 1436\\times 0.9801 \\times 0.2496 = 384.1677,\n  \\]\n  其他结果见表 \\ref{tab7.4.6}\n  \\begin{table}[!ht]\n    \\centering\n    \\caption{诸$n\\hat p_{ij}$的计算结果}\\label{tab7.4.6}\n    \\begin{tabular}{c|cccc|c}\n      \\toprule\n        & $<80$ & $80\\sim89$ & $90\\sim99$ & $\\ge100$ & $\\hat p_{i\\cdot}$ \\\\\n        \\midrule\n      营养良好 & 384.1677 & 346.8724 & 259.7631 & 313.3588 & 0.9801 \\\\\n      营养不良 & 38.8779 & 35.1036 & 26.2881 & 31.7120 & 0.0919 \\\\\n      \\midrule\n      $p_{\\cdot j}$ & 0.2946 & 0.2660 & 0.1992 & 0.2403 & \\\\\n      \\bottomrule\n    \\end{tabular}\n  \\end{table}\n  由表 \\ref{tab7.4.5} 和表 \\ref{tab7.4.6} 可以计算检验统计量的值\n    \\begin{align*}\n      \\chi^2 & = \\frac{(367-384.1677)^2}{384.1677} + \\frac{(342-346.8724)^2}{346.8724} + \\cdots + \\frac{(16-31.7120)^2}{31.7120} \\\\\n      & = 19.2785.\n    \\end{align*}\n    此处$r=2,c=4,(r-1)(c-1)=3$，若取$\\alpha=0.05$，查表有$\\chi^2_{0.95}=7.815$，由于$19.2785>7.815$，故拒绝原假设，认为营养状况对智商有影响.本例中检验的$p$值为0.0002.\n\\end{solution}"
    },
    {
        "id": "chatcmpl-9491OO9xv12pJrJ0QUFDtgsDBqGzK",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"什么是列联表？它通常用于哪些领域？\",\n    \"回答1\": \"列联表是将观测数据按两个或更多属性（定性变量）分类时所列出的频数表。它通常用于应用统计中，特别在医学、生物学及社会科学等领域，有着广泛的应用。\",\n    \"问题2\": \"列联表分析的基本问题是什么？\",\n    \"回答2\": \"列联表分析的基本问题是考察各属性之间有无关联，即判别二属性是否独立。例如，在某个调查中，一个人的营养状况是否与其智商水平有关，就是列联表分析的基本问题之一。\",\n    \"问题3\": \"在$r\\times c$表中，“$A$、$B$两属性独立”的假设可以如何表述？\",\n    \"回答3\": \"在$r\\times c$表中，“$A$、$B$两属性独立”的假设可以表述为 $H_0: p_{ij} = p_{i\\bullet}p_{\\bullet j},\\text{ 其中 } i = 1,\\text{...},r, j = 1,\\text{...},c$。\",\n    \"问题4\": \"列联表独立性检验的检验统计量是如何计算的？\",\n    \"回答4\": \"列联表独立性检验的检验统计量 $\\text{X}^2$ 计算公式为 $\\text{X}^2 = \\text{∑}_{i=1}^r\\text{∑}_{j=1}^c\\frac{(n_{ij}-n\\text{̂ }p_{ij})^2}{n\\text{̂ }p_{ij}}$，其中 $n_{ij}$ 是观测频数，$\\text{̂ }p_{ij}$ 是在原假设下得到的$p_{ij}$的最大似然估计。\",\n    \"问题5\": \"列联表独立性检验的拒绝域如何定义？\",\n    \"回答5\": \"对给定的显著性水平$\\text{α}$（$0<\\text{α}<1$），列联表独立性检验的拒绝域为 $W=\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\\\{\\text{X}^2≥χ_{1-α}^2((r-1)(c-1)) \\big\\\\}$。\",\n    \"问题6\": \"在给定例子中，如何判断智力发展与营养有无关系？\",\n    \"回答6\": \"在给定例子中，可以通过计算检验统计量 $\\text{X}^2$ 的值，并与临界值进行比较。若$\\text{X}^2$大于临界值，则拒绝原假设，认为智力发展与营养有关系；否则接受原假设，认为智力发展与营养无关系。\",\n    \"问题7\": \"在给定例子中，检验的$p$值是多少？\",\n    \"回答7\": \"在给定例子中，检验的$p$值为0.0002。这个$p$值表示，在原假设成立的情况下，观察到当前样本或更极端情况的概率。由于$p$值小于显著性水平0.05，因此拒绝原假设，认为智力发展与营养有关系。\",\n    \"问题8\": \"在给定例子中，如何计算诸参数的最大似然估计值？\",\n    \"回答8\": \"在给定例子中，可以通过观测频数和总体样本量计算诸参数的最大似然估计值。例如，可以计算出各个$p_{ij}$和$n\\text{̂ }p_{ij}$的值，并进而得到检验统计量 $\\text{X}^2$ 的计算结果。\",\n    \"问题9\": \"在给定例子中，检验统计量$\\text{X}^2$的自由度是多少？\",\n    \"回答9\": \"在给定例子中，检验统计量$\\text{X}^2$的自由度为3。自由度是用来描述统计推断中独立参数数量的概念，在这个例子中由$(r-1)(c-1)$确定。\",\n    \"问题10\": \"列联表独立性检验适用于哪些类型的数据分析？\",\n    \"回答10\": \"列联表独立性检验适用于定性变量之间关联性分析，特别适用于观测数据按两个或更多属性分类时所列出的频数表。它能够帮助分析者判断不同属性之间是否存在关联或独立关系，从而对实际问题进行推断和决策。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710775018,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1369,
            "prompt_tokens": 5097,
            "total_tokens": 6466
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]