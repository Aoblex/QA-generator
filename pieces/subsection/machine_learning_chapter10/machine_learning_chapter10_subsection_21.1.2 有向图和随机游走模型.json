[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter10",
        "title": "21.1.2 有向图和随机游走模型",
        "content_length": 2218,
        "content": "Title: 21.1.2 有向图和随机游走模型\nContent:\n\\section*{1. 有向图}\n定义 21.1 (有向图) 有向图 (directed graph) 记作 $G=(V, E)$, 其中 $V$ 和 $E$ 分别表示结点和有向边的集合。\n\n比如, 互联网就可以看作是一个有向图, 每个网页是有向图的一个结点, 网页之间的每一条超链接是有向图的一条边。\n\n从一个结点出发到达另一个结点, 所经过的边的一个序列称为一条路径 (path), 路径上边的个数称为路径的长度。如果一个有向图从其中任何一个结点出发可以到达其他任何一个结点, 就称这个有向图是强连通图 (strongly connected graph)。图 21.1 中的有向图就是一个强连通图。\n\n假设 $k$ 是一个大于 1 的自然数, 如果从有向图的一个结点出发返回到这个结点的路径的长度都是 $k$ 的倍数, 那么称这个结点为周期性结点。如果一个有向图不含有周期性结点, 则称这个有向图为非周期性图（aperiodic graph），否则为周期性图。\n\n图 21.2 是一个周期性有向图的例子。从结点 A 出发返回到 A, 必须经过路径 A-B-C-A,所有可能的路径的长度都是 3 的倍数, 所以结点 $\\mathrm{A}$ 是周期性结点。这个有向图是周期性图。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_3182641e7f8cf23e4171g-14}\n\\end{center}\n\n图 21.2 周期性有向图\n\n\\section*{2. 随机游走模型}\n定义 21.2 (随机游走模型) 给定一个含有 $n$ 个结点的有向图, 在有向图上定义随机游走 (random walk) 模型, 即一阶马尔可夫链 (1), 其中结点表示状态, 有向边表示状态之间的转移, 假设从一个结点到通过有向边相连的所有结点的转移概率相等。具体地, 转移矩阵是一个 $n$ 阶矩阵 $M$ :\n\n\n\\begin{equation*}\n\\boldsymbol{M}=\\left[m_{i j}\\right]_{n \\times n} \\tag{21.1}\n\\end{equation*}\n\n\n第 $i$ 行第 $j$ 列的元素 $m_{i j}$ 取值规则如下: 如果结点 $j$ 有 $k$ 个有向边连出, 并且结点 $i$ 是其连出的一个结点, 则 $m_{i j}=\\frac{1}{k}$; 否则 $m_{i j}=0, i, j=1,2, \\cdots, n$ 。\n\n注意转移矩阵具有性质:\n\n\n\\begin{gather*}\nm_{i j} \\geqslant 0  \\tag{21.2}\\\\\n\\sum_{i=1}^{n} m_{i j}=1 \\tag{21.3}\n\\end{gather*}\n\n\n即每个元素非负, 每列元素之和为 1 , 即矩阵 $\\boldsymbol{M}$ 为随机矩阵 (stochastic matrix)。\n\n在有向图上的随机游走形成马尔可夫链。也就是说, 随机游走者每经一个单位时间转移一个状态, 如果当前时刻在第 $j$ 个结点 (状态), 那么下一个时刻在第 $i$ 个结点（状态）的概率是 $m_{i j}$, 这一概率只依赖于当前的状态, 与过去无关, 具有马尔可夫性。\n\n在图 21.1 的有向图上可以定义随机游走模型。结点 $\\mathrm{A}$ 到结点 $\\mathrm{B}, \\mathrm{C}$ 和 $\\mathrm{D}$ 存在有向边, 可以以概率 $1 / 3$ 从 $\\mathrm{A}$ 分别转移到 $\\mathrm{B}, \\mathrm{C}$ 和 $\\mathrm{D}$, 并以概率 0 转移到 $\\mathrm{A}$, 于是可以写出转移矩阵的第 1 列。结点 $\\mathrm{B}$ 到结点 $\\mathrm{A}$ 和 $\\mathrm{D}$ 存在有向边, 可以以概率 $1 / 2$ 从 $\\mathrm{B}$ 分别转移到 $\\mathrm{A}$ 和 $\\mathrm{D}$, 并以概率 0 分别转移到 $B$ 和 $C$, 于是可以写出矩阵的第 2 列等。于是得到转移矩阵:\n\n$$\nM=\\left[\\begin{array}{cccc}\n0 & 1 / 2 & 1 & 0 \\\\\n1 / 3 & 0 & 0 & 1 / 2 \\\\\n1 / 3 & 0 & 0 & 1 / 2 \\\\\n1 / 3 & 1 / 2 & 0 & 0\n\\end{array}\\right]\n$$\n\n随机游走在某个时刻 $t$ 访问各个结点的概率分布就是马尔可夫链在时刻 $t$ 的状态分布,可以用一个 $n$ 维列向量 $\\boldsymbol{R}_{t}$ 表示, 那么在时刻 $t+1$ 访问各个结点的概率分布 $\\boldsymbol{R}_{t+1}$ 满足\n\n\n\\begin{equation*}\n\\boldsymbol{R}_{t+1}=M \\boldsymbol{R}_{t} \\tag{21.4}\n\\end{equation*}\n\n\n(1) 马尔可夫链的介绍可参照第 19 章。"
    },
    {
        "id": "chatcmpl-93zRVtGV40r1d77TUccL08jua03cU",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"有向图和无向图有什么区别？\",\n    \"回答1\": \"有向图（directed graph）和无向图的主要区别在于边的方向。在有向图中，边是有方向的，表示结点之间的单向关系；而在无向图中，边是没有方向的，表示结点之间的双向关系。\",\n    \"问题2\": \"什么是强连通图？\",\n    \"回答2\": \"如果一个有向图从其中任何一个结点出发可以到达其他任何一个结点，就称这个有向图是强连通图（strongly connected graph）。强连通图具有一种较强的连通性，任意两个结点之间都存在双向路径。\",\n    \"问题3\": \"什么是周期性结点？\",\n    \"回答3\": \"假设 $k$ 是一个大于 1 的自然数，如果从有向图的一个结点出发返回到这个结点的路径的长度都是 $k$ 的倍数，那么称这个结点为周期性结点。周期性结点在随机游走模型中具有特殊的性质。\",\n    \"问题4\": \"随机游走模型中的转移矩阵具有什么性质？\",\n    \"回答4\": \"转移矩阵是一个 $n$ 阶矩阵 $M$，其中每个元素非负且每列元素之和为 1，即矩阵 $\\boldsymbol{M}$ 为随机矩阵（stochastic matrix）。这一性质保证了随机游走形成马尔可夫链，具有马尔可夫性。\",\n    \"问题5\": \"随机游走模型中的马尔可夫链满足什么条件？\",\n    \"回答5\": \"在随机游走模型中，马尔可夫链满足每个状态到下一个状态的转移概率只依赖于当前的状态，与过去无关。具体地，在时刻 $t+1$ 访问各个结点的概率分布 $\\boldsymbol{R}_{t+1}$ 满足 $\\boldsymbol{R}_{t+1}=M \\boldsymbol{R}_{t}$。\",\n    \"问题6\": \"如何定义随机游走模型中的转移矩阵？\",\n    \"回答6\": \"在含有 $n$ 个结点的有向图上定义随机游走模型时，转移矩阵 $M$ 的第 $i$ 行第 $j$ 列的元素 $m_{i j}$ 取值规则如下：如果结点 $j$ 有 $k$ 个有向边连出，并且结点 $i$ 是其连出的一个结点，则 $m_{i j}=\\frac{1}{k}$；否则 $m_{i j}=0, i, j=1,2, \\text{...}, n$。\",\n    \"问题7\": \"随机游走模型中如何表示某一时刻访问各个结点的概率分布？\",\n    \"回答7\": \"随机游走在某个时刻 $t$ 访问各个结点的概率分布可以用一个 $n$ 维列向量 $\\boldsymbol{R}_{t}$ 表示。在时刻 $t+1$ 访问各个结点的概率分布 $\\boldsymbol{R}_{t+1}$ 满足 $\\boldsymbol{R}_{t+1}=M \\boldsymbol{R}_{t}$。\",\n    \"问题8\": \"什么是随机游走模型中的非周期性图？\",\n    \"回答8\": \"如果一个有向图不含有周期性结点，则称这个有向图为非周期性图（aperiodic graph）。非周期性图在随机游走模型中具有特殊的性质。\",\n    \"问题9\": \"如何理解随机游走模型在实际应用中的意义？\",\n    \"回答9\": \"随机游走模型在实际应用中可以用来描述在给定有向图上的随机行为。通过定义转移矩阵和状态转移规则，可以模拟和分析在复杂网络或系统中的随机行为和状态变化，对于理解和预测系统行为具有重要意义。\",\n    \"问题10\": \"随机游走模型与马尔可夫链之间有何联系？\",\n    \"回答10\": \"随机游走模型实际上形成了一阶马尔可夫链。随机游走者每经一个单位时间转移一个状态，如果当前时刻在第 $j$ 个结点（状态），那么下一个时刻在第 $i$ 个结点（状态）的概率是 $m_{i j}$。因此，随机游走模型与马尔可夫链密切相关，并且具有马尔可夫性质。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710738197,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1341,
            "prompt_tokens": 4133,
            "total_tokens": 5474
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]