[
    {
        "strategy": "subsection",
        "source": "statistics",
        "title": "12.1.3 参数的最小二乘估计",
        "content_length": 5959,
        "content": "Title: 12.1.3 参数的最小二乘估计\nContent:\n回归方程中的 $\\hat{\\beta}_{0}, \\hat{\\beta}_{1}, \\hat{\\beta}_{2}, \\cdots, \\hat{\\beta}_{k}$ 仍然是根据最小二乘法求得的, 也就是使残差平方和\n\n\n\\begin{equation*}\nQ=\\sum\\left(y_{i}-\\hat{y}_{i}\\right)^{2}=\\sum\\left(y_{i}-\\hat{\\beta}_{0}-\\hat{\\beta}_{1} x_{1}-\\cdots-\\hat{\\beta}_{k} x_{k}\\right)^{2} \\tag{12.4}\n\\end{equation*}\n\n\n最小。由此可以得到求解 $\\hat{\\beta}_{0}, \\hat{\\beta}_{1}, \\hat{\\beta}_{2}, \\cdots, \\hat{\\beta}_{k}$ 的标准方程组:\n\n\\[\n\\left\\{\\begin{array}{l}\n\\left.\\frac{\\partial Q}{\\partial \\beta_{0}}\\right|_{\\beta_{0}=\\hat{\\beta}_{0}}=0  \\tag{12.5}\\\\\n\\left.\\frac{\\partial Q}{\\partial \\beta_{i}}\\right|_{\\beta_{i}=\\hat{\\beta}_{i}}=0\n\\end{array} \\quad i=1,2, \\cdots, k\\right.\n\\]\n\n求解上述方程组需要借助计算机, 可直接由 Excel 给出回归结果。\n\n\\section*{例 12.1}\n继续沿用第 11 章中的例 11.6 。一家大型商业银行在多个地区设有分行, 其业务主要是进行基础设施建设、国家重点项目建设、固定资产投资等项目的贷款。近年来，该\\\\\n银行的贷款额平稳增长, 但不良贷款额也有较大比例的提高, 这给银行业务的发展带来较大压力。为弄清楚不良贷款形成的原因, 管理者希望利用银行业务的有关数据做些定量分析, 以便找出控制不良货款的办法。表 12-1 就是该银行所属的 25 家分行的有关业务数据。\n\n表 12-1 某商业银行的主要业务数据\n\n\\begin{center}\n\\begin{tabular}{|c|c|c|c|c|c|}\n\\hline\n分行编号 & \\begin{tabular}{c}\n不良贷款 \\\\\n（亿元） \\\\\n\\end{tabular} & \\begin{tabular}{c}\n贷款余额 \\\\\n（亿元） \\\\\n\\end{tabular} & \\begin{tabular}{c}\n累计应收贷款 \\\\\n(亿元) \\\\\n\\end{tabular} & \\begin{tabular}{c}\n贷款项目个数 \\\\\n(个) \\\\\n\\end{tabular} & \\begin{tabular}{c}\n固定资产投资额 \\\\\n(亿元） \\\\\n\\end{tabular} \\\\\n\\hline\n1 & 0.9 & 67.3 & 6.8 & 5 & 51.9 \\\\\n\\hline\n2 & 1.1 & 111.3 & 19.8 & 16 & 90.9 \\\\\n\\hline\n3 & 4. 8 & 173.0 & 7. 7 & 17 & 73. 7 \\\\\n\\hline\n4 & 3.2 & 80.8 & 7. 2 & 10 & 14.5 \\\\\n\\hline\n5 & 7. 8 & 199.7 & 16.5 & 19 & 63.2 \\\\\n\\hline\n6 & 2. 7 & 16. 2 & 2.2 & 1 & 2.2 \\\\\n\\hline\n7 & 1.6 & 107.4 & 10.7 & 17 & 20.2 \\\\\n\\hline\n8 & 12.5 & 185.4 & 27.1 & 18 & 43.8 \\\\\n\\hline\n9 & 1.0 & 96.1 & 1. 7 & 10 & 55.9 \\\\\n\\hline\n10 & 2.6 & 72.8 & 9.1 & 14 & 64.3 \\\\\n\\hline\n11 & 0.3 & 64.2 & 2.1 & 11 & 42.7 \\\\\n\\hline\n12 & 4. 0 & 132.2 & 11.2 & 23 & 76. 7 \\\\\n\\hline\n13 & 0.8 & 58.6 & 6.0 & 14 & 22.8 \\\\\n\\hline\n14 & 3.5 & 174.6 & 12.7 & 26 & 117.1 \\\\\n\\hline\n15 & 10.2 & 263.5 & 15.6 & 34 & 146.7 \\\\\n\\hline\n16 & 3.0 & 79.3 & 8.9 & 15 & 29.9 \\\\\n\\hline\n17 & 0.2 & 14.8 & 0.6 & 2 & 42.1 \\\\\n\\hline\n18 & 0.4 & 73.5 & 5.9 & 11 & 25.3 \\\\\n\\hline\n19 & 1.0 & 24.7 & 5.0 & 4 & 13.4 \\\\\n\\hline\n20 & 6.8 & 139.4 & 7.2 & 28 & 64.3 \\\\\n\\hline\n21 & 11.6 & 368.2 & 16.8 & 32 & 163.9 \\\\\n\\hline\n22 & 1. 6 & 95.7 & 3. 8 & 10 & 44.5 \\\\\n\\hline\n23 & 1.2 & 109.6 & 10.3 & 14 & 67.9 \\\\\n\\hline\n24 & 7.2 & 196.2 & 15.8 & 16 & 39.7 \\\\\n\\hline\n25 & 3.2 & 102.2 & 12.0 & 10 & 97.1 \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\n试建立不良贷款 $(y)$ 与货款余额 $\\left(x_{1}\\right)$ 、累计应收贷款 $\\left(x_{2}\\right)$ 、货款项目个数 $\\left(x_{3}\\right)$\\\\\n和固定资产投资额 $\\left(x_{4}\\right)$ 的线性回归方程, 并解释各回归系数的含义。\n\n由 Excel 输出的多元回归分析结果如表 12-2 所示。\n\n根据表 $12-2$ 的结果, 得到不良贷款与贷款余额、累计应收贷款、贷款项目个数和固定资产投资额的多元线性回归方程:\n\n$$\n\\hat{y}=-1.021640+0.040039 x_{1}+0.148034 x_{2}+0.014529 x_{3}-0.029193 x_{4}\n$$\n\n各回归系数的实际意义为:\n\n$\\hat{\\beta}_{1}=0.040039$, 表示在累计应收贷款、贷款项目个数和固定资产投资额不变的条件下，贷款余额每增加 1 亿元，不良贷款平均增加 0.040039 亿元。\n\n表 12-2 Excel 输出的多元回归分析结果\n\n\\section*{SUMMARY OUTPUT}\n回归统计\n\n\\begin{center}\n\\begin{tabular}{cc}\n\\hline\nMultiple R & 0.893087 \\\\\nR Square & 0.797604 \\\\\nAdjusted R Square & 0.757125 \\\\\n标准误差 & 1.778752 \\\\\n观测值 & 25 \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\n方差分析\n\n\\begin{center}\n\\begin{tabular}{ccccccc}\n\\hline\n & df & SS & MS & F & Significance F &  \\\\\n\\hline\n回归分析 & 4 & 249.3712 & 62.3428 & 19.7040 & $1.03539 E-06$ &  \\\\\n残差 & 20 & 63.2792 & 3.163960 &  &  &  \\\\\n总计 & 24 & 312.6504 &  &  &  &  \\\\\n\\hline\n & Coefficients & 标准误差 & t Stat & P-value & Lower 95\\% & Upper 95\\% \\\\\n\\hline\nIntercept & -1.021640 & 0.782372 & -1.305823 & 0.206434 & -2.653639 & 0.610360 \\\\\nX Variable 1 & 0.040039 & 0.010434 & 3.837495 & 0.001028 & 0.018275 & 0.061804 \\\\\nX Variable 2 & 0.148034 & 0.078794 & 1.878738 & 0.074935 & -0.016328 & 0.312398 \\\\\nX Variable 3 & 0.014529 & 0.083033 & 0.174983 & 0.862853 & -0.158675 & 0.167733 \\\\\nX Variable 4 & -0.029193 & 0.015073 & -1.936769 & 0.067030 & -0.060635 & 0.002249 \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\n$\\hat{\\beta}_{2}=0.148034$, 表示在货款余额、贷款项目个数和固定资产投资额不变的条件下, 累计应收贷款每增加 1 亿元，不良货款平均增加 0.148034 亿元。\n\n$\\hat{\\beta}_{3}=0.014529$, 表示在贷款余额、累计应收贷款和固定资产投资额不变的条件下，贷款项目个数每增加 1 个, 不良贷款平均增加 0.014529 亿元。\n\n$\\hat{\\beta}_{4}=-0.029193$, 表示在贷款余额、累计应收贷款和贷款项目个数不变的条件下, 固定资产投资额每增加 1 亿元，不良贷款平均减少 0.029193 亿元。\n\n\\section*{12.2 回归方程的拟合优度}\n\\section*{12. 2.1 多重判定系数}\n与一元回归类似, 对多元线性回归方程, 需要用多重判定系数来评价其拟合程度。\n\n在一元回归中曾介绍过因变量离差平方和的分解方法, 对多元回归中因变量离差平方和的分解也一样, 同样有\n\n\n\\begin{equation*}\nS S T=S S R+S S E \\tag{12.6}\n\\end{equation*}\n\n\n式中, $S S T=\\sum\\left(y_{i}-\\bar{y}\\right)^{2}$, 为总平方和; $S S R=\\sum\\left(\\hat{y}_{i}-\\bar{y}\\right)^{2}$, 为回归平方和; $S S E=$ $\\sum\\left(y_{i}-\\hat{y}_{i}\\right)^{2}$, 为残差平方和。\n\n由于这三个平方和的计算非常麻烦, 所以可直接利用 Excel 的输出结果。由表 12-2 给出的方差分析部分可知, $S S T=312.650400 ; S S R=249.371206 ; S S E=63.279$ 194。\n\n有了这些平方和, 可以将多重判定系数定义如下:\n\n\n\\begin{equation*}\nR^{2}=\\frac{S S R}{S S T}=1-\\frac{S S E}{S S T} \\tag{12.7}\n\\end{equation*}\n\n\n多重判定系数 (multiple coefficient of determination) 是多元回归中的回归平方和占总平方和的比例, 它是度量多元回归方程拟合程度的一个统计量, 反映了因变量 $y$ 的变差中能被估计的回归方程所解释的比例。\n\n对于多重判定系数还有一点需要注意: 自变量个数的增加将影响因变量的变差中被估计的回归方程所解释的比例。当增加自变量时, 会使预测误差变得较小, 从而减少残差平方和 $S S E$ 。由于回归平方和 $S S R=S S T-S S E$, 当 $S S E$ 变小时, $S S R$ 就会变大, 从而使 $R^{2}$ 变大。如果模型中增加一个自变量, 即使这个自变量在统计上并不显著, $R^{2}$ 也会变大。因此, 为避免增加自变量而高估 $R^{2}$, 统计学家提出用样本量 $n$ 和自变量的个数 $k$ 去调整 $R^{2}$, 计算出调整的多重判定系数 (adjusted multiple coefficient of determination), 记为 $R_{a}^{2}$, 其计算公式为:\n\n\n\\begin{equation*}\nR_{a}^{2}=1-\\left(1-R^{2}\\right)\\left(\\frac{n-1}{n-k-1}\\right) \\tag{12.8}\n\\end{equation*}\n\n\n$R_{a}^{2}$ 的解释与 $R^{2}$ 类似, 不同的是: $R_{a}^{2}$ 同时考虑了样本量 $n$ 和模型中自变量的个数 $k$ 的影响, 这就使得 $R_{a}^{2}$ 的值永远小于 $R^{2}$, 而且 $R_{a}^{2}$ 的值不会因为模型中自变量个数的增加而越来越接近 1 。因此, 在多元回归分析中, 通常用调整的多重判定系数。\n\n$R^{2}$ 的平方根称为多重相关系数, 也称为复相关系数, 它度量了因变量同 $k$ 个自变量的相关程度。\n\n根据表 $12-2$ 的输出结果得知: 多重判定系数 $R^{2}=0.797604=79.7604 \\%$ 。其实际意义是: 在不良贷款取值的变差中, 能被不良贷款与贷款余额、累计应收贷款、贷款项目个数和固定资产投资额的多元回归方程所解释的比例为 $79.7604 \\%$ 。\\\\\n调整的多重判定系数 $R_{a}^{2}=0.757125=75.7125 \\%$, 其意义与 $R^{2}$ 类似。它表示: 在用样本量和模型中自变量的个数进行调整后, 在不良贷款取值的变差中, 能被不良贷款与贷款余额、累计应收贷款、贷款项目个数和固定资产投资额的多元回归方程所解释的比例为 $75.7125 \\%$ 。"
    },
    {
        "id": "chatcmpl-93yHUkCSHkSQB20GV40cgcm3UEzNQ",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"在线性回归方程中，如何求解参数 $\\beta_{0}, \\beta_{1}, \\beta_{2}, \\text{...}, \\beta_{k}$？\",\n    \"回答1\": \"在线性回归方程中，参数 $\\beta_{0}, \\beta_{1}, \\beta_{2}, \\text{...}, \\beta_{k}$ 是根据最小二乘法求得的，即通过最小化残差平方和 $Q=\\text{sum}\\big(y_{i}-\\text{hat}y_{i}\\big)^{2}$ 来求解。这可以得到求解 $\\beta_{0}, \\beta_{1}, \\beta_{2}, \\text{...}, \\beta_{k}$ 的标准方程组。\",\n    \"问题2\": \"如何利用 Excel 求解多元回归分析结果？\",\n    \"回答2\": \"求解多元回归分析结果需要借助计算机，可以直接由 Excel 给出回归结果。通过 Excel 输出的多元回归分析结果，可以得到各自变量的系数、标准误差、t 统计量、P 值以及置信区间等信息。\",\n    \"问题3\": \"多重判定系数 $R^{2}$ 的定义是什么？它反映了什么信息？\",\n    \"回答3\": \"多重判定系数 $R^{2}$ 是多元回归中的回归平方和占总平方和的比例，它是度量多元回归方程拟合程度的一个统计量，反映了因变量 $y$ 的变差中能被估计的回归方程所解释的比例。$R^{2}$ 的值越接近 1，表示模型对数据的拟合程度越好。\",\n    \"问题4\": \"为什么需要使用调整的多重判定系数 $R_{a}^{2}$？\",\n    \"回答4\": \"在多元回归分析中，增加自变量会使得预测误差变得较小，从而减少残差平方和 $S S E$。因此，为避免增加自变量而高估 $R^{2}$，统计学家提出用样本量 $n$ 和自变量的个数 $k$ 去调整 $R^{2$，计算出调整的多重判定系数 $R_{a}^{2}$。$R_{a}^{2}$ 同时考虑了样本量和模型中自变量个数的影响，使得其值永远小于 $R^{2}$，并且不会因为模型中自变量个数的增加而越来越接近 1。\",\n    \"问题5\": \"多重相关系数是如何定义的？它有什么实际意义？\",\n    \"回答5\": \"多重相关系数是多重判定系数 $R^{2}$ 的平方根，也称为复相关系数。它度量了因变量同 $k$ 个自变量的相关程度。实际上，它表示了因变量与自变量之间的线性关系强度，值越接近 1 表示模型对数据的拟合程度越好。\",\n    \"问题6\": \"在表格输出结果中，如何计算总平方和、回归平方和和残差平方和？\",\n    \"回答6\": \"在表格输出结果中，可以直接利用 Excel 的输出结果来计算总平方和、回归平方和和残差平方和。总平方和 $S S T$ 为总体数据的离差平方和；回归平方和 $S S R$ 为模型对数据拟合后产生的离差平方和；残差平方和 $S S E$ 为模型未能解释的离差平方和。\",\n    \"问题7\": \"多重判定系数 $R^{2}$ 和调整的多重判定系数 $R_{a}^{2}$ 分别反映了什么信息？\",\n    \"回答7\": \"$R^{2}$ 反映了因变量取值的变差中能被多元回归方程所解释的比例；而调整的多重判定系数 $R_{a}^{2}$ 同时考虑了样本量和模型中自变量个数的影响，在不良贷款取值的变差中能被多元回归方程所解释的比例。\",\n    \"问题8\": \"在线性回归分析中，如何解释各回归系数的实际意义？\",\n    \"回答8\": \"在线性回归分析中，各回归系数表示了在其他自变量不变的情况下，因变量每增加一个单位时自变量相应增加或减少的单位数量。例如，$\\beta_{1}=0.040039$ 表示在累计应收贷款、贷款项目个数和固定资产投资额不变的条件下，贷款余额每增加 1 亿元，不良贷款平均增加 0.040039 亿元。\",\n    \"问题9\": \"如何评价多元线性回归方程的拟合优度？\",\n    \"回答9\": \"评价多元线性回归方程的拟合优度主要通过多重判定系数 $R^{2}$ 和调整的多重判定系数 $R_{a}^{2}$ 来进行。$R^{2}$ 反映了因变量取值的变差中能被多元回归方程所解释的比例；而调整的多重判定系数 $R_{a}^{2}$ 同时考虑了样本量和模型中自变量个数的影响，在不良贷款取值的变差中能被多元回归方程所解释的比例。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710733732,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1571,
            "prompt_tokens": 6518,
            "total_tokens": 8089
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]