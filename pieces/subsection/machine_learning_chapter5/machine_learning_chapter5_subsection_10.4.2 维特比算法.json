[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter5",
        "title": "10.4.2 维特比算法",
        "content_length": 3684,
        "content": "Title: 10.4.2 维特比算法\nContent:\n维特比算法实际是用动态规划 (dynamic programming) 解隐马尔可夫模型预测问题, 即用动态规划求概率最大路径 (最优路径)。这时一条路径对应着一个状态序列。\n\n根据动态规划原理, 最优路径具有这样的特性: 如果最优路径在时刻 $t$ 通过结点 $i_{t}^{*}$, 那么这一路径从结点 $i_{t}^{*}$ 到终点 $i_{T}^{*}$ 的部分路径对于从 $i_{t}^{*}$ 到 $i_{T}^{*}$ 的所有可能的部分路径来说, 必须是最优的。因为假如不是这样, 那么从 $i_{t}^{*}$ 到 $i_{T}^{*}$ 就有另一条更好的部分路径存在, 如果把它和从 $i_{1}^{*}$ 到 $i_{t}^{*}$ 的部分路径连接起来, 就会形成一条比原来的路径更优的路径, 这是矛盾的。依据这一原理, 我们只需从时刻 $t=1$ 开始, 递推地计算在时刻 $t$ 状态为 $i$ 的各条部分路径的最大概率, 直至得到时刻 $t=T$ 时状态为 $i$ 的各条路径的最大概率。时刻 $t=T$ 的最大概率即为最优路径的概率 $P^{*}$, 最优路径的终结点 $i_{T}^{*}$ 也同时得到。之后, 为了找出最优路径的各个结点, 从终结点 $i_{T}^{*}$ 开始, 由后向前逐步求得结点 $i_{T-1}^{*}, i_{T-2}^{*}, \\cdots, i_{1}^{*}$, 得到最优路径 $I^{*}=\\left(i_{1}^{*}, i_{2}^{*}, \\cdots, i_{T}^{*}\\right)$ 。这就是维特比算法。\n\n首先导入两个变量 $\\delta$ 和 $\\Psi$ 。定义在时刻 $t$ 状态为 $i$ 的所有单个路径 $\\left(i_{1}, i_{2}, \\cdots, i_{t}\\right)$ 中概率最大值为\n\n\n\\begin{equation*}\n\\delta_{t}(i)=\\max _{i_{1}, i_{2}, \\cdots, i_{t-1}} P\\left(i_{t}=i, i_{t-1}, \\cdots, i_{1}, o_{t}, \\cdots, o_{1} \\mid \\lambda\\right), \\quad i=1,2, \\cdots, N \\tag{10.44}\n\\end{equation*}\n\n\n由定义可得变量 $\\delta$ 的递推公式:\n\n\n\\begin{align*}\n\\delta_{t+1}(i) & =\\max _{i_{1}, i_{2}, \\cdots, i_{t}} P\\left(i_{t+1}=i, i_{t}, \\cdots, i_{1}, o_{t+1}, \\cdots, o_{1} \\mid \\lambda\\right) \\\\\n& =\\max _{1 \\leqslant j \\leqslant N}\\left[\\delta_{t}(j) a_{j i}\\right] b_{i}\\left(o_{t+1}\\right), \\quad i=1,2, \\cdots, N, \\quad t=1,2, \\cdots, T-1 \\tag{10.45}\n\\end{align*}\n\n\n定义在时刻 $t$ 状态为 $i$ 的所有单个路径 $\\left(i_{1}, i_{2}, \\cdots, i_{t-1}, i\\right)$ 中概率最大的路径的第 $t-1$个结点为\n\n\n\\begin{equation*}\n\\Psi_{t}(i)=\\arg \\max _{1 \\leqslant j \\leqslant N}\\left[\\delta_{t-1}(j) a_{j i}\\right], \\quad i=1,2, \\cdots, N \\tag{10.46}\n\\end{equation*}\n\n\n下面介绍维特比算法。\n\n\\section*{算法 10.5 (维特比算法)}\n输入: 模型 $\\lambda=(A, B, \\pi)$ 和观测 $O=\\left(o_{1}, o_{2}, \\cdots, o_{T}\\right)$ 。\n\n输出: 最优路径 $I^{*}=\\left(i_{1}^{*}, i_{2}^{*}, \\cdots, i_{T}^{*}\\right)$ 。\n\n(1) 初始化。\n\n$$\n\\begin{gathered}\n\\delta_{1}(i)=\\pi_{i} b_{i}\\left(o_{1}\\right), \\quad i=1,2, \\cdots, N \\\\\n\\Psi_{1}(i)=0, \\quad i=1,2, \\cdots, N\n\\end{gathered}\n$$\n\n(2) 递推。对 $t=2,3, \\cdots, T$,\n\n$$\n\\begin{gathered}\n\\delta_{t}(i)=\\max _{1 \\leqslant j \\leqslant N}\\left[\\delta_{t-1}(j) a_{j i}\\right] b_{i}\\left(o_{t}\\right), \\quad i=1,2, \\cdots, N \\\\\n\\Psi_{t}(i)=\\arg \\max _{1 \\leqslant j \\leqslant N}\\left[\\delta_{t-1}(j) a_{j i}\\right], \\quad i=1,2, \\cdots, N\n\\end{gathered}\n$$\n\n(3) 终止。\n\n$$\n\\begin{gathered}\nP^{*}=\\max _{1 \\leqslant i \\leqslant N} \\delta_{T}(i) \\\\\ni_{T}^{*}=\\arg \\max _{1 \\leqslant i \\leqslant N}\\left[\\delta_{T}(i)\\right]\n\\end{gathered}\n$$\n\n（4）最优路径回溯。对 $t=T-1, T-2, \\cdots, 1$,\n\n$$\ni_{t}^{*}=\\Psi_{t+1}\\left(i_{t+1}^{*}\\right)\n$$\n\n求得最优路径 $I^{*}=\\left(i_{1}^{*}, i_{2}^{*}, \\cdots, i_{T}^{*}\\right)$ 。\n\n下面通过一个例子来说明维特比算法。\n\n例 10.3 对例 10.2 的模型 $\\lambda=(A, B, \\pi)$,\n\n$$\nA=\\left[\\begin{array}{lll}\n0.5 & 0.2 & 0.3 \\\\\n0.3 & 0.5 & 0.2 \\\\\n0.2 & 0.3 & 0.5\n\\end{array}\\right], \\quad B=\\left[\\begin{array}{ll}\n0.5 & 0.5 \\\\\n0.4 & 0.6 \\\\\n0.7 & 0.3\n\\end{array}\\right], \\quad \\pi=\\left[\\begin{array}{l}\n0.2 \\\\\n0.4 \\\\\n0.4\n\\end{array}\\right]\n$$\n\n已知观测序列 $O=$ (红, 白, 红), 试求最优状态序列, 即最优路径 $I^{*}=\\left(i_{1}^{*}, i_{2}^{*}, i_{3}^{*}\\right)$ 。\n\n解 如图 10.4 所示, 要在所有可能的路径中选择一条最优路径, 按照以下步骤处理:\n\n(1) 初始化。在 $t=1$ 时, 对每一个状态 $i, i=1,2,3$, 求状态为 $i$ 、观测 $o_{1}$ 为红的概率,记此概率为 $\\delta_{1}(i)$, 则\n\n$$\n\\delta_{1}(i)=\\pi_{i} b_{i}\\left(o_{1}\\right)=\\pi_{i} b_{i}(\\text { 红 }), \\quad i=1,2,3\n$$\n\n代入实际数据\n\n$$\n\\delta_{1}(1)=0.10, \\quad \\delta_{1}(2)=0.16, \\quad \\delta_{1}(3)=0.28\n$$\n\n记 $\\Psi_{1}(i)=0, i=1,2,3$ 。\n\n(2) 在 $t=2$ 时, 对每个状态 $i, i=1,2,3$, 求在 $t=1$ 时状态为 $j$, 观测为红并在 $t=2$时状态为 $i$ 、观测 $o_{2}$ 为白的路径的最大概率, 记此最大概率为 $\\delta_{2}(i)$, 则\n\n$$\n\\delta_{2}(i)=\\max _{1 \\leqslant j \\leqslant 3}\\left[\\delta_{1}(j) a_{j i}\\right] b_{i}\\left(o_{2}\\right)\n$$\n\n\n\\end{document}"
    },
    {
        "id": "chatcmpl-948kgFP3f6xJdyQKWlAZlU4y8qY0J",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"维特比算法是用来解决什么问题的？\",\n    \"回答1\": \"维特比算法实际是用动态规划解隐马尔可夫模型预测问题，即用动态规划求概率最大路径（最优路径）。这时一条路径对应着一个状态序列。\",\n    \"问题2\": \"最优路径的特性是什么？\",\n    \"回答2\": \"根据动态规划原理，最优路径具有这样的特性: 如果最优路径在时刻 $t$ 通过结点 $i_{t}^{*}$，那么这一路径从结点 $i_{t}^{*}$ 到终点 $i_{T}^{*}$ 的部分路径对于从 $i_{t}^{*}$ 到 $i_{T}^{*}$ 的所有可能的部分路径来说，必须是最优的。\",\n    \"问题3\": \"维特比算法中的变量 $\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldelta}}}}}}}}}}}}}}}}}}}}}}}}}}}}$ 的递推公式是怎样的？\",\n    \"回答3\": \"变量 $\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldelta}}}}$ 的递推公式为 $\\boldelta_{t+1}(i) = \\text{max}_{1 \\text{ 为 } j \\text{ 为 } N}\\big[\\boldelta_{t}(j) a_{j i}\\big] b_{i}\\big(o_{t+1}\\big), \\text{ 且 } i=1,2, \\text{...}, N, \\text{ 且 } t=1,2, \\text{...}, T-1$。\",\n    \"问题4\": \"维特比算法中的变量 $\\boldsymbol{\\boldsymbol{\\boldsymbol{\\boldPsi}}}$ 的定义是怎样的？\",\n    \"回答4\": \"变量 $\\boldPsi_{t}(i)=\\text{arg max}_{1 \\text{ 为 } j \\text{ 为 } N}\\big[\\boldelta_{t-1}(j) a_{j i}\\big], \\text{ 且 } i=1,2, \\text{...}, N$。\",\n    \"问题5\": \"维特比算法的具体步骤是什么？\",\n    \"回答5\": \"维特比算法的具体步骤包括初始化、递推、终止和最优路径回溯。在初始化阶段，需要计算初始时刻状态为 $i$ 的各条部分路径的最大概率。然后通过递推计算各个时刻状态为 $i$ 的各条部分路径的最大概率。在终止阶段，找出最优路径的概率和终结点。最后进行最优路径回溯，求得最优路径。\",\n    \"问题6\": \"维特比算法中的 $\\boldPsi$ 和 $\\boldelta$ 变量有什么作用？\",\n    \"回答6\": \"变量 $\\boldPsi$ 用于记录在时刻 $t$ 状态为 $i$ 的所有单个路径中概率最大的路径的第 $t-1$个结点；而变量 $\\boldelta$ 则用于记录在时刻 $t$ 状态为 $i$ 的所有单个路径中概率最大值。\",\n    \"问题7\": \"维特比算法如何找出最优路径？\",\n    \"回答7\": \"维特比算法通过动态规划的方式，从时刻 $t=1$ 开始递推地计算在时刻 $t=T$ 时状态为 $i$ 的各条路径的最大概率，然后通过回溯找出最优路径。\",\n    \"问题8\": \"维特比算法中的动态规划原理是如何应用的？\",\n    \"回答8\": \"维特比算法利用动态规划原理来递推地计算各个时刻状态为 $i$ 的各条部分路径的最大概率，以及记录在时刻 $t$ 状态为 $i$ 的所有单个路径中概率最大的路径的第 $t-1$个结点。\",\n    \"问题9\": \"维特比算法和动态规划有何关联？\",\n    \"回答9\": \"维特比算法实际上就是利用动态规划原理来解决隐马尔可夫模型预测问题，即求概率最大路径（最优路径）。它通过递推地计算各个时刻状态为 $i$ 的各条部分路径的最大概率，并利用动态规划思想来寻找最优路径。\",\n    \"问题10\": \"维特比算法在实际应用中有哪些场景？\",\n    \"回答10\": \"维特比算法在实际应用中常用于语音识别、自然语言处理、生物信息学等领域。它能够有效地求解隐马尔可夫模型预测问题，寻找概率最大路径，因此在需要对序列数据进行分析和预测的场景中具有重要作用。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710773982,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1414,
            "prompt_tokens": 4839,
            "total_tokens": 6253
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]