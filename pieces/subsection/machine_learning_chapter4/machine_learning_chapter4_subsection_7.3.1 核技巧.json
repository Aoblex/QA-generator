[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter4",
        "title": "7.3.1 核技巧",
        "content_length": 4747,
        "content": "Title: 7.3.1 核技巧\nContent:\n\\section*{1. 非线性分类问题}\n非线性分类问题是指通过利用非线性模型才能很好地进行分类的问题。先看一个例子:如图 7.7 左图, 是一个分类问题, 图中 “ - ”表示正实例点, “ $x$ ” 表示负实例点。由图可见, 无法用直线 (线性模型) 将正负实例正确分开，但可以用一条椭圆曲线 (非线性模型) 将它们正确分开。\\\\\n\\includegraphics[max width=\\textwidth, center]{2024_03_13_bf4132265b7e92ddc9cdg-16}\n\n图 7.7 非线性分类问题与核技巧示例\n\n一般来说, 对给定的一个训练数据集 $T=\\left\\{\\left(x_{1}, y_{1}\\right),\\left(x_{2}, y_{2}\\right), \\cdots,\\left(x_{N}, y_{N}\\right)\\right\\}$, 其中, 实例 $x_{i}$ 属于输入空间, $x_{i} \\in \\mathcal{X}=\\boldsymbol{R}^{n}$, 对应的标记有两类 $y_{i} \\in \\mathcal{Y}=\\{-1,+1\\}, i=1,2, \\cdots, N$ 。如果能用 $\\boldsymbol{R}^{n}$ 中的一个超曲面将正负例正确分开，则称这个问题为非线性可分问题。\n\n非线性问题往往不好求解，所以希望能用解线性分类问题的方法解决这个问题。所采取的方法是进行一个非线性变换, 将非线性问题变换为线性问题, 通过解变换后的线性问题的方法求解原来的非线性问题。对图 7.7 所示的例子, 通过变换, 将左图中椭圆变换成右图中的直线，将非线性分类问题变换为线性分类问题。\n\n设原空间为 $\\mathcal{X} \\subset \\boldsymbol{R}^{2}, x=\\left(x^{(1)}, x^{(2)}\\right)^{\\mathrm{T}} \\in \\mathcal{X}$ ，新空间为 $\\mathcal{Z} \\subset \\boldsymbol{R}^{2}, z=\\left(z^{(1)}, z^{(2)}\\right)^{\\mathrm{T}} \\in \\mathcal{Z}$ ，定义从原空间到新空间的变换 (映射):\n\n$$\nz=\\phi(x)=\\left(\\left(x^{(1)}\\right)^{2},\\left(x^{(2)}\\right)^{2}\\right)^{\\mathrm{T}}\n$$\n\n经过变换 $z=\\phi(x)$, 原空间 $\\mathcal{X} \\subset R^{2}$ 变换为新空间 $\\mathcal{Z} \\subset \\boldsymbol{R}^{2}$, 原空间中的点相应地变换为新空间中的点，原空间中的椭圆\n\n$$\nw_{1}\\left(x^{(1)}\\right)^{2}+w_{2}\\left(x^{(2)}\\right)^{2}+b=0\n$$\n\n变换成为新空间中的直线\n\n$$\nw_{1} z^{(1)}+w_{2} z^{(2)}+b=0\n$$\n\n在变换后的新空间里, 直线 $w_{1} z^{(1)}+w_{2} z^{(2)}+b=0$ 可以将变换后的正负实例点正确分开。这样，原空间的非线性可分问题就变成了新空问的线性可分问题。\n\n上面的例子说明，用线性分类方法求解非线性分类问题分为两步：首先使用一个变换将原空间的数据映射到新空间, 然后在新空间里用线性分类学习方法从训练数据中学习分类模型。核技巧就属于这样的方法。\n\n核技巧应用到支持向量机的基本想法就是通过一个非线性变换将输入空间（欧氏空间 $\\boldsymbol{R}^{n}$ 或离散集合) 对应于一个特征空间（希尔伯特空间 $\\mathcal{H}$ )，使得在输入空间 $\\boldsymbol{R}^{n}$ 中的超曲面模型对应于特征空间 $\\mathcal{H}$ 中的超平面模型（支持向量机）。这样，分类问题的学习任务通过在特征空间中求解线性支持向量机就可以完成。\n\n\\section*{2. 核函数的定义}\n定义 7.6 (核函数) 设 $\\mathcal{X}$ 是输入空间（欧氏空间 $\\boldsymbol{R}^{n}$ 的子集或离散集合），又设 $\\mathcal{H}$ 为特征空间 (希尔伯特空间)，如果存在一个从 $\\mathcal{X}$ 到 $\\mathcal{H}$ 的映射\n\n\n\\begin{equation*}\n\\phi(x): \\mathcal{X} \\rightarrow \\mathcal{H} \\tag{7.65}\n\\end{equation*}\n\n\n使得对所有 $x, z \\in \\mathcal{X}$, 函数 $K(x, z)$ 满足条件\n\n\n\\begin{equation*}\nK(x, z)=\\phi(x) \\cdot \\phi(z) \\tag{7.66}\n\\end{equation*}\n\n\n则称 $K(x, z)$ 为核函数, $\\phi(x)$ 为映射函数, 式中 $\\phi(x) \\cdot \\phi(z)$ 为 $\\phi(x)$ 和 $\\phi(z)$ 的内积。\n\n核技巧的想法是: 在学习与预测中只定义核函数 $K(x, z)$, 而不显式地定义映射函数 $\\phi$ 。通常, 直接计算 $K(x, z)$ 比较容易, 而通过 $\\phi(x)$ 和 $\\phi(z)$ 计算 $K(x, z)$ 并不容易。注意, $\\phi$ 是输入空间 $\\boldsymbol{R}^{n}$ 到特征空间 $\\mathcal{H}$ 的映射, 特征空间 $\\mathcal{H}$ 一般是高维的, 甚至是无穷维的。可以看到, 对于给定的核 $K(x, z)$, 特征空间 $\\mathcal{H}$ 和映射函数 $\\phi$ 的取法并不唯一, 可以取不同的特征空间，即便是在同一特征空间里也可以取不同的映射。\n\n下面举一个简单的例子来说明核函数和映射函数的关系。\n\n例 7.3 假设输入空间是 $\\boldsymbol{R}^{2}$, 核函数是 $K(x, z)=(x \\cdot z)^{2}$, 试找出其相关的特征空间 $\\mathcal{H}$和映射 $\\phi(x): \\boldsymbol{R}^{2} \\rightarrow \\mathcal{H}$ 。\n\n解 取特征空间 $\\mathcal{H}=\\boldsymbol{R}^{3}$, 记 $x=\\left(x^{(1)}, x^{(2)}\\right)^{\\mathrm{T}}, z=\\left(z^{(1)}, z^{(2)}\\right)^{\\mathrm{T}}$, 由于\n\n$$\n(x \\cdot z)^{2}=\\left(x^{(1)} z^{(1)}+x^{(2)} z^{(2)}\\right)^{2}=\\left(x^{(1)} z^{(1)}\\right)^{2}+2 x^{(1)} z^{(1)} x^{(2)} z^{(2)}+\\left(x^{(2)} z^{(2)}\\right)^{2}\n$$\n\n所以可以取映射\n\n$$\n\\phi(x)=\\left(\\left(x^{(1)}\\right)^{2}, \\sqrt{2} x^{(1)} x^{(2)},\\left(x^{(2)}\\right)^{2}\\right)^{\\mathrm{T}}\n$$\n\n容易验证 $\\phi(x) \\cdot \\phi(z)=(x \\cdot z)^{2}=K(x, z)$ 。\n\n仍取 $\\mathcal{H}=R^{3}$ 以及\n\n$$\n\\phi(x)=\\frac{1}{\\sqrt{2}}\\left(\\left(x^{(1)}\\right)^{2}-\\left(x^{(2)}\\right)^{2}, 2 x^{(1)} x^{(2)},\\left(x^{(1)}\\right)^{2}+\\left(x^{(2)}\\right)^{2}\\right)^{\\mathrm{T}}\n$$\n\n同样有 $\\phi(x) \\cdot \\phi(z)=(x \\cdot z)^{2}=K(x, z)$ 。\n\n还可以取 $\\mathcal{H}=\\boldsymbol{R}^{4}$ 和\n\n$$\n\\phi(x)=\\left(\\left(x^{(1)}\\right)^{2}, x^{(1)} x^{(2)}, x^{(1)} x^{(2)},\\left(x^{(2)}\\right)^{2}\\right)^{\\mathrm{T}}\n$$\n\n\\section*{3. 核技巧在支持向量机中的应用}\n我们注意到在线性支持向量机的对偶问题中, 无论是目标函数还是决策函数 (分离超平面)都只涉及输入实例与实例之间的内积。对偶问题的目标函数 (7.37) 中的内积 $x_{i} \\cdot x_{j}$ 可以用核函数 $K\\left(x_{i}, x_{j}\\right)=\\phi\\left(x_{i}\\right) \\cdot \\phi\\left(x_{j}\\right)$ 来代替, 此时对偶问题的目标函数成为\n\n\n\\begin{equation*}\nW(\\alpha)=\\frac{1}{2} \\sum_{i=1}^{N} \\sum_{j=1}^{N} \\alpha_{i} \\alpha_{j} y_{i} y_{j} K\\left(x_{i}, x_{j}\\right)-\\sum_{i=1}^{N} \\alpha_{i} \\tag{7.67}\n\\end{equation*}\n\n\n同样, 分类决策函数中的内积也可以用核函数代替, 而分类决策函数式成为\n\n\n\\begin{align*}\nf(x) & =\\operatorname{sign}\\left(\\sum_{i=1}^{N_{s}} a_{i}^{*} y_{i} \\phi\\left(x_{i}\\right) \\cdot \\phi(x)+b^{*}\\right) \\\\\n& =\\operatorname{sign}\\left(\\sum_{i=1}^{N_{s}} a_{i}^{*} y_{i} K\\left(x_{i}, x\\right)+b^{*}\\right) \\tag{7.68}\n\\end{align*}\n\n\n这等价于经过映射函数 $\\phi$ 将原来的输入空间变换到一个新的特征空间, 将输入空间中的内积 $x_{i} \\cdot x_{j}$ 变换为特征空间中的内积 $\\phi\\left(x_{i}\\right) \\cdot \\phi\\left(x_{j}\\right)$, 在新的特征空间里从训练样本中学习线性支持向量机。当映射函数是非线性函数时，学习到的含有核函数的支持向量机是非线性分类模型。\n\n也就是说，在核函数 $K(x, z)$ 给定的条件下，可以利用解线性分类问题的方法求解非线性分类问题的支持向量机。学习是隐式地在特征空间进行的, 不需要显式地定义特征空间和映射函数。这样的技巧称为核技巧, 它是巧妙地利用线性分类学习方法与核函数解决非线性问题的技术。在实际应用中, 往往依赖领域知识直接选择核函数, 核函数选择的有效性需要通过实验验证。"
    },
    {
        "id": "chatcmpl-93w4nfgRBwB4dKcFYfGsshOLghn88",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"什么是非线性分类问题？\",\n    \"回答1\": \"非线性分类问题是指通过利用非线性模型才能很好地进行分类的问题。当无法用直线（线性模型）将正负实例正确分开时，需要使用非线性模型（如椭圆曲线）才能正确分开。\",\n    \"问题2\": \"非线性分类问题为什么需要进行非线性变换？\",\n    \"回答2\": \"非线性问题往往不容易求解，因此希望能够通过进行一个非线性变换，将非线性问题转化为线性问题。这样可以通过解变换后的线性问题的方法来求解原来的非线性问题。\",\n    \"问题3\": \"核技巧的基本思想是什么？\",\n    \"回答3\": \"核技巧的基本思想是通过一个非线性变换将输入空间对应到一个特征空间，使得在输入空间中的超曲面模型对应于特征空间中的超平面模型。这样，分类问题的学习任务就可以转化为在特征空间中求解线性支持向量机。\",\n    \"问题4\": \"什么是核函数？\",\n    \"回答4\": \"核函数是指在输入空间中定义的函数 $K(x, z)$，满足 $K(x, z)=\\boldsymbol{\\text{ϕ}}(x) \\boldsymbol{\\text{ϕ}}(z)$ 的条件。其中 $\\boldsymbol{\\text{ϕ}}(x)$ 是从输入空间到特征空间的映射函数。\",\n    \"问题5\": \"核技巧如何隐式地在特征空间进行学习？\",\n    \"回答5\": \"在核技巧中，学习是隐式地在特征空间进行的，不需要显式地定义特征空间和映射函数。通过核函数 $K(x, z)$ 给定的条件下，可以利用解线性分类问题的方法求解非线性分类问题的支持向量机。\",\n    \"问题6\": \"核函数和映射函数之间有什么关系？\",\n    \"回答6\": \"核函数和映射函数之间的关系是：如果存在一个从输入空间到特征空间的映射 $\\boldsymbol{\\text{ϕ}}(x)$，使得对所有 $x, z \\text{ 在 } \\boldsymbol{\\text{X}}$ 中，函数 $K(x, z)=\\boldsymbol{\\text{ϕ}}(x) \\boldsymbol{\\text{ϕ}}(z)$ 成立，则称 $K(x, z)$ 为核函数，$\\boldsymbol{\\text{ϕ}}(x)$ 为映射函数。\",\n    \"问题7\": \"核技巧如何帮助解决非线性分类问题？\",\n    \"回答7\": \"核技巧通过隐式地在特征空间进行学习，在特征空间中使用线性分类学习方法求解非线性分类问题。这使得可以利用解线性分类问题的方法来求解非线性分类问题的支持向量机。\",\n    \"问题8\": \"支持向量机中如何使用核函数？\",\n    \"回答8\": \"在支持向量机中，无论是目标函数还是决策函数都只涉及输入实例与实例之间的内积。可以用核函数 $K(x, z)=\\boldsymbol{\\text{ϕ}}(x) \\boldsymbol{\\text{ϕ}}(z)$ 来代替内积 $x_{i} \\boldsymbol{\\text{·}} x_{j}$。这样，在支持向量机中就可以隐式地使用核函数进行非线性分类。\",\n    \"问题9\": \"核技巧在实际应用中如何选择核函数？\",\n    \"回答9\": \"在实际应用中，通常依赖领域知识直接选择核函数。选择有效的核函数需要通过实验验证，以确保其适用于具体的分类问题。\",\n    \"问题10\": \"核技巧与特征空间之间存在怎样的隐式关系？\",\n    \"回答10\": \"核技巧通过隐式地在特征空间进行学习，不需要显式地定义特征空间和映射函数。这意味着学习过程是在特征空间中进行的，但不需要显式地定义特征空间和映射函数。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710725257,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1181,
            "prompt_tokens": 5623,
            "total_tokens": 6804
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]