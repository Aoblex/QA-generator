[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter8",
        "title": "19.1.1 随机抽样",
        "content_length": 1572,
        "content": "Title: 19.1.1 随机抽样\nContent:\n统计学和机器学习的目的是基于数据对概率分布的特征进行推断, 蒙特卡罗法要解决的问题是: 假设概率分布的定义已知, 通过抽样获得概率分布的随机样本, 并通过得到的随机样本对概率分布的特征进行分析。比如, 从样本得到经验分布, 从而估计总体分布; 或者从样本计算出样本均值, 从而估计总体期望。所以蒙特卡罗法的核心是随机抽样 (random sampling）。\n\n一般的蒙特卡罗法有直接抽样法、接受-拒绝抽样法、重要性抽样法等。接受-拒绝抽样\\\\\n法、重要性抽样法适合于概率密度函数复杂 (如密度函数含有多个变量, 各变量相互不独立,密度函数形式复杂) 、不能直接抽样的情况。\n\n这里介绍接受-拒绝抽样法 (accept-reject sampling method)。假设有随机变量 $x$, 取值 $x \\in \\mathcal{X}$, 其概率密度函数为 $p(x)$ 。目标是得到该概率分布的随机样本, 以对这个概率分布进行分析。\n\n接受-拒绝法的基本想法如下。假设 $p(x)$ 不可以直接抽样。找一个可以直接抽样的分布,称为建议分布 (proposal distribution)。假设 $q(x)$ 是建议分布的概率密度函数, 并且有 $q(x)$的 $c$ 倍一定大于等于 $p(x)$, 其中 $c>0$, 如图 19.1 所示。按照 $q(x)$ 进行抽样, 假设得到的结果是 $x^{*}$, 再按照 $\\frac{p\\left(x^{*}\\right)}{c q\\left(x^{*}\\right)}$ 的比例随机决定是否接受 $x^{*}$ 。直观上, 落到 $p\\left(x^{*}\\right)$ 范围内的就接受 (绿色), 落到 $p\\left(x^{*}\\right)$ 范围外的就拒绝 (红色)。接受-拒绝法实际是按照 $p(x)$ 的涵盖面积（或涵盖体积）占 $c q(x)$ 的涵盖面积（或涵盖体积）的比例进行抽样。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_60436489efc55078c367g-40}\n\\end{center}\n\n图 19.1 接受-拒绝抽样法 (见文前彩图)\n\n接受-拒绝法的具体算法如下。\n\n\\section*{算法 19.1 (接受-拒绝法)}\n输入: 抽样的目标概率分布的概率密度函数 $p(x)$ 。\n\n输出: 概率分布的随机样本 $x_{1}, x_{2}, \\cdots, x_{n}$ 。\n\n参数: 样本数 $n$ 。\n\n(1) 选择概率密度函数为 $q(x)$ 的概率分布, 作为建议分布, 使其对任一 $x$ 满足 $c q(x) \\geqslant p(x)$, 其中 $c>0$ 。\n\n(2) 按照建议分布 $q(x)$ 随机抽样得到样本 $x^{*}$, 再按照均匀分布在 $(0,1)$ 范围内抽样得到 $u$ 。\n\n(3) 如果 $u \\leqslant \\frac{p\\left(x^{*}\\right)}{c q\\left(x^{*}\\right)}$, 则将 $x^{*}$ 作为抽样结果; 否则, 回到步骤 $(2)$ 。\n\n(4) 直至得到 $n$ 个随机样本, 结束。\n\n接受-拒绝法的优点是容易实现, 缺点是效率可能不高。如果 $p(x)$ 的涵盖体积占 $c q(x)$ 的涵盖体积的比例很低, 就会导致拒绝的比例很高, 抽样效率很低。注意, 一般是在高维空间进行抽样, 即使 $p(x)$ 与 $c q(x)$ 很接近, 两者涵盖体积的差异也可能很大 (与我们在三维空间的直观不同)。"
    },
    {
        "id": "chatcmpl-947SVVc5biMkjfNtB9muWp1LNfCBe",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"蒙特卡罗法的核心是什么？\",\n    \"回答1\": \"蒙特卡罗法的核心是随机抽样（random sampling）。其目的是通过抽样获得概率分布的随机样本，并通过得到的随机样本对概率分布的特征进行分析，如估计总体分布或总体期望。\",\n    \"问题2\": \"蒙特卡罗法中有哪些常见的抽样方法？\",\n    \"回答2\": \"一般的蒙特卡罗法包括直接抽样法、接受-拒绝抽样法、重要性抽样法等。其中，接受-拒绝抽样法和重要性抽样法适合于概率密度函数复杂、不能直接抽样的情况。\",\n    \"问题3\": \"接受-拒绝抽样法的基本思想是什么？\",\n    \"回答3\": \"接受-拒绝抽样法的基本思想是找一个可以直接抽样的建议分布，使其对任一 $x$ 满足 $c q(x) \\text{ 且 } c>0$ 大于等于 $p(x)$。然后按照建议分布 $q(x)$ 进行抽样，再按照 $\\frac{p\\big(x^{*}\\big)}{c q\\big(x^{*}\\big)}$ 的比例随机决定是否接受 $x^{*}$。\",\n    \"问题4\": \"接受-拒绝抽样法的具体算法包括哪些步骤？\",\n    \"回答4\": \"接受-拒绝抽样法的具体算法包括：选择建议分布 $q(x)$，按照建议分布 $q(x)$ 随机抽样得到样本 $x^{*}$，再按照均匀分布在 $(0,1)$ 范围内抽样得到 $u$，根据 $u \\text{ 和 } \\frac{p\\big(x^{*}\\big)}{c q\\big(x^{*}\\big)}$ 的比较结果决定是否接受 $x^{*}$，直至得到指定数量的随机样本。\",\n    \"问题5\": \"接受-拒绝抽样法的优点和缺点分别是什么？\",\n    \"回答5\": \"接受-拒绝抽样法的优点是容易实现，但缺点是效率可能不高。当 $p(x)$ 的涵盖体积占 $c q(x)$ 的涵盖体积比例很低时，会导致拒绝的比例很高，从而降低了抽样效率。\",\n    \"问题6\": \"蒙特卡罗法主要用于解决什么问题？\",\n    \"回答6\": \"蒙特卡罗法主要用于解决假设概率分布的定义已知的情况下，通过抽样获得概率分布的随机样本，并通过得到的随机样本对概率分布的特征进行分析。例如，从样本得到经验分布以估计总体分布，或者从样本计算出样本均值以估计总体期望。\",\n    \"问题7\": \"为什么接受-拒绝抽样法适合于概率密度函数复杂、不能直接抽样的情况？\",\n    \"回答7\": \"接受-拒绝抽样法适合于概率密度函数复杂、不能直接抽样的情况，因为它可以利用建议分布对复杂概率密度函数进行近似，并通过比例判断是否接受生成的随机样本，从而实现对复杂概率分布的随机抽样。\",\n    \"问题8\": \"在接受-拒绝抽样法中，如何确定是否接受生成的随机样本？\",\n    \"回答8\": \"在接受-拒绝抽样法中，根据生成的随机数与 $\\frac{p\\big(x^{*}\\big)}{c q\\big(x^{*}\\big)}$ 的比较结果来确定是否接受生成的随机样本。如果生成的随机数小于等于 $\\frac{p\\big(x^{*}\\big)}{c q\\big(x^{*}\\big)}$，则接受该随机样本；否则将重新进行抽样。\",\n    \"问题9\": \"为什么即使 $p(x)$ 与 $c q(x)$ 很接近，在高维空间进行抽样时也可能导致效率低下？\",\n    \"回答9\": \"$p(x)$ 与 $c q(x)$ 很接近并不意味着在高维空间进行抽样时两者涵盖体积的差异很小。即使在高维空间中，两者涵盖体积的差异也可能很大，这与我们在三维空间的直观感觉不同，导致即使两者很接近也可能导致效率低下。\",\n    \"问题10\": \"蒙特卡罗法和蒙特卡罗模拟有何区别？\",\n    \"回答10\": \"蒙特卡罗法是一种基于随机抽样进行推断和估计的方法，而蒙特卡罗模拟则是利用蒙特卡罗方法进行模拟和仿真。蒙特卡罗模拟通常用于模拟复杂系统或过程中的随机变量和不确定性因素，以评估系统行为和性能。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710769011,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1574,
            "prompt_tokens": 3872,
            "total_tokens": 5446
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]