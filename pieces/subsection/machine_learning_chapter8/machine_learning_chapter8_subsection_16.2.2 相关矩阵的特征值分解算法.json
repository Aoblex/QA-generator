[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter8",
        "title": "16.2.2 相关矩阵的特征值分解算法",
        "content_length": 4135,
        "content": "Title: 16.2.2 相关矩阵的特征值分解算法\nContent:\n传统的主成分分析通过数据的协方差矩阵或相关矩阵的特征值分解进行, 现在常用的方法是通过数据矩阵的奇异值分解进行。首先叙述数据的协方差矩阵或相关矩阵的特征值分解方法。\n\n给定样本矩阵 $\\boldsymbol{X}$, 利用数据的样本协方差矩阵或者样本相关矩阵的特征值分解进行主成分分析。具体步骤如下:\n\n(1) 对观测数据按式 (16.48) 进行规范化处理, 得到规范化数据矩阵, 仍以 $\\boldsymbol{X}$ 表示。\n\n(2) 依据规范化数据矩阵, 计算样本相关矩阵 $\\boldsymbol{R}$ :\n\n$$\n\\boldsymbol{R}=\\left[r_{i j}\\right]_{m \\times m}=\\frac{1}{n-1} \\boldsymbol{X} \\boldsymbol{X}^{\\mathrm{T}}\n$$\n\n其中,\n\n$$\nr_{i j}=\\frac{1}{n-1} \\sum_{l=1}^{n} x_{i l} x_{l j}, \\quad i, j=1,2, \\cdots, m\n$$\n\n(3) 求样本相关矩阵 $\\boldsymbol{R}$ 的 $k$ 个特征值和对应的 $k$ 个单位特征向量。\n\n求解 $\\boldsymbol{R}$ 的特征方程\n\n$$\n|\\boldsymbol{R}-\\lambda \\boldsymbol{I}|=0\n$$\n\n得 $\\boldsymbol{R}$ 的 $m$ 个特征值:\n\n$$\n\\lambda_{1} \\geqslant \\lambda_{2} \\geqslant \\cdots \\geqslant \\lambda_{m}\n$$\n\n求方差贡献率 $\\sum_{i=1}^{k} \\eta_{i}$ 达到预定值的主成分个数 $k$ 。\n\n求前 $k$ 个特征值对应的单位特征向量:\n\n$$\n\\boldsymbol{a}_{i}=\\left(a_{1 i}, a_{2 i}, \\cdots, a_{m i}\\right)^{\\mathrm{T}}, \\quad i=1,2, \\cdots, k\n$$\n\n(4) 求 $k$ 个样本主成分\n\n以 $k$ 个单位特征向量为系数进行线性变换, 求出 $k$ 个样本主成分:\n\n\n\\begin{equation*}\ny_{i}=\\boldsymbol{a}_{i}^{\\mathrm{T}} \\boldsymbol{x}, \\quad i=1,2, \\cdots, k \\tag{16.50}\n\\end{equation*}\n\n\n(5) 计算 $k$ 个主成分 $y_{j}$ 与原变量 $x_{i}$ 的相关系数 $\\rho\\left(x_{i}, y_{j}\\right)$, 以及 $k$ 个主成分对原变量 $x_{i}$的贡献率 $\\nu_{i}$ 。\n\n(6) 计算 $n$ 个样本的 $k$ 个主成分值\n\n将规范化样本数据代入 $k$ 个主成分式 (16.50), 得到 $n$ 个样本的主成分值。第 $j$ 个样本 $\\boldsymbol{x}_{j}=\\left(x_{1 j}, x_{2 j}, \\cdots, x_{m j}\\right)^{\\mathrm{T}}$ 的第 $i$ 主成分值是\n\n$$\n\\begin{gathered}\ny_{i j}=\\left(a_{1 i}, a_{2 i}, \\cdots, a_{m i}\\right)\\left(x_{1 j}, x_{2 j}, \\cdots, x_{m j}\\right)^{\\mathrm{T}}=\\sum_{l=1}^{m} a_{l i} x_{l j}, \\\\\ni=1,2, \\cdots, m, \\quad j=1,2, \\cdots, n\n\\end{gathered}\n$$\n\n主成分分析得到的结果可以用于其他机器学习方法的输入。比如, 将样本点投影到以主成分为坐标轴的空间中, 然后应用聚类算法就可以对样本点进行聚类。\n\n下面举例说明主成分分析方法。\n\n例 16.1 假设有 $n$ 个学生参加四门课程的考试, 将学生们的考试成绩看作随机变量的取值, 对考试成绩数据进行标准化处理, 得到样本相关矩阵 $\\boldsymbol{R}$, 列于表 16.1。\n\n表 16.1 样本相关矩阵 $\\boldsymbol{R}$\n\n\\begin{center}\n\\begin{tabular}{ccccc}\n\\hline\n课程 & 语文 & 外语 & 数学 & 物理 \\\\\n\\hline\n语文 & 1.00 & 0.44 & 0.29 & 0.33 \\\\\n外语 & 0.44 & 1.00 & 0.35 & 0.32 \\\\\n数学 & 0.29 & 0.35 & 1.00 & 0.60 \\\\\n物理 & 0.33 & 0.32 & 0.60 & 1.00 \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\n试对数据进行主成分分析。\n\n解 设变量 $x_{1}, x_{2}, x_{3}, x_{4}$ 分别表示语文、外语、数学、物理的成绩。对样本相关矩阵进行特征值分解, 得到相关矩阵的特征值, 并按大小排序:\n\n$$\n\\lambda_{1}=2.17, \\quad \\lambda_{2}=0.87, \\quad \\lambda_{3}=0.57, \\quad \\lambda_{4}=0.39\n$$\n\n这些特征值就是各主成分的方差贡献率。假设要求主成分的累计方差贡献率大于 $75 \\%$, 那么只需取前两个主成分即可, 即 $k=2$, 因为\n\n$$\n\\frac{\\lambda_{1}+\\lambda_{2}}{\\sum_{i=1}^{4} \\lambda_{i}}=0.76\n$$\n\n求出对应于特征值 $\\lambda_{1}, \\lambda_{2}$ 的单位特征向量, 列于表 16.2 , 表中最后一列为主成分的方差贡献率。\n\n表 16.2 单位特征向量和主成分的方差贡献率\n\n\\begin{center}\n\\begin{tabular}{cccccc}\n\\hline\n项目 & $x_{1}$ & $x_{2}$ & $x_{3}$ & $x_{4}$ & 方差贡献率 \\\\\n\\hline\n$y_{1}$ & 0.460 & 0.476 & 0.523 & 0.537 & 0.543 \\\\\n$y_{2}$ & 0.574 & 0.486 & -0.476 & -0.456 & 0.218 \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\n由此按照式 (16.50) 可得第一、第二主成分:\n\n$$\n\\begin{aligned}\n& y_{1}=0.460 x_{1}+0.476 x_{2}+0.523 x_{3}+0.537 x_{4} \\\\\n& y_{2}=0.574 x_{1}+0.486 x_{2}-0.476 x_{3}-0.456 x_{4}\n\\end{aligned}\n$$\n\n这就是主成分分析的结果。变量 $y_{1}$ 和 $y_{2}$ 表示第一、第二主成分。\\\\\n接下来由特征值和单位特征向量求出第一、第二主成分的因子负荷量, 以及第一、第二主成分对变量 $x_{i}$ 的贡献率, 列于表 16.3 。\n\n表 16.3 主成分的因子负荷量和贡献率\n\n\\begin{center}\n\\begin{tabular}{ccccc}\n\\hline\n项目 & $x_{1}$ & $x_{2}$ & $x_{3}$ & $x_{4}$ \\\\\n\\hline\n$y_{1}$ & 0.678 & 0.701 & 0.770 & 0.791 \\\\\n$y_{2}$ & 0.536 & 0.453 & -0.444 & -0.425 \\\\\n$y_{1}, y_{2}$ 对 $x_{i}$ 的贡献率 & 0.747 & 0.697 & 0.790 & 0.806 \\\\\n\\hline\n\\end{tabular}\n\\end{center}\n\n从表 16.3 中可以看出, 第一主成分 $y_{1}$ 对应的因子负荷量 $\\rho\\left(y_{1}, x_{i}\\right), i=1,2,3,4$, 均为正数, 表明各门课程成绩提高都可使 $y_{1}$ 提高, 也就是说, 第一主成分 $y_{1}$ 反映了学生的整体成绩。还可以看出, 因子负荷量的数值相近, 且 $\\rho\\left(y_{1}, x_{4}\\right)$ 的数值最大, 这表明物理成绩在整体成绩中占最重要位置。\n\n第二主成分 $y_{2}$ 对应的因子负荷量 $\\rho\\left(y_{2}, x_{i}\\right), i=1,2,3,4$, 有正有负, 正的是语文和外语,负的是数学和物理, 表明文科成绩提高都可使 $y_{2}$ 提高, 而理科成绩提高都可使 $y_{2}$ 降低, 也就是说, 第二主成分 $y_{2}$ 反映了学生的文科成绩与理科成绩的关系。\n\n图 16.3 将原变量 $x_{1}, x_{2}, x_{3}, x_{4}$ (分别表示语文、外语、数学、物理) 和主成分 $y_{1}, y_{2}$ (分别表示整体成绩、文科对理科成绩) 的因子负荷量在平面坐标系中表示, 从中可以看出变量之间的关系。 4 个原变量聚成了两类: 因子负荷量相近的语文、外语为一类, 数学、物理为一类, 前者反映文科课程成绩, 后者反映理科课程成绩。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_60436489efc55078c367g-08}\n\\end{center}\n\n图 16.3 因子负荷量的分布图"
    },
    {
        "id": "chatcmpl-947HGenBWJoKRUzXHWEEGs6J4khHR",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"主成分分析中，传统的协方差矩阵和相关矩阵的特征值分解有何作用？\",\n    \"回答1\": \"传统的主成分分析通过数据的协方差矩阵或相关矩阵的特征值分解进行，这一过程可以帮助我们找到数据中的主要变化方向，从而实现数据降维和特征提取的目的。\",\n    \"问题2\": \"主成分分析中，如何计算样本相关矩阵 $\\boldsymbol{R}$？\",\n    \"回答2\": \"在主成分分析中，计算样本相关矩阵 $\\boldsymbol{R}$ 的步骤是依据规范化数据矩阵，通过公式 $\\boldsymbol{R}=\\frac{1}{n-1} \\boldsymbol{X} \\boldsymbol{X}^{\\top}$ 来计算样本相关矩阵 $\\boldsymbol{R}$，其中 $r_{i j}=\\frac{1}{n-1} \\textstyle\\bigsum_{l=1}^{n} x_{i l} x_{l j}$。\",\n    \"问题3\": \"在主成分分析中，如何求解样本相关矩阵 $\\boldsymbol{R}$ 的特征值和对应的单位特征向量？\",\n    \"回答3\": \"求解样本相关矩阵 $\\boldsymbol{R}$ 的特征值和对应的单位特征向量的步骤是首先求解 $\\boldsymbol{R}$ 的特征方程 $|\\boldsymbol{R}-\\textstyle\\biglambda \\boldsymbol{I}|=0$，得到 $\\boldsymbol{R}$ 的 $m$ 个特征值 $\\textstyle\\biglambda_{1} \\textgeqslant \\textstyle\\biglambda_{2} \\textgeqslant \\textstyle\\bigcdots \\textgeqslant \\textstyle\\biglambda_{m}$。然后根据需要选择前 $k$ 个特征值对应的单位特征向量。\",\n    \"问题4\": \"主成分分析中，如何计算主成分的贡献率并确定主成分个数 $k$？\",\n    \"回答4\": \"在主成分分析中，可以通过求解方差贡献率 $\\textstyle\\bigsum_{i=1}^{k} \\texteta_{i}$ 达到预定值的主成分个数 $k$。具体做法是计算前 $k$ 个特征值对应的单位特征向量，并根据方差贡献率来确定保留的主成分个数。\",\n    \"问题5\": \"主成分分析中，如何计算样本主成分？\",\n    \"回答5\": \"在主成分分析中，可以通过线性变换，以 $k$ 个单位特征向量为系数进行线性变换，从而求出 $k$ 个样本主成分。具体公式为 $y_{i}=\\boldsymbol{a}_{i}^{\\top} \\boldsymbol{x}, i=1,2, \\textstyle\\bigcdots, k$。\",\n    \"问题6\": \"主成分分析得到的结果可以用于哪些机器学习方法的输入？\",\n    \"回答6\": \"主成分分析得到的结果可以用于其他机器学习方法的输入。例如，可以将样本点投影到以主成分为坐标轴的空间中，然后应用聚类算法就可以对样本点进行聚类。\",\n    \"问题7\": \"在例 16.1 中，为什么选择了前两个主成分？\",\n    \"回答7\": \"在例 16.1 中，选择了前两个主成分是因为它们对应的方差贡献率之和达到了预定值（大于 $75\\text{%}$），即 $\\frac{\\textstyle\\biglambda_{1}+\\textstyle\\biglambda_{2}}{\\textstyle\\bigsum_{i=1}^{4} \\textstyle\\biglambda_{i}}=0.76$。\",\n    \"问题8\": \"在例 16.1 中，第一、第二主成分 $y_{1}$ 和 $y_{2}$ 分别表示什么？\",\n    \"回答8\": \"在例 16.1 中，第一、第二主成分 $y_{1}$ 和 $y_{2}$ 分别表示整体成绩和文科对理科成绩。它们是通过线性变换得到的样本主成分，反映了学生考试成绩数据中的不同维度信息。\",\n    \"问题9\": \"在例 16.1 中，第一、第二主成分对应的因子负荷量有何含义？\",\n    \"回答9\": \"在例 16.1 中，第一、第二主成分对应的因子负荷量 $\\rho\\textleft(y_{1}, x_{i}\\textright), i=1,2,3,4$ 反映了各门课程成绩对应各个主成分的影响程度。它们提供了关于原变量与主成分之间关系的重要信息。\",\n    \"问题10\": \"在例 16.1 中，如何利用图示来解释变量之间的关系？\",\n    \"回答10\": \"在例 16.1 中，通过图示将原变量和主成分的因子负荷量在平面坐标系中表示，可以直观地展示变量之间的关系。这有助于理解不同变量之间的相关性和聚类关系。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710768314,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1471,
            "prompt_tokens": 5403,
            "total_tokens": 6874
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]