[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter8",
        "title": "18.1.2 生成模型",
        "content_length": 1881,
        "content": "Title: 18.1.2 生成模型\nContent:\n假设有单词集合 $W=\\left\\{w_{1}, w_{2}, \\cdots, w_{M}\\right\\}$, 其中 $M$ 是单词个数; 文本（指标）集合 $D=\\left\\{d_{1}, d_{2}, \\cdots, d_{N}\\right\\}$, 其中 $N$ 是文本个数; 话题集合 $Z=\\left\\{z_{1}, z_{2}, \\cdots, z_{K}\\right\\}$, 其中 $K$ 是预先设定的话题个数。随机变量 $w$ 取值于单词集合, 随机变量 $d$ 取值于文本集合, 随机变量 $z$ 取值于话题集合。概率分布 $P(d)$ 、条件概率分布 $P(z \\mid d)$ 、条件概率分布 $P(w \\mid z)$ 皆属于多项分布, 其中 $P(d)$ 表示生成文本 $d$ 的概率, $P(z \\mid d)$ 表示文本 $d$ 生成话题 $z$ 的概率, $P(w \\mid z)$ 表示话题 $z$ 生成单词 $w$ 的概率。\n\n每个文本 $d$ 拥有自己的话题概率分布 $P(z \\mid d)$, 每个话题 $z$ 拥有自己的单词概率分布 $P(w \\mid z)$, 也就是说一个文本的内容由其相关话题决定, 一个话题的内容由其相关单词决定。\n\n生成模型通过以下步骤生成文本-单词共现数据:\n\n（1）依据概率分布 $P(d)$, 从文本（指标）集合中随机选取一个文本 $d$, 共生成 $N$ 个文本,针对每个文本, 执行以下操作;\n\n(2) 在文本 $d$ 给定的条件下, 依据条件概率分布 $P(z \\mid d)$, 从话题集合随机选取一个话题 $z$, 共生成 $L$ 个话题, 这里 $L$ 是文本长度;\n\n(3) 在话题 $z$ 给定的条件下, 依据条件概率分布 $P(w \\mid z)$, 从单词集合中随机选取一个单词 $w$ 。\n\n注意这里为叙述方便, 假设文本都是等长的, 现实中不需要这个假设。\n\n生成模型中, 单词变量 $w$ 与文本变量 $d$ 是观测变量, 话题变量 $z$ 是隐变量。也就是说模型生成的是单词-话题-文本三元组 $(w, z, d)$ 的集合, 但观测到的是单词-文本二元组 $(w, d)$ 的集合, 观测数据表示为单词-文本矩阵 $T$ 的形式, 矩阵 $T$ 的行表示单词, 列表示文本, 元素表示单词-文本对 $(w, d)$ 的出现次数。\n\n从数据的生成过程可以推出, 文本-单词共现数据 $T$ 的生成概率为所有单词-文本对 $(w, d)$ 的生成概率的乘积:\n\n\n\\begin{equation*}\nP(T)=\\prod_{(w, d)} P(w, d)^{n(w, d)} \\tag{18.1}\n\\end{equation*}\n\n\n这里 $n(w, d)$ 表示 $(w, d)$ 的出现次数, 单词-文本对出现的总次数是 $N \\times L$ 。每个单词-文本对\\\\\n$(w, d)$ 的生成概率由以下公式决定:\n\n\n\\begin{align*}\nP(w, d) & =P(d) P(w \\mid d) \\\\\n& =P(d) \\sum_{z} P(w, z \\mid d) \\\\\n& =P(d) \\sum_{z} P(z \\mid d) P(w \\mid z) \\tag{18.2}\n\\end{align*}\n\n\n式 (18.2) 即生成模型的定义。\n\n生成模型假设在话题 $z$ 给定的条件下, 单词 $w$ 与文本 $d$ 条件独立, 即\n\n\n\\begin{equation*}\nP(w, z \\mid d)=P(z \\mid d) P(w \\mid z) \\tag{18.3}\n\\end{equation*}\n\n\n生成模型属于概率有向图模型, 可以用有向图 (directed graph) 表示, 如图 18.2 所示。图中实心圆表示观测变量, 空心圆表示隐变量, 箭头表示概率依存关系, 方框表示多次重复,方框内数字表示重复次数。文本变量 $d$ 是一个观测变量, 话题变量 $z$ 是一个隐变量, 单词变量 $w$ 是一个观测变量。\n\n\\begin{center}\n\\includegraphics[max width=\\textwidth]{2024_03_13_60436489efc55078c367g-31}\n\\end{center}\n\n图 18.2 概率潜在语义分析的生成模型"
    },
    {
        "id": "chatcmpl-947Qh0Lve3nXuhhxOgKrgcTaRAFrU",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"生成模型中的随机变量 $w$、$d$、$z$ 分别代表什么？\",\n    \"回答1\": \"随机变量 $w$ 取值于单词集合，代表一个单词；随机变量 $d$ 取值于文本集合，代表一个文本；随机变量 $z$ 取值于话题集合，代表一个话题。\",\n    \"问题2\": \"生成模型中的概率分布 $P(d)$ 表示什么意义？\",\n    \"回答2\": \"概率分布 $P(d)$ 表示生成文本 $d$ 的概率，即在给定单词和话题的情况下，生成特定文本的概率。\",\n    \"问题3\": \"生成模型中的条件概率分布 $P(z \\text{ ｜ } d)$ 表示什么意义？\",\n    \"回答3\": \"条件概率分布 $P(z \\text{ ｜ } d)$ 表示在给定文本 $d$ 的条件下，生成话题 $z$ 的概率，即文本与话题之间的关联概率。\",\n    \"问题4\": \"生成模型中的条件概率分布 $P(w \\text{ ｜ } z)$ 表示什么意义？\",\n    \"回答4\": \"条件概率分布 $P(w \\text{ ｜ } z)$ 表示在给定话题 $z$ 的条件下，生成单词 $w$ 的概率，即话题与单词之间的关联概率。\",\n    \"问题5\": \"生成模型中的观测变量和隐变量分别指代什么？\",\n    \"回答5\": \"生成模型中，单词变量 $w$ 与文本变量 $d$ 是观测变量，代表已知的数据；话题变量 $z$ 是隐变量，代表未知的隐藏信息。\",\n    \"问题6\": \"生成模型中的单词-文本共现数据是如何生成的？\",\n    \"回答6\": \"生成模型通过依据概率分布 $P(d)$、条件概率分布 $P(z \\text{ ｜ } d)$ 和条件概率分布 $P(w \\text{ ｜ } z)$，依次生成文本-单词共现数据。具体包括从文本集合中随机选取一个文本、在文本给定的条件下随机选取一个话题、以及在话题给定的条件下随机选取一个单词。\",\n    \"问题7\": \"生成模型中的观测数据表示为什么形式？\",\n    \"回答7\": \"生成模型中的观测数据表示为单词-文本矩阵 $T$ 的形式。矩阵 $T$ 的行表示单词，列表示文本，元素表示单词-文本对 $(w, d)$ 的出现次数。\",\n    \"问题8\": \"生成模型中的文本-单词共现数据的生成概率是如何计算的？\",\n    \"回答8\": \"文本-单词共现数据 $T$ 的生成概率为所有单词-文本对 $(w, d)$ 的生成概率的乘积。其中每个单词-文本对 $(w, d)$ 的生成概率由公式 $P(w, d) = P(d) P(w \\text{ ｜ } d) = P(d) \\text{ ｜ }_{z} P(w, z \\text{ ｜ } d)$ 决定。\",\n    \"问题9\": \"生成模型假设了什么条件独立性？\",\n    \"回答9\": \"生成模型假设在话题 $z$ 给定的条件下，单词 $w$ 与文本 $d$ 条件独立，即满足条件独立性假设 $P(w, z \\text{ ｜ } d) = P(z \\text{ ｜ } d) P(w \\text{ ｜ } z)$。\",\n    \"问题10\": \"生成模型属于哪种类型的概率图模型？\",\n    \"回答10\": \"生成模型属于概率有向图模型。它可以用有向图表示，其中实心圆表示观测变量，空心圆表示隐变量，箭头表示概率依存关系。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710768899,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1156,
            "prompt_tokens": 3961,
            "total_tokens": 5117
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]