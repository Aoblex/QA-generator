[
    {
        "strategy": "subsection",
        "source": "machine_learning_chapter7",
        "title": "14.3.3 算法",
        "content_length": 2996,
        "content": "Title: 14.3.3 算法\nContent:\n$k$ 均值聚类的算法是一个迭代的过程, 每次迭代包括两个步骤。首先选择 $k$ 个类的中心,将样本逐个指派到与其最近的中心的类中, 得到一个聚类结果; 然后更新每个类的样本的均值,作为类的新的中心; 重复以上步骤, 直到收玫为止。具体过程如下。\n\n首先, 对于给定的中心值 $\\left(m_{1}, m_{2}, \\cdots, m_{k}\\right)$, 求一个划分 $C$, 使得目标函数极小化:\n\n\n\\begin{equation*}\n\\min _{C} \\sum_{l=1}^{k} \\sum_{C(i)=l}\\left\\|x_{i}-m_{l}\\right\\|^{2} \\tag{14.22}\n\\end{equation*}\n\n\n就是说在类中心确定的情况下, 将每个样本分到一个类中, 使样本和其所属类的中心之间的距离总和最小。求解结果, 将每个样本指派到与其最近的中心 $m_{l}$ 的类 $G_{l}$ 中。\n\n然后, 对给定的划分 $C$, 再求各个类的中心 $\\left(m_{1}, m_{2}, \\cdots, m_{k}\\right)$, 使得目标函数极小化:\n\n$$\n\\min _{m_{1}, m_{2}, \\cdots, m_{k}} \\sum_{l=1}^{k} \\sum_{C(i)=l}\\left\\|x_{i}-m_{l}\\right\\|^{2}\n$$\n\n就是说在划分确定的情况下, 使样本和其所属类的中心之间的距离总和最小。求解结果, 对于每个包含 $n_{l}$ 个样本的类 $G_{l}$, 更新其均值 $m_{l}$ :\n\n$$\nm_{l}=\\frac{1}{n_{l}} \\sum_{C(i)=l} x_{i}, \\quad l=1,2, \\cdots, k\n$$\n\n重复以上两个步骤, 直到划分不再改变, 得到聚类结果。现将 $k$ 均值聚类算法叙述如下。\n\n\\section*{算法 14.2 ( $k$ 均值聚类算法)}\n输入: $n$ 个样本的集合 $X$ 。\n\n输出: 样本集合的聚类 $C^{*}$ 。\n\n(1) 初始化。令 $t=0$, 随机选择 $k$ 个样本点作为初始聚类中心 $m^{(0)}=\\left(m_{1}^{(0)}, \\cdots, m_{l}^{(0)}, \\cdots\\right.$, $\\left.m_{k}^{(0)}\\right)$ 。\n\n(2) 对样本进行聚类。对固定的类中心 $m^{(t)}=\\left(m_{1}^{(t)}, \\cdots, m_{l}^{(t)}, \\cdots, m_{k}^{(t)}\\right)$, 其中 $m_{l}^{(t)}$ 为类 $G_{l}$ 的中心, 计算每个样本到类中心的距离, 将每个样本指派到与其最近的中心的类中, 构成聚类结果 $C^{(t)}$ 。\n\n(3) 计算新的类中心。对聚类结果 $C^{(t)}$, 计算当前各个类中的样本的均值, 作为新的类中心 $m^{(t+1)}=\\left(m_{1}^{(t+1)}, \\cdots, m_{l}^{(t+1)}, \\cdots, m_{k}^{(t+1)}\\right)$ 。\n\n(4) 如果迭代收玫或符合停止条件, 输出 $C^{*}=C^{(t)}$; 否则, 令 $t=t+1$, 返回步骤 (2)。\n\n$k$ 均值聚类算法的复杂度是 $O(m n k)$, 其中 $m$ 是样本维数, $n$ 是样本个数, $k$ 是类别个数。\n\n例 14.2 给定含有 5 个样本的集合\n\n$$\nX=\\left[\\begin{array}{lllll}\n0 & 0 & 1 & 5 & 5 \\\\\n2 & 0 & 0 & 0 & 2\n\\end{array}\\right]\n$$\n\n试用 $k$ 均值聚类算法将样本聚到两个类中。\\\\\n解 按照算法 14.2:\n\n(1) 选择两个样本点作为类的中心。假设选择 $m_{1}^{(0)}=x_{1}=(0,2)^{\\mathrm{T}}, m_{2}^{(0)}=x_{2}=(0,0)^{\\mathrm{T}}$ 。\n\n(2) 以 $m_{1}^{(0)}, m_{2}^{(0)}$ 为类 $G_{1}^{(0)}, G_{2}^{(0)}$ 的中心, 计算 $x_{3}=(1,0)^{\\mathrm{T}}, x_{4}=(5,0)^{\\mathrm{T}}, x_{5}=(5,2)^{\\mathrm{T}}$与 $m_{1}^{(0)}=(0,2)^{\\mathrm{T}}, m_{2}^{(0)}=(0,0)^{\\mathrm{T}}$ 的欧氏距离平方。\n\n(a) 对 $x_{3}=(1,0)^{\\mathrm{T}}, d\\left(x_{3}, m_{1}^{(0)}\\right)=5, d\\left(x_{3}, m_{2}^{(0)}\\right)=1$, 将 $x_{3}$ 分到类 $G_{2}^{(0)}$ 。\n\n(b) 对 $x_{4}=(5,0)^{\\mathrm{T}}, d\\left(x_{4}, m_{1}^{(0)}\\right)=29, d\\left(x_{4}, m_{2}^{(0)}\\right)=25$, 将 $x_{4}$ 分到类 $G_{2}^{(0)}$ 。\n\n(c) 对 $x_{5}=(5,2)^{\\mathrm{T}}, d\\left(x_{5}, m_{1}^{(0)}\\right)=25, d\\left(x_{5}, m_{2}^{(0)}\\right)=29$, 将 $x_{5}$ 分到类 $G_{1}^{(0)}$ 。\n\n(3) 得到新的类 $G_{1}^{(1)}=\\left\\{x_{1}, x_{5}\\right\\}, G_{2}^{(1)}=\\left\\{x_{2}, x_{3}, x_{4}\\right\\}$, 计算类的中心 $m_{1}^{(1)}, m_{2}^{(1)}$ :\n\n$$\nm_{1}^{(1)}=(2.5,2.0)^{\\mathrm{T}}, \\quad m_{2}^{(1)}=(2,0)^{\\mathrm{T}}\n$$\n\n(4) 重复步骤 (2) 和步骤 (3)。将 $x_{1}$ 分到类 $G_{1}^{(1)}$, 将 $x_{2}$ 分到类 $G_{2}^{(1)}, x_{3}$ 分到类 $G_{2}^{(1)}, x_{4}$分到类 $G_{2}^{(1)}, x_{5}$ 分到类 $G_{1}^{(1)}$, 得到新的类 $G_{1}^{(2)}=\\left\\{x_{1}, x_{5}\\right\\}, G_{2}^{(2)}=\\left\\{x_{2}, x_{3}, x_{4}\\right\\}$ 。\n\n由于得到的新的类没有改变, 聚类停止。得到聚类结果:\n\n$$\nG_{1}^{*}=\\left\\{x_{1}, x_{5}\\right\\}, \\quad G_{2}^{*}=\\left\\{x_{2}, x_{3}, x_{4}\\right\\}\n$$"
    },
    {
        "id": "chatcmpl-93yzy2Y6HqJrCJ3GQ7K2dISQKKso6",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"在$k$均值聚类算法中，每次迭代的两个步骤分别是什么？\",\n    \"回答1\": \"在$k$均值聚类算法中，每次迭代包括两个步骤。首先选择$k$个类的中心，将样本逐个指派到与其最近的中心的类中，得到一个聚类结果；然后更新每个类的样本的均值，作为类的新的中心。\",\n    \"问题2\": \"如何定义$k$均值聚类算法的目标函数？\",\n    \"回答2\": \"对于给定的中心值$\\big(m_{1}, m_{2}, \\text{...}, m_{k}\\big)$，$k$均值聚类算法的目标函数是求一个划分$C$，使得目标函数极小化：$\\text{min}_{C} \\text{  }\\bigg(\\text{min}_{C(i)=l} \\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\big\\\\|x_{i}-m_{l}\\\\|^2 \\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  }\\text{  } \\forall l=1,2,\\text{...},k \\bigg) \\text{  }$。\",\n    \"问题3\": \"在$k$均值聚类算法中，如何更新每个类的样本的均值作为新的中心？\",\n    \"回答3\": \"在$k$均值聚类算法中，对于给定的划分$C$，更新每个类的样本的均值$m_{l}$的计算公式为：$m_{l}=\\frac{1}{n_{l}} \\text{  }\\text{  }\\text{  }\\text{  } \\text{  } \\text{sum}_{C(i)=l} x_{i}, \\forall l=1,2,\\text{...},k$。\",\n    \"问题4\": \"在$k$均值聚类算法中，如何确定迭代结束并得到最终聚类结果？\",\n    \"回答4\": \"在$k$均值聚类算法中，当迭代收敛或符合停止条件时，即划分不再改变时，算法结束并得到最终聚类结果。\",\n    \"问题5\": \"请简要叙述$k$均值聚类算法的具体过程。\",\n    \"回答5\": \"$k$均值聚类算法的具体过程包括：初始化；对样本进行聚类；计算新的类中心；迭代直到划分不再改变。在每次迭代中，首先选择$k$个样本点作为初始聚类中心，然后计算每个样本到类中心的距离，并将每个样本指派到与其最近的中心的类中，得到一个聚类结果；接着计算当前各个类中的样本的均值，作为新的类中心；重复以上步骤直到划分不再改变，得到最终聚类结果。\",\n    \"问题6\": \"请简要说明$k$均值聚类算法的时间复杂度。\",\n    \"回答6\": \"$k$均值聚类算法的时间复杂度是$O(m n k)$，其中$m$是样本维数，$n$是样本个数，$k$是类别个数。\",\n    \"问题7\": \"例14.2中给定了一个包含5个样本的集合，请问如何使用$k$均值聚类算法将这些样本聚到两个类中？\",\n    \"回答7\": \"按照例14.2中给定的集合和算法步骤进行计算：首先选择两个样本点作为初始聚类中心；然后以初始聚类中心为基础计算每个样本到类中心的距离，并将每个样本指派到与其最近的中心的类中；接着计算当前各个类中的样本的均值，作为新的类中心；重复以上步骤直到划分不再改变，得到最终聚类结果。\",\n    \"问题8\": \"在例14.2中给出了最终的聚类结果，请问最终得到了哪些聚类？\",\n    \"回答8\": \"在例14.2中得到了最终的聚类结果：$G_{1}^{*}=\\bigg\\\\{x_{1}, x_{5}\\bigg\\\\}$和$G_{2}^{*}=\\bigg\\\\{x_{2}, x_{3}, x_{4}\\bigg\\\\}$。\",\n    \"问题9\": \"例14.2展示了如何使用$k$均值聚类算法将给定集合进行聚类，请问该例子展示了怎样一种情况下的聚类过程？\",\n    \"回答9\": \"例14.2展示了在给定含有5个样本的集合下，使用$k$均值聚类算法将这些样本聚到两个类中的具体过程。通过选择初始聚类中心、计算距离、更新新的类中心等步骤展示了整个聚类过程。\",\n    \"问题10\": \"在$k$均值聚类算法中，为什么需要重复以上两个步骤直到划分不再改变？\",\n    \"回答10\": \"在$k$均值聚类算法中需要重复以上两个步骤直到划分不再改变是为了确保得到稳定且收敛于最优解的最终聚类结果。通过反复迭代直至收敛可以有效地优化和调整各个样本点所属的簇，从而得到更加准确和稳定的聚类结果。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710736490,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1668,
            "prompt_tokens": 4614,
            "total_tokens": 6282
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]