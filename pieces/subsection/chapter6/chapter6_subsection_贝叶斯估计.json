[
    {
        "strategy": "subsection",
        "source": "chapter6",
        "title": "贝叶斯估计",
        "content_length": 4258,
        "content": "Title: 贝叶斯估计\nContent:\n\\label{ssec:6.4.3}\n\n由后验分布 $\\pi(\\theta|\\boldsymbol{X})$ 估计 $\\theta$ 有三种常用的方法：\n\\begin{itemize}\n\\item 使用后验分布的密度函数最大值点作为 $\\theta$ 的点估计的最大后验估计;\n\\item 使用后验分布的中位数作为 $\\theta$ 的点估计的后验中位数估计;\n\\item 使用后验分布的均值作为 $\\theta$ 的点估计的后验期望估计.\n\\end{itemize}\n用得最多的是后验期望估计, 它一般也简称为贝叶斯估计, 记为的 $\\hat{\\theta}_\\theta$.\n\n\\begin{example}\\label{exam:6.4.2}\n设某事件 $A$ 在一次试验中发生的概率为 $\\theta$, 为估计 $\\theta$, 对试验进行了 $n$ 次独立观测, 其中事件 $A$ 发生了 $X$ 次, 显然 $X | \\theta \\sim b(n, \\theta)$, 即\n\\[P(X=x | \\theta)=\\Binom nx \\theta^{x}(1-\\theta)^{n-x}, \\quad x=0,1, \\cdots, n\\]\n假若我们在试验前对事件 $A$ 没有什么了解, 从而对其发生的概率日也没有任何信息. 在这种场合, 贝叶斯本人建议采用“同等无知”的原则使用区间 $(0,1)$ 上的均匀分布 $U(0,1)$ 作为 $\\theta$ 的先验分布, 因为它取 $(0,1)$ 上的每一点的机会均等.\n贝叶斯的这个建议被后人称为贝叶斯假设, 由此即可利用贝叶斯公式求出 $\\theta$ 的后验分布. 具体如下: 先写出 $X$ 和 $\\theta$ 的联合分布\n\\[h(x, \\theta)=\\Binom nx \\theta^{x}(1-\\theta)^{n-x}, \\quad x=0,1, \\cdots, n, \\quad 0<\\theta<1\\]\n然后求 $X$ 的边际分布\n\\[m(x)=\\Binom nx \\int_{0}^{1} \\theta^{x}(1-\\theta)^{n \\cdot x} \\mathrm{d} \\theta=\\Binom nx \\frac{\\Gamma(x+1) \\Gamma(n-x+1)}{\\Gamma(n+2)}\\]\n最后求出 $\\theta$ 的后验分布\n\\begin{align*} \\pi(\\theta | x) &=\\frac{h(x, \\theta)}{m(x)} \\\\ &=\\frac{\\Gamma(n+2)}{\\Gamma(x+1) \\Gamma(n-x+1)} \\theta^{(x+1)-1}(1-\\theta)^{(n-x+1)-1}, \\quad 0<\\theta<1 \\end{align*}\n最后的结果说明 $\\theta | x \\sim B e(x+1, n-x+1)$，其后验期望估计为\n\\begin{equation}\\label{eq:6.4.4}\n\\hat{\\theta}_{\\mathrm{B}}=E(\\theta | x)=\\frac{x+1}{n+2}\n\\end{equation}\n假如不用先验信息, 只用总体信息与样本信息, 那么事件A发生的概率的最大似然估计为\n\\[\\hat{\\theta}_{M}=\\frac{x}{n}\\]\n它与贝叶斯估计是不同的两个估计. 某些场合, 贝叶斯估计要比最大似然估计更合理一点. 比如, 在产品抽样检验中只区分合格品和不合格品, 对质量好的产品批, 抽检的产品常为合格品, 但“抽检3个全是合格品”与“抽检10个全是合格品”这两个事件在人们心目中留下的印象是不同的, 后者的质量比前者更信得过.这种差别在不合格品率 $\\theta$ 最大似然估计 $\\hat{\\theta}_M$ 中反映不出来(两者都为 $\\theta$), 而用贝叶斯估计 $\\hat{\\theta}_B$ 则有所反映，两者分别是 $1/(3+2)=0.20$ 和 $1/(10+2)=0.083$. 类似地, 对质量差的产品批, 抽检的产品常为不合格品, 这时“抽检3个全是不合格品”与“抽检10个全是不合格品”也是有差别的两个事件, 前者质量很差, 后者则不可救药.这种差别用 $\\hat{\\theta}_M$ 也反映不出(两者都是1), 而 $\\hat{\\theta}_B$ 则分别是 $(3+1)/(3+2)=0.80$ 和 $(10+1)/(10+2)=0.917$. 由此可以看到, 在这些极端情况下, 贝叶斯估计比最大似然估计更符合人们的理念\n\\end{example}\n\n\\begin{example}\\label{exam:6.4.3}\n设 $x_{1}, \\cdots, x_{n}$ 是来自正态分布 $N\\left(\\mu, \\sigma_{0}^{2}\\right)$ 的一个样本, 其中品已知, $\\mu$ 未知, 假设 $\\mu$ 的先验分布亦为正态分布 $N\\left(\\theta, \\tau^{2}\\right)$, 其中先验均值8和先验方差 $\\tau^2$ 均已知, 试求 $\\mu$ 的贝叶斯估计.\n\\end{example}\\begin{solution}\n样本 $\\boldsymbol X$ 的分布和 $\\mu$ 的先验分布分别为\n\\[p(\\boldsymbol{X} | \\mu)=\\left(2 \\pi \\sigma_{0}^{2}\\right)^{-n / 2} \\exp \\left\\{-\\frac{1}{2 \\sigma_{0}^{2}} \\sum_{i=1}^{n}\\left(x_{i}-\\mu\\right)^{2}\\right\\}\\]\n\\[\\pi(\\mu)=\\left(2 \\pi \\tau^{2}\\right)^{-1 / 2} \\exp \\left\\{-\\frac{1}{2 \\tau^{2}}(\\mu-\\theta)^{2}\\right\\}\\]\n由此可以写出 $\\boldsymbol X$ 与 $\\mu$ 的联合分布\n\\[h(\\boldsymbol{X}, \\mu)=k_{1} \\cdot \\exp \\left\\{-\\frac{1}{2}\\left[\\frac{n_{\\mu}^{2}-2 n \\mu \\overline{x}+\\sum_{i=1}^{n} x_{i}^{2}}{\\sigma_{0}^{2}}+\\frac{\\mu^{2}-2 \\theta_{\\mu}+\\theta^{2}}{\\tau^{2}}\\right]\\right\\}\\]\n其中 $\\overline{x}=\\frac{1}{n} \\sum_{i=1}^{n} x_{i}, k_{1}=(2 \\pi)^{-(n+1) / 2} \\tau^{-1} \\sigma_{0}^{-n}$, 若记\n\\[A=\\frac{n}{\\sigma_{0}^{2}}+\\frac{1}{\\tau^{2}}, \\quad B=\\frac{n \\overline{x}}{\\sigma_{0}^{2}}+\\frac{\\theta}{\\tau^{2}}, \\quad C=\\frac{\\sum_{i=1}^{n} x_{i}^{2}}{\\sigma_{0}^{2}}+\\frac{\\theta^{2}}{\\tau^{2}}\\]\n则有\n\\begin{align*} h(\\boldsymbol{X}, \\mu) &=k_{1} \\exp \\left\\{-\\frac{1}{2}\\left[A \\mu^{2}-2 B\\mu+C\\right]\\right \\} \\\\ &=k_{1} \\exp \\left\\{-\\frac{(\\mu-B / A)^{2}}{2 / A}-\\frac{1}{2}\\left(C-B^{2} / A\\right)\\right\\} \\end{align*}\n注意到 $A,B,C$ 均与 $\\mu$ 无关, 由此容易算得样本的边际密度函数\n\\[m(\\boldsymbol{X})=\\int_{-\\infty}^{+\\infty} h(\\boldsymbol{X}, \\mu) \\mathrm{d}\\mu=k_{1} \\exp \\left\\{-\\frac{1}{2}\\left(C-B^{2} / A\\right)\\right\\}(2 \\pi / A)^{1 / 2}\\]\n应用贝叶斯公式即可得到后验分布\n\\[\\pi(\\mu|\\boldsymbol{X})=\\frac{h(\\boldsymbol{X}, \\underline{\\mu})}{m(\\boldsymbol{X})}=(2 \\pi / A)^{1 / 2} \\exp \\left\\{-\\frac{1}{2 / A}\\left(\\mu-B(A)^{2}\\right)\\right\\}\\]\n这说明在样本给定后, $\\mu$ 的后验分布为 $N(B/A,1/A)$, 即\n\\[\\mu | \\mathbf{X} \\sim N\\left(\\frac{n \\overline{x} \\sigma_{0}^{-2}+\\theta_{\\tau}^{-2}}{n \\sigma_{0}^{-2}+r^{-2}}, \\frac{1}{n \\sigma_{0}^{-2}+\\tau^{-2}}\\right)\\]\n后验均值即为其贝叶斯估计:\n\\[\\dot{\\mu}=\\frac{n / \\sigma_{0}^{2}}{n / \\sigma_{0}^{2}+1 / \\tau^{2}} \\bar{x}+\\frac{1 / \\tau^{2}}{n / \\sigma_{0}^{2}+1 / r^{2}} \\theta\\]\n它是样本均值 $\\bar x$ 与先验均值 $\\theta$ 的加权平均. 当总体方差 $\\sigma_0^2$ 较小或样本量 $n$ 较大时, 样本均值 $\\bar x$ 的权重较大; 当先验方差 $\\tau^2$ 较小时, 先验均值 $\\theta$ 的权重较大, 这一综合很符合人们的经验, 也是可以接收的.\n\\end{solution}"
    },
    {
        "id": "chatcmpl-947d2oReYywXU7dj0N2iZ9Ux5VfSc",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"贝叶斯估计中的三种常用方法分别是什么？\",\n    \"回答1\": \"贝叶斯估计中的三种常用方法分别是：使用后验分布的密度函数最大值点作为 $\\theta$ 的点估计的最大后验估计；使用后验分布的中位数作为 $\\theta$ 的点估计的后验中位数估计；使用后验分布的均值作为 $\\theta$ 的点估计的后验期望估计。\",\n    \"问题2\": \"贝叶斯估计中最常用的方法是哪一种？它还有什么别称？\",\n    \"回答2\": \"贝叶斯估计中最常用的方法是后验期望估计，它一般也简称为贝叶斯估计。\",\n    \"问题3\": \"在贝叶斯估计中，如果没有先验信息，贝叶斯建议采用什么分布作为参数的先验分布？\",\n    \"回答3\": \"在贝叶斯估计中，如果没有先验信息，贝叶斯建议采用区间 $(0,1)$ 上的均匀分布 $U(0,1)$ 作为参数的先验分布，因为它取 $(0,1)$ 上的每一点的机会均等。\",\n    \"问题4\": \"在贝叶斯估计中，如何求出参数的后验分布？\",\n    \"回答4\": \"在贝叶斯估计中，可以利用贝叶斯公式求出参数的后验分布。具体步骤是先写出参数和样本的联合分布，然后求出样本的边际分布，最后得到参数的后验分布。\",\n    \"问题5\": \"在贝叶斯估计中，如果不使用先验信息，对于事件发生概率的最大似然估计是什么？\",\n    \"回答5\": \"在贝叶斯估计中，如果不使用先验信息，对于事件发生概率的最大似然估计是事件发生次数与总次数的比值，即 $\\frac{x}{n}$。\",\n    \"问题6\": \"在贝叶斯估计中，贝叶斯估计和最大似然估计有何区别？\",\n    \"回答6\": \"在贝叶斯估计中，贝叶斯估计和最大似然估计是两种不同的参数估计方法。贝叶斯估计考虑了先验信息，并通过后验分布得到参数的点估计；而最大似然估计则只利用样本信息来得到参数的点估计。\",\n    \"问题7\": \"在某些情况下，为什么贝叶斯估计比最大似然估计更合理？\",\n    \"回答7\": \"在某些情况下，贝叶斯估计比最大似然估计更合理，因为贝叶斯估计能够更好地反映不同事件发生概率之间的差异。例如，在产品抽样检验中，对于不同抽检情况下事件发生概率的差异，贝叶斯估计能够更好地进行区分和反映。\",\n    \"问题8\": \"在给定正态分布样本和正态分布先验下，如何求解参数的贝叶斯估计？\",\n    \"回答8\": \"在给定正态分布样本和正态分布先验下，可以通过应用贝叶斯公式得到参数的后验分布，并进而求解参数的后验期望作为贝叶斯估计。具体步骤包括写出样本和参数的联合分布、求出样本的边际密度函数、应用贝叶斯公式得到后验分布，并最终得到参数的后验期望作为贝叶斯估计。\",\n    \"问题9\": \"在给定正态分布样本和正态分布先验下，参数的后验期望是如何求解得到的？\",\n    \"回答9\": \"在给定正态分布样本和正态分布先验下，参数的后验期望可以通过应用贝叶斯公式得到后验分布，并进而求解得到。具体表达式为 $\\frac{n / \\theta_{0}^{2}}{n / \\theta_{0}^{2}+1 / \\tau^{2}} \\bar{x}+\\frac{1 / \\tau^{2}}{n / \\theta_{0}^{2}+1 / \\tau^{2}} \\theta$。\",\n    \"问题10\": \"在给定正态分布样本和正态分布先验下，参数的后验期望与哪些因素相关？\",\n    \"回答10\": \"在给定正态分布样本和正态分布先验下，参数的后验期望与样本均值 $\\bar x$ 和先验均值 $\\theta$ 相关，并且其权重由总体方差 $\\theta_{0}^{2}$、样本量 $n$ 和先验方差 $\\tau^{2}$ 决定。当总体方差较小或样本量较大时，样本均值 $\\bar x$ 的权重较大；当先验方差较小时，先验均值 $\\theta$ 的权重较大。\" \n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710769664,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1488,
            "prompt_tokens": 5221,
            "total_tokens": 6709
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]