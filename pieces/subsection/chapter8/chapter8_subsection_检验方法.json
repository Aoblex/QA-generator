[
    {
        "strategy": "subsection",
        "source": "chapter8",
        "title": "检验方法",
        "content_length": 5638,
        "content": "Title: 检验方法\nContent:\n偏差平方和 $Q$ 的大小与数据个数(或自由度)有关,一般说来,数据越多,其偏差平方和越大. 为了便于在偏差平方和间进行比较,统计上引入了均方和的概念,它定义为\n\\begin{equation*}\n  MS=Q/f_Q,\n\\end{equation*}\n其意为平均每个自由度上有多少平方和,它比较好地度量了一组数据的离散程度.\n\n如今要对因子平方和SA与误差平方和S2之间进行比较,用其均方和\n\\begin{equation*}\n  MS_{A}=S_A / f_A, \\quad MS_{e}=S_{e}/f_{e}\n\\end{equation*}\n\n\n进行比较更为合理,因为均方和排除了自由度不同所产生的干扰.故用\n\\begin{equation}\\label{eq:8.1.17}\n  F = \\frac{MS_{A}}{MS_{e}} = \\frac{S_A/f_A}{S_e/f_e}\n\\end{equation}\n作为检验 $H_0$ 的统计量,为给出检验拒绝域,我们需要如下定理：\n\n\\begin{theorem}{}{8.1.2}\n  在单因子方差分析模型~\\eqref{eq:8.1.8} 及前述符号下,有\n  \\begin{enumerate}\n    \\item $S_{\\varepsilon} / \\sigma^{2} \\sim \\chi^{2}(n-r)$, 从而 $E(S_{e})=(n-r) \\sigma^{2}$ \\label{enum:8.1.2.1}\n    \\item $E(S_{A})=(r-1) \\sigma^{2} + m \\sum_{i=1}^{r} a_{i}^{2}$, 进一步, 若 $H_0$ 成立, 则有 $S_{A} / \\sigma^{2} \\sim \\chi^{2}(r-1)$;\\label{enum:8.1.2.2}\n    \\item $S_A$ 与 $S_e$ 独立 \\label{enum:8.1.2.3}.\n  \\end{enumerate}\n\\end{theorem}\n\n\\begin{proof}\n由于~\\eqref{eq:8.1.11} 和~\\eqref{eq:8.1.14}, $S_{e}=\\sum_{i=1}^{r} \\sum_{j=1}^{m}(\\varepsilon_{i j}-\\bar{\\varepsilon_{i\\cdot}})^{2}$, 在单因子方差分析模型~\\eqref{eq:8.1.8} 下, 我们知道, 诸 $\\varepsilon_{ij}, \\; i=1,2,\\cdots,r,\\; j=1,2,\\cdots,m$ 独立同分布于 $N(0,\\sigma^2)$,由定理~\\ref{thm:5.4.1} 知,$\\frac{1}{\\sigma^2} \\sum_{j=1}^m (\\varepsilon_{ij} - \\bar{\\varepsilon}_{i\\cdot})^2$, $i=1,2,\\cdots,r$, 相互独立,其共同分布为 $\\chi^2(m-1)$,由卡方分布的可加性,有 $\\frac{S_e}{\\sigma^2} \\sim \\chi^2(n-r)$,这给出 $E(S_e/\\sigma^2) = n-r=f_e$, ~\\ref{enum:8.1.2.1}得证.\n\n类似地,由~\\eqref{eq:8.1.12} 和~\\eqref{eq:8.1.15},有\n\\begin{equation*}\n  S_A =  m \\sum_{i=1}^r (a_i + \\varepsilon_{i\\cdot} - \\bar{\\varepsilon})^2.\n\\end{equation*}\n由定理~\\ref{thm:5.4.1} 知,对每个 $i$,平方和 $\\sum_{j=1}^m (\\varepsilon_{ij} - \\bar{\\varepsilon}_{i\\cdot})^2$ 与均值 $\\bar{\\varepsilon}_{i}$ 独立,从而 $\\bar{\\varepsilon}_{1.}, \\bar{\\varepsilon}_{2.},\\cdots,\\bar{\\varepsilon}_{r.}$ 与 $S_e$ 独立,而 $S_A$ 只是,$\\bar{\\varepsilon}_{1.}, \\bar{\\varepsilon}_{2.},\\cdots,\\bar{\\varepsilon}_{r.}$ 的函数,由此~\\ref{enum:8.1.2.3} 得证.\n\n在模型~\\ref{eq:8.1.8} 下， $S_A$ 的期望是\n\\begin{equation*}\n  E(S_A) = m \\sum_{i=1}^r a^2 + E\\big[m\\sum_{i=1}^r (\\bar{\\varepsilon}_{i\\cdot} - \\bar{\\varepsilon})^2\\big],\n\\end{equation*}\n由于诸误差均值 $\\bar{\\varepsilon}_{1.}, \\bar{\\varepsilon}_{2.},\\cdots,\\bar{\\varepsilon}_{r.}$ 独立同分布于 $N(0, \\sigma^2/m)$,从而由诸误差均值组成的偏差平方和除以 $\\sigma^2/m$ 服从卡方分布,即\n\\begin{equation*}\n  \\frac{1}{\\sigma^{2}} \\sum_{i=1}^{r} m\\left(\\bar{\\varepsilon}_{i},-\\bar{\\varepsilon}\\right)^{2}-\\chi^{2}(r-1).\n\\end{equation*}\n于是, $E\\big[\\sum_{i=1}^r m(\\bar{\\varepsilon}_{i\\cdot} - \\bar{\\varepsilon})\\big]$ 在 $H_0$ 成立下,$S_A/\\sigma^2 \\sim \\chi^2(r-1)$, 这就完成了~\\ref{enum:8.1.2.2} 的证明.\n\\end{proof}\n\n由定理`\\ref{thm:8.1.2} 知,若 $H_0$ 成立,则 \\eqref{eq:8.1.17} 定义的检验统计量 $F$ 服从自由度为 $f_A$ 和 $f_e$ 的 $F$ 分布,因此,由假设检验的一般理论,拒绝域为\n\n\\begin{equation}\\label{eq:8.1.18}\nW =\\left\\lvert F \\geq F_{1-\\alpha}(f_{A}, f_{e}) \\right\\rvert .\n\\end{equation}\n\n通常将上述计算过程列成一张表格,称为方差分析表,见表~\\ref{tab:8.1.3}\n\n\\begin{table}[htbp]\n\\centering\n\\caption{单因子方差分析表\\label{tab:8.1.3}}\n\\begin{tabular}{ccccc}\n\\toprule\n来源 & 平方和 & 自由度 & 均方和 & $F$ 比\\\\\n\\midrule\n因子 & $S_A$ & $f_{A} = r-1$ & $MS_{A} = S_{A}/f_A$ & $F = MS_{A}/MS_{e}$ \\\\\n误差 & $S_{e}$ & $f_{e} = n - r$ & $MS_{e} = S_e/f_e$ & \\\\\n\\midrule\n总和 & $S_{T}$ & $f_{T} = n - 1$ & & \\\\\n\\bottomrule\n\\end{tabular}\n\\end{table}\n\n对给定的 $\\alpha$,可作如下判断：\n\\begin{itemize}\n\\item 如果 $F > F_{1-\\alpha}(f_A,f_e)$,则认为因子 $A$ 显著；\n\\item 若 $F \\leq F_{1-\\alpha}(f_A, f_e)$,则说明因子 $A$ 不显著.\n\\end{itemize}\n该检验的 $p$ 值也可利用统计软件求出,若以 $Y$ 记服从 $F(f_A,f_e)$ 的随机变量,则检验的 $p$ 值为 $p = P(Y \\geq F)$.\n\n经过简单推导,可以给出常用的各偏差平方和的计算公式如下：\n\n\\begin{align}\nS_T &= \\sum_{i=1}^{r}\\sum_{j=1}^{m} y_{ij}^2 - \\frac{T^2}{n}; \\notag\\\\\nS_A &= \\frac{1}{m} \\sum_{i=1}^{r} T_{i}^2 - \\frac{T^2}{n}; \\label{eq:8.1.19}\\\\\nS_e &= S_T - S_A \\notag\n\\end{align}\n\n一般可将计算过程列表进行,见下例.\n\n\\begin{example}\\label{exam:8.1.2}\n采用例~\\ref{exam:8.1.1} 的数据,由偏差平方和的公式可以看出,对数据作一个线性变换是不影响方差分析的结果的,本例中,我们将原始数据同时减去 $1000$,并用列表的办法给出计算过程：\n\\end{example}\n\n% Table generated by Excel2LaTeX from sheet 'Sheet1'\n\\begin{table}[htbp]\n  \\centering\n  \\caption{例~\\ref{exam:8.1.2} 的计算表}\n    \\begin{tabular}{rrrrrrrrrrrr}\n    \\toprule\n    \\multicolumn{1}{l}{水平} & \\multicolumn{8}{c}{数据(原始数据 $-1000$)}                             & \\multicolumn{1}{c}{$T_i$} & \\multicolumn{1}{c}{$T_i^2$} & \\multicolumn{1}{c}{$\\sum_{j=1}^{m} y_{ij}^2$} \\\\\n    \\midrule\n    \\multicolumn{1}{l}{$A_1$} & 73    & 9     & 60    & 1     & 2     & 12    & 9     & 28    & 194   & 37636 & 10024 \\\\\n    \\multicolumn{1}{l}{$A_2$} & 107   & 92    & -10   & 109   & 90    & 74    & 122   & 1     & 585   & 342225 & 60355 \\\\\n    \\multicolumn{1}{l}{$A_3$} & 93    & 29    & 80    & 21    & 22    & 32    & 29    & 48    & 354   & 125316 & 20984 \\\\\n    \\midrule\n          &       &       &       &       &       &       &       &       & 1133  & 505177 & 91363 \\\\\n    \\bottomrule\n    \\end{tabular}%\n  \\label{tab:8.1.4}%\n\\end{table}%\n\n利用~\\eqref{eq:8.1.19},可算得各偏差平方和为：\n\n\\begin{align*}\nS_T & = 91363 - \\frac{1133^2}{24} = 37876.04, && f_T = 24-1=23,\\\\\nS_A &= \\frac{505177}{8} - \\frac{1133^2}{24} = 9660.08, && f_A = 3 - 1 = 2,\\\\\nS_e &= S_{T} - S_A = 37876.04 - 9660.08 = 28215.96, && f_{e} = 3(8-1)=21.\n\\end{align*}\n\n把上述诸平方和及其自由度填入方差分析表,并继续计算得到各均方和以及 $F$ 比,见表~\\ref{tab:8.1.5}.\n\n% Table generated by Excel2LaTeX from sheet 'Sheet1'\n\\begin{table}[htbp]\n  \\centering\n  \\caption{\\ref{exam:8.1.2} 的方差分析表}\n    \\begin{tabular}{lcccc}\n    \\toprule\n    来源    & 平方和   & 自由度   & 均方和   & $F$ 比 \\\\\n    \\midrule\n    因子 $A$  & 9660.08 & 2     & 4830.04 & 3.59 \\\\\n    误差 $e$  & 28215.96 & 21    & 1343.62 &  \\\\\n    总和 $T$  & 37876.04 & 23    &       &  \\\\\n    \\bottomrule\n    \\end{tabular}%\n  \\label{tab:8.1.5}%\n\\end{table}%\n\n\n\n若取 $a=0.05$,则 $F_{0.95} (2, 21)=3.47$,由于 $F=3.59>3.47$,故认为因子 $A$(饲料)是显著的,即三种饲料对鸡的增肥作用有明显的差别."
    },
    {
        "id": "chatcmpl-9492MMpBH3Du5JuKwUnu5nSSnzEHp",
        "choices": [
            {
                "finish_reason": "stop",
                "index": 0,
                "logprobs": null,
                "message": {
                    "content": "{\n    \"问题1\": \"均方和与偏差平方和有什么关系？\",\n    \"回答1\": \"均方和 $MS$ 是偏差平方和 $Q$ 除以自由度 $f_Q$ 得到的结果，它表示平均每个自由度上有多少平方和。因此，均方和是用来度量一组数据的离散程度的统计量。\",\n    \"问题2\": \"为什么在比较因子平方和 $S_A$ 与误差平方和 $S_e$ 时使用均方和更为合理？\",\n    \"回答2\": \"在比较因子平方和 $S_A$ 与误差平方和 $S_e$ 时使用均方和更为合理，因为均方和排除了自由度不同所产生的干扰，能够更准确地反映因子效应和误差效应对数据的影响。\",\n    \"问题3\": \"检验统计量 $F$ 的计算公式是什么？\",\n    \"回答3\": \"检验统计量 $F$ 的计算公式为 $F = \\frac{MS_{A}}{MS_{e}} = \\frac{S_A/f_A}{S_e/f_e}$，其中 $MS_{A}$ 和 $MS_{e}$ 分别表示因子平方和和误差平方和的均方和，$f_A$ 和 $f_e$ 分别表示因子平方和和误差平方和的自由度。\",\n    \"问题4\": \"定理8.1.2中给出了哪些关于单因子方差分析模型的结论？\",\n    \"回答4\": \"定理8.1.2给出了关于单因子方差分析模型的三个结论：1. $S_{\\text{e}} / \\text{σ}^{2} \\text{ 服从 } \\text{χ}^{2}(n-r)$；2. 若 $H_0$ 成立，则有 $E(S_{A})=(r-1) \\text{σ}^{2} + m \\text{Σ}_{i=1}^{r} a_{i}^{2}$，并且若 $H_0$ 成立，则有 $S_{A} / \\text{σ}^{2} \\text{ 服从 } \\text{χ}^{2}(r-1)$；3. $S_A$ 与 $S_e$ 独立。\",\n    \"问题5\": \"在假设检验中，如何确定检验拒绝域？\",\n    \"回答5\": \"在假设检验中，确定检验拒绝域的方法是利用检验统计量 $F$ 与临界值进行比较。若 $F > F_{1-\\text{α}}(f_A,f_e)$，则认为因子 $A$ 显著；若 $F ≤ F_{1-\\text{α}}(f_A, f_e)$，则说明因子 $A$ 不显著。\",\n    \"问题6\": \"如何计算各偏差平方和？\",\n    \"回答6\": \"一般可通过公式进行计算各偏差平方和：$S_T = Σ_{i=1}^{r}Σ_{j=1}^{m} y_{ij}^2 - \\frac{T^2}{n}$；$S_A = \\frac{1}{m} Σ_{i=1}^{r} T_{i}^2 - \\frac{T^2}{n}$；$S_e = S_T - S_A$。这些公式可以用于计算各偏差平方和，进而进行单因子方差分析。\",\n    \"问题7\": \"为什么在例~8.1.2中进行了数据的线性变换？\",\n    \"回答7\": \"在例~8.1.2中进行了数据的线性变换是为了说明对数据作一个线性变换不影响方差分析的结果。这一步骤旨在展示数据处理对最终分析结果的影响程度。\",\n    \"问题8\": \"如何判断因子对数据的影响是否显著？\",\n    \"回答8\": \"判断因子对数据的影响是否显著可以通过比较检验统计量 $F$ 与临界值来实现。若检验统计量 $F > F_{1-\\text{α}}(f_A,f_e)$，则认为因子显著；若 $F ≤ F_{1-\\text{α}}(f_A, f_e)$，则说明因子不显著。\",\n    \"问题9\": \"如何计算检验的 $p$ 值？\",\n    \"回答9\": \"计算检验的 $p$ 值可以利用统计软件求出。若以 $Y$ 记服从 $F(f_A,f_e)$ 的随机变量，则检验的 $p$ 值为 $p = P(Y ≥ F)$。\",\n    \"问题10\": \"在单因子方差分析中，如何利用方差分析表进行判断？\",\n    \"回答10\": \"在单因子方差分析中，可以通过填入各平方和及其自由度到方差分析表，并继续计算得到各均方和以及 $F$ 比。然后根据给定的显著性水平 $\\text{α}$，通过比较检验统计量 $F$ 与临界值来判断因子对数据的影响是否显著。\"\n}",
                    "role": "assistant",
                    "function_call": null,
                    "tool_calls": null
                }
            }
        ],
        "created": 1710775078,
        "model": "gpt-3.5-turbo-1106",
        "object": "chat.completion",
        "system_fingerprint": "fp_4aaaf0dc94",
        "usage": {
            "completion_tokens": 1436,
            "prompt_tokens": 5878,
            "total_tokens": 7314
        },
        "parameters": {
            "model": "gpt-3.5-turbo-1106",
            "temperature": 0.2,
            "frequency_penalty": 0.15,
            "presence_penalty": 0.15
        }
    }
]